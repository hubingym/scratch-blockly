var COMPILED=true;var goog={};var Blockly={};var _global={Blockly:Blockly,goog:goog};goog.global=_global;goog.global.CLOSURE_UNCOMPILED_DEFINES;goog.global.CLOSURE_DEFINES;goog.isDef=function(e){return void 0!==e};goog.isString=function(e){return"string"==typeof e};goog.isBoolean=function(e){return"boolean"==typeof e};goog.isNumber=function(e){return"number"==typeof e};goog.exportPath_=function(e,o,t){var i=e.split(".");var r=t||goog.global;if(!(i[0]in r)&&"undefined"!=typeof r.execScript)r.execScript("var "+i[0]);for(var n;i.length&&(n=i.shift());)if(!i.length&&goog.isDef(o))r[n]=o;else if(r[n]&&r[n]!==Object.prototype[n])r=r[n];else r=r[n]={}};goog.define=function(e,o){var t=o;goog.exportPath_(e,t)};goog.define("goog.DEBUG",true);goog.define("goog.LOCALE","en");goog.define("goog.TRUSTED_SITE",true);goog.define("goog.STRICT_MODE_COMPATIBLE",false);goog.define("goog.DISALLOW_TEST_ONLY_CODE",!goog.DEBUG);goog.define("goog.ENABLE_CHROME_APP_SAFE_SCRIPT_LOADING",false);goog.provide=function(e){if(goog.isInModuleLoader_())throw new Error("goog.provide can not be used within a module.");goog.constructNamespace_(e)};goog.constructNamespace_=function(e,o){goog.exportPath_(e,o)};goog.VALID_MODULE_RE_=/^[a-zA-Z_$][a-zA-Z0-9._$]*$/;goog.module=function(e){if(!goog.isString(e)||!e||-1==e.search(goog.VALID_MODULE_RE_))throw new Error("Invalid module identifier");if(!goog.isInGoogModuleLoader_())throw new Error("Module "+e+" has been loaded incorrectly. Note, "+"modules cannot be loaded as normal scripts. They require some kind of "+"pre-processing step. You're likely trying to load a module via a "+"script tag or as a part of a concatenated bundle without rewriting the "+"module. For more info see: "+"https://github.com/google/closure-library/wiki/goog.module:-an-ES6-module-like-alternative-to-goog.provide.");if(goog.moduleLoaderState_.moduleName)throw new Error("goog.module may only be called once per module.");goog.moduleLoaderState_.moduleName=e};goog.module.get=function(e){return goog.module.getInternal_(e)};goog.module.getInternal_=function(e){return null};goog.ModuleType={ES6:"es6",GOOG:"goog"};goog.moduleLoaderState_=null;goog.isInModuleLoader_=function(){return goog.isInGoogModuleLoader_()||goog.isInEs6ModuleLoader_()};goog.isInGoogModuleLoader_=function(){return!!goog.moduleLoaderState_&&goog.moduleLoaderState_.type==goog.ModuleType.GOOG};goog.isInEs6ModuleLoader_=function(){return!!goog.moduleLoaderState_&&goog.moduleLoaderState_.type==goog.ModuleType.ES6};goog.getModulePath_=function(){return goog.moduleLoaderState_&&goog.moduleLoaderState_.path};goog.module.declareLegacyNamespace=function(){goog.moduleLoaderState_.declareLegacyNamespace=true};goog.setTestOnly=function(e){if(goog.DISALLOW_TEST_ONLY_CODE){e=e||"";throw new Error("Importing test-only code into non-debug environment"+(e?": "+e:"."))}};goog.forwardDeclare=function(e){};goog.forwardDeclare("Document");goog.forwardDeclare("HTMLScriptElement");goog.forwardDeclare("XMLHttpRequest");goog.getObjectByName=function(e,o){var t=e.split(".");var i=o||goog.global;for(var r=0;r<t.length;r++){i=i[t[r]];if(!goog.isDefAndNotNull(i))return null}return i};goog.globalize=function(e,o){var t=o||goog.global;for(var i in e)t[i]=e[i]};goog.addDependency=function(e,o,t,i){};goog.define("goog.ENABLE_DEBUG_LOADER",true);goog.logToConsole_=function(e){if(goog.global.console)goog.global.console["error"](e)};goog.isPath_=function(e){return 0==e.indexOf("./")||0==e.indexOf("../")};goog.require=function(e){if(goog.isPath_(e))if(goog.isInGoogModuleLoader_()){if(!goog.getModulePath_())throw new Error("Current module has no path information. Was it loaded via "+"goog.loadModule without a path argument?");e=goog.normalizePath_(goog.getModulePath_()+"/../"+e)}else throw new Error("Cannot require by path outside of goog.modules.")};goog.basePath="";goog.global.CLOSURE_BASE_PATH;goog.global.CLOSURE_NO_DEPS;goog.global.CLOSURE_IMPORT_SCRIPT;goog.nullFunction=function(){};goog.abstractMethod=function(){throw new Error("unimplemented abstract method")};goog.addSingletonGetter=function(e){e.instance_=void 0;e.getInstance=function(){if(e.instance_)return e.instance_;if(goog.DEBUG)goog.instantiatedSingletons_[goog.instantiatedSingletons_.length]=e;return e.instance_=new e}};goog.instantiatedSingletons_=[];goog.define("goog.LOAD_MODULE_USING_EVAL",true);goog.define("goog.SEAL_MODULE_EXPORTS",goog.DEBUG);goog.loadedModules_={};goog.DEPENDENCIES_ENABLED=!COMPILED;goog.define("goog.TRANSPILE","detect");goog.define("goog.TRANSPILER","transpile.js");goog.hasBadLetScoping=null;goog.useSafari10Workaround=function(){if(null==goog.hasBadLetScoping){var hasBadLetScoping;try{hasBadLetScoping=!eval('"use strict";'+"let x = 1; function f() { return typeof x; };"+'f() == "number";')}catch(e){hasBadLetScoping=false}goog.hasBadLetScoping=hasBadLetScoping}return goog.hasBadLetScoping};goog.workaroundSafari10EvalBug=function(e){return"(function(){"+e+"\n"+";"+"})();\n"};goog.loadModule=function(e,o){var t=goog.moduleLoaderState_;try{goog.moduleLoaderState_={moduleName:"",declareLegacyNamespace:false,type:goog.ModuleType.GOOG,path:o};var i;if(goog.isFunction(e))i=e.call(void 0,{});else if(goog.isString(e)){if(goog.useSafari10Workaround())e=goog.workaroundSafari10EvalBug(e);i=goog.loadModuleFromSource_.call(void 0,e)}else throw new Error("Invalid module definition");var r=goog.moduleLoaderState_.moduleName;if(goog.isString(r)&&r){if(goog.moduleLoaderState_.declareLegacyNamespace)goog.constructNamespace_(r,i);else if(goog.SEAL_MODULE_EXPORTS&&Object.seal&&"object"==typeof i&&null!=i)Object.seal(i);var n={exports:i,type:goog.ModuleType.GOOG,moduleId:goog.moduleLoaderState_.moduleName};goog.loadedModules_[r]=n;o&&(goog.loadedModules_[o]=n)}else throw new Error('Invalid module name "'+r+'"')}finally{goog.moduleLoaderState_=t}};goog.loadModuleFromSource_=function(){var exports={};eval(arguments[0]);return exports};goog.normalizePath_=function(e){var o=e.split("/");var t=0;while(t<o.length)if("."==o[t])o.splice(t,1);else if(t&&".."==o[t]&&o[t-1]&&".."!=o[t-1])o.splice(--t,2);else t++;return o.join("/")};goog.global.CLOSURE_LOAD_FILE_SYNC;goog.loadFileSync_=function(e){if(goog.global.CLOSURE_LOAD_FILE_SYNC)return goog.global.CLOSURE_LOAD_FILE_SYNC(e);else try{var o=new goog.global["XMLHttpRequest"];o.open("get",e,false);o.send();return 0==o.status||200==o.status?o.responseText:null}catch(e){return null}};goog.transpile_=function(code,path){var jscomp=goog.global["$jscomp"];if(!jscomp)goog.global["$jscomp"]=jscomp={};var transpile=jscomp.transpile;if(!transpile){var transpilerPath=goog.basePath+goog.TRANSPILER;var transpilerCode=goog.loadFileSync_(transpilerPath);if(transpilerCode){(function(){eval(transpilerCode+"\n//# sourceURL="+transpilerPath)}).call(goog.global);if(goog.global["$gwtExport"]&&goog.global["$gwtExport"]["$jscomp"]&&!goog.global["$gwtExport"]["$jscomp"]["transpile"])throw new Error('The transpiler did not properly export the "transpile" '+"method. $gwtExport: "+JSON.stringify(goog.global["$gwtExport"]));goog.global["$jscomp"].transpile=goog.global["$gwtExport"]["$jscomp"]["transpile"];jscomp=goog.global["$jscomp"];transpile=jscomp.transpile}}if(!transpile){var suffix=" requires transpilation but no transpiler was found.";transpile=jscomp.transpile=function(e,o){goog.logToConsole_(o+suffix);return e}}return transpile(code,path)};goog.typeOf=function(e){var o=typeof e;if("object"==o)if(e){if(e instanceof Array)return"array";else if(e instanceof Object)return o;var t=Object.prototype.toString.call(e);if("[object Window]"==t)return"object";if("[object Array]"==t||"number"==typeof e.length&&"undefined"!=typeof e.splice&&"undefined"!=typeof e.propertyIsEnumerable&&!e.propertyIsEnumerable("splice"))return"array";if("[object Function]"==t||"undefined"!=typeof e.call&&"undefined"!=typeof e.propertyIsEnumerable&&!e.propertyIsEnumerable("call"))return"function"}else return"null";else if("function"==o&&"undefined"==typeof e.call)return"object";return o};goog.isNull=function(e){return null===e};goog.isDefAndNotNull=function(e){return null!=e};goog.isArray=function(e){return"array"==goog.typeOf(e)};goog.isArrayLike=function(e){var o=goog.typeOf(e);return"array"==o||"object"==o&&"number"==typeof e.length};goog.isDateLike=function(e){return goog.isObject(e)&&"function"==typeof e.getFullYear};goog.isFunction=function(e){return"function"==goog.typeOf(e)};goog.isObject=function(e){var o=typeof e;return"object"==o&&null!=e||"function"==o};goog.getUid=function(e){return e[goog.UID_PROPERTY_]||(e[goog.UID_PROPERTY_]=++goog.uidCounter_)};goog.hasUid=function(e){return!!e[goog.UID_PROPERTY_]};goog.removeUid=function(e){if(null!==e&&"removeAttribute"in e)e.removeAttribute(goog.UID_PROPERTY_);try{delete e[goog.UID_PROPERTY_]}catch(e){}};goog.UID_PROPERTY_="closure_uid_"+(1e9*Math.random()>>>0);goog.uidCounter_=0;goog.getHashCode=goog.getUid;goog.removeHashCode=goog.removeUid;goog.cloneObject=function(e){var o=goog.typeOf(e);if("object"==o||"array"==o){if("function"===typeof e.clone)return e.clone();var t="array"==o?[]:{};for(var i in e)t[i]=goog.cloneObject(e[i]);return t}return e};goog.bindNative_=function(e,o,t){return e.call.apply(e.bind,arguments)};goog.bindJs_=function(e,o,t){if(!e)throw new Error;if(arguments.length>2){var i=Array.prototype.slice.call(arguments,2);return function(){var t=Array.prototype.slice.call(arguments);Array.prototype.unshift.apply(t,i);return e.apply(o,t)}}else return function(){return e.apply(o,arguments)}};goog.bind=function(e,o,t){if(Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code"))goog.bind=goog.bindNative_;else goog.bind=goog.bindJs_;return goog.bind.apply(null,arguments)};goog.partial=function(e,o){var t=Array.prototype.slice.call(arguments,1);return function(){var o=t.slice();o.push.apply(o,arguments);return e.apply(this,o)}};goog.mixin=function(e,o){for(var t in o)e[t]=o[t]};goog.now=goog.TRUSTED_SITE&&Date.now||function(){return+new Date};goog.globalEval=function(e){if(goog.global.execScript)goog.global.execScript(e,"JavaScript");else if(goog.global.eval){if(null==goog.evalWorksForGlobals_){try{goog.global.eval("var _evalTest_ = 1;")}catch(e){}if("undefined"!=typeof goog.global["_evalTest_"]){try{delete goog.global["_evalTest_"]}catch(e){}goog.evalWorksForGlobals_=true}else goog.evalWorksForGlobals_=false}if(goog.evalWorksForGlobals_)goog.global.eval(e);else{var o=goog.global.document;var t=o.createElement("SCRIPT");t.type="text/javascript";t.defer=false;t.appendChild(o.createTextNode(e));o.head.appendChild(t);o.head.removeChild(t)}}else throw new Error("goog.globalEval not available")};goog.evalWorksForGlobals_=null;goog.global.CLOSURE_CSS_NAME_MAP_FN;goog.getCssName=function(e,o){if("."==String(e).charAt(0))throw new Error('className passed in goog.getCssName must not start with ".".'+" You passed: "+e);var t=function(e){return goog.cssNameMapping_[e]||e};var i=function(e){var o=e.split("-");var i=[];for(var r=0;r<o.length;r++)i.push(t(o[r]));return i.join("-")};var r;if(goog.cssNameMapping_)r="BY_WHOLE"==goog.cssNameMappingStyle_?t:i;else r=function(e){return e};var n=o?e+"-"+r(o):r(e);if(goog.global.CLOSURE_CSS_NAME_MAP_FN)return goog.global.CLOSURE_CSS_NAME_MAP_FN(n);return n};goog.setCssNameMapping=function(e,o){goog.cssNameMapping_=e;goog.cssNameMappingStyle_=o};goog.global.CLOSURE_CSS_NAME_MAPPING;goog.getMsg=function(e,o){if(o)e=e.replace(/\{\$([^}]+)}/g,(function(e,t){return null!=o&&t in o?o[t]:e}));return e};goog.getMsgWithFallback=function(e,o){return e};goog.exportSymbol=function(e,o,t){goog.exportPath_(e,o,t)};goog.exportProperty=function(e,o,t){e[o]=t};goog.inherits=function(e,o){function t(){}t.prototype=o.prototype;e.superClass_=o.prototype;e.prototype=new t;e.prototype.constructor=e;e.base=function(e,t,i){var r=new Array(arguments.length-2);for(var n=2;n<arguments.length;n++)r[n-2]=arguments[n];return o.prototype[t].apply(e,r)}};goog.base=function(e,o,t){var i=arguments.callee.caller;if(goog.STRICT_MODE_COMPATIBLE||goog.DEBUG&&!i)throw new Error("arguments.caller not defined.  goog.base() cannot be used "+"with strict mode code. See "+"http://www.ecma-international.org/ecma-262/5.1/#sec-C");if("undefined"!==typeof i.superClass_){var r=new Array(arguments.length-1);for(var n=1;n<arguments.length;n++)r[n-1]=arguments[n];return i.superClass_.constructor.apply(e,r)}if("string"!=typeof o&&"symbol"!=typeof o)throw new Error("method names provided to goog.base must be a string or a symbol");var l=new Array(arguments.length-2);for(var n=2;n<arguments.length;n++)l[n-2]=arguments[n];var s=false;for(var g=e.constructor;g;g=g.superClass_&&g.superClass_.constructor)if(g.prototype[o]===i)s=true;else if(s)return g.prototype[o].apply(e,l);if(e[o]===i)return e.constructor.prototype[o].apply(e,l);else throw new Error("goog.base called from a method of one name "+"to a method of a different name")};goog.scope=function(e){if(goog.isInModuleLoader_())throw new Error("goog.scope is not supported within a module.");e.call(goog.global)};goog.defineClass=function(e,o){var t=o.constructor;var i=o.statics;if(!t||t==Object.prototype.constructor)t=function(){throw new Error("cannot instantiate an interface (no constructor defined).")};var r=goog.defineClass.createSealingConstructor_(t,e);if(e)goog.inherits(r,e);delete o.constructor;delete o.statics;goog.defineClass.applyProperties_(r.prototype,o);if(null!=i)if(i instanceof Function)i(r);else goog.defineClass.applyProperties_(r,i);return r};goog.defineClass.ClassDescriptor;goog.define("goog.defineClass.SEAL_CLASS_INSTANCES",goog.DEBUG);goog.defineClass.createSealingConstructor_=function(e,o){if(!goog.defineClass.SEAL_CLASS_INSTANCES)return e;var t=!goog.defineClass.isUnsealable_(o);var i=function(){var o=e.apply(this,arguments)||this;o[goog.UID_PROPERTY_]=o[goog.UID_PROPERTY_];if(this.constructor===i&&t&&Object.seal instanceof Function)Object.seal(o);return o};return i};goog.defineClass.isUnsealable_=function(e){return e&&e.prototype&&e.prototype[goog.UNSEALABLE_CONSTRUCTOR_PROPERTY_]};goog.defineClass.OBJECT_PROTOTYPE_FIELDS_=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"];goog.defineClass.applyProperties_=function(e,o){var t;for(t in o)if(Object.prototype.hasOwnProperty.call(o,t))e[t]=o[t];for(var i=0;i<goog.defineClass.OBJECT_PROTOTYPE_FIELDS_.length;i++){t=goog.defineClass.OBJECT_PROTOTYPE_FIELDS_[i];if(Object.prototype.hasOwnProperty.call(o,t))e[t]=o[t]}};goog.tagUnsealableClass=function(e){};goog.UNSEALABLE_CONSTRUCTOR_PROPERTY_="goog_defineClass_legacy_unsealable";goog.provide("goog.object");goog.object.is=function(e,o){if(e===o)return 0!==e||1/e===1/o;return e!==e&&o!==o};goog.object.forEach=function(e,o,t){for(var i in e)o.call(t,e[i],i,e)};goog.object.filter=function(e,o,t){var i={};for(var r in e)if(o.call(t,e[r],r,e))i[r]=e[r];return i};goog.object.map=function(e,o,t){var i={};for(var r in e)i[r]=o.call(t,e[r],r,e);return i};goog.object.some=function(e,o,t){for(var i in e)if(o.call(t,e[i],i,e))return true;return false};goog.object.every=function(e,o,t){for(var i in e)if(!o.call(t,e[i],i,e))return false;return true};goog.object.getCount=function(e){var o=0;for(var t in e)o++;return o};goog.object.getAnyKey=function(e){for(var o in e)return o};goog.object.getAnyValue=function(e){for(var o in e)return e[o]};goog.object.contains=function(e,o){return goog.object.containsValue(e,o)};goog.object.getValues=function(e){var o=[];var t=0;for(var i in e)o[t++]=e[i];return o};goog.object.getKeys=function(e){var o=[];var t=0;for(var i in e)o[t++]=i;return o};goog.object.getValueByKeys=function(e,o){var t=goog.isArrayLike(o);var i=t?o:arguments;for(var r=t?0:1;r<i.length;r++){if(null==e)return;e=e[i[r]]}return e};goog.object.containsKey=function(e,o){return null!==e&&o in e};goog.object.containsValue=function(e,o){for(var t in e)if(e[t]==o)return true;return false};goog.object.findKey=function(e,o,t){for(var i in e)if(o.call(t,e[i],i,e))return i;return};goog.object.findValue=function(e,o,t){var i=goog.object.findKey(e,o,t);return i&&e[i]};goog.object.isEmpty=function(e){for(var o in e)return false;return true};goog.object.clear=function(e){for(var o in e)delete e[o]};goog.object.remove=function(e,o){var t;if(t=o in e)delete e[o];return t};goog.object.add=function(e,o,t){if(null!==e&&o in e)throw new Error('The object already contains the key "'+o+'"');goog.object.set(e,o,t)};goog.object.get=function(e,o,t){if(null!==e&&o in e)return e[o];return t};goog.object.set=function(e,o,t){e[o]=t};goog.object.setIfUndefined=function(e,o,t){return o in e?e[o]:e[o]=t};goog.object.setWithReturnValueIfNotSet=function(e,o,t){if(o in e)return e[o];var i=t();e[o]=i;return i};goog.object.equals=function(e,o){for(var t in e)if(!(t in o)||e[t]!==o[t])return false;for(var t in o)if(!(t in e))return false;return true};goog.object.clone=function(e){var o={};for(var t in e)o[t]=e[t];return o};goog.object.unsafeClone=function(e){var o=goog.typeOf(e);if("object"==o||"array"==o){if(goog.isFunction(e.clone))return e.clone();var t="array"==o?[]:{};for(var i in e)t[i]=goog.object.unsafeClone(e[i]);return t}return e};goog.object.transpose=function(e){var o={};for(var t in e)o[e[t]]=t;return o};goog.object.PROTOTYPE_FIELDS_=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"];goog.object.extend=function(e,o){var t,i;for(var r=1;r<arguments.length;r++){i=arguments[r];for(t in i)e[t]=i[t];for(var n=0;n<goog.object.PROTOTYPE_FIELDS_.length;n++){t=goog.object.PROTOTYPE_FIELDS_[n];if(Object.prototype.hasOwnProperty.call(i,t))e[t]=i[t]}}};goog.object.create=function(e){var o=arguments.length;if(1==o&&goog.isArray(arguments[0]))return goog.object.create.apply(null,arguments[0]);if(o%2)throw new Error("Uneven number of arguments");var t={};for(var i=0;i<o;i+=2)t[arguments[i]]=arguments[i+1];return t};goog.object.createSet=function(e){var o=arguments.length;if(1==o&&goog.isArray(arguments[0]))return goog.object.createSet.apply(null,arguments[0]);var t={};for(var i=0;i<o;i++)t[arguments[i]]=true;return t};goog.object.createImmutableView=function(e){var o=e;if(Object.isFrozen&&!Object.isFrozen(e)){o=Object.create(e);Object.freeze(o)}return o};goog.object.isImmutableView=function(e){return!!Object.isFrozen&&Object.isFrozen(e)};goog.object.getAllPropertyNames=function(e,o,t){if(!e)return[];if(!Object.getOwnPropertyNames||!Object.getPrototypeOf)return goog.object.getKeys(e);var i={};var r=e;while(r&&(r!==Object.prototype||!!o)&&(r!==Function.prototype||!!t)){var n=Object.getOwnPropertyNames(r);for(var l=0;l<n.length;l++)i[n[l]]=true;r=Object.getPrototypeOf(r)}return goog.object.getKeys(i)};goog.provide("goog.debug");goog.require("goog.array");goog.require("goog.debug.errorcontext");goog.require("goog.userAgent");goog.define("goog.debug.LOGGING_ENABLED",goog.DEBUG);goog.define("goog.debug.FORCE_SLOPPY_STACKS",false);goog.debug.catchErrors=function(e,o,t){var i=t||goog.global;var r=i.onerror;var n=!!o;if(goog.userAgent.WEBKIT&&!goog.userAgent.isVersionOrHigher("535.3"))n=!n;i.onerror=function(o,t,i,l,s){if(r)r(o,t,i,l,s);e({message:o,fileName:t,line:i,lineNumber:i,col:l,error:s});return n}};goog.debug.expose=function(e,o){if("undefined"==typeof e)return"undefined";if(null==e)return"NULL";var t=[];for(var i in e){if(!o&&goog.isFunction(e[i]))continue;var r=i+" = ";try{r+=e[i]}catch(e){r+="*** "+e+" ***"}t.push(r)}return t.join("\n")};goog.debug.deepExpose=function(e,o){var t=[];var i=[];var r={};var n=function(e,l){var s=l+"  ";var g=function(e){return e.replace(/\n/g,"\n"+l)};try{if(!goog.isDef(e))t.push("undefined");else if(goog.isNull(e))t.push("NULL");else if(goog.isString(e))t.push('"'+g(e)+'"');else if(goog.isFunction(e))t.push(g(String(e)));else if(goog.isObject(e)){if(!goog.hasUid(e))i.push(e);var a=goog.getUid(e);if(r[a])t.push("*** reference loop detected (id="+a+") ***");else{r[a]=true;t.push("{");for(var c in e){if(!o&&goog.isFunction(e[c]))continue;t.push("\n");t.push(s);t.push(c+" = ");n(e[c],s)}t.push("\n"+l+"}");delete r[a]}}else t.push(e)}catch(e){t.push("*** "+e+" ***")}};n(e,"");for(var l=0;l<i.length;l++)goog.removeUid(i[l]);return t.join("")};goog.debug.exposeArray=function(e){var o=[];for(var t=0;t<e.length;t++)if(goog.isArray(e[t]))o.push(goog.debug.exposeArray(e[t]));else o.push(e[t]);return"[ "+o.join(", ")+" ]"};goog.debug.normalizeErrorObject=function(e){var o=goog.getObjectByName("window.location.href");if(goog.isString(e))return{message:e,name:"Unknown error",lineNumber:"Not available",fileName:o,stack:"Not available"};var t,i;var r=false;try{t=e.lineNumber||e.line||"Not available"}catch(e){t="Not available";r=true}try{i=e.fileName||e.filename||e.sourceURL||goog.global["$googDebugFname"]||o}catch(e){i="Not available";r=true}if(r||!e.lineNumber||!e.fileName||!e.stack||!e.message||!e.name)return{message:e.message||"Not available",name:e.name||"UnknownError",lineNumber:t,fileName:i,stack:e.stack||"Not available"};return e};goog.debug.enhanceError=function(e,o){var t;if(!(e instanceof Error)){t=Error(e);if(Error.captureStackTrace)Error.captureStackTrace(t,goog.debug.enhanceError)}else t=e;if(!t.stack)t.stack=goog.debug.getStacktrace(goog.debug.enhanceError);if(o){var i=0;while(t["message"+i])++i;t["message"+i]=String(o)}return t};goog.debug.enhanceErrorWithContext=function(e,o){var t=goog.debug.enhanceError(e);if(o)for(var i in o)goog.debug.errorcontext.addErrorContext(t,i,o[i]);return t};goog.debug.getStacktraceSimple=function(e){if(!goog.debug.FORCE_SLOPPY_STACKS){var o=goog.debug.getNativeStackTrace_(goog.debug.getStacktraceSimple);if(o)return o}var t=[];var i=arguments.callee.caller;var r=0;while(i&&(!e||r<e)){t.push(goog.debug.getFunctionName(i));t.push("()\n");try{i=i.caller}catch(e){t.push("[exception trying to get caller]\n");break}r++;if(r>=goog.debug.MAX_STACK_DEPTH){t.push("[...long stack...]");break}}if(e&&r>=e)t.push("[...reached max depth limit...]");else t.push("[end]");return t.join("")};goog.debug.MAX_STACK_DEPTH=50;goog.debug.getNativeStackTrace_=function(e){var o=new Error;if(Error.captureStackTrace){Error.captureStackTrace(o,e);return String(o.stack)}else{try{throw o}catch(e){o=e}var t=o.stack;if(t)return String(t)}return null};goog.debug.getStacktrace=function(e){var o;if(!goog.debug.FORCE_SLOPPY_STACKS){var t=e||goog.debug.getStacktrace;o=goog.debug.getNativeStackTrace_(t)}if(!o)o=goog.debug.getStacktraceHelper_(e||arguments.callee.caller,[]);return o};goog.debug.getStacktraceHelper_=function(e,o){var t=[];if(goog.array.contains(o,e))t.push("[...circular reference...]");else if(e&&o.length<goog.debug.MAX_STACK_DEPTH){t.push(goog.debug.getFunctionName(e)+"(");var i=e.arguments;for(var r=0;i&&r<i.length;r++){if(r>0)t.push(", ");var n;var l=i[r];switch(typeof l){case"object":n=l?"object":"null";break;case"string":n=l;break;case"number":n=String(l);break;case"boolean":n=l?"true":"false";break;case"function":n=goog.debug.getFunctionName(l);n=n?n:"[fn]";break;case"undefined":default:n=typeof l;break}if(n.length>40)n=n.substr(0,40)+"...";t.push(n)}o.push(e);t.push(")\n");try{t.push(goog.debug.getStacktraceHelper_(e.caller,o))}catch(e){t.push("[exception trying to get caller]\n")}}else if(e)t.push("[...long stack...]");else t.push("[end]");return t.join("")};goog.debug.setFunctionResolver=function(e){goog.debug.fnNameResolver_=e};goog.debug.getFunctionName=function(e){if(goog.debug.fnNameCache_[e])return goog.debug.fnNameCache_[e];if(goog.debug.fnNameResolver_){var o=goog.debug.fnNameResolver_(e);if(o){goog.debug.fnNameCache_[e]=o;return o}}var t=String(e);if(!goog.debug.fnNameCache_[t]){var i=/function ([^\(]+)/.exec(t);if(i){var r=i[1];goog.debug.fnNameCache_[t]=r}else goog.debug.fnNameCache_[t]="[Anonymous]"}return goog.debug.fnNameCache_[t]};goog.debug.makeWhitespaceVisible=function(e){return e.replace(/ /g,"[_]").replace(/\f/g,"[f]").replace(/\n/g,"[n]\n").replace(/\r/g,"[r]").replace(/\t/g,"[t]")};goog.debug.runtimeType=function(e){if(e instanceof Function)return e.displayName||e.name||"unknown type name";else if(e instanceof Object)return e.constructor.displayName||e.constructor.name||Object.prototype.toString.call(e);else return null===e?"null":typeof e};goog.debug.fnNameCache_={};goog.debug.fnNameResolver_;goog.debug.freezeInternal_=goog.DEBUG&&Object.freeze||function(e){return e};goog.debug.freeze=function(e){return{valueOf:function(){return goog.debug.freezeInternal_(e)}}.valueOf()};goog.provide("goog.debug.EntryPointMonitor");goog.provide("goog.debug.entryPointRegistry");goog.require("goog.asserts");goog.debug.EntryPointMonitor=function(){};goog.debug.EntryPointMonitor.prototype.wrap;goog.debug.EntryPointMonitor.prototype.unwrap;goog.debug.entryPointRegistry.refList_=[];goog.debug.entryPointRegistry.monitors_=[];goog.debug.entryPointRegistry.monitorsMayExist_=false;goog.debug.entryPointRegistry.register=function(e){goog.debug.entryPointRegistry.refList_[goog.debug.entryPointRegistry.refList_.length]=e;if(goog.debug.entryPointRegistry.monitorsMayExist_){var o=goog.debug.entryPointRegistry.monitors_;for(var t=0;t<o.length;t++)e(goog.bind(o[t].wrap,o[t]))}};goog.debug.entryPointRegistry.monitorAll=function(e){goog.debug.entryPointRegistry.monitorsMayExist_=true;var o=goog.bind(e.wrap,e);for(var t=0;t<goog.debug.entryPointRegistry.refList_.length;t++)goog.debug.entryPointRegistry.refList_[t](o);goog.debug.entryPointRegistry.monitors_.push(e)};goog.debug.entryPointRegistry.unmonitorAllIfPossible=function(e){var o=goog.debug.entryPointRegistry.monitors_;goog.asserts.assert(e==o[o.length-1],"Only the most recent monitor can be unwrapped.");var t=goog.bind(e.unwrap,e);for(var i=0;i<goog.debug.entryPointRegistry.refList_.length;i++)goog.debug.entryPointRegistry.refList_[i](t);o.length--};goog.provide("goog.debug.Error");goog.debug.Error=function(e){if(Error.captureStackTrace)Error.captureStackTrace(this,goog.debug.Error);else{var o=(new Error).stack;if(o)this.stack=o}if(e)this.message=String(e);this.reportErrorToServer=true};goog.inherits(goog.debug.Error,Error);goog.debug.Error.prototype.name="CustomError";goog.provide("goog.debug.errorcontext");goog.debug.errorcontext.addErrorContext=function(e,o,t){if(!e[goog.debug.errorcontext.CONTEXT_KEY_])e[goog.debug.errorcontext.CONTEXT_KEY_]={};e[goog.debug.errorcontext.CONTEXT_KEY_][o]=t};goog.debug.errorcontext.getErrorContext=function(e){return e[goog.debug.errorcontext.CONTEXT_KEY_]||{}};goog.debug.errorcontext.CONTEXT_KEY_="__closure__error__context__984382";goog.provide("goog.debug.LogBuffer");goog.require("goog.asserts");goog.require("goog.debug.LogRecord");goog.debug.LogBuffer=function(){goog.asserts.assert(goog.debug.LogBuffer.isBufferingEnabled(),"Cannot use goog.debug.LogBuffer without defining "+"goog.debug.LogBuffer.CAPACITY.");this.clear()};goog.debug.LogBuffer.getInstance=function(){if(!goog.debug.LogBuffer.instance_)goog.debug.LogBuffer.instance_=new goog.debug.LogBuffer;return goog.debug.LogBuffer.instance_};goog.define("goog.debug.LogBuffer.CAPACITY",0);goog.debug.LogBuffer.prototype.buffer_;goog.debug.LogBuffer.prototype.curIndex_;goog.debug.LogBuffer.prototype.isFull_;goog.debug.LogBuffer.prototype.addRecord=function(e,o,t){var i=(this.curIndex_+1)%goog.debug.LogBuffer.CAPACITY;this.curIndex_=i;if(this.isFull_){var r=this.buffer_[i];r.reset(e,o,t);return r}this.isFull_=i==goog.debug.LogBuffer.CAPACITY-1;return this.buffer_[i]=new goog.debug.LogRecord(e,o,t)};goog.debug.LogBuffer.isBufferingEnabled=function(){return goog.debug.LogBuffer.CAPACITY>0};goog.debug.LogBuffer.prototype.clear=function(){this.buffer_=new Array(goog.debug.LogBuffer.CAPACITY);this.curIndex_=-1;this.isFull_=false};goog.debug.LogBuffer.prototype.forEachRecord=function(e){var o=this.buffer_;if(!o[0])return;var t=this.curIndex_;var i=this.isFull_?t:-1;do{i=(i+1)%goog.debug.LogBuffer.CAPACITY;e(o[i])}while(i!=t)};goog.provide("goog.debug.LogManager");goog.provide("goog.debug.Loggable");goog.provide("goog.debug.Logger");goog.provide("goog.debug.Logger.Level");goog.require("goog.array");goog.require("goog.asserts");goog.require("goog.debug");goog.require("goog.debug.LogBuffer");goog.require("goog.debug.LogRecord");goog.debug.Loggable;goog.debug.Logger=function(e){this.name_=e;this.parent_=null;this.level_=null;this.children_=null;this.handlers_=null};goog.debug.Logger.ROOT_LOGGER_NAME="";goog.define("goog.debug.Logger.ENABLE_HIERARCHY",true);goog.define("goog.debug.Logger.ENABLE_PROFILER_LOGGING",false);if(!goog.debug.Logger.ENABLE_HIERARCHY){goog.debug.Logger.rootHandlers_=[];goog.debug.Logger.rootLevel_}goog.debug.Logger.Level=function(e,o){this.name=e;this.value=o};goog.debug.Logger.Level.prototype.toString=function(){return this.name};goog.debug.Logger.Level.OFF=new goog.debug.Logger.Level("OFF",1/0);goog.debug.Logger.Level.SHOUT=new goog.debug.Logger.Level("SHOUT",1200);goog.debug.Logger.Level.SEVERE=new goog.debug.Logger.Level("SEVERE",1e3);goog.debug.Logger.Level.WARNING=new goog.debug.Logger.Level("WARNING",900);goog.debug.Logger.Level.INFO=new goog.debug.Logger.Level("INFO",800);goog.debug.Logger.Level.CONFIG=new goog.debug.Logger.Level("CONFIG",700);goog.debug.Logger.Level.FINE=new goog.debug.Logger.Level("FINE",500);goog.debug.Logger.Level.FINER=new goog.debug.Logger.Level("FINER",400);goog.debug.Logger.Level.FINEST=new goog.debug.Logger.Level("FINEST",300);goog.debug.Logger.Level.ALL=new goog.debug.Logger.Level("ALL",0);goog.debug.Logger.Level.PREDEFINED_LEVELS=[goog.debug.Logger.Level.OFF,goog.debug.Logger.Level.SHOUT,goog.debug.Logger.Level.SEVERE,goog.debug.Logger.Level.WARNING,goog.debug.Logger.Level.INFO,goog.debug.Logger.Level.CONFIG,goog.debug.Logger.Level.FINE,goog.debug.Logger.Level.FINER,goog.debug.Logger.Level.FINEST,goog.debug.Logger.Level.ALL];goog.debug.Logger.Level.predefinedLevelsCache_=null;goog.debug.Logger.Level.createPredefinedLevelsCache_=function(){goog.debug.Logger.Level.predefinedLevelsCache_={};for(var e=0,o;o=goog.debug.Logger.Level.PREDEFINED_LEVELS[e];e++){goog.debug.Logger.Level.predefinedLevelsCache_[o.value]=o;goog.debug.Logger.Level.predefinedLevelsCache_[o.name]=o}};goog.debug.Logger.Level.getPredefinedLevel=function(e){if(!goog.debug.Logger.Level.predefinedLevelsCache_)goog.debug.Logger.Level.createPredefinedLevelsCache_();return goog.debug.Logger.Level.predefinedLevelsCache_[e]||null};goog.debug.Logger.Level.getPredefinedLevelByValue=function(e){if(!goog.debug.Logger.Level.predefinedLevelsCache_)goog.debug.Logger.Level.createPredefinedLevelsCache_();if(e in goog.debug.Logger.Level.predefinedLevelsCache_)return goog.debug.Logger.Level.predefinedLevelsCache_[e];for(var o=0;o<goog.debug.Logger.Level.PREDEFINED_LEVELS.length;++o){var t=goog.debug.Logger.Level.PREDEFINED_LEVELS[o];if(t.value<=e)return t}return null};goog.debug.Logger.getLogger=function(e){return goog.debug.LogManager.getLogger(e)};goog.debug.Logger.logToProfilers=function(e){if(goog.debug.Logger.ENABLE_PROFILER_LOGGING){var o=goog.global["msWriteProfilerMark"];if(o){o(e);return}var t=goog.global["console"];if(t&&t["timeStamp"])t["timeStamp"](e)}};goog.debug.Logger.prototype.getName=function(){return this.name_};goog.debug.Logger.prototype.addHandler=function(e){if(goog.debug.LOGGING_ENABLED)if(goog.debug.Logger.ENABLE_HIERARCHY){if(!this.handlers_)this.handlers_=[];this.handlers_.push(e)}else{goog.asserts.assert(!this.name_,"Cannot call addHandler on a non-root logger when "+"goog.debug.Logger.ENABLE_HIERARCHY is false.");goog.debug.Logger.rootHandlers_.push(e)}};goog.debug.Logger.prototype.removeHandler=function(e){if(goog.debug.LOGGING_ENABLED){var o=goog.debug.Logger.ENABLE_HIERARCHY?this.handlers_:goog.debug.Logger.rootHandlers_;return!!o&&goog.array.remove(o,e)}else return false};goog.debug.Logger.prototype.getParent=function(){return this.parent_};goog.debug.Logger.prototype.getChildren=function(){if(!this.children_)this.children_={};return this.children_};goog.debug.Logger.prototype.setLevel=function(e){if(goog.debug.LOGGING_ENABLED)if(goog.debug.Logger.ENABLE_HIERARCHY)this.level_=e;else{goog.asserts.assert(!this.name_,"Cannot call setLevel() on a non-root logger when "+"goog.debug.Logger.ENABLE_HIERARCHY is false.");goog.debug.Logger.rootLevel_=e}};goog.debug.Logger.prototype.getLevel=function(){return goog.debug.LOGGING_ENABLED?this.level_:goog.debug.Logger.Level.OFF};goog.debug.Logger.prototype.getEffectiveLevel=function(){if(!goog.debug.LOGGING_ENABLED)return goog.debug.Logger.Level.OFF;if(!goog.debug.Logger.ENABLE_HIERARCHY)return goog.debug.Logger.rootLevel_;if(this.level_)return this.level_;if(this.parent_)return this.parent_.getEffectiveLevel();goog.asserts.fail("Root logger has no level set.");return null};goog.debug.Logger.prototype.isLoggable=function(e){return goog.debug.LOGGING_ENABLED&&e.value>=this.getEffectiveLevel().value};goog.debug.Logger.prototype.log=function(e,o,t){if(goog.debug.LOGGING_ENABLED&&this.isLoggable(e)){if(goog.isFunction(o))o=o();this.doLogRecord_(this.getLogRecord(e,o,t))}};goog.debug.Logger.prototype.getLogRecord=function(e,o,t){if(goog.debug.LogBuffer.isBufferingEnabled())var i=goog.debug.LogBuffer.getInstance().addRecord(e,o,this.name_);else i=new goog.debug.LogRecord(e,String(o),this.name_);if(t)i.setException(t);return i};goog.debug.Logger.prototype.shout=function(e,o){if(goog.debug.LOGGING_ENABLED)this.log(goog.debug.Logger.Level.SHOUT,e,o)};goog.debug.Logger.prototype.severe=function(e,o){if(goog.debug.LOGGING_ENABLED)this.log(goog.debug.Logger.Level.SEVERE,e,o)};goog.debug.Logger.prototype.warning=function(e,o){if(goog.debug.LOGGING_ENABLED)this.log(goog.debug.Logger.Level.WARNING,e,o)};goog.debug.Logger.prototype.info=function(e,o){if(goog.debug.LOGGING_ENABLED)this.log(goog.debug.Logger.Level.INFO,e,o)};goog.debug.Logger.prototype.config=function(e,o){if(goog.debug.LOGGING_ENABLED)this.log(goog.debug.Logger.Level.CONFIG,e,o)};goog.debug.Logger.prototype.fine=function(e,o){if(goog.debug.LOGGING_ENABLED)this.log(goog.debug.Logger.Level.FINE,e,o)};goog.debug.Logger.prototype.finer=function(e,o){if(goog.debug.LOGGING_ENABLED)this.log(goog.debug.Logger.Level.FINER,e,o)};goog.debug.Logger.prototype.finest=function(e,o){if(goog.debug.LOGGING_ENABLED)this.log(goog.debug.Logger.Level.FINEST,e,o)};goog.debug.Logger.prototype.logRecord=function(e){if(goog.debug.LOGGING_ENABLED&&this.isLoggable(e.getLevel()))this.doLogRecord_(e)};goog.debug.Logger.prototype.doLogRecord_=function(e){if(goog.debug.Logger.ENABLE_PROFILER_LOGGING)goog.debug.Logger.logToProfilers("log:"+e.getMessage());if(goog.debug.Logger.ENABLE_HIERARCHY){var o=this;while(o){o.callPublish_(e);o=o.getParent()}}else for(var t=0,i;i=goog.debug.Logger.rootHandlers_[t++];)i(e)};goog.debug.Logger.prototype.callPublish_=function(e){if(this.handlers_)for(var o=0,t;t=this.handlers_[o];o++)t(e)};goog.debug.Logger.prototype.setParent_=function(e){this.parent_=e};goog.debug.Logger.prototype.addChild_=function(e,o){this.getChildren()[e]=o};goog.debug.LogManager={};goog.debug.LogManager.loggers_={};goog.debug.LogManager.rootLogger_=null;goog.debug.LogManager.initialize=function(){if(!goog.debug.LogManager.rootLogger_){goog.debug.LogManager.rootLogger_=new goog.debug.Logger(goog.debug.Logger.ROOT_LOGGER_NAME);goog.debug.LogManager.loggers_[goog.debug.Logger.ROOT_LOGGER_NAME]=goog.debug.LogManager.rootLogger_;goog.debug.LogManager.rootLogger_.setLevel(goog.debug.Logger.Level.CONFIG)}};goog.debug.LogManager.getLoggers=function(){return goog.debug.LogManager.loggers_};goog.debug.LogManager.getRoot=function(){goog.debug.LogManager.initialize();return goog.debug.LogManager.rootLogger_};goog.debug.LogManager.getLogger=function(e){goog.debug.LogManager.initialize();var o=goog.debug.LogManager.loggers_[e];return o||goog.debug.LogManager.createLogger_(e)};goog.debug.LogManager.createFunctionForCatchErrors=function(e){return function(o){var t=e||goog.debug.LogManager.getRoot();t.severe("Error: "+o.message+" ("+o.fileName+" @ Line: "+o.line+")")}};goog.debug.LogManager.createLogger_=function(e){var o=new goog.debug.Logger(e);if(goog.debug.Logger.ENABLE_HIERARCHY){var t=e.lastIndexOf(".");var i=e.substr(0,t);var r=e.substr(t+1);var n=goog.debug.LogManager.getLogger(i);n.addChild_(r,o);o.setParent_(n)}goog.debug.LogManager.loggers_[e]=o;return o};goog.provide("goog.debug.LogRecord");goog.debug.LogRecord=function(e,o,t,i,r){this.reset(e,o,t,i,r)};goog.debug.LogRecord.prototype.time_;goog.debug.LogRecord.prototype.level_;goog.debug.LogRecord.prototype.msg_;goog.debug.LogRecord.prototype.loggerName_;goog.debug.LogRecord.prototype.sequenceNumber_=0;goog.debug.LogRecord.prototype.exception_=null;goog.define("goog.debug.LogRecord.ENABLE_SEQUENCE_NUMBERS",true);goog.debug.LogRecord.nextSequenceNumber_=0;goog.debug.LogRecord.prototype.reset=function(e,o,t,i,r){if(goog.debug.LogRecord.ENABLE_SEQUENCE_NUMBERS)this.sequenceNumber_="number"==typeof r?r:goog.debug.LogRecord.nextSequenceNumber_++;this.time_=i||goog.now();this.level_=e;this.msg_=o;this.loggerName_=t;delete this.exception_};goog.debug.LogRecord.prototype.getLoggerName=function(){return this.loggerName_};goog.debug.LogRecord.prototype.getException=function(){return this.exception_};goog.debug.LogRecord.prototype.setException=function(e){this.exception_=e};goog.debug.LogRecord.prototype.setLoggerName=function(e){this.loggerName_=e};goog.debug.LogRecord.prototype.getLevel=function(){return this.level_};goog.debug.LogRecord.prototype.setLevel=function(e){this.level_=e};goog.debug.LogRecord.prototype.getMessage=function(){return this.msg_};goog.debug.LogRecord.prototype.setMessage=function(e){this.msg_=e};goog.debug.LogRecord.prototype.getMillis=function(){return this.time_};goog.debug.LogRecord.prototype.setMillis=function(e){this.time_=e};goog.debug.LogRecord.prototype.getSequenceNumber=function(){return this.sequenceNumber_};goog.provide("goog.Disposable");goog.provide("goog.dispose");goog.provide("goog.disposeAll");goog.require("goog.disposable.IDisposable");goog.Disposable=function(){this.creationStack;if(goog.Disposable.MONITORING_MODE!=goog.Disposable.MonitoringMode.OFF){if(goog.Disposable.INCLUDE_STACK_ON_CREATION)this.creationStack=(new Error).stack;goog.Disposable.instances_[goog.getUid(this)]=this}this.disposed_=this.disposed_;this.onDisposeCallbacks_=this.onDisposeCallbacks_};goog.Disposable.MonitoringMode={OFF:0,PERMANENT:1,INTERACTIVE:2};goog.define("goog.Disposable.MONITORING_MODE",0);goog.define("goog.Disposable.INCLUDE_STACK_ON_CREATION",true);goog.Disposable.instances_={};goog.Disposable.getUndisposedObjects=function(){var e=[];for(var o in goog.Disposable.instances_)if(goog.Disposable.instances_.hasOwnProperty(o))e.push(goog.Disposable.instances_[Number(o)]);return e};goog.Disposable.clearUndisposedObjects=function(){goog.Disposable.instances_={}};goog.Disposable.prototype.disposed_=false;goog.Disposable.prototype.onDisposeCallbacks_;goog.Disposable.prototype.isDisposed=function(){return this.disposed_};goog.Disposable.prototype.getDisposed=goog.Disposable.prototype.isDisposed;goog.Disposable.prototype.dispose=function(){if(!this.disposed_){this.disposed_=true;this.disposeInternal();if(goog.Disposable.MONITORING_MODE!=goog.Disposable.MonitoringMode.OFF){var e=goog.getUid(this);if(goog.Disposable.MONITORING_MODE==goog.Disposable.MonitoringMode.PERMANENT&&!goog.Disposable.instances_.hasOwnProperty(e))throw new Error(this+" did not call the goog.Disposable base "+"constructor or was disposed of after a clearUndisposedObjects "+"call");if(goog.Disposable.MONITORING_MODE!=goog.Disposable.MonitoringMode.OFF&&this.onDisposeCallbacks_&&this.onDisposeCallbacks_.length>0)throw new Error(this+" did not empty its onDisposeCallbacks queue. This "+"probably means it overrode dispose() or disposeInternal() "+"without calling the superclass' method.");delete goog.Disposable.instances_[e]}}};goog.Disposable.prototype.registerDisposable=function(e){this.addOnDisposeCallback(goog.partial(goog.dispose,e))};goog.Disposable.prototype.addOnDisposeCallback=function(e,o){if(this.disposed_){goog.isDef(o)?e.call(o):e();return}if(!this.onDisposeCallbacks_)this.onDisposeCallbacks_=[];this.onDisposeCallbacks_.push(goog.isDef(o)?goog.bind(e,o):e)};goog.Disposable.prototype.disposeInternal=function(){if(this.onDisposeCallbacks_)while(this.onDisposeCallbacks_.length)this.onDisposeCallbacks_.shift()()};goog.Disposable.isDisposed=function(e){if(e&&"function"==typeof e.isDisposed)return e.isDisposed();return false};goog.dispose=function(e){if(e&&"function"==typeof e.dispose)e.dispose()};goog.disposeAll=function(e){for(var o=0,t=arguments.length;o<t;++o){var i=arguments[o];if(goog.isArrayLike(i))goog.disposeAll.apply(null,i);else goog.dispose(i)}};goog.provide("goog.disposable.IDisposable");goog.disposable.IDisposable=function(){};goog.disposable.IDisposable.prototype.dispose=goog.abstractMethod;goog.disposable.IDisposable.prototype.isDisposed=goog.abstractMethod;goog.provide("goog.array");goog.require("goog.asserts");goog.define("goog.NATIVE_ARRAY_PROTOTYPES",goog.TRUSTED_SITE);goog.define("goog.array.ASSUME_NATIVE_FUNCTIONS",false);goog.array.peek=function(e){return e[e.length-1]};goog.array.last=goog.array.peek;goog.array.indexOf=goog.NATIVE_ARRAY_PROTOTYPES&&(goog.array.ASSUME_NATIVE_FUNCTIONS||Array.prototype.indexOf)?function(e,o,t){goog.asserts.assert(null!=e.length);return Array.prototype.indexOf.call(e,o,t)}:function(e,o,t){var i=null==t?0:t<0?Math.max(0,e.length+t):t;if(goog.isString(e)){if(!goog.isString(o)||1!=o.length)return-1;return e.indexOf(o,i)}for(var r=i;r<e.length;r++)if(r in e&&e[r]===o)return r;return-1};goog.array.lastIndexOf=goog.NATIVE_ARRAY_PROTOTYPES&&(goog.array.ASSUME_NATIVE_FUNCTIONS||Array.prototype.lastIndexOf)?function(e,o,t){goog.asserts.assert(null!=e.length);var i=null==t?e.length-1:t;return Array.prototype.lastIndexOf.call(e,o,i)}:function(e,o,t){var i=null==t?e.length-1:t;if(i<0)i=Math.max(0,e.length+i);if(goog.isString(e)){if(!goog.isString(o)||1!=o.length)return-1;return e.lastIndexOf(o,i)}for(var r=i;r>=0;r--)if(r in e&&e[r]===o)return r;return-1};goog.array.forEach=goog.NATIVE_ARRAY_PROTOTYPES&&(goog.array.ASSUME_NATIVE_FUNCTIONS||Array.prototype.forEach)?function(e,o,t){goog.asserts.assert(null!=e.length);Array.prototype.forEach.call(e,o,t)}:function(e,o,t){var i=e.length;var r=goog.isString(e)?e.split(""):e;for(var n=0;n<i;n++)if(n in r)o.call(t,r[n],n,e)};goog.array.forEachRight=function(e,o,t){var i=e.length;var r=goog.isString(e)?e.split(""):e;for(var n=i-1;n>=0;--n)if(n in r)o.call(t,r[n],n,e)};goog.array.filter=goog.NATIVE_ARRAY_PROTOTYPES&&(goog.array.ASSUME_NATIVE_FUNCTIONS||Array.prototype.filter)?function(e,o,t){goog.asserts.assert(null!=e.length);return Array.prototype.filter.call(e,o,t)}:function(e,o,t){var i=e.length;var r=[];var n=0;var l=goog.isString(e)?e.split(""):e;for(var s=0;s<i;s++)if(s in l){var g=l[s];if(o.call(t,g,s,e))r[n++]=g}return r};goog.array.map=goog.NATIVE_ARRAY_PROTOTYPES&&(goog.array.ASSUME_NATIVE_FUNCTIONS||Array.prototype.map)?function(e,o,t){goog.asserts.assert(null!=e.length);return Array.prototype.map.call(e,o,t)}:function(e,o,t){var i=e.length;var r=new Array(i);var n=goog.isString(e)?e.split(""):e;for(var l=0;l<i;l++)if(l in n)r[l]=o.call(t,n[l],l,e);return r};goog.array.reduce=goog.NATIVE_ARRAY_PROTOTYPES&&(goog.array.ASSUME_NATIVE_FUNCTIONS||Array.prototype.reduce)?function(e,o,t,i){goog.asserts.assert(null!=e.length);if(i)o=goog.bind(o,i);return Array.prototype.reduce.call(e,o,t)}:function(e,o,t,i){var r=t;goog.array.forEach(e,(function(t,n){r=o.call(i,r,t,n,e)}));return r};goog.array.reduceRight=goog.NATIVE_ARRAY_PROTOTYPES&&(goog.array.ASSUME_NATIVE_FUNCTIONS||Array.prototype.reduceRight)?function(e,o,t,i){goog.asserts.assert(null!=e.length);goog.asserts.assert(null!=o);if(i)o=goog.bind(o,i);return Array.prototype.reduceRight.call(e,o,t)}:function(e,o,t,i){var r=t;goog.array.forEachRight(e,(function(t,n){r=o.call(i,r,t,n,e)}));return r};goog.array.some=goog.NATIVE_ARRAY_PROTOTYPES&&(goog.array.ASSUME_NATIVE_FUNCTIONS||Array.prototype.some)?function(e,o,t){goog.asserts.assert(null!=e.length);return Array.prototype.some.call(e,o,t)}:function(e,o,t){var i=e.length;var r=goog.isString(e)?e.split(""):e;for(var n=0;n<i;n++)if(n in r&&o.call(t,r[n],n,e))return true;return false};goog.array.every=goog.NATIVE_ARRAY_PROTOTYPES&&(goog.array.ASSUME_NATIVE_FUNCTIONS||Array.prototype.every)?function(e,o,t){goog.asserts.assert(null!=e.length);return Array.prototype.every.call(e,o,t)}:function(e,o,t){var i=e.length;var r=goog.isString(e)?e.split(""):e;for(var n=0;n<i;n++)if(n in r&&!o.call(t,r[n],n,e))return false;return true};goog.array.count=function(e,o,t){var i=0;goog.array.forEach(e,(function(e,r,n){if(o.call(t,e,r,n))++i}),t);return i};goog.array.find=function(e,o,t){var i=goog.array.findIndex(e,o,t);return i<0?null:goog.isString(e)?e.charAt(i):e[i]};goog.array.findIndex=function(e,o,t){var i=e.length;var r=goog.isString(e)?e.split(""):e;for(var n=0;n<i;n++)if(n in r&&o.call(t,r[n],n,e))return n;return-1};goog.array.findRight=function(e,o,t){var i=goog.array.findIndexRight(e,o,t);return i<0?null:goog.isString(e)?e.charAt(i):e[i]};goog.array.findIndexRight=function(e,o,t){var i=e.length;var r=goog.isString(e)?e.split(""):e;for(var n=i-1;n>=0;n--)if(n in r&&o.call(t,r[n],n,e))return n;return-1};goog.array.contains=function(e,o){return goog.array.indexOf(e,o)>=0};goog.array.isEmpty=function(e){return 0==e.length};goog.array.clear=function(e){if(!goog.isArray(e))for(var o=e.length-1;o>=0;o--)delete e[o];e.length=0};goog.array.insert=function(e,o){if(!goog.array.contains(e,o))e.push(o)};goog.array.insertAt=function(e,o,t){goog.array.splice(e,t,0,o)};goog.array.insertArrayAt=function(e,o,t){goog.partial(goog.array.splice,e,t,0).apply(null,o)};goog.array.insertBefore=function(e,o,t){var i;if(2==arguments.length||(i=goog.array.indexOf(e,t))<0)e.push(o);else goog.array.insertAt(e,o,i)};goog.array.remove=function(e,o){var t=goog.array.indexOf(e,o);var i;if(i=t>=0)goog.array.removeAt(e,t);return i};goog.array.removeLast=function(e,o){var t=goog.array.lastIndexOf(e,o);if(t>=0){goog.array.removeAt(e,t);return true}return false};goog.array.removeAt=function(e,o){goog.asserts.assert(null!=e.length);return 1==Array.prototype.splice.call(e,o,1).length};goog.array.removeIf=function(e,o,t){var i=goog.array.findIndex(e,o,t);if(i>=0){goog.array.removeAt(e,i);return true}return false};goog.array.removeAllIf=function(e,o,t){var i=0;goog.array.forEachRight(e,(function(r,n){if(o.call(t,r,n,e))if(goog.array.removeAt(e,n))i++}));return i};goog.array.concat=function(e){return Array.prototype.concat.apply([],arguments)};goog.array.join=function(e){return Array.prototype.concat.apply([],arguments)};goog.array.toArray=function(e){var o=e.length;if(o>0){var t=new Array(o);for(var i=0;i<o;i++)t[i]=e[i];return t}return[]};goog.array.clone=goog.array.toArray;goog.array.extend=function(e,o){for(var t=1;t<arguments.length;t++){var i=arguments[t];if(goog.isArrayLike(i)){var r=e.length||0;var n=i.length||0;e.length=r+n;for(var l=0;l<n;l++)e[r+l]=i[l]}else e.push(i)}};goog.array.splice=function(e,o,t,i){goog.asserts.assert(null!=e.length);return Array.prototype.splice.apply(e,goog.array.slice(arguments,1))};goog.array.slice=function(e,o,t){goog.asserts.assert(null!=e.length);if(arguments.length<=2)return Array.prototype.slice.call(e,o);else return Array.prototype.slice.call(e,o,t)};goog.array.removeDuplicates=function(e,o,t){var i=o||e;var r=function(e){return goog.isObject(e)?"o"+goog.getUid(e):(typeof e).charAt(0)+e};var n=t||r;var l={},s=0,g=0;while(g<e.length){var a=e[g++];var c=n(a);if(!Object.prototype.hasOwnProperty.call(l,c)){l[c]=true;i[s++]=a}}i.length=s};goog.array.binarySearch=function(e,o,t){return goog.array.binarySearch_(e,t||goog.array.defaultCompare,false,o)};goog.array.binarySelect=function(e,o,t){return goog.array.binarySearch_(e,o,true,void 0,t)};goog.array.binarySearch_=function(e,o,t,i,r){var n=0;var l=e.length;var s;while(n<l){var g=n+l>>1;var a;if(t)a=o.call(r,e[g],g,e);else a=o(i,e[g]);if(a>0)n=g+1;else{l=g;s=!a}}return s?n:~n};goog.array.sort=function(e,o){e.sort(o||goog.array.defaultCompare)};goog.array.stableSort=function(e,o){var t=new Array(e.length);for(var i=0;i<e.length;i++)t[i]={index:i,value:e[i]};var r=o||goog.array.defaultCompare;function n(e,o){return r(e.value,o.value)||e.index-o.index}goog.array.sort(t,n);for(var i=0;i<e.length;i++)e[i]=t[i].value};goog.array.sortByKey=function(e,o,t){var i=t||goog.array.defaultCompare;goog.array.sort(e,(function(e,t){return i(o(e),o(t))}))};goog.array.sortObjectsByKey=function(e,o,t){goog.array.sortByKey(e,(function(e){return e[o]}),t)};goog.array.isSorted=function(e,o,t){var i=o||goog.array.defaultCompare;for(var r=1;r<e.length;r++){var n=i(e[r-1],e[r]);if(n>0||0==n&&t)return false}return true};goog.array.equals=function(e,o,t){if(!goog.isArrayLike(e)||!goog.isArrayLike(o)||e.length!=o.length)return false;var i=e.length;var r=t||goog.array.defaultCompareEquality;for(var n=0;n<i;n++)if(!r(e[n],o[n]))return false;return true};goog.array.compare3=function(e,o,t){var i=t||goog.array.defaultCompare;var r=Math.min(e.length,o.length);for(var n=0;n<r;n++){var l=i(e[n],o[n]);if(0!=l)return l}return goog.array.defaultCompare(e.length,o.length)};goog.array.defaultCompare=function(e,o){return e>o?1:e<o?-1:0};goog.array.inverseDefaultCompare=function(e,o){return-goog.array.defaultCompare(e,o)};goog.array.defaultCompareEquality=function(e,o){return e===o};goog.array.binaryInsert=function(e,o,t){var i=goog.array.binarySearch(e,o,t);if(i<0){goog.array.insertAt(e,o,-(i+1));return true}return false};goog.array.binaryRemove=function(e,o,t){var i=goog.array.binarySearch(e,o,t);return i>=0?goog.array.removeAt(e,i):false};goog.array.bucket=function(e,o,t){var i={};for(var r=0;r<e.length;r++){var n=e[r];var l=o.call(t,n,r,e);if(goog.isDef(l)){var s=i[l]||(i[l]=[]);s.push(n)}}return i};goog.array.toObject=function(e,o,t){var i={};goog.array.forEach(e,(function(r,n){i[o.call(t,r,n,e)]=r}));return i};goog.array.range=function(e,o,t){var i=[];var r=0;var n=e;var l=t||1;if(void 0!==o){r=e;n=o}if(l*(n-r)<0)return[];if(l>0)for(var s=r;s<n;s+=l)i.push(s);else for(var s=r;s>n;s+=l)i.push(s);return i};goog.array.repeat=function(e,o){var t=[];for(var i=0;i<o;i++)t[i]=e;return t};goog.array.flatten=function(e){var o=8192;var t=[];for(var i=0;i<arguments.length;i++){var r=arguments[i];if(goog.isArray(r))for(var n=0;n<r.length;n+=o){var l=goog.array.slice(r,n,n+o);var s=goog.array.flatten.apply(null,l);for(var g=0;g<s.length;g++)t.push(s[g])}else t.push(r)}return t};goog.array.rotate=function(e,o){goog.asserts.assert(null!=e.length);if(e.length){o%=e.length;if(o>0)Array.prototype.unshift.apply(e,e.splice(-o,o));else if(o<0)Array.prototype.push.apply(e,e.splice(0,-o))}return e};goog.array.moveItem=function(e,o,t){goog.asserts.assert(o>=0&&o<e.length);goog.asserts.assert(t>=0&&t<e.length);var i=Array.prototype.splice.call(e,o,1);Array.prototype.splice.call(e,t,0,i[0])};goog.array.zip=function(e){if(!arguments.length)return[];var o=[];var t=arguments[0].length;for(var i=1;i<arguments.length;i++)if(arguments[i].length<t)t=arguments[i].length;for(var i=0;i<t;i++){var r=[];for(var n=0;n<arguments.length;n++)r.push(arguments[n][i]);o.push(r)}return o};goog.array.shuffle=function(e,o){var t=o||Math.random;for(var i=e.length-1;i>0;i--){var r=Math.floor(t()*(i+1));var n=e[i];e[i]=e[r];e[r]=n}};goog.array.copyByIndex=function(e,o){var t=[];goog.array.forEach(o,(function(o){t.push(e[o])}));return t};goog.array.concatMap=function(e,o,t){return goog.array.concat.apply([],goog.array.map(e,o,t))};goog.provide("goog.functions");goog.functions.constant=function(e){return function(){return e}};goog.functions.FALSE=goog.functions.constant(false);goog.functions.TRUE=goog.functions.constant(true);goog.functions.NULL=goog.functions.constant(null);goog.functions.identity=function(e,o){return e};goog.functions.error=function(e){return function(){throw new Error(e)}};goog.functions.fail=function(e){return function(){throw e}};goog.functions.lock=function(e,o){o=o||0;return function(){var t=this;return e.apply(t,Array.prototype.slice.call(arguments,0,o))}};goog.functions.nth=function(e){return function(){return arguments[e]}};goog.functions.partialRight=function(e,o){var t=Array.prototype.slice.call(arguments,1);return function(){var o=this;var i=Array.prototype.slice.call(arguments);i.push.apply(i,t);return e.apply(o,i)}};goog.functions.withReturnValue=function(e,o){return goog.functions.sequence(e,goog.functions.constant(o))};goog.functions.equalTo=function(e,o){return function(t){return o?e==t:e===t}};goog.functions.compose=function(e,o){var t=arguments;var i=t.length;return function(){var e=this;var o;if(i)o=t[i-1].apply(e,arguments);for(var r=i-2;r>=0;r--)o=t[r].call(e,o);return o}};goog.functions.sequence=function(e){var o=arguments;var t=o.length;return function(){var e=this;var i;for(var r=0;r<t;r++)i=o[r].apply(e,arguments);return i}};goog.functions.and=function(e){var o=arguments;var t=o.length;return function(){var e=this;for(var i=0;i<t;i++)if(!o[i].apply(e,arguments))return false;return true}};goog.functions.or=function(e){var o=arguments;var t=o.length;return function(){var e=this;for(var i=0;i<t;i++)if(o[i].apply(e,arguments))return true;return false}};goog.functions.not=function(e){return function(){var o=this;return!e.apply(o,arguments)}};goog.functions.create=function(e,o){var t=function(){};t.prototype=e.prototype;var i=new t;e.apply(i,Array.prototype.slice.call(arguments,1));return i};goog.define("goog.functions.CACHE_RETURN_VALUE",true);goog.functions.cacheReturnValue=function(e){var o=false;var t;return function(){if(!goog.functions.CACHE_RETURN_VALUE)return e();if(!o){t=e();o=true}return t}};goog.functions.once=function(e){var o=e;return function(){if(o){var e=o;o=null;e()}}};goog.functions.debounce=function(e,o,t){var i=0;return function(r){goog.global.clearTimeout(i);var n=arguments;i=goog.global.setTimeout((function(){e.apply(t,n)}),o)}};goog.functions.throttle=function(e,o,t){var i=0;var r=false;var n=[];var l=function(){i=0;if(r){r=false;s()}};var s=function(){i=goog.global.setTimeout(l,o);e.apply(t,n)};return function(e){n=arguments;if(!i)s();else r=true}};goog.functions.rateLimit=function(e,o,t){var i=0;var r=function(){i=0};return function(n){if(!i){i=goog.global.setTimeout(r,o);e.apply(t,arguments)}}};goog.provide("goog.asserts");goog.provide("goog.asserts.AssertionError");goog.require("goog.debug.Error");goog.require("goog.dom.NodeType");goog.define("goog.asserts.ENABLE_ASSERTS",goog.DEBUG);goog.asserts.AssertionError=function(e,o){goog.debug.Error.call(this,goog.asserts.subs_(e,o));this.messagePattern=e};goog.inherits(goog.asserts.AssertionError,goog.debug.Error);goog.asserts.AssertionError.prototype.name="AssertionError";goog.asserts.DEFAULT_ERROR_HANDLER=function(e){throw e};goog.asserts.errorHandler_=goog.asserts.DEFAULT_ERROR_HANDLER;goog.asserts.subs_=function(e,o){var t=e.split("%s");var i="";var r=t.length-1;for(var n=0;n<r;n++){var l=n<o.length?o[n]:"%s";i+=t[n]+l}return i+t[r]};goog.asserts.doAssertFailure_=function(e,o,t,i){var r="Assertion failed";if(t){r+=": "+t;var n=i}else if(e){r+=": "+e;n=o}var l=new goog.asserts.AssertionError(""+r,n||[]);goog.asserts.errorHandler_(l)};goog.asserts.setErrorHandler=function(e){if(goog.asserts.ENABLE_ASSERTS)goog.asserts.errorHandler_=e};goog.asserts.assert=function(e,o,t){if(goog.asserts.ENABLE_ASSERTS&&!e)goog.asserts.doAssertFailure_("",null,o,Array.prototype.slice.call(arguments,2));return e};goog.asserts.fail=function(e,o){if(goog.asserts.ENABLE_ASSERTS)goog.asserts.errorHandler_(new goog.asserts.AssertionError("Failure"+(e?": "+e:""),Array.prototype.slice.call(arguments,1)))};goog.asserts.assertNumber=function(e,o,t){if(goog.asserts.ENABLE_ASSERTS&&!goog.isNumber(e))goog.asserts.doAssertFailure_("Expected number but got %s: %s.",[goog.typeOf(e),e],o,Array.prototype.slice.call(arguments,2));return e};goog.asserts.assertString=function(e,o,t){if(goog.asserts.ENABLE_ASSERTS&&!goog.isString(e))goog.asserts.doAssertFailure_("Expected string but got %s: %s.",[goog.typeOf(e),e],o,Array.prototype.slice.call(arguments,2));return e};goog.asserts.assertFunction=function(e,o,t){if(goog.asserts.ENABLE_ASSERTS&&!goog.isFunction(e))goog.asserts.doAssertFailure_("Expected function but got %s: %s.",[goog.typeOf(e),e],o,Array.prototype.slice.call(arguments,2));return e};goog.asserts.assertObject=function(e,o,t){if(goog.asserts.ENABLE_ASSERTS&&!goog.isObject(e))goog.asserts.doAssertFailure_("Expected object but got %s: %s.",[goog.typeOf(e),e],o,Array.prototype.slice.call(arguments,2));return e};goog.asserts.assertArray=function(e,o,t){if(goog.asserts.ENABLE_ASSERTS&&!goog.isArray(e))goog.asserts.doAssertFailure_("Expected array but got %s: %s.",[goog.typeOf(e),e],o,Array.prototype.slice.call(arguments,2));return e};goog.asserts.assertBoolean=function(e,o,t){if(goog.asserts.ENABLE_ASSERTS&&!goog.isBoolean(e))goog.asserts.doAssertFailure_("Expected boolean but got %s: %s.",[goog.typeOf(e),e],o,Array.prototype.slice.call(arguments,2));return e};goog.asserts.assertElement=function(e,o,t){if(goog.asserts.ENABLE_ASSERTS&&(!goog.isObject(e)||e.nodeType!=goog.dom.NodeType.ELEMENT))goog.asserts.doAssertFailure_("Expected Element but got %s: %s.",[goog.typeOf(e),e],o,Array.prototype.slice.call(arguments,2));return e};goog.asserts.assertInstanceof=function(e,o,t,i){if(goog.asserts.ENABLE_ASSERTS&&!(e instanceof o))goog.asserts.doAssertFailure_("Expected instanceof %s but got %s.",[goog.asserts.getType_(o),goog.asserts.getType_(e)],t,Array.prototype.slice.call(arguments,3));return e};goog.asserts.assertFinite=function(e,o,t){if(goog.asserts.ENABLE_ASSERTS&&("number"!=typeof e||!isFinite(e)))goog.asserts.doAssertFailure_("Expected %s to be a finite number but it is not.",[e],o,Array.prototype.slice.call(arguments,2));return e};goog.asserts.assertObjectPrototypeIsIntact=function(){for(var e in Object.prototype)goog.asserts.fail(e+" should not be enumerable in Object.prototype.")};goog.asserts.getType_=function(e){if(e instanceof Function)return e.displayName||e.name||"unknown type name";else if(e instanceof Object)return e.constructor.displayName||e.constructor.name||Object.prototype.toString.call(e);else return null===e?"null":typeof e};goog.provide("goog.async.AnimationDelay");goog.require("goog.Disposable");goog.require("goog.events");goog.require("goog.functions");goog.async.AnimationDelay=function(e,o,t){goog.async.AnimationDelay.base(this,"constructor");this.id_=null;this.usingListeners_=false;this.listener_=e;this.handler_=t;this.win_=o||window;this.callback_=goog.bind(this.doAction_,this)};goog.inherits(goog.async.AnimationDelay,goog.Disposable);goog.async.AnimationDelay.TIMEOUT=20;goog.async.AnimationDelay.MOZ_BEFORE_PAINT_EVENT_="MozBeforePaint";goog.async.AnimationDelay.prototype.start=function(){this.stop();this.usingListeners_=false;var e=this.getRaf_();var o=this.getCancelRaf_();if(e&&!o&&this.win_.mozRequestAnimationFrame){this.id_=goog.events.listen(this.win_,goog.async.AnimationDelay.MOZ_BEFORE_PAINT_EVENT_,this.callback_);this.win_.mozRequestAnimationFrame(null);this.usingListeners_=true}else if(e&&o)this.id_=e.call(this.win_,this.callback_);else this.id_=this.win_.setTimeout(goog.functions.lock(this.callback_),goog.async.AnimationDelay.TIMEOUT)};goog.async.AnimationDelay.prototype.startIfNotActive=function(){if(!this.isActive())this.start()};goog.async.AnimationDelay.prototype.stop=function(){if(this.isActive()){var e=this.getRaf_();var o=this.getCancelRaf_();if(e&&!o&&this.win_.mozRequestAnimationFrame)goog.events.unlistenByKey(this.id_);else if(e&&o)o.call(this.win_,this.id_);else this.win_.clearTimeout(this.id_)}this.id_=null};goog.async.AnimationDelay.prototype.fire=function(){this.stop();this.doAction_()};goog.async.AnimationDelay.prototype.fireIfActive=function(){if(this.isActive())this.fire()};goog.async.AnimationDelay.prototype.isActive=function(){return null!=this.id_};goog.async.AnimationDelay.prototype.doAction_=function(){if(this.usingListeners_&&this.id_)goog.events.unlistenByKey(this.id_);this.id_=null;this.listener_.call(this.handler_,goog.now())};goog.async.AnimationDelay.prototype.disposeInternal=function(){this.stop();goog.async.AnimationDelay.base(this,"disposeInternal")};goog.async.AnimationDelay.prototype.getRaf_=function(){var e=this.win_;return e.requestAnimationFrame||e.webkitRequestAnimationFrame||e.mozRequestAnimationFrame||e.oRequestAnimationFrame||e.msRequestAnimationFrame||null};goog.async.AnimationDelay.prototype.getCancelRaf_=function(){var e=this.win_;return e.cancelAnimationFrame||e.cancelRequestAnimationFrame||e.webkitCancelRequestAnimationFrame||e.mozCancelRequestAnimationFrame||e.oCancelRequestAnimationFrame||e.msCancelRequestAnimationFrame||null};goog.provide("goog.Delay");goog.provide("goog.async.Delay");goog.require("goog.Disposable");goog.require("goog.Timer");goog.async.Delay=function(e,o,t){goog.async.Delay.base(this,"constructor");this.listener_=e;this.interval_=o||0;this.handler_=t;this.callback_=goog.bind(this.doAction_,this)};goog.inherits(goog.async.Delay,goog.Disposable);goog.Delay=goog.async.Delay;goog.async.Delay.prototype.id_=0;goog.async.Delay.prototype.disposeInternal=function(){goog.async.Delay.base(this,"disposeInternal");this.stop();delete this.listener_;delete this.handler_};goog.async.Delay.prototype.start=function(e){this.stop();this.id_=goog.Timer.callOnce(this.callback_,goog.isDef(e)?e:this.interval_)};goog.async.Delay.prototype.startIfNotActive=function(e){if(!this.isActive())this.start(e)};goog.async.Delay.prototype.stop=function(){if(this.isActive())goog.Timer.clear(this.id_);this.id_=0};goog.async.Delay.prototype.fire=function(){this.stop();this.doAction_()};goog.async.Delay.prototype.fireIfActive=function(){if(this.isActive())this.fire()};goog.async.Delay.prototype.isActive=function(){return 0!=this.id_};goog.async.Delay.prototype.doAction_=function(){this.id_=0;if(this.listener_)this.listener_.call(this.handler_)};goog.provide("goog.async.FreeList");goog.async.FreeList=goog.defineClass(null,{constructor:function(e,o,t){this.limit_=t;this.create_=e;this.reset_=o;this.occupants_=0;this.head_=null},get:function(){var e;if(this.occupants_>0){this.occupants_--;e=this.head_;this.head_=e.next;e.next=null}else e=this.create_();return e},put:function(e){this.reset_(e);if(this.occupants_<this.limit_){this.occupants_++;e.next=this.head_;this.head_=e}},occupants:function(){return this.occupants_}});goog.provide("goog.async.nextTick");goog.provide("goog.async.throwException");goog.require("goog.debug.entryPointRegistry");goog.require("goog.dom.TagName");goog.require("goog.functions");goog.require("goog.labs.userAgent.browser");goog.require("goog.labs.userAgent.engine");goog.async.throwException=function(e){goog.global.setTimeout((function(){throw e}),0)};goog.async.nextTick=function(e,o,t){var i=e;if(o)i=goog.bind(e,o);i=goog.async.nextTick.wrapCallback_(i);if(goog.isFunction(goog.global.setImmediate)&&(t||goog.async.nextTick.useSetImmediate_())){goog.global.setImmediate(i);return}if(!goog.async.nextTick.setImmediate_)goog.async.nextTick.setImmediate_=goog.async.nextTick.getSetImmediateEmulator_();goog.async.nextTick.setImmediate_(i)};goog.async.nextTick.useSetImmediate_=function(){if(!goog.global.Window||!goog.global.Window.prototype)return true;if(goog.labs.userAgent.browser.isEdge()||goog.global.Window.prototype.setImmediate!=goog.global.setImmediate)return true;return false};goog.async.nextTick.setImmediate_;goog.async.nextTick.getSetImmediateEmulator_=function(){var e=goog.global["MessageChannel"];if("undefined"===typeof e&&"undefined"!==typeof window&&window.postMessage&&window.addEventListener&&!goog.labs.userAgent.engine.isPresto())e=function(){var e=document.createElement(String(goog.dom.TagName.IFRAME));e.style.display="none";e.src="";document.documentElement.appendChild(e);var o=e.contentWindow;var t=o.document;t.open();t.write("");t.close();var i="callImmediate"+Math.random();var r="file:"==o.location.protocol?"*":o.location.protocol+"//"+o.location.host;var n=goog.bind((function(e){if("*"!=r&&e.origin!=r||e.data!=i)return;this["port1"].onmessage()}),this);o.addEventListener("message",n,false);this["port1"]={};this["port2"]={postMessage:function(){o.postMessage(i,r)}}};if("undefined"!==typeof e&&!goog.labs.userAgent.browser.isIE()){var o=new e;var t={};var i=t;o["port1"].onmessage=function(){if(goog.isDef(t.next)){t=t.next;var e=t.cb;t.cb=null;e()}};return function(e){i.next={cb:e};i=i.next;o["port2"].postMessage(0)}}if("undefined"!==typeof document&&"onreadystatechange"in document.createElement(String(goog.dom.TagName.SCRIPT)))return function(e){var o=document.createElement(String(goog.dom.TagName.SCRIPT));o.onreadystatechange=function(){o.onreadystatechange=null;o.parentNode.removeChild(o);o=null;e();e=null};document.documentElement.appendChild(o)};return function(e){goog.global.setTimeout(e,0)}};goog.async.nextTick.wrapCallback_=goog.functions.identity;goog.debug.entryPointRegistry.register((function(e){goog.async.nextTick.wrapCallback_=e}));goog.provide("goog.async.WorkItem");goog.provide("goog.async.WorkQueue");goog.require("goog.asserts");goog.require("goog.async.FreeList");goog.async.WorkQueue=function(){this.workHead_=null;this.workTail_=null};goog.define("goog.async.WorkQueue.DEFAULT_MAX_UNUSED",100);goog.async.WorkQueue.freelist_=new goog.async.FreeList((function(){return new goog.async.WorkItem}),(function(e){e.reset()}),goog.async.WorkQueue.DEFAULT_MAX_UNUSED);goog.async.WorkQueue.prototype.add=function(e,o){var t=this.getUnusedItem_();t.set(e,o);if(this.workTail_){this.workTail_.next=t;this.workTail_=t}else{goog.asserts.assert(!this.workHead_);this.workHead_=t;this.workTail_=t}};goog.async.WorkQueue.prototype.remove=function(){var e=null;if(this.workHead_){e=this.workHead_;this.workHead_=this.workHead_.next;if(!this.workHead_)this.workTail_=null;e.next=null}return e};goog.async.WorkQueue.prototype.returnUnused=function(e){goog.async.WorkQueue.freelist_.put(e)};goog.async.WorkQueue.prototype.getUnusedItem_=function(){return goog.async.WorkQueue.freelist_.get()};goog.async.WorkItem=function(){this.fn=null;this.scope=null;this.next=null};goog.async.WorkItem.prototype.set=function(e,o){this.fn=e;this.scope=o;this.next=null};goog.async.WorkItem.prototype.reset=function(){this.fn=null;this.scope=null;this.next=null};goog.provide("goog.async.run");goog.require("goog.async.WorkQueue");goog.require("goog.async.nextTick");goog.require("goog.async.throwException");goog.async.run=function(e,o){if(!goog.async.run.schedule_)goog.async.run.initializeRunner_();if(!goog.async.run.workQueueScheduled_){goog.async.run.schedule_();goog.async.run.workQueueScheduled_=true}goog.async.run.workQueue_.add(e,o)};goog.async.run.initializeRunner_=function(){if(goog.global.Promise&&goog.global.Promise.resolve){var e=goog.global.Promise.resolve(void 0);goog.async.run.schedule_=function(){e.then(goog.async.run.processWorkQueue)}}else goog.async.run.schedule_=function(){goog.async.nextTick(goog.async.run.processWorkQueue)}};goog.async.run.forceNextTick=function(e){goog.async.run.schedule_=function(){goog.async.nextTick(goog.async.run.processWorkQueue);if(e)e(goog.async.run.processWorkQueue)}};goog.async.run.schedule_;goog.async.run.workQueueScheduled_=false;goog.async.run.workQueue_=new goog.async.WorkQueue;if(goog.DEBUG)goog.async.run.resetQueue=function(){goog.async.run.workQueueScheduled_=false;goog.async.run.workQueue_=new goog.async.WorkQueue};goog.async.run.processWorkQueue=function(){var e=null;while(e=goog.async.run.workQueue_.remove()){try{e.fn.call(e.scope)}catch(e){goog.async.throwException(e)}goog.async.run.workQueue_.returnUnused(e)}goog.async.run.workQueueScheduled_=false};goog.provide("goog.color");goog.provide("goog.color.Hsl");goog.provide("goog.color.Hsv");goog.provide("goog.color.Rgb");goog.require("goog.color.names");goog.require("goog.math");goog.color.Rgb;goog.color.Hsv;goog.color.Hsl;goog.color.parse=function(e){var o={};e=String(e);var t=goog.color.prependHashIfNecessaryHelper(e);if(goog.color.isValidHexColor_(t)){o.hex=goog.color.normalizeHex(t);o.type="hex";return o}else{var i=goog.color.isValidRgbColor_(e);if(i.length){o.hex=goog.color.rgbArrayToHex(i);o.type="rgb";return o}else if(goog.color.names){var r=goog.color.names[e.toLowerCase()];if(r){o.hex=r;o.type="named";return o}}}throw Error(e+" is not a valid color string")};goog.color.isValidColor=function(e){var o=goog.color.prependHashIfNecessaryHelper(e);return!!(goog.color.isValidHexColor_(o)||goog.color.isValidRgbColor_(e).length||goog.color.names&&goog.color.names[e.toLowerCase()])};goog.color.parseRgb=function(e){var o=goog.color.isValidRgbColor_(e);if(!o.length)throw Error(e+" is not a valid RGB color");return o};goog.color.hexToRgbStyle=function(e){return goog.color.rgbStyle_(goog.color.hexToRgb(e))};goog.color.hexTripletRe_=/#(.)(.)(.)/;goog.color.normalizeHex=function(e){if(!goog.color.isValidHexColor_(e))throw Error("'"+e+"' is not a valid hex color");if(4==e.length)e=e.replace(goog.color.hexTripletRe_,"#$1$1$2$2$3$3");return e.toLowerCase()};goog.color.hexToRgb=function(e){e=goog.color.normalizeHex(e);var o=parseInt(e.substr(1,2),16);var t=parseInt(e.substr(3,2),16);var i=parseInt(e.substr(5,2),16);return[o,t,i]};goog.color.rgbToHex=function(e,o,t){e=Number(e);o=Number(o);t=Number(t);if(e!=(255&e)||o!=(255&o)||t!=(255&t))throw Error('"('+e+","+o+","+t+'") is not a valid RGB color');var i=goog.color.prependZeroIfNecessaryHelper(e.toString(16));var r=goog.color.prependZeroIfNecessaryHelper(o.toString(16));var n=goog.color.prependZeroIfNecessaryHelper(t.toString(16));return"#"+i+r+n};goog.color.rgbArrayToHex=function(e){return goog.color.rgbToHex(e[0],e[1],e[2])};goog.color.rgbToHsl=function(e,o,t){var i=e/255;var r=o/255;var n=t/255;var l=Math.max(i,r,n);var s=Math.min(i,r,n);var g=0;var a=0;var c=.5*(l+s);if(l!=s){if(l==i)g=60*(r-n)/(l-s);else if(l==r)g=60*(n-i)/(l-s)+120;else if(l==n)g=60*(i-r)/(l-s)+240;if(0<c&&c<=.5)a=(l-s)/(2*c);else a=(l-s)/(2-2*c)}return[Math.round(g+360)%360,a,c]};goog.color.rgbArrayToHsl=function(e){return goog.color.rgbToHsl(e[0],e[1],e[2])};goog.color.hueToRgb_=function(e,o,t){if(t<0)t+=1;else if(t>1)t-=1;if(6*t<1)return e+6*(o-e)*t;else if(2*t<1)return o;else if(3*t<2)return e+(o-e)*(2/3-t)*6;return e};goog.color.hslToRgb=function(e,o,t){var i=0;var r=0;var n=0;var l=e/360;if(0==o)i=r=n=255*t;else{var s=0;var g=0;if(t<.5)g=t*(1+o);else g=t+o-o*t;s=2*t-g;i=255*goog.color.hueToRgb_(s,g,l+1/3);r=255*goog.color.hueToRgb_(s,g,l);n=255*goog.color.hueToRgb_(s,g,l-1/3)}return[Math.round(i),Math.round(r),Math.round(n)]};goog.color.hslArrayToRgb=function(e){return goog.color.hslToRgb(e[0],e[1],e[2])};goog.color.validHexColorRe_=/^#(?:[0-9a-f]{3}){1,2}$/i;goog.color.isValidHexColor_=function(e){return goog.color.validHexColorRe_.test(e)};goog.color.normalizedHexColorRe_=/^#[0-9a-f]{6}$/;goog.color.isNormalizedHexColor_=function(e){return goog.color.normalizedHexColorRe_.test(e)};goog.color.rgbColorRe_=/^(?:rgb)?\((0|[1-9]\d{0,2}),\s?(0|[1-9]\d{0,2}),\s?(0|[1-9]\d{0,2})\)$/i;goog.color.isValidRgbColor_=function(e){var o=e.match(goog.color.rgbColorRe_);if(o){var t=Number(o[1]);var i=Number(o[2]);var r=Number(o[3]);if(t>=0&&t<=255&&i>=0&&i<=255&&r>=0&&r<=255)return[t,i,r]}return[]};goog.color.prependZeroIfNecessaryHelper=function(e){return 1==e.length?"0"+e:e};goog.color.prependHashIfNecessaryHelper=function(e){return"#"==e.charAt(0)?e:"#"+e};goog.color.rgbStyle_=function(e){return"rgb("+e.join(",")+")"};goog.color.hsvToRgb=function(e,o,t){var i=0;var r=0;var n=0;if(0==o){i=t;r=t;n=t}else{var l=Math.floor(e/60);var s=e/60-l;var g=t*(1-o);var a=t*(1-o*s);var c=t*(1-o*(1-s));switch(l){case 1:i=a;r=t;n=g;break;case 2:i=g;r=t;n=c;break;case 3:i=g;r=a;n=t;break;case 4:i=c;r=g;n=t;break;case 5:i=t;r=g;n=a;break;case 6:case 0:i=t;r=c;n=g;break}}return[Math.floor(i),Math.floor(r),Math.floor(n)]};goog.color.rgbToHsv=function(e,o,t){var i=Math.max(Math.max(e,o),t);var r=Math.min(Math.min(e,o),t);var n;var l;var s=i;if(r==i){n=0;l=0}else{var g=i-r;l=g/i;if(e==i)n=(o-t)/g;else if(o==i)n=2+(t-e)/g;else n=4+(e-o)/g;n*=60;if(n<0)n+=360;if(n>360)n-=360}return[n,l,s]};goog.color.rgbArrayToHsv=function(e){return goog.color.rgbToHsv(e[0],e[1],e[2])};goog.color.hsvArrayToRgb=function(e){return goog.color.hsvToRgb(e[0],e[1],e[2])};goog.color.hexToHsl=function(e){var o=goog.color.hexToRgb(e);return goog.color.rgbToHsl(o[0],o[1],o[2])};goog.color.hslToHex=function(e,o,t){return goog.color.rgbArrayToHex(goog.color.hslToRgb(e,o,t))};goog.color.hslArrayToHex=function(e){return goog.color.rgbArrayToHex(goog.color.hslToRgb(e[0],e[1],e[2]))};goog.color.hexToHsv=function(e){return goog.color.rgbArrayToHsv(goog.color.hexToRgb(e))};goog.color.hsvToHex=function(e,o,t){return goog.color.rgbArrayToHex(goog.color.hsvToRgb(e,o,t))};goog.color.hsvArrayToHex=function(e){return goog.color.hsvToHex(e[0],e[1],e[2])};goog.color.hslDistance=function(e,o){var t,i;if(e[2]<=.5)t=e[1]*e[2];else t=e[1]*(1-e[2]);if(o[2]<=.5)i=o[1]*o[2];else i=o[1]*(1-o[2]);var r=e[0]/360;var n=o[0]/360;var l=2*(r-n)*Math.PI;return(e[2]-o[2])*(e[2]-o[2])+t*t+i*i-2*t*i*Math.cos(l)};goog.color.blend=function(e,o,t){t=goog.math.clamp(t,0,1);return[Math.round(t*e[0]+(1-t)*o[0]),Math.round(t*e[1]+(1-t)*o[1]),Math.round(t*e[2]+(1-t)*o[2])]};goog.color.darken=function(e,o){var t=[0,0,0];return goog.color.blend(t,e,o)};goog.color.lighten=function(e,o){var t=[255,255,255];return goog.color.blend(t,e,o)};goog.color.highContrast=function(e,o){var t=[];for(var i=0;i<o.length;i++)t.push({color:o[i],diff:goog.color.yiqBrightnessDiff_(o[i],e)+goog.color.colorDiff_(o[i],e)});t.sort((function(e,o){return o.diff-e.diff}));return t[0].color};goog.color.yiqBrightness_=function(e){return Math.round((299*e[0]+587*e[1]+114*e[2])/1e3)};goog.color.yiqBrightnessDiff_=function(e,o){return Math.abs(goog.color.yiqBrightness_(e)-goog.color.yiqBrightness_(o))};goog.color.colorDiff_=function(e,o){return Math.abs(e[0]-o[0])+Math.abs(e[1]-o[1])+Math.abs(e[2]-o[2])};goog.provide("goog.color.names");goog.color.names={aliceblue:"#f0f8ff",antiquewhite:"#faebd7",aqua:"#00ffff",aquamarine:"#7fffd4",azure:"#f0ffff",beige:"#f5f5dc",bisque:"#ffe4c4",black:"#000000",blanchedalmond:"#ffebcd",blue:"#0000ff",blueviolet:"#8a2be2",brown:"#a52a2a",burlywood:"#deb887",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",cornflowerblue:"#6495ed",cornsilk:"#fff8dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkgray:"#a9a9a9",darkgreen:"#006400",darkgrey:"#a9a9a9",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",darkorange:"#ff8c00",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkseagreen:"#8fbc8f",darkslateblue:"#483d8b",darkslategray:"#2f4f4f",darkslategrey:"#2f4f4f",darkturquoise:"#00ced1",darkviolet:"#9400d3",deeppink:"#ff1493",deepskyblue:"#00bfff",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1e90ff",firebrick:"#b22222",floralwhite:"#fffaf0",forestgreen:"#228b22",fuchsia:"#ff00ff",gainsboro:"#dcdcdc",ghostwhite:"#f8f8ff",gold:"#ffd700",goldenrod:"#daa520",gray:"#808080",green:"#008000",greenyellow:"#adff2f",grey:"#808080",honeydew:"#f0fff0",hotpink:"#ff69b4",indianred:"#cd5c5c",indigo:"#4b0082",ivory:"#fffff0",khaki:"#f0e68c",lavender:"#e6e6fa",lavenderblush:"#fff0f5",lawngreen:"#7cfc00",lemonchiffon:"#fffacd",lightblue:"#add8e6",lightcoral:"#f08080",lightcyan:"#e0ffff",lightgoldenrodyellow:"#fafad2",lightgray:"#d3d3d3",lightgreen:"#90ee90",lightgrey:"#d3d3d3",lightpink:"#ffb6c1",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",lightskyblue:"#87cefa",lightslategray:"#778899",lightslategrey:"#778899",lightsteelblue:"#b0c4de",lightyellow:"#ffffe0",lime:"#00ff00",limegreen:"#32cd32",linen:"#faf0e6",magenta:"#ff00ff",maroon:"#800000",mediumaquamarine:"#66cdaa",mediumblue:"#0000cd",mediumorchid:"#ba55d3",mediumpurple:"#9370db",mediumseagreen:"#3cb371",mediumslateblue:"#7b68ee",mediumspringgreen:"#00fa9a",mediumturquoise:"#48d1cc",mediumvioletred:"#c71585",midnightblue:"#191970",mintcream:"#f5fffa",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",navajowhite:"#ffdead",navy:"#000080",oldlace:"#fdf5e6",olive:"#808000",olivedrab:"#6b8e23",orange:"#ffa500",orangered:"#ff4500",orchid:"#da70d6",palegoldenrod:"#eee8aa",palegreen:"#98fb98",paleturquoise:"#afeeee",palevioletred:"#db7093",papayawhip:"#ffefd5",peachpuff:"#ffdab9",peru:"#cd853f",pink:"#ffc0cb",plum:"#dda0dd",powderblue:"#b0e0e6",purple:"#800080",red:"#ff0000",rosybrown:"#bc8f8f",royalblue:"#4169e1",saddlebrown:"#8b4513",salmon:"#fa8072",sandybrown:"#f4a460",seagreen:"#2e8b57",seashell:"#fff5ee",sienna:"#a0522d",silver:"#c0c0c0",skyblue:"#87ceeb",slateblue:"#6a5acd",slategray:"#708090",slategrey:"#708090",snow:"#fffafa",springgreen:"#00ff7f",steelblue:"#4682b4",tan:"#d2b48c",teal:"#008080",thistle:"#d8bfd8",tomato:"#ff6347",turquoise:"#40e0d0",violet:"#ee82ee",wheat:"#f5deb3",white:"#ffffff",whitesmoke:"#f5f5f5",yellow:"#ffff00",yellowgreen:"#9acd32"};goog.provide("goog.i18n.bidi");goog.provide("goog.i18n.bidi.Dir");goog.provide("goog.i18n.bidi.DirectionalString");goog.provide("goog.i18n.bidi.Format");goog.define("goog.i18n.bidi.FORCE_RTL",false);goog.i18n.bidi.IS_RTL=goog.i18n.bidi.FORCE_RTL||("ar"==goog.LOCALE.substring(0,2).toLowerCase()||"fa"==goog.LOCALE.substring(0,2).toLowerCase()||"he"==goog.LOCALE.substring(0,2).toLowerCase()||"iw"==goog.LOCALE.substring(0,2).toLowerCase()||"ps"==goog.LOCALE.substring(0,2).toLowerCase()||"sd"==goog.LOCALE.substring(0,2).toLowerCase()||"ug"==goog.LOCALE.substring(0,2).toLowerCase()||"ur"==goog.LOCALE.substring(0,2).toLowerCase()||"yi"==goog.LOCALE.substring(0,2).toLowerCase())&&(2==goog.LOCALE.length||"-"==goog.LOCALE.substring(2,3)||"_"==goog.LOCALE.substring(2,3))||goog.LOCALE.length>=3&&"ckb"==goog.LOCALE.substring(0,3).toLowerCase()&&(3==goog.LOCALE.length||"-"==goog.LOCALE.substring(3,4)||"_"==goog.LOCALE.substring(3,4));goog.i18n.bidi.Format={LRE:"‪",RLE:"‫",PDF:"‬",LRM:"‎",RLM:"‏"};goog.i18n.bidi.Dir={LTR:1,RTL:-1,NEUTRAL:0};goog.i18n.bidi.RIGHT="right";goog.i18n.bidi.LEFT="left";goog.i18n.bidi.I18N_RIGHT=goog.i18n.bidi.IS_RTL?goog.i18n.bidi.LEFT:goog.i18n.bidi.RIGHT;goog.i18n.bidi.I18N_LEFT=goog.i18n.bidi.IS_RTL?goog.i18n.bidi.RIGHT:goog.i18n.bidi.LEFT;goog.i18n.bidi.toDir=function(e,o){if("number"==typeof e)return e>0?goog.i18n.bidi.Dir.LTR:e<0?goog.i18n.bidi.Dir.RTL:o?null:goog.i18n.bidi.Dir.NEUTRAL;else if(null==e)return null;else return e?goog.i18n.bidi.Dir.RTL:goog.i18n.bidi.Dir.LTR};goog.i18n.bidi.ltrChars_="A-Za-zÀ-ÖØ-öø-ʸ̀-֐ࠀ-῿"+"‎Ⰰ-﬜︀-﹯﻽-￿";goog.i18n.bidi.rtlChars_="֑-ۯۺ-߿‏יִ-﷿ﹰ-ﻼ";goog.i18n.bidi.htmlSkipReg_=/<[^>]*>|&[^;]+;/g;goog.i18n.bidi.stripHtmlIfNeeded_=function(e,o){return o?e.replace(goog.i18n.bidi.htmlSkipReg_,""):e};goog.i18n.bidi.rtlCharReg_=new RegExp("["+goog.i18n.bidi.rtlChars_+"]");goog.i18n.bidi.ltrCharReg_=new RegExp("["+goog.i18n.bidi.ltrChars_+"]");goog.i18n.bidi.hasAnyRtl=function(e,o){return goog.i18n.bidi.rtlCharReg_.test(goog.i18n.bidi.stripHtmlIfNeeded_(e,o))};goog.i18n.bidi.hasRtlChar=goog.i18n.bidi.hasAnyRtl;goog.i18n.bidi.hasAnyLtr=function(e,o){return goog.i18n.bidi.ltrCharReg_.test(goog.i18n.bidi.stripHtmlIfNeeded_(e,o))};goog.i18n.bidi.ltrRe_=new RegExp("^["+goog.i18n.bidi.ltrChars_+"]");goog.i18n.bidi.rtlRe_=new RegExp("^["+goog.i18n.bidi.rtlChars_+"]");goog.i18n.bidi.isRtlChar=function(e){return goog.i18n.bidi.rtlRe_.test(e)};goog.i18n.bidi.isLtrChar=function(e){return goog.i18n.bidi.ltrRe_.test(e)};goog.i18n.bidi.isNeutralChar=function(e){return!goog.i18n.bidi.isLtrChar(e)&&!goog.i18n.bidi.isRtlChar(e)};goog.i18n.bidi.ltrDirCheckRe_=new RegExp("^[^"+goog.i18n.bidi.rtlChars_+"]*["+goog.i18n.bidi.ltrChars_+"]");goog.i18n.bidi.rtlDirCheckRe_=new RegExp("^[^"+goog.i18n.bidi.ltrChars_+"]*["+goog.i18n.bidi.rtlChars_+"]");goog.i18n.bidi.startsWithRtl=function(e,o){return goog.i18n.bidi.rtlDirCheckRe_.test(goog.i18n.bidi.stripHtmlIfNeeded_(e,o))};goog.i18n.bidi.isRtlText=goog.i18n.bidi.startsWithRtl;goog.i18n.bidi.startsWithLtr=function(e,o){return goog.i18n.bidi.ltrDirCheckRe_.test(goog.i18n.bidi.stripHtmlIfNeeded_(e,o))};goog.i18n.bidi.isLtrText=goog.i18n.bidi.startsWithLtr;goog.i18n.bidi.isRequiredLtrRe_=/^http:\/\/.*/;goog.i18n.bidi.isNeutralText=function(e,o){e=goog.i18n.bidi.stripHtmlIfNeeded_(e,o);return goog.i18n.bidi.isRequiredLtrRe_.test(e)||!goog.i18n.bidi.hasAnyLtr(e)&&!goog.i18n.bidi.hasAnyRtl(e)};goog.i18n.bidi.ltrExitDirCheckRe_=new RegExp("["+goog.i18n.bidi.ltrChars_+"][^"+goog.i18n.bidi.rtlChars_+"]*$");goog.i18n.bidi.rtlExitDirCheckRe_=new RegExp("["+goog.i18n.bidi.rtlChars_+"][^"+goog.i18n.bidi.ltrChars_+"]*$");goog.i18n.bidi.endsWithLtr=function(e,o){return goog.i18n.bidi.ltrExitDirCheckRe_.test(goog.i18n.bidi.stripHtmlIfNeeded_(e,o))};goog.i18n.bidi.isLtrExitText=goog.i18n.bidi.endsWithLtr;goog.i18n.bidi.endsWithRtl=function(e,o){return goog.i18n.bidi.rtlExitDirCheckRe_.test(goog.i18n.bidi.stripHtmlIfNeeded_(e,o))};goog.i18n.bidi.isRtlExitText=goog.i18n.bidi.endsWithRtl;goog.i18n.bidi.rtlLocalesRe_=new RegExp("^(ar|ckb|dv|he|iw|fa|nqo|ps|sd|ug|ur|yi|"+".*[-_](Arab|Hebr|Thaa|Nkoo|Tfng))"+"(?!.*[-_](Latn|Cyrl)($|-|_))($|-|_)","i");goog.i18n.bidi.isRtlLanguage=function(e){return goog.i18n.bidi.rtlLocalesRe_.test(e)};goog.i18n.bidi.bracketGuardTextRe_=/(\(.*?\)+)|(\[.*?\]+)|(\{.*?\}+)|(<.*?>+)/g;goog.i18n.bidi.guardBracketInText=function(e,o){var t=void 0===o?goog.i18n.bidi.hasAnyRtl(e):o;var i=t?goog.i18n.bidi.Format.RLM:goog.i18n.bidi.Format.LRM;return e.replace(goog.i18n.bidi.bracketGuardTextRe_,i+"$&"+i)};goog.i18n.bidi.enforceRtlInHtml=function(e){if("<"==e.charAt(0))return e.replace(/<\w+/,"$& dir=rtl");return"\n<span dir=rtl>"+e+"</span>"};goog.i18n.bidi.enforceRtlInText=function(e){return goog.i18n.bidi.Format.RLE+e+goog.i18n.bidi.Format.PDF};goog.i18n.bidi.enforceLtrInHtml=function(e){if("<"==e.charAt(0))return e.replace(/<\w+/,"$& dir=ltr");return"\n<span dir=ltr>"+e+"</span>"};goog.i18n.bidi.enforceLtrInText=function(e){return goog.i18n.bidi.Format.LRE+e+goog.i18n.bidi.Format.PDF};goog.i18n.bidi.dimensionsRe_=/:\s*([.\d][.\w]*)\s+([.\d][.\w]*)\s+([.\d][.\w]*)\s+([.\d][.\w]*)/g;goog.i18n.bidi.leftRe_=/left/gi;goog.i18n.bidi.rightRe_=/right/gi;goog.i18n.bidi.tempRe_=/%%%%/g;goog.i18n.bidi.mirrorCSS=function(e){return e.replace(goog.i18n.bidi.dimensionsRe_,":$1 $4 $3 $2").replace(goog.i18n.bidi.leftRe_,"%%%%").replace(goog.i18n.bidi.rightRe_,goog.i18n.bidi.LEFT).replace(goog.i18n.bidi.tempRe_,goog.i18n.bidi.RIGHT)};goog.i18n.bidi.doubleQuoteSubstituteRe_=/([\u0591-\u05f2])"/g;goog.i18n.bidi.singleQuoteSubstituteRe_=/([\u0591-\u05f2])'/g;goog.i18n.bidi.normalizeHebrewQuote=function(e){return e.replace(goog.i18n.bidi.doubleQuoteSubstituteRe_,"$1״").replace(goog.i18n.bidi.singleQuoteSubstituteRe_,"$1׳")};goog.i18n.bidi.wordSeparatorRe_=/\s+/;goog.i18n.bidi.hasNumeralsRe_=/[\d\u06f0-\u06f9]/;goog.i18n.bidi.rtlDetectionThreshold_=.4;goog.i18n.bidi.estimateDirection=function(e,o){var t=0;var i=0;var r=false;var n=goog.i18n.bidi.stripHtmlIfNeeded_(e,o).split(goog.i18n.bidi.wordSeparatorRe_);for(var l=0;l<n.length;l++){var s=n[l];if(goog.i18n.bidi.startsWithRtl(s)){t++;i++}else if(goog.i18n.bidi.isRequiredLtrRe_.test(s))r=true;else if(goog.i18n.bidi.hasAnyLtr(s))i++;else if(goog.i18n.bidi.hasNumeralsRe_.test(s))r=true}return 0==i?r?goog.i18n.bidi.Dir.LTR:goog.i18n.bidi.Dir.NEUTRAL:t/i>goog.i18n.bidi.rtlDetectionThreshold_?goog.i18n.bidi.Dir.RTL:goog.i18n.bidi.Dir.LTR};goog.i18n.bidi.detectRtlDirectionality=function(e,o){return goog.i18n.bidi.estimateDirection(e,o)==goog.i18n.bidi.Dir.RTL};goog.i18n.bidi.setElementDirAndAlign=function(e,o){if(e){var t=e;o=goog.i18n.bidi.toDir(o);if(o){t.style.textAlign=o==goog.i18n.bidi.Dir.RTL?goog.i18n.bidi.RIGHT:goog.i18n.bidi.LEFT;t.dir=o==goog.i18n.bidi.Dir.RTL?"rtl":"ltr"}}};goog.i18n.bidi.setElementDirByTextDirectionality=function(e,o){var t=e;switch(goog.i18n.bidi.estimateDirection(o)){case goog.i18n.bidi.Dir.LTR:t.dir="ltr";break;case goog.i18n.bidi.Dir.RTL:t.dir="rtl";break;default:t.removeAttribute("dir")}};goog.i18n.bidi.DirectionalString=function(){};goog.i18n.bidi.DirectionalString.prototype.implementsGoogI18nBidiDirectionalString;goog.i18n.bidi.DirectionalString.prototype.getDirection;goog.provide("goog.i18n.DateTimeFormat");goog.provide("goog.i18n.DateTimeFormat.Format");goog.require("goog.asserts");goog.require("goog.date");goog.require("goog.i18n.DateTimeSymbols");goog.require("goog.i18n.TimeZone");goog.require("goog.string");goog.i18n.DateTimeFormat=function(e,o){goog.asserts.assert(goog.isDef(e),"Pattern must be defined");goog.asserts.assert(goog.isDef(o)||goog.isDef(goog.i18n.DateTimeSymbols),"goog.i18n.DateTimeSymbols or explicit symbols must be defined");this.patternParts_=[];this.dateTimeSymbols_=o||goog.i18n.DateTimeSymbols;if("number"==typeof e)this.applyStandardPattern_(e);else this.applyPattern_(e)};goog.i18n.DateTimeFormat.Format={FULL_DATE:0,LONG_DATE:1,MEDIUM_DATE:2,SHORT_DATE:3,FULL_TIME:4,LONG_TIME:5,MEDIUM_TIME:6,SHORT_TIME:7,FULL_DATETIME:8,LONG_DATETIME:9,MEDIUM_DATETIME:10,SHORT_DATETIME:11};goog.i18n.DateTimeFormat.TOKENS_=[/^\'(?:[^\']|\'\')*(\'|$)/,/^(?:G+|y+|M+|k+|S+|E+|a+|h+|K+|H+|c+|L+|Q+|d+|m+|s+|v+|V+|w+|z+|Z+)/,/^[^\'GyMkSEahKHcLQdmsvVwzZ]+/];goog.i18n.DateTimeFormat.PartTypes_={QUOTED_STRING:0,FIELD:1,LITERAL:2};goog.i18n.DateTimeFormat.getHours_=function(e){return e.getHours?e.getHours():0};goog.i18n.DateTimeFormat.prototype.applyPattern_=function(e){if(goog.i18n.DateTimeFormat.removeRlmInPatterns_)e=e.replace(/\u200f/g,"");while(e){var o=e;for(var t=0;t<goog.i18n.DateTimeFormat.TOKENS_.length;++t){var i=e.match(goog.i18n.DateTimeFormat.TOKENS_[t]);if(i){var r=i[0];e=e.substring(r.length);if(t==goog.i18n.DateTimeFormat.PartTypes_.QUOTED_STRING)if("''"==r)r="'";else{r=r.substring(1,"'"==i[1]?r.length-1:r.length);r=r.replace(/\'\'/g,"'")}this.patternParts_.push({text:r,type:t});break}}if(o===e)throw new Error("Malformed pattern part: "+e)}};goog.i18n.DateTimeFormat.prototype.format=function(e,o){if(!e)throw new Error("The date to format must be non-null.");var t=o?6e4*(e.getTimezoneOffset()-o.getOffset(e)):0;var i=t?new Date(e.getTime()+t):e;var r=i;if(o&&i.getTimezoneOffset()!=e.getTimezoneOffset()){var n=6e4*(i.getTimezoneOffset()-e.getTimezoneOffset());i=new Date(i.getTime()+n);t+=t>0?-goog.date.MS_PER_DAY:goog.date.MS_PER_DAY;r=new Date(e.getTime()+t)}var l=[];for(var s=0;s<this.patternParts_.length;++s){var g=this.patternParts_[s].text;if(goog.i18n.DateTimeFormat.PartTypes_.FIELD==this.patternParts_[s].type)l.push(this.formatField_(g,e,i,r,o));else l.push(g)}return l.join("")};goog.i18n.DateTimeFormat.prototype.applyStandardPattern_=function(e){var o;if(e<4)o=this.dateTimeSymbols_.DATEFORMATS[e];else if(e<8)o=this.dateTimeSymbols_.TIMEFORMATS[e-4];else if(e<12){o=this.dateTimeSymbols_.DATETIMEFORMATS[e-8];o=o.replace("{1}",this.dateTimeSymbols_.DATEFORMATS[e-8]);o=o.replace("{0}",this.dateTimeSymbols_.TIMEFORMATS[e-8])}else{this.applyStandardPattern_(goog.i18n.DateTimeFormat.Format.MEDIUM_DATETIME);return}this.applyPattern_(o)};goog.i18n.DateTimeFormat.prototype.localizeNumbers_=function(e){return goog.i18n.DateTimeFormat.localizeNumbers(e,this.dateTimeSymbols_)};goog.i18n.DateTimeFormat.enforceAsciiDigits_=false;goog.i18n.DateTimeFormat.removeRlmInPatterns_=false;goog.i18n.DateTimeFormat.setEnforceAsciiDigits=function(e){goog.i18n.DateTimeFormat.enforceAsciiDigits_=e;goog.i18n.DateTimeFormat.removeRlmInPatterns_=e};goog.i18n.DateTimeFormat.isEnforceAsciiDigits=function(){return goog.i18n.DateTimeFormat.enforceAsciiDigits_};goog.i18n.DateTimeFormat.localizeNumbers=function(e,o){e=String(e);var t=o||goog.i18n.DateTimeSymbols;if(void 0===t.ZERODIGIT||goog.i18n.DateTimeFormat.enforceAsciiDigits_)return e;var i=[];for(var r=0;r<e.length;r++){var n=e.charCodeAt(r);i.push(48<=n&&n<=57?String.fromCharCode(t.ZERODIGIT+n-48):e.charAt(r))}return i.join("")};goog.i18n.DateTimeFormat.prototype.formatEra_=function(e,o){var t=o.getFullYear()>0?1:0;return e>=4?this.dateTimeSymbols_.ERANAMES[t]:this.dateTimeSymbols_.ERAS[t]};goog.i18n.DateTimeFormat.prototype.formatYear_=function(e,o){var t=o.getFullYear();if(t<0)t=-t;if(2==e)t%=100;return this.localizeNumbers_(goog.string.padNumber(t,e))};goog.i18n.DateTimeFormat.prototype.formatMonth_=function(e,o){var t=o.getMonth();switch(e){case 5:return this.dateTimeSymbols_.NARROWMONTHS[t];case 4:return this.dateTimeSymbols_.MONTHS[t];case 3:return this.dateTimeSymbols_.SHORTMONTHS[t];default:return this.localizeNumbers_(goog.string.padNumber(t+1,e))}};goog.i18n.DateTimeFormat.validateDateHasTime_=function(e){if(e.getHours&&e.getSeconds&&e.getMinutes)return;throw new Error("The date to format has no time (probably a goog.date.Date). "+"Use Date or goog.date.DateTime, or use a pattern without time fields.")};goog.i18n.DateTimeFormat.prototype.format24Hours_=function(e,o){goog.i18n.DateTimeFormat.validateDateHasTime_(o);var t=goog.i18n.DateTimeFormat.getHours_(o)||24;return this.localizeNumbers_(goog.string.padNumber(t,e))};goog.i18n.DateTimeFormat.prototype.formatFractionalSeconds_=function(e,o){var t=o.getTime()%1e3/1e3;return this.localizeNumbers_(t.toFixed(Math.min(3,e)).substr(2)+(e>3?goog.string.padNumber(0,e-3):""))};goog.i18n.DateTimeFormat.prototype.formatDayOfWeek_=function(e,o){var t=o.getDay();return e>=4?this.dateTimeSymbols_.WEEKDAYS[t]:this.dateTimeSymbols_.SHORTWEEKDAYS[t]};goog.i18n.DateTimeFormat.prototype.formatAmPm_=function(e,o){goog.i18n.DateTimeFormat.validateDateHasTime_(o);var t=goog.i18n.DateTimeFormat.getHours_(o);return this.dateTimeSymbols_.AMPMS[t>=12&&t<24?1:0]};goog.i18n.DateTimeFormat.prototype.format1To12Hours_=function(e,o){goog.i18n.DateTimeFormat.validateDateHasTime_(o);var t=goog.i18n.DateTimeFormat.getHours_(o)%12||12;return this.localizeNumbers_(goog.string.padNumber(t,e))};goog.i18n.DateTimeFormat.prototype.format0To11Hours_=function(e,o){goog.i18n.DateTimeFormat.validateDateHasTime_(o);var t=goog.i18n.DateTimeFormat.getHours_(o)%12;return this.localizeNumbers_(goog.string.padNumber(t,e))};goog.i18n.DateTimeFormat.prototype.format0To23Hours_=function(e,o){goog.i18n.DateTimeFormat.validateDateHasTime_(o);var t=goog.i18n.DateTimeFormat.getHours_(o);return this.localizeNumbers_(goog.string.padNumber(t,e))};goog.i18n.DateTimeFormat.prototype.formatStandaloneDay_=function(e,o){var t=o.getDay();switch(e){case 5:return this.dateTimeSymbols_.STANDALONENARROWWEEKDAYS[t];case 4:return this.dateTimeSymbols_.STANDALONEWEEKDAYS[t];case 3:return this.dateTimeSymbols_.STANDALONESHORTWEEKDAYS[t];default:return this.localizeNumbers_(goog.string.padNumber(t,1))}};goog.i18n.DateTimeFormat.prototype.formatStandaloneMonth_=function(e,o){var t=o.getMonth();switch(e){case 5:return this.dateTimeSymbols_.STANDALONENARROWMONTHS[t];case 4:return this.dateTimeSymbols_.STANDALONEMONTHS[t];case 3:return this.dateTimeSymbols_.STANDALONESHORTMONTHS[t];default:return this.localizeNumbers_(goog.string.padNumber(t+1,e))}};goog.i18n.DateTimeFormat.prototype.formatQuarter_=function(e,o){var t=Math.floor(o.getMonth()/3);return e<4?this.dateTimeSymbols_.SHORTQUARTERS[t]:this.dateTimeSymbols_.QUARTERS[t]};goog.i18n.DateTimeFormat.prototype.formatDate_=function(e,o){return this.localizeNumbers_(goog.string.padNumber(o.getDate(),e))};goog.i18n.DateTimeFormat.prototype.formatMinutes_=function(e,o){goog.i18n.DateTimeFormat.validateDateHasTime_(o);return this.localizeNumbers_(goog.string.padNumber(o.getMinutes(),e))};goog.i18n.DateTimeFormat.prototype.formatSeconds_=function(e,o){goog.i18n.DateTimeFormat.validateDateHasTime_(o);return this.localizeNumbers_(goog.string.padNumber(o.getSeconds(),e))};goog.i18n.DateTimeFormat.prototype.formatWeekOfYear_=function(e,o){var t=goog.date.getWeekNumber(o.getFullYear(),o.getMonth(),o.getDate(),this.dateTimeSymbols_.FIRSTWEEKCUTOFFDAY,this.dateTimeSymbols_.FIRSTDAYOFWEEK);return this.localizeNumbers_(goog.string.padNumber(t,e))};goog.i18n.DateTimeFormat.prototype.formatTimeZoneRFC_=function(e,o,t){t=t||goog.i18n.TimeZone.createTimeZone(o.getTimezoneOffset());return e<4?t.getRFCTimeZoneString(o):this.localizeNumbers_(t.getGMTString(o))};goog.i18n.DateTimeFormat.prototype.formatTimeZone_=function(e,o,t){t=t||goog.i18n.TimeZone.createTimeZone(o.getTimezoneOffset());return e<4?t.getShortName(o):t.getLongName(o)};goog.i18n.DateTimeFormat.prototype.formatTimeZoneId_=function(e,o){o=o||goog.i18n.TimeZone.createTimeZone(e.getTimezoneOffset());return o.getTimeZoneId()};goog.i18n.DateTimeFormat.prototype.formatTimeZoneLocationId_=function(e,o,t){t=t||goog.i18n.TimeZone.createTimeZone(o.getTimezoneOffset());return e<=2?t.getTimeZoneId():t.getGenericLocation(o)};goog.i18n.DateTimeFormat.prototype.formatField_=function(e,o,t,i,r){var n=e.length;switch(e.charAt(0)){case"G":return this.formatEra_(n,t);case"y":return this.formatYear_(n,t);case"M":return this.formatMonth_(n,t);case"k":return this.format24Hours_(n,i);case"S":return this.formatFractionalSeconds_(n,i);case"E":return this.formatDayOfWeek_(n,t);case"a":return this.formatAmPm_(n,i);case"h":return this.format1To12Hours_(n,i);case"K":return this.format0To11Hours_(n,i);case"H":return this.format0To23Hours_(n,i);case"c":return this.formatStandaloneDay_(n,t);case"L":return this.formatStandaloneMonth_(n,t);case"Q":return this.formatQuarter_(n,t);case"d":return this.formatDate_(n,t);case"m":return this.formatMinutes_(n,i);case"s":return this.formatSeconds_(n,i);case"v":return this.formatTimeZoneId_(o,r);case"V":return this.formatTimeZoneLocationId_(n,o,r);case"w":return this.formatWeekOfYear_(n,i);case"z":return this.formatTimeZone_(n,o,r);case"Z":return this.formatTimeZoneRFC_(n,o,r);default:return""}};goog.provide("goog.i18n.DateTimePatterns");goog.provide("goog.i18n.DateTimeSymbols");goog.provide("goog.i18n.TimeZone");goog.require("goog.array");goog.require("goog.date.DateLike");goog.require("goog.object");goog.require("goog.string");goog.i18n.TimeZone=function(){this.timeZoneId_;this.standardOffset_;this.tzNames_;this.tzNamesExt_;this.transitions_};goog.i18n.TimeZone.MILLISECONDS_PER_HOUR_=3600*1e3;goog.i18n.TimeZone.NameType={STD_SHORT_NAME:0,STD_LONG_NAME:1,DLT_SHORT_NAME:2,DLT_LONG_NAME:3};goog.i18n.TimeZone.createTimeZone=function(e){if("number"==typeof e)return goog.i18n.TimeZone.createSimpleTimeZone_(e);var o=new goog.i18n.TimeZone;o.timeZoneId_=e["id"];o.standardOffset_=-e["std_offset"];o.tzNames_=e["names"];o.tzNamesExt_=e["names_ext"];o.transitions_=e["transitions"];return o};goog.i18n.TimeZone.createSimpleTimeZone_=function(e){var o=new goog.i18n.TimeZone;o.standardOffset_=e;o.timeZoneId_=goog.i18n.TimeZone.composePosixTimeZoneID_(e);var t=goog.i18n.TimeZone.composeUTCString_(e);var i=goog.i18n.TimeZone.composeGMTString_(e);o.tzNames_=[t,t];o.tzNamesExt_={STD_LONG_NAME_GMT:i,STD_GENERIC_LOCATION:i};o.transitions_=[];return o};goog.i18n.TimeZone.composeGMTString_=function(e){var o=["GMT"];o.push(e<=0?"+":"-");e=Math.abs(e);o.push(goog.string.padNumber(Math.floor(e/60)%100,2),":",goog.string.padNumber(e%60,2));return o.join("")};goog.i18n.TimeZone.composePosixTimeZoneID_=function(e){if(0==e)return"Etc/GMT";var o=["Etc/GMT",e<0?"-":"+"];e=Math.abs(e);o.push(Math.floor(e/60)%100);e%=60;if(0!=e)o.push(":",goog.string.padNumber(e,2));return o.join("")};goog.i18n.TimeZone.composeUTCString_=function(e){if(0==e)return"UTC";var o=["UTC",e<0?"+":"-"];e=Math.abs(e);o.push(Math.floor(e/60)%100);e%=60;if(0!=e)o.push(":",e);return o.join("")};goog.i18n.TimeZone.prototype.getTimeZoneData=function(){return{id:this.timeZoneId_,std_offset:-this.standardOffset_,names:goog.array.clone(this.tzNames_),names_ext:goog.object.clone(this.tzNamesExt_),transitions:goog.array.clone(this.transitions_)}};goog.i18n.TimeZone.prototype.getDaylightAdjustment=function(e){var o=Date.UTC(e.getUTCFullYear(),e.getUTCMonth(),e.getUTCDate(),e.getUTCHours(),e.getUTCMinutes());var t=o/goog.i18n.TimeZone.MILLISECONDS_PER_HOUR_;var i=0;while(i<this.transitions_.length&&t>=this.transitions_[i])i+=2;return 0==i?0:this.transitions_[i-1]};goog.i18n.TimeZone.prototype.getGMTString=function(e){return goog.i18n.TimeZone.composeGMTString_(this.getOffset(e))};goog.i18n.TimeZone.prototype.getLongName=function(e){return this.tzNames_[this.isDaylightTime(e)?goog.i18n.TimeZone.NameType.DLT_LONG_NAME:goog.i18n.TimeZone.NameType.STD_LONG_NAME]};goog.i18n.TimeZone.prototype.getOffset=function(e){return this.standardOffset_-this.getDaylightAdjustment(e)};goog.i18n.TimeZone.prototype.getRFCTimeZoneString=function(e){var o=-this.getOffset(e);var t=[o<0?"-":"+"];o=Math.abs(o);t.push(goog.string.padNumber(Math.floor(o/60)%100,2),goog.string.padNumber(o%60,2));return t.join("")};goog.i18n.TimeZone.prototype.getShortName=function(e){return this.tzNames_[this.isDaylightTime(e)?goog.i18n.TimeZone.NameType.DLT_SHORT_NAME:goog.i18n.TimeZone.NameType.STD_SHORT_NAME]};goog.i18n.TimeZone.prototype.getTimeZoneId=function(){return this.timeZoneId_};goog.i18n.TimeZone.prototype.isDaylightTime=function(e){return this.getDaylightAdjustment(e)>0};goog.i18n.TimeZone.prototype.getLongNameGMT=function(e){if(this.isDaylightTime(e))return goog.isDef(this.tzNamesExt_.DST_LONG_NAME_GMT)?this.tzNamesExt_.DST_LONG_NAME_GMT:this.tzNamesExt_["DST_LONG_NAME_GMT"];else return goog.isDef(this.tzNamesExt_.STD_LONG_NAME_GMT)?this.tzNamesExt_.STD_LONG_NAME_GMT:this.tzNamesExt_["STD_LONG_NAME_GMT"]};goog.i18n.TimeZone.prototype.getGenericLocation=function(e){if(this.isDaylightTime(e))return goog.isDef(this.tzNamesExt_.DST_GENERIC_LOCATION)?this.tzNamesExt_.DST_GENERIC_LOCATION:this.tzNamesExt_["DST_GENERIC_LOCATION"];else return goog.isDef(this.tzNamesExt_.STD_GENERIC_LOCATION)?this.tzNamesExt_.STD_GENERIC_LOCATION:this.tzNamesExt_["STD_GENERIC_LOCATION"]};goog.provide("goog.iter");goog.provide("goog.iter.Iterable");goog.provide("goog.iter.Iterator");goog.provide("goog.iter.StopIteration");goog.require("goog.array");goog.require("goog.asserts");goog.require("goog.functions");goog.require("goog.math");goog.iter.Iterable;goog.iter.StopIteration="StopIteration"in goog.global?goog.global["StopIteration"]:{message:"StopIteration",stack:""};goog.iter.Iterator=function(){};goog.iter.Iterator.prototype.next=function(){throw goog.iter.StopIteration};goog.iter.Iterator.prototype.__iterator__=function(e){return this};goog.iter.toIterator=function(e){if(e instanceof goog.iter.Iterator)return e;if("function"==typeof e.__iterator__)return e.__iterator__(false);if(goog.isArrayLike(e)){var o=e;var t=0;var i=new goog.iter.Iterator;i.next=function(){while(true){if(t>=o.length)throw goog.iter.StopIteration;if(!(t in o)){t++;continue}return o[t++]}};return i}throw new Error("Not implemented")};goog.iter.forEach=function(e,o,t){if(goog.isArrayLike(e))try{goog.array.forEach(e,o,t)}catch(e){if(e!==goog.iter.StopIteration)throw e}else{e=goog.iter.toIterator(e);try{while(true)o.call(t,e.next(),void 0,e)}catch(e){if(e!==goog.iter.StopIteration)throw e}}};goog.iter.filter=function(e,o,t){var i=goog.iter.toIterator(e);var r=new goog.iter.Iterator;r.next=function(){while(true){var e=i.next();if(o.call(t,e,void 0,i))return e}};return r};goog.iter.filterFalse=function(e,o,t){return goog.iter.filter(e,goog.functions.not(o),t)};goog.iter.range=function(e,o,t){var i=0;var r=e;var n=t||1;if(arguments.length>1){i=e;r=+o}if(0==n)throw new Error("Range step argument must not be zero");var l=new goog.iter.Iterator;l.next=function(){if(n>0&&i>=r||n<0&&i<=r)throw goog.iter.StopIteration;var e=i;i+=n;return e};return l};goog.iter.join=function(e,o){return goog.iter.toArray(e).join(o)};goog.iter.map=function(e,o,t){var i=goog.iter.toIterator(e);var r=new goog.iter.Iterator;r.next=function(){var e=i.next();return o.call(t,e,void 0,i)};return r};goog.iter.reduce=function(e,o,t,i){var r=t;goog.iter.forEach(e,(function(e){r=o.call(i,r,e)}));return r};goog.iter.some=function(e,o,t){e=goog.iter.toIterator(e);try{while(true)if(o.call(t,e.next(),void 0,e))return true}catch(e){if(e!==goog.iter.StopIteration)throw e}return false};goog.iter.every=function(e,o,t){e=goog.iter.toIterator(e);try{while(true)if(!o.call(t,e.next(),void 0,e))return false}catch(e){if(e!==goog.iter.StopIteration)throw e}return true};goog.iter.chain=function(e){return goog.iter.chainFromIterable(arguments)};goog.iter.chainFromIterable=function(e){var o=goog.iter.toIterator(e);var t=new goog.iter.Iterator;var i=null;t.next=function(){while(true){if(null==i){var e=o.next();i=goog.iter.toIterator(e)}try{return i.next()}catch(e){if(e!==goog.iter.StopIteration)throw e;i=null}}};return t};goog.iter.dropWhile=function(e,o,t){var i=goog.iter.toIterator(e);var r=new goog.iter.Iterator;var n=true;r.next=function(){while(true){var e=i.next();if(n&&o.call(t,e,void 0,i))continue;else n=false;return e}};return r};goog.iter.takeWhile=function(e,o,t){var i=goog.iter.toIterator(e);var r=new goog.iter.Iterator;r.next=function(){var e=i.next();if(o.call(t,e,void 0,i))return e;throw goog.iter.StopIteration};return r};goog.iter.toArray=function(e){if(goog.isArrayLike(e))return goog.array.toArray(e);e=goog.iter.toIterator(e);var o=[];goog.iter.forEach(e,(function(e){o.push(e)}));return o};goog.iter.equals=function(e,o,t){var i={};var r=goog.iter.zipLongest(i,e,o);var n=t||goog.array.defaultCompareEquality;return goog.iter.every(r,(function(e){return n(e[0],e[1])}))};goog.iter.nextOrValue=function(e,o){try{return goog.iter.toIterator(e).next()}catch(e){if(e!=goog.iter.StopIteration)throw e;return o}};goog.iter.product=function(e){var o=goog.array.some(arguments,(function(e){return!e.length}));if(o||!arguments.length)return new goog.iter.Iterator;var t=new goog.iter.Iterator;var i=arguments;var r=goog.array.repeat(0,i.length);t.next=function(){if(r){var e=goog.array.map(r,(function(e,o){return i[o][e]}));for(var o=r.length-1;o>=0;o--){goog.asserts.assert(r);if(r[o]<i[o].length-1){r[o]++;break}if(0==o){r=null;break}r[o]=0}return e}throw goog.iter.StopIteration};return t};goog.iter.cycle=function(e){var o=goog.iter.toIterator(e);var t=[];var i=0;var r=new goog.iter.Iterator;var n=false;r.next=function(){var e=null;if(!n)try{e=o.next();t.push(e);return e}catch(e){if(e!=goog.iter.StopIteration||goog.array.isEmpty(t))throw e;n=true}e=t[i];i=(i+1)%t.length;return e};return r};goog.iter.count=function(e,o){var t=e||0;var i=goog.isDef(o)?o:1;var r=new goog.iter.Iterator;r.next=function(){var e=t;t+=i;return e};return r};goog.iter.repeat=function(e){var o=new goog.iter.Iterator;o.next=goog.functions.constant(e);return o};goog.iter.accumulate=function(e){var o=goog.iter.toIterator(e);var t=0;var i=new goog.iter.Iterator;i.next=function(){t+=o.next();return t};return i};goog.iter.zip=function(e){var o=arguments;var t=new goog.iter.Iterator;if(o.length>0){var i=goog.array.map(o,goog.iter.toIterator);t.next=function(){var e=goog.array.map(i,(function(e){return e.next()}));return e}}return t};goog.iter.zipLongest=function(e,o){var t=goog.array.slice(arguments,1);var i=new goog.iter.Iterator;if(t.length>0){var r=goog.array.map(t,goog.iter.toIterator);i.next=function(){var o=false;var t=goog.array.map(r,(function(t){var i;try{i=t.next();o=true}catch(o){if(o!==goog.iter.StopIteration)throw o;i=e}return i}));if(!o)throw goog.iter.StopIteration;return t}}return i};goog.iter.compress=function(e,o){var t=goog.iter.toIterator(o);return goog.iter.filter(e,(function(){return!!t.next()}))};goog.iter.GroupByIterator_=function(e,o){this.iterator=goog.iter.toIterator(e);this.keyFunc=o||goog.functions.identity;this.targetKey;this.currentKey;this.currentValue};goog.inherits(goog.iter.GroupByIterator_,goog.iter.Iterator);goog.iter.GroupByIterator_.prototype.next=function(){while(this.currentKey==this.targetKey){this.currentValue=this.iterator.next();this.currentKey=this.keyFunc(this.currentValue)}this.targetKey=this.currentKey;return[this.currentKey,this.groupItems_(this.targetKey)]};goog.iter.GroupByIterator_.prototype.groupItems_=function(e){var o=[];while(this.currentKey==e){o.push(this.currentValue);try{this.currentValue=this.iterator.next()}catch(e){if(e!==goog.iter.StopIteration)throw e;break}this.currentKey=this.keyFunc(this.currentValue)}return o};goog.iter.groupBy=function(e,o){return new goog.iter.GroupByIterator_(e,o)};goog.iter.starMap=function(e,o,t){var i=goog.iter.toIterator(e);var r=new goog.iter.Iterator;r.next=function(){var e=goog.iter.toArray(i.next());return o.apply(t,goog.array.concat(e,void 0,i))};return r};goog.iter.tee=function(e,o){var t=goog.iter.toIterator(e);var i=goog.isNumber(o)?o:2;var r=goog.array.map(goog.array.range(i),(function(){return[]}));var n=function(){var e=t.next();goog.array.forEach(r,(function(o){o.push(e)}))};var l=function(e){var o=new goog.iter.Iterator;o.next=function(){if(goog.array.isEmpty(e))n();goog.asserts.assert(!goog.array.isEmpty(e));return e.shift()};return o};return goog.array.map(r,l)};goog.iter.enumerate=function(e,o){return goog.iter.zip(goog.iter.count(o),e)};goog.iter.limit=function(e,o){goog.asserts.assert(goog.math.isInt(o)&&o>=0);var t=goog.iter.toIterator(e);var i=new goog.iter.Iterator;var r=o;i.next=function(){if(r-- >0)return t.next();throw goog.iter.StopIteration};return i};goog.iter.consume=function(e,o){goog.asserts.assert(goog.math.isInt(o)&&o>=0);var t=goog.iter.toIterator(e);while(o-- >0)goog.iter.nextOrValue(t,null);return t};goog.iter.slice=function(e,o,t){goog.asserts.assert(goog.math.isInt(o)&&o>=0);var i=goog.iter.consume(e,o);if(goog.isNumber(t)){goog.asserts.assert(goog.math.isInt(t)&&t>=o);i=goog.iter.limit(i,t-o)}return i};goog.iter.hasDuplicates_=function(e){var o=[];goog.array.removeDuplicates(e,o);return e.length!=o.length};goog.iter.permutations=function(e,o){var t=goog.iter.toArray(e);var i=goog.isNumber(o)?o:t.length;var r=goog.array.repeat(t,i);var n=goog.iter.product.apply(void 0,r);return goog.iter.filter(n,(function(e){return!goog.iter.hasDuplicates_(e)}))};goog.iter.combinations=function(e,o){var t=goog.iter.toArray(e);var i=goog.iter.range(t.length);var r=goog.iter.permutations(i,o);var n=goog.iter.filter(r,(function(e){return goog.array.isSorted(e)}));var l=new goog.iter.Iterator;function s(e){return t[e]}l.next=function(){return goog.array.map(n.next(),s)};return l};goog.iter.combinationsWithReplacement=function(e,o){var t=goog.iter.toArray(e);var i=goog.array.range(t.length);var r=goog.array.repeat(i,o);var n=goog.iter.product.apply(void 0,r);var l=goog.iter.filter(n,(function(e){return goog.array.isSorted(e)}));var s=new goog.iter.Iterator;function g(e){return t[e]}s.next=function(){return goog.array.map(l.next(),g)};return s};goog.provide("goog.date");goog.provide("goog.date.Date");goog.provide("goog.date.DateTime");goog.provide("goog.date.Interval");goog.provide("goog.date.month");goog.provide("goog.date.weekDay");goog.require("goog.asserts");goog.require("goog.date.DateLike");goog.require("goog.i18n.DateTimeSymbols");goog.require("goog.string");goog.date.weekDay={MON:0,TUE:1,WED:2,THU:3,FRI:4,SAT:5,SUN:6};goog.date.month={JAN:0,FEB:1,MAR:2,APR:3,MAY:4,JUN:5,JUL:6,AUG:7,SEP:8,OCT:9,NOV:10,DEC:11};goog.date.formatMonthAndYear=function(e,o){var t=goog.getMsg("{$monthName} {$yearNum}",{monthName:e,yearNum:String(o)});return t};goog.date.splitDateStringRegex_=new RegExp("^(\\d{4})(?:(?:-?(\\d{2})(?:-?(\\d{2}))?)|"+"(?:-?(\\d{3}))|(?:-?W(\\d{2})(?:-?([1-7]))?))?$");goog.date.splitTimeStringRegex_=/^(\d{2})(?::?(\d{2})(?::?(\d{2})(\.\d+)?)?)?$/;goog.date.splitTimezoneStringRegex_=/Z|(?:([-+])(\d{2})(?::?(\d{2}))?)$/;goog.date.splitDurationRegex_=new RegExp("^(-)?P(?:(\\d+)Y)?(?:(\\d+)M)?(?:(\\d+)D)?"+"(T(?:(\\d+)H)?(?:(\\d+)M)?(?:(\\d+(?:\\.\\d+)?)S)?)?$");goog.date.MS_PER_DAY=24*60*60*1e3;goog.date.isLeapYear=function(e){return e%4==0&&(e%100!=0||e%400==0)};goog.date.isLongIsoYear=function(e){var o=5*e+12-4*(Math.floor(e/100)-Math.floor(e/400));o+=Math.floor((e-100)/400)-Math.floor((e-102)/400);o+=Math.floor((e-200)/400)-Math.floor((e-199)/400);return o%28<5};goog.date.getNumberOfDaysInMonth=function(e,o){switch(o){case goog.date.month.FEB:return goog.date.isLeapYear(e)?29:28;case goog.date.month.JUN:case goog.date.month.SEP:case goog.date.month.NOV:case goog.date.month.APR:return 30}return 31};goog.date.isSameDay=function(e,o){var t=o||new Date(goog.now());return e.getDate()==t.getDate()&&goog.date.isSameMonth(e,t)};goog.date.isSameMonth=function(e,o){var t=o||new Date(goog.now());return e.getMonth()==t.getMonth()&&goog.date.isSameYear(e,t)};goog.date.isSameYear=function(e,o){var t=o||new Date(goog.now());return e.getFullYear()==t.getFullYear()};goog.date.getWeekNumber=function(e,o,t,i,r){var n=new Date(e,o,t);var l=goog.isDef(i)?i:goog.date.weekDay.THU;var s=r||goog.date.weekDay.MON;var g=(n.getDay()+6)%7;var a=(g-s+7)%7;var c=(l-s+7)%7;var u=n.valueOf()+(c-a)*goog.date.MS_PER_DAY;var h=new Date(new Date(u).getFullYear(),0,1).valueOf();return Math.floor(Math.round((u-h)/goog.date.MS_PER_DAY)/7)+1};goog.date.min=function(e,o){return e<o?e:o};goog.date.max=function(e,o){return e>o?e:o};goog.date.setIso8601DateTime=function(e,o){o=goog.string.trim(o);var t=-1==o.indexOf("T")?" ":"T";var i=o.split(t);return goog.date.setIso8601DateOnly_(e,i[0])&&(i.length<2||goog.date.setIso8601TimeOnly_(e,i[1]))};goog.date.setIso8601DateOnly_=function(e,o){var t=o.match(goog.date.splitDateStringRegex_);if(!t)return false;var i=Number(t[1]);var r=Number(t[2]);var n=Number(t[3]);var l=Number(t[4]);var s=Number(t[5]);var g=Number(t[6])||1;e.setFullYear(i);if(l){e.setDate(1);e.setMonth(0);var a=l-1;e.add(new goog.date.Interval(goog.date.Interval.DAYS,a))}else if(s)goog.date.setDateFromIso8601Week_(e,s,g);else{if(r){e.setDate(1);e.setMonth(r-1)}if(n)e.setDate(n)}return true};goog.date.setDateFromIso8601Week_=function(e,o,t){e.setMonth(0);e.setDate(1);var i=e.getDay();var r=i||7;var n=4;if(r<=n)var l=1-r;else l=8-r;var s=Number(t)+7*(Number(o)-1);var g=l+s-1;var a=new goog.date.Interval(goog.date.Interval.DAYS,g);e.add(a)};goog.date.setIso8601TimeOnly_=function(e,o){var t=o.match(goog.date.splitTimezoneStringRegex_);var i=0;if(t){if("Z"!=t[0]){i=60*Number(t[2])+Number(t[3]);i*="-"==t[1]?1:-1}i-=e.getTimezoneOffset();o=o.substr(0,o.length-t[0].length)}t=o.match(goog.date.splitTimeStringRegex_);if(!t)return false;e.setHours(Number(t[1]));e.setMinutes(Number(t[2])||0);e.setSeconds(Number(t[3])||0);e.setMilliseconds(t[4]?1e3*Number(t[4]):0);if(0!=i)e.setTime(e.getTime()+6e4*i);return true};goog.date.Interval=function(e,o,t,i,r,n){if(goog.isString(e)){var l=e;var s=o;this.years=l==goog.date.Interval.YEARS?s:0;this.months=l==goog.date.Interval.MONTHS?s:0;this.days=l==goog.date.Interval.DAYS?s:0;this.hours=l==goog.date.Interval.HOURS?s:0;this.minutes=l==goog.date.Interval.MINUTES?s:0;this.seconds=l==goog.date.Interval.SECONDS?s:0}else{this.years=e||0;this.months=o||0;this.days=t||0;this.hours=i||0;this.minutes=r||0;this.seconds=n||0}};goog.date.Interval.fromIsoString=function(e){var o=e.match(goog.date.splitDurationRegex_);if(!o)return null;var t=!(o[6]||o[7]||o[8]);var i=t&&!(o[2]||o[3]||o[4]);if(i||t&&o[5])return null;var r=o[1];var n=parseInt(o[2],10)||0;var l=parseInt(o[3],10)||0;var s=parseInt(o[4],10)||0;var g=parseInt(o[6],10)||0;var a=parseInt(o[7],10)||0;var c=parseFloat(o[8])||0;return r?new goog.date.Interval(-n,-l,-s,-g,-a,-c):new goog.date.Interval(n,l,s,g,a,c)};goog.date.Interval.prototype.toIsoString=function(e){var o=Math.min(this.years,this.months,this.days,this.hours,this.minutes,this.seconds);var t=Math.max(this.years,this.months,this.days,this.hours,this.minutes,this.seconds);if(o<0&&t>0)return null;if(!e&&0==o&&0==t)return"PT0S";var i=[];if(o<0)i.push("-");i.push("P");if(this.years||e)i.push(Math.abs(this.years)+"Y");if(this.months||e)i.push(Math.abs(this.months)+"M");if(this.days||e)i.push(Math.abs(this.days)+"D");if(this.hours||this.minutes||this.seconds||e){i.push("T");if(this.hours||e)i.push(Math.abs(this.hours)+"H");if(this.minutes||e)i.push(Math.abs(this.minutes)+"M");if(this.seconds||e)i.push(Math.abs(this.seconds)+"S")}return i.join("")};goog.date.Interval.prototype.equals=function(e){return e.years==this.years&&e.months==this.months&&e.days==this.days&&e.hours==this.hours&&e.minutes==this.minutes&&e.seconds==this.seconds};goog.date.Interval.prototype.clone=function(){return new goog.date.Interval(this.years,this.months,this.days,this.hours,this.minutes,this.seconds)};goog.date.Interval.YEARS="y";goog.date.Interval.MONTHS="m";goog.date.Interval.DAYS="d";goog.date.Interval.HOURS="h";goog.date.Interval.MINUTES="n";goog.date.Interval.SECONDS="s";goog.date.Interval.prototype.isZero=function(){return 0==this.years&&0==this.months&&0==this.days&&0==this.hours&&0==this.minutes&&0==this.seconds};goog.date.Interval.prototype.getInverse=function(){return this.times(-1)};goog.date.Interval.prototype.times=function(e){return new goog.date.Interval(this.years*e,this.months*e,this.days*e,this.hours*e,this.minutes*e,this.seconds*e)};goog.date.Interval.prototype.getTotalSeconds=function(){goog.asserts.assert(0==this.years&&0==this.months);return 60*(60*(24*this.days+this.hours)+this.minutes)+this.seconds};goog.date.Interval.prototype.add=function(e){this.years+=e.years;this.months+=e.months;this.days+=e.days;this.hours+=e.hours;this.minutes+=e.minutes;this.seconds+=e.seconds};goog.date.Date=function(e,o,t){this.date;if(goog.isNumber(e)){this.date=this.buildDate_(e,o||0,t||1);this.maybeFixDst_(t||1)}else if(goog.isObject(e)){this.date=this.buildDate_(e.getFullYear(),e.getMonth(),e.getDate());this.maybeFixDst_(e.getDate())}else{this.date=new Date(goog.now());var i=this.date.getDate();this.date.setHours(0);this.date.setMinutes(0);this.date.setSeconds(0);this.date.setMilliseconds(0);this.maybeFixDst_(i)}};goog.date.Date.prototype.buildDate_=function(e,o,t){var i=new Date(e,o,t);if(e>=0&&e<100)i.setFullYear(i.getFullYear()-1900);return i};goog.date.Date.prototype.firstDayOfWeek_=goog.i18n.DateTimeSymbols.FIRSTDAYOFWEEK;goog.date.Date.prototype.firstWeekCutOffDay_=goog.i18n.DateTimeSymbols.FIRSTWEEKCUTOFFDAY;goog.date.Date.prototype.clone=function(){var e=new goog.date.Date(this.date);e.firstDayOfWeek_=this.firstDayOfWeek_;e.firstWeekCutOffDay_=this.firstWeekCutOffDay_;return e};goog.date.Date.prototype.getFullYear=function(){return this.date.getFullYear()};goog.date.Date.prototype.getYear=function(){return this.getFullYear()};goog.date.Date.prototype.getMonth=function(){return this.date.getMonth()};goog.date.Date.prototype.getDate=function(){return this.date.getDate()};goog.date.Date.prototype.getTime=function(){return this.date.getTime()};goog.date.Date.prototype.getDay=function(){return this.date.getDay()};goog.date.Date.prototype.getIsoWeekday=function(){return(this.getDay()+6)%7};goog.date.Date.prototype.getWeekday=function(){return(this.getIsoWeekday()-this.firstDayOfWeek_+7)%7};goog.date.Date.prototype.getUTCFullYear=function(){return this.date.getUTCFullYear()};goog.date.Date.prototype.getUTCMonth=function(){return this.date.getUTCMonth()};goog.date.Date.prototype.getUTCDate=function(){return this.date.getUTCDate()};goog.date.Date.prototype.getUTCDay=function(){return this.date.getDay()};goog.date.Date.prototype.getUTCHours=function(){return this.date.getUTCHours()};goog.date.Date.prototype.getUTCMinutes=function(){return this.date.getUTCMinutes()};goog.date.Date.prototype.getUTCIsoWeekday=function(){return(this.date.getUTCDay()+6)%7};goog.date.Date.prototype.getUTCWeekday=function(){return(this.getUTCIsoWeekday()-this.firstDayOfWeek_+7)%7};goog.date.Date.prototype.getFirstDayOfWeek=function(){return this.firstDayOfWeek_};goog.date.Date.prototype.getFirstWeekCutOffDay=function(){return this.firstWeekCutOffDay_};goog.date.Date.prototype.getNumberOfDaysInMonth=function(){return goog.date.getNumberOfDaysInMonth(this.getFullYear(),this.getMonth())};goog.date.Date.prototype.getWeekNumber=function(){return goog.date.getWeekNumber(this.getFullYear(),this.getMonth(),this.getDate(),this.firstWeekCutOffDay_,this.firstDayOfWeek_)};goog.date.Date.prototype.getDayOfYear=function(){var e=this.getDate();var o=this.getFullYear();for(var t=this.getMonth()-1;t>=0;t--)e+=goog.date.getNumberOfDaysInMonth(o,t);return e};goog.date.Date.prototype.getTimezoneOffset=function(){return this.date.getTimezoneOffset()};goog.date.Date.prototype.getTimezoneOffsetString=function(){var e;var o=this.getTimezoneOffset();if(0==o)e="Z";else{var t=Math.abs(o)/60;var i=Math.floor(t);var r=60*(t-i);e=(o>0?"-":"+")+goog.string.padNumber(i,2)+":"+goog.string.padNumber(r,2)}return e};goog.date.Date.prototype.set=function(e){this.date=new Date(e.getFullYear(),e.getMonth(),e.getDate())};goog.date.Date.prototype.setFullYear=function(e){this.date.setFullYear(e)};goog.date.Date.prototype.setYear=function(e){this.setFullYear(e)};goog.date.Date.prototype.setMonth=function(e){this.date.setMonth(e)};goog.date.Date.prototype.setDate=function(e){this.date.setDate(e)};goog.date.Date.prototype.setTime=function(e){this.date.setTime(e)};goog.date.Date.prototype.setUTCFullYear=function(e){this.date.setUTCFullYear(e)};goog.date.Date.prototype.setUTCMonth=function(e){this.date.setUTCMonth(e)};goog.date.Date.prototype.setUTCDate=function(e){this.date.setUTCDate(e)};goog.date.Date.prototype.setFirstDayOfWeek=function(e){this.firstDayOfWeek_=e};goog.date.Date.prototype.setFirstWeekCutOffDay=function(e){this.firstWeekCutOffDay_=e};goog.date.Date.prototype.add=function(e){if(e.years||e.months){var o=this.getMonth()+e.months+12*e.years;var t=this.getYear()+Math.floor(o/12);o%=12;if(o<0)o+=12;var i=goog.date.getNumberOfDaysInMonth(t,o);var r=Math.min(i,this.getDate());this.setDate(1);this.setFullYear(t);this.setMonth(o);this.setDate(r)}if(e.days){var n=new Date(this.getYear(),this.getMonth(),this.getDate(),12);var l=new Date(n.getTime()+864e5*e.days);this.setDate(1);this.setFullYear(l.getFullYear());this.setMonth(l.getMonth());this.setDate(l.getDate());this.maybeFixDst_(l.getDate())}};goog.date.Date.prototype.toIsoString=function(e,o){var t=[this.getFullYear(),goog.string.padNumber(this.getMonth()+1,2),goog.string.padNumber(this.getDate(),2)];return t.join(e?"-":"")+(o?this.getTimezoneOffsetString():"")};goog.date.Date.prototype.toUTCIsoString=function(e,o){var t=[this.getUTCFullYear(),goog.string.padNumber(this.getUTCMonth()+1,2),goog.string.padNumber(this.getUTCDate(),2)];return t.join(e?"-":"")+(o?"Z":"")};goog.date.Date.prototype.equals=function(e){return!!(e&&this.getYear()==e.getYear()&&this.getMonth()==e.getMonth()&&this.getDate()==e.getDate())};goog.date.Date.prototype.toString=function(){return this.toIsoString()};goog.date.Date.prototype.maybeFixDst_=function(e){if(this.getDate()!=e){var o=this.getDate()<e?1:-1;this.date.setUTCHours(this.date.getUTCHours()+o)}};goog.date.Date.prototype.valueOf=function(){return this.date.valueOf()};goog.date.Date.compare=function(e,o){return e.getTime()-o.getTime()};goog.date.Date.fromIsoString=function(e){var o=new goog.date.Date(2e3);return goog.date.setIso8601DateOnly_(o,e)?o:null};goog.date.DateTime=function(e,o,t,i,r,n,l){if(goog.isNumber(e))this.date=new Date(e,o||0,t||1,i||0,r||0,n||0,l||0);else this.date=new Date(e&&e.getTime?e.getTime():goog.now())};goog.inherits(goog.date.DateTime,goog.date.Date);goog.date.DateTime.fromTimestamp=function(e){var o=new goog.date.DateTime;o.setTime(e);return o};goog.date.DateTime.fromRfc822String=function(e){var o=new Date(e);return!isNaN(o.getTime())?new goog.date.DateTime(o):null};goog.date.DateTime.prototype.getHours=function(){return this.date.getHours()};goog.date.DateTime.prototype.getMinutes=function(){return this.date.getMinutes()};goog.date.DateTime.prototype.getSeconds=function(){return this.date.getSeconds()};goog.date.DateTime.prototype.getMilliseconds=function(){return this.date.getMilliseconds()};goog.date.DateTime.prototype.getUTCDay=function(){return this.date.getUTCDay()};goog.date.DateTime.prototype.getUTCHours=function(){return this.date.getUTCHours()};goog.date.DateTime.prototype.getUTCMinutes=function(){return this.date.getUTCMinutes()};goog.date.DateTime.prototype.getUTCSeconds=function(){return this.date.getUTCSeconds()};goog.date.DateTime.prototype.getUTCMilliseconds=function(){return this.date.getUTCMilliseconds()};goog.date.DateTime.prototype.setHours=function(e){this.date.setHours(e)};goog.date.DateTime.prototype.setMinutes=function(e){this.date.setMinutes(e)};goog.date.DateTime.prototype.setSeconds=function(e){this.date.setSeconds(e)};goog.date.DateTime.prototype.setMilliseconds=function(e){this.date.setMilliseconds(e)};goog.date.DateTime.prototype.setUTCHours=function(e){this.date.setUTCHours(e)};goog.date.DateTime.prototype.setUTCMinutes=function(e){this.date.setUTCMinutes(e)};goog.date.DateTime.prototype.setUTCSeconds=function(e){this.date.setUTCSeconds(e)};goog.date.DateTime.prototype.setUTCMilliseconds=function(e){this.date.setUTCMilliseconds(e)};goog.date.DateTime.prototype.isMidnight=function(){return 0==this.getHours()&&0==this.getMinutes()&&0==this.getSeconds()&&0==this.getMilliseconds()};goog.date.DateTime.prototype.add=function(e){goog.date.Date.prototype.add.call(this,e);if(e.hours)this.setUTCHours(this.date.getUTCHours()+e.hours);if(e.minutes)this.setUTCMinutes(this.date.getUTCMinutes()+e.minutes);if(e.seconds)this.setUTCSeconds(this.date.getUTCSeconds()+e.seconds)};goog.date.DateTime.prototype.toIsoString=function(e,o){var t=goog.date.Date.prototype.toIsoString.call(this,e);if(e)return t+" "+goog.string.padNumber(this.getHours(),2)+":"+goog.string.padNumber(this.getMinutes(),2)+":"+goog.string.padNumber(this.getSeconds(),2)+(o?this.getTimezoneOffsetString():"");return t+"T"+goog.string.padNumber(this.getHours(),2)+goog.string.padNumber(this.getMinutes(),2)+goog.string.padNumber(this.getSeconds(),2)+(o?this.getTimezoneOffsetString():"")};goog.date.DateTime.prototype.toXmlDateTime=function(e){return goog.date.Date.prototype.toIsoString.call(this,true)+"T"+goog.string.padNumber(this.getHours(),2)+":"+goog.string.padNumber(this.getMinutes(),2)+":"+goog.string.padNumber(this.getSeconds(),2)+(e?this.getTimezoneOffsetString():"")};goog.date.DateTime.prototype.toUTCIsoString=function(e,o){var t=goog.date.Date.prototype.toUTCIsoString.call(this,e);if(e)return t+" "+goog.string.padNumber(this.getUTCHours(),2)+":"+goog.string.padNumber(this.getUTCMinutes(),2)+":"+goog.string.padNumber(this.getUTCSeconds(),2)+(o?"Z":"");return t+"T"+goog.string.padNumber(this.getUTCHours(),2)+goog.string.padNumber(this.getUTCMinutes(),2)+goog.string.padNumber(this.getUTCSeconds(),2)+(o?"Z":"")};goog.date.DateTime.prototype.toUTCRfc3339String=function(){var e=this.toUTCIsoString(true).replace(" ","T");var o=this.getUTCMilliseconds();return(o?e+"."+goog.string.padNumber(o,3):e)+"Z"};goog.date.DateTime.prototype.equals=function(e){return this.getTime()==e.getTime()};goog.date.DateTime.prototype.toString=function(){return this.toIsoString()};goog.date.DateTime.prototype.toUsTimeString=function(e,o,t){var i=this.getHours();if(!goog.isDef(o))o=true;var r=12==i;if(i>12){i-=12;r=true}if(0==i&&o)i=12;var n=e?goog.string.padNumber(i,2):String(i);var l=this.getMinutes();if(!t||l>0)n+=":"+goog.string.padNumber(l,2);if(o)n+=r?" PM":" AM";return n};goog.date.DateTime.prototype.toIsoTimeString=function(e){var o=this.getHours();var t=goog.string.padNumber(o,2)+":"+goog.string.padNumber(this.getMinutes(),2);if(!goog.isDef(e)||e)t+=":"+goog.string.padNumber(this.getSeconds(),2);return t};goog.date.DateTime.prototype.clone=function(){var e=new goog.date.DateTime(this.date);e.setFirstDayOfWeek(this.getFirstDayOfWeek());e.setFirstWeekCutOffDay(this.getFirstWeekCutOffDay());return e};goog.date.DateTime.fromIsoString=function(e){var o=new goog.date.DateTime(2e3);return goog.date.setIso8601DateTime(o,e)?o:null};goog.provide("goog.date.DateLike");goog.forwardDeclare("goog.date.Date");goog.date.DateLike;goog.provide("goog.date.DateRange");goog.provide("goog.date.DateRange.Iterator");goog.provide("goog.date.DateRange.StandardDateRangeKeys");goog.require("goog.date.Date");goog.require("goog.date.Interval");goog.require("goog.iter.Iterator");goog.require("goog.iter.StopIteration");goog.date.DateRange=function(e,o){this.startDate_=e;this.endDate_=o};goog.date.DateRange.MINIMUM_DATE=new goog.date.Date(0,0,1);goog.date.DateRange.MAXIMUM_DATE=new goog.date.Date(9999,11,31);goog.date.DateRange.prototype.getStartDate=function(){return this.startDate_};goog.date.DateRange.prototype.getEndDate=function(){return this.endDate_};goog.date.DateRange.prototype.contains=function(e){return e.valueOf()>=this.startDate_.valueOf()&&e.valueOf()<=this.endDate_.valueOf()};goog.date.DateRange.prototype.iterator=function(){return new goog.date.DateRange.Iterator(this)};goog.date.DateRange.equals=function(e,o){if(e===o)return true;if(null==e||null==o)return false;return e.startDate_.equals(o.startDate_)&&e.endDate_.equals(o.endDate_)};goog.date.DateRange.offsetInDays_=function(e,o){var t=e.clone();t.add(new goog.date.Interval(goog.date.Interval.DAYS,o));return t};goog.date.DateRange.offsetInMonths_=function(e,o){var t=e.clone();t.setDate(1);t.add(new goog.date.Interval(goog.date.Interval.MONTHS,o));return t};goog.date.DateRange.yesterday=function(e){var o=goog.date.DateRange.cloneOrCreate_(e);var t=goog.date.DateRange.offsetInDays_(o,-1);return new goog.date.DateRange(t,t.clone())};goog.date.DateRange.today=function(e){var o=goog.date.DateRange.cloneOrCreate_(e);return new goog.date.DateRange(o,o.clone())};goog.date.DateRange.last7Days=function(e){var o=goog.date.DateRange.cloneOrCreate_(e);var t=goog.date.DateRange.offsetInDays_(o,-1);return new goog.date.DateRange(goog.date.DateRange.offsetInDays_(o,-7),t)};goog.date.DateRange.thisMonth=function(e){var o=goog.date.DateRange.cloneOrCreate_(e);return new goog.date.DateRange(goog.date.DateRange.offsetInMonths_(o,0),goog.date.DateRange.offsetInDays_(goog.date.DateRange.offsetInMonths_(o,1),-1))};goog.date.DateRange.lastMonth=function(e){var o=goog.date.DateRange.cloneOrCreate_(e);return new goog.date.DateRange(goog.date.DateRange.offsetInMonths_(o,-1),goog.date.DateRange.offsetInDays_(goog.date.DateRange.offsetInMonths_(o,0),-1))};goog.date.DateRange.thisWeek=function(e){var o=goog.date.DateRange.cloneOrCreate_(e);var t=o.getIsoWeekday();var i=o.getFirstDayOfWeek();var r=t>=i?t-i:t+(7-i);var n=goog.date.DateRange.offsetInDays_(o,-r);var l=goog.date.DateRange.offsetInDays_(n,6);return new goog.date.DateRange(n,l)};goog.date.DateRange.lastWeek=function(e){var o=goog.date.DateRange.thisWeek(e);var t=goog.date.DateRange.offsetInDays_(o.getStartDate(),-7);var i=goog.date.DateRange.offsetInDays_(o.getEndDate(),-7);return new goog.date.DateRange(t,i)};goog.date.DateRange.lastBusinessWeek=function(e){var o=goog.date.DateRange.cloneOrCreate_(e);var t=goog.date.DateRange.offsetInDays_(o,-7-o.getIsoWeekday());var i=goog.date.DateRange.offsetInDays_(t,4);return new goog.date.DateRange(t,i)};goog.date.DateRange.allTime=function(e){return new goog.date.DateRange(goog.date.DateRange.MINIMUM_DATE,goog.date.DateRange.MAXIMUM_DATE)};goog.date.DateRange.StandardDateRangeKeys={YESTERDAY:"yesterday",TODAY:"today",LAST_7_DAYS:"last7days",THIS_MONTH:"thismonth",LAST_MONTH:"lastmonth",THIS_WEEK:"thisweek",LAST_WEEK:"lastweek",LAST_BUSINESS_WEEK:"lastbusinessweek",ALL_TIME:"alltime"};goog.date.DateRange.standardDateRange=function(e,o){switch(e){case goog.date.DateRange.StandardDateRangeKeys.YESTERDAY:return goog.date.DateRange.yesterday(o);case goog.date.DateRange.StandardDateRangeKeys.TODAY:return goog.date.DateRange.today(o);case goog.date.DateRange.StandardDateRangeKeys.LAST_7_DAYS:return goog.date.DateRange.last7Days(o);case goog.date.DateRange.StandardDateRangeKeys.THIS_MONTH:return goog.date.DateRange.thisMonth(o);case goog.date.DateRange.StandardDateRangeKeys.LAST_MONTH:return goog.date.DateRange.lastMonth(o);case goog.date.DateRange.StandardDateRangeKeys.THIS_WEEK:return goog.date.DateRange.thisWeek(o);case goog.date.DateRange.StandardDateRangeKeys.LAST_WEEK:return goog.date.DateRange.lastWeek(o);case goog.date.DateRange.StandardDateRangeKeys.LAST_BUSINESS_WEEK:return goog.date.DateRange.lastBusinessWeek(o);case goog.date.DateRange.StandardDateRangeKeys.ALL_TIME:return goog.date.DateRange.allTime(o);default:throw new Error("no such date range key: "+e)}};goog.date.DateRange.cloneOrCreate_=function(e){return e?e.clone():new goog.date.Date};goog.date.DateRange.Iterator=function(e){this.nextDate_=e.getStartDate().clone();this.endDate_=Number(e.getEndDate().toIsoString())};goog.inherits(goog.date.DateRange.Iterator,goog.iter.Iterator);goog.date.DateRange.Iterator.prototype.next=function(){if(Number(this.nextDate_.toIsoString())>this.endDate_)throw goog.iter.StopIteration;var e=this.nextDate_.clone();this.nextDate_.add(new goog.date.Interval(goog.date.Interval.DAYS,1));return e};goog.provide("goog.string.Const");goog.require("goog.asserts");goog.require("goog.string.TypedString");goog.string.Const=function(){this.stringConstValueWithSecurityContract__googStringSecurityPrivate_="";this.STRING_CONST_TYPE_MARKER__GOOG_STRING_SECURITY_PRIVATE_=goog.string.Const.TYPE_MARKER_};goog.string.Const.prototype.implementsGoogStringTypedString=true;goog.string.Const.prototype.getTypedStringValue=function(){return this.stringConstValueWithSecurityContract__googStringSecurityPrivate_};goog.string.Const.prototype.toString=function(){return"Const{"+this.stringConstValueWithSecurityContract__googStringSecurityPrivate_+"}"};goog.string.Const.unwrap=function(e){if(e instanceof goog.string.Const&&e.constructor===goog.string.Const&&e.STRING_CONST_TYPE_MARKER__GOOG_STRING_SECURITY_PRIVATE_===goog.string.Const.TYPE_MARKER_)return e.stringConstValueWithSecurityContract__googStringSecurityPrivate_;else{goog.asserts.fail("expected object of type Const, got '"+e+"'");return"type_error:Const"}};goog.string.Const.from=function(e){return goog.string.Const.create__googStringSecurityPrivate_(e)};goog.string.Const.TYPE_MARKER_={};goog.string.Const.create__googStringSecurityPrivate_=function(e){var o=new goog.string.Const;o.stringConstValueWithSecurityContract__googStringSecurityPrivate_=e;return o};goog.string.Const.EMPTY=goog.string.Const.from("");goog.provide("goog.string");goog.provide("goog.string.Unicode");goog.define("goog.string.DETECT_DOUBLE_ESCAPING",false);goog.define("goog.string.FORCE_NON_DOM_HTML_UNESCAPING",false);goog.string.Unicode={NBSP:" "};goog.string.startsWith=function(e,o){return 0==e.lastIndexOf(o,0)};goog.string.endsWith=function(e,o){var t=e.length-o.length;return t>=0&&e.indexOf(o,t)==t};goog.string.caseInsensitiveStartsWith=function(e,o){return 0==goog.string.caseInsensitiveCompare(o,e.substr(0,o.length))};goog.string.caseInsensitiveEndsWith=function(e,o){return 0==goog.string.caseInsensitiveCompare(o,e.substr(e.length-o.length,o.length))};goog.string.caseInsensitiveEquals=function(e,o){return e.toLowerCase()==o.toLowerCase()};goog.string.subs=function(e,o){var t=e.split("%s");var i="";var r=Array.prototype.slice.call(arguments,1);while(r.length&&t.length>1)i+=t.shift()+r.shift();return i+t.join("%s")};goog.string.collapseWhitespace=function(e){return e.replace(/[\s\xa0]+/g," ").replace(/^\s+|\s+$/g,"")};goog.string.isEmptyOrWhitespace=function(e){return/^[\s\xa0]*$/.test(e)};goog.string.isEmptyString=function(e){return 0==e.length};goog.string.isEmpty=goog.string.isEmptyOrWhitespace;goog.string.isEmptyOrWhitespaceSafe=function(e){return goog.string.isEmptyOrWhitespace(goog.string.makeSafe(e))};goog.string.isEmptySafe=goog.string.isEmptyOrWhitespaceSafe;goog.string.isBreakingWhitespace=function(e){return!/[^\t\n\r ]/.test(e)};goog.string.isAlpha=function(e){return!/[^a-zA-Z]/.test(e)};goog.string.isNumeric=function(e){return!/[^0-9]/.test(e)};goog.string.isAlphaNumeric=function(e){return!/[^a-zA-Z0-9]/.test(e)};goog.string.isSpace=function(e){return" "==e};goog.string.isUnicodeChar=function(e){return 1==e.length&&e>=" "&&e<="~"||e>=""&&e<="�"};goog.string.stripNewlines=function(e){return e.replace(/(\r\n|\r|\n)+/g," ")};goog.string.canonicalizeNewlines=function(e){return e.replace(/(\r\n|\r|\n)/g,"\n")};goog.string.normalizeWhitespace=function(e){return e.replace(/\xa0|\s/g," ")};goog.string.normalizeSpaces=function(e){return e.replace(/\xa0|[ \t]+/g," ")};goog.string.collapseBreakingSpaces=function(e){return e.replace(/[\t\r\n ]+/g," ").replace(/^[\t\r\n ]+|[\t\r\n ]+$/g,"")};goog.string.trim=goog.TRUSTED_SITE&&String.prototype.trim?function(e){return e.trim()}:function(e){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(e)[1]};goog.string.trimLeft=function(e){return e.replace(/^[\s\xa0]+/,"")};goog.string.trimRight=function(e){return e.replace(/[\s\xa0]+$/,"")};goog.string.caseInsensitiveCompare=function(e,o){var t=String(e).toLowerCase();var i=String(o).toLowerCase();if(t<i)return-1;else if(t==i)return 0;else return 1};goog.string.numberAwareCompare_=function(e,o,t){if(e==o)return 0;if(!e)return-1;if(!o)return 1;var i=e.toLowerCase().match(t);var r=o.toLowerCase().match(t);var n=Math.min(i.length,r.length);for(var l=0;l<n;l++){var s=i[l];var g=r[l];if(s!=g){var a=parseInt(s,10);if(!isNaN(a)){var c=parseInt(g,10);if(!isNaN(c)&&a-c)return a-c}return s<g?-1:1}}if(i.length!=r.length)return i.length-r.length;return e<o?-1:1};goog.string.intAwareCompare=function(e,o){return goog.string.numberAwareCompare_(e,o,/\d+|\D+/g)};goog.string.floatAwareCompare=function(e,o){return goog.string.numberAwareCompare_(e,o,/\d+|\.\d+|\D+/g)};goog.string.numerateCompare=goog.string.floatAwareCompare;goog.string.urlEncode=function(e){return encodeURIComponent(String(e))};goog.string.urlDecode=function(e){return decodeURIComponent(e.replace(/\+/g," "))};goog.string.newLineToBr=function(e,o){return e.replace(/(\r\n|\r|\n)/g,o?"<br />":"<br>")};goog.string.htmlEscape=function(e,o){if(o){e=e.replace(goog.string.AMP_RE_,"&amp;").replace(goog.string.LT_RE_,"&lt;").replace(goog.string.GT_RE_,"&gt;").replace(goog.string.QUOT_RE_,"&quot;").replace(goog.string.SINGLE_QUOTE_RE_,"&#39;").replace(goog.string.NULL_RE_,"&#0;");if(goog.string.DETECT_DOUBLE_ESCAPING)e=e.replace(goog.string.E_RE_,"&#101;");return e}else{if(!goog.string.ALL_RE_.test(e))return e;if(-1!=e.indexOf("&"))e=e.replace(goog.string.AMP_RE_,"&amp;");if(-1!=e.indexOf("<"))e=e.replace(goog.string.LT_RE_,"&lt;");if(-1!=e.indexOf(">"))e=e.replace(goog.string.GT_RE_,"&gt;");if(-1!=e.indexOf('"'))e=e.replace(goog.string.QUOT_RE_,"&quot;");if(-1!=e.indexOf("'"))e=e.replace(goog.string.SINGLE_QUOTE_RE_,"&#39;");if(-1!=e.indexOf("\0"))e=e.replace(goog.string.NULL_RE_,"&#0;");if(goog.string.DETECT_DOUBLE_ESCAPING&&-1!=e.indexOf("e"))e=e.replace(goog.string.E_RE_,"&#101;");return e}};goog.string.AMP_RE_=/&/g;goog.string.LT_RE_=/</g;goog.string.GT_RE_=/>/g;goog.string.QUOT_RE_=/"/g;goog.string.SINGLE_QUOTE_RE_=/'/g;goog.string.NULL_RE_=/\x00/g;goog.string.E_RE_=/e/g;goog.string.ALL_RE_=goog.string.DETECT_DOUBLE_ESCAPING?/[\x00&<>"'e]/:/[\x00&<>"']/;goog.string.unescapeEntities=function(e){if(goog.string.contains(e,"&"))if(!goog.string.FORCE_NON_DOM_HTML_UNESCAPING&&"document"in goog.global)return goog.string.unescapeEntitiesUsingDom_(e);else return goog.string.unescapePureXmlEntities_(e);return e};goog.string.unescapeEntitiesWithDocument=function(e,o){if(goog.string.contains(e,"&"))return goog.string.unescapeEntitiesUsingDom_(e,o);return e};goog.string.unescapeEntitiesUsingDom_=function(e,o){var t={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"'};var i;if(o)i=o.createElement("div");else i=goog.global.document.createElement("div");return e.replace(goog.string.HTML_ENTITY_PATTERN_,(function(e,o){var r=t[e];if(r)return r;if("#"==o.charAt(0)){var n=Number("0"+o.substr(1));if(!isNaN(n))r=String.fromCharCode(n)}if(!r){i.innerHTML=e+" ";r=i.firstChild.nodeValue.slice(0,-1)}return t[e]=r}))};goog.string.unescapePureXmlEntities_=function(e){return e.replace(/&([^;]+);/g,(function(e,o){switch(o){case"amp":return"&";case"lt":return"<";case"gt":return">";case"quot":return'"';default:if("#"==o.charAt(0)){var t=Number("0"+o.substr(1));if(!isNaN(t))return String.fromCharCode(t)}return e}}))};goog.string.HTML_ENTITY_PATTERN_=/&([^;\s<&]+);?/g;goog.string.whitespaceEscape=function(e,o){return goog.string.newLineToBr(e.replace(/  /g," &#160;"),o)};goog.string.preserveSpaces=function(e){return e.replace(/(^|[\n ]) /g,"$1"+goog.string.Unicode.NBSP)};goog.string.stripQuotes=function(e,o){var t=o.length;for(var i=0;i<t;i++){var r=1==t?o:o.charAt(i);if(e.charAt(0)==r&&e.charAt(e.length-1)==r)return e.substring(1,e.length-1)}return e};goog.string.truncate=function(e,o,t){if(t)e=goog.string.unescapeEntities(e);if(e.length>o)e=e.substring(0,o-3)+"...";if(t)e=goog.string.htmlEscape(e);return e};goog.string.truncateMiddle=function(e,o,t,i){if(t)e=goog.string.unescapeEntities(e);if(i&&e.length>o){if(i>o)i=o;var r=e.length-i;var n=o-i;e=e.substring(0,n)+"..."+e.substring(r)}else if(e.length>o){var l=Math.floor(o/2);var s=e.length-l;l+=o%2;e=e.substring(0,l)+"..."+e.substring(s)}if(t)e=goog.string.htmlEscape(e);return e};goog.string.specialEscapeChars_={"\0":"\\0","\b":"\\b","\f":"\\f","\n":"\\n","\r":"\\r","\t":"\\t","\v":"\\x0B",'"':'\\"',"\\":"\\\\","<":"<"};goog.string.jsEscapeCache_={"'":"\\'"};goog.string.quote=function(e){e=String(e);var o=['"'];for(var t=0;t<e.length;t++){var i=e.charAt(t);var r=i.charCodeAt(0);o[t+1]=goog.string.specialEscapeChars_[i]||(r>31&&r<127?i:goog.string.escapeChar(i))}o.push('"');return o.join("")};goog.string.escapeString=function(e){var o=[];for(var t=0;t<e.length;t++)o[t]=goog.string.escapeChar(e.charAt(t));return o.join("")};goog.string.escapeChar=function(e){if(e in goog.string.jsEscapeCache_)return goog.string.jsEscapeCache_[e];if(e in goog.string.specialEscapeChars_)return goog.string.jsEscapeCache_[e]=goog.string.specialEscapeChars_[e];var o=e;var t=e.charCodeAt(0);if(t>31&&t<127)o=e;else{if(t<256){o="\\x";if(t<16||t>256)o+="0"}else{o="\\u";if(t<4096)o+="0"}o+=t.toString(16).toUpperCase()}return goog.string.jsEscapeCache_[e]=o};goog.string.contains=function(e,o){return-1!=e.indexOf(o)};goog.string.caseInsensitiveContains=function(e,o){return goog.string.contains(e.toLowerCase(),o.toLowerCase())};goog.string.countOf=function(e,o){return e&&o?e.split(o).length-1:0};goog.string.removeAt=function(e,o,t){var i=e;if(o>=0&&o<e.length&&t>0)i=e.substr(0,o)+e.substr(o+t,e.length-o-t);return i};goog.string.remove=function(e,o){return e.replace(o,"")};goog.string.removeAll=function(e,o){var t=new RegExp(goog.string.regExpEscape(o),"g");return e.replace(t,"")};goog.string.replaceAll=function(e,o,t){var i=new RegExp(goog.string.regExpEscape(o),"g");return e.replace(i,t.replace(/\$/g,"$$$$"))};goog.string.regExpEscape=function(e){return String(e).replace(/([-()\[\]{}+?*.$\^|,:#<!\\])/g,"\\$1").replace(/\x08/g,"\\x08")};goog.string.repeat=String.prototype.repeat?function(e,o){return e.repeat(o)}:function(e,o){return new Array(o+1).join(e)};goog.string.padNumber=function(e,o,t){var i=goog.isDef(t)?e.toFixed(t):String(e);var r=i.indexOf(".");if(-1==r)r=i.length;return goog.string.repeat("0",Math.max(0,o-r))+i};goog.string.makeSafe=function(e){return null==e?"":String(e)};goog.string.buildString=function(e){return Array.prototype.join.call(arguments,"")};goog.string.getRandomString=function(){var e=2147483648;return Math.floor(Math.random()*e).toString(36)+Math.abs(Math.floor(Math.random()*e)^goog.now()).toString(36)};goog.string.compareVersions=function(e,o){var t=0;var i=goog.string.trim(String(e)).split(".");var r=goog.string.trim(String(o)).split(".");var n=Math.max(i.length,r.length);for(var l=0;0==t&&l<n;l++){var s=i[l]||"";var g=r[l]||"";do{var a=/(\d*)(\D*)(.*)/.exec(s)||["","","",""];var c=/(\d*)(\D*)(.*)/.exec(g)||["","","",""];if(0==a[0].length&&0==c[0].length)break;var u=0==a[1].length?0:parseInt(a[1],10);var h=0==c[1].length?0:parseInt(c[1],10);t=goog.string.compareElements_(u,h)||goog.string.compareElements_(0==a[2].length,0==c[2].length)||goog.string.compareElements_(a[2],c[2]);s=a[3];g=c[3]}while(0==t)}return t};goog.string.compareElements_=function(e,o){if(e<o)return-1;else if(e>o)return 1;return 0};goog.string.hashCode=function(e){var o=0;for(var t=0;t<e.length;++t)o=31*o+e.charCodeAt(t)>>>0;return o};goog.string.uniqueStringCounter_=2147483648*Math.random()|0;goog.string.createUniqueString=function(){return"goog_"+goog.string.uniqueStringCounter_++};goog.string.toNumber=function(e){var o=Number(e);if(0==o&&goog.string.isEmptyOrWhitespace(e))return NaN;return o};goog.string.isLowerCamelCase=function(e){return/^[a-z]+([A-Z][a-z]*)*$/.test(e)};goog.string.isUpperCamelCase=function(e){return/^([A-Z][a-z]*)+$/.test(e)};goog.string.toCamelCase=function(e){return String(e).replace(/\-([a-z])/g,(function(e,o){return o.toUpperCase()}))};goog.string.toSelectorCase=function(e){return String(e).replace(/([A-Z])/g,"-$1").toLowerCase()};goog.string.toTitleCase=function(e,o){var t=goog.isString(o)?goog.string.regExpEscape(o):"\\s";t=t?"|["+t+"]+":"";var i=new RegExp("(^"+t+")([a-z])","g");return e.replace(i,(function(e,o,t){return o+t.toUpperCase()}))};goog.string.capitalize=function(e){return String(e.charAt(0)).toUpperCase()+String(e.substr(1)).toLowerCase()};goog.string.parseInt=function(e){if(isFinite(e))e=String(e);if(goog.isString(e))return/^\s*-?0x/i.test(e)?parseInt(e,16):parseInt(e,10);return NaN};goog.string.splitLimit=function(e,o,t){var i=e.split(o);var r=[];while(t>0&&i.length){r.push(i.shift());t--}if(i.length)r.push(i.join(o));return r};goog.string.lastComponent=function(e,o){if(!o)return e;else if("string"==typeof o)o=[o];var t=-1;for(var i=0;i<o.length;i++){if(""==o[i])continue;var r=e.lastIndexOf(o[i]);if(r>t)t=r}if(-1==t)return e;return e.slice(t+1)};goog.string.editDistance=function(e,o){var t=[];var i=[];if(e==o)return 0;if(!e.length||!o.length)return Math.max(e.length,o.length);for(var r=0;r<o.length+1;r++)t[r]=r;for(var r=0;r<e.length;r++){i[0]=r+1;for(var n=0;n<o.length;n++){var l=Number(e[r]!=o[n]);i[n+1]=Math.min(i[n]+1,t[n+1]+1,t[n]+l)}for(var n=0;n<t.length;n++)t[n]=i[n]}return i[o.length]};goog.provide("goog.string.StringBuffer");goog.string.StringBuffer=function(e,o){if(null!=e)this.append.apply(this,arguments)};goog.string.StringBuffer.prototype.buffer_="";goog.string.StringBuffer.prototype.set=function(e){this.buffer_=""+e};goog.string.StringBuffer.prototype.append=function(e,o,t){this.buffer_+=String(e);if(null!=o)for(var i=1;i<arguments.length;i++)this.buffer_+=arguments[i];return this};goog.string.StringBuffer.prototype.clear=function(){this.buffer_=""};goog.string.StringBuffer.prototype.getLength=function(){return this.buffer_.length};goog.string.StringBuffer.prototype.toString=function(){return this.buffer_};goog.provide("goog.string.TypedString");goog.string.TypedString=function(){};goog.string.TypedString.prototype.implementsGoogStringTypedString;goog.string.TypedString.prototype.getTypedStringValue;goog.provide("goog.reflect");goog.reflect.object=function(e,o){return o};goog.reflect.objectProperty=function(e,o){return e};goog.reflect.sinkValue=function(e){goog.reflect.sinkValue[" "](e);return e};goog.reflect.sinkValue[" "]=goog.nullFunction;goog.reflect.canAccessProperty=function(e,o){try{goog.reflect.sinkValue(e[o]);return true}catch(e){}return false};goog.reflect.cache=function(e,o,t,i){var r=i?i(o):o;if(Object.prototype.hasOwnProperty.call(e,r))return e[r];return e[r]=t(o)};goog.provide("goog.labs.userAgent.browser");goog.require("goog.array");goog.require("goog.labs.userAgent.util");goog.require("goog.object");goog.require("goog.string");goog.labs.userAgent.browser.matchOpera_=function(){return goog.labs.userAgent.util.matchUserAgent("Opera")};goog.labs.userAgent.browser.matchIE_=function(){return goog.labs.userAgent.util.matchUserAgent("Trident")||goog.labs.userAgent.util.matchUserAgent("MSIE")};goog.labs.userAgent.browser.matchEdge_=function(){return goog.labs.userAgent.util.matchUserAgent("Edge")};goog.labs.userAgent.browser.matchFirefox_=function(){return goog.labs.userAgent.util.matchUserAgent("Firefox")};goog.labs.userAgent.browser.matchSafari_=function(){return goog.labs.userAgent.util.matchUserAgent("Safari")&&!(goog.labs.userAgent.browser.matchChrome_()||goog.labs.userAgent.browser.matchCoast_()||goog.labs.userAgent.browser.matchOpera_()||goog.labs.userAgent.browser.matchEdge_()||goog.labs.userAgent.browser.isSilk()||goog.labs.userAgent.util.matchUserAgent("Android"))};goog.labs.userAgent.browser.matchCoast_=function(){return goog.labs.userAgent.util.matchUserAgent("Coast")};goog.labs.userAgent.browser.matchIosWebview_=function(){return(goog.labs.userAgent.util.matchUserAgent("iPad")||goog.labs.userAgent.util.matchUserAgent("iPhone"))&&!goog.labs.userAgent.browser.matchSafari_()&&!goog.labs.userAgent.browser.matchChrome_()&&!goog.labs.userAgent.browser.matchCoast_()&&goog.labs.userAgent.util.matchUserAgent("AppleWebKit")};goog.labs.userAgent.browser.matchChrome_=function(){return(goog.labs.userAgent.util.matchUserAgent("Chrome")||goog.labs.userAgent.util.matchUserAgent("CriOS"))&&!goog.labs.userAgent.browser.matchEdge_()};goog.labs.userAgent.browser.matchAndroidBrowser_=function(){return goog.labs.userAgent.util.matchUserAgent("Android")&&!(goog.labs.userAgent.browser.isChrome()||goog.labs.userAgent.browser.isFirefox()||goog.labs.userAgent.browser.isOpera()||goog.labs.userAgent.browser.isSilk())};goog.labs.userAgent.browser.isOpera=goog.labs.userAgent.browser.matchOpera_;goog.labs.userAgent.browser.isIE=goog.labs.userAgent.browser.matchIE_;goog.labs.userAgent.browser.isEdge=goog.labs.userAgent.browser.matchEdge_;goog.labs.userAgent.browser.isFirefox=goog.labs.userAgent.browser.matchFirefox_;goog.labs.userAgent.browser.isSafari=goog.labs.userAgent.browser.matchSafari_;goog.labs.userAgent.browser.isCoast=goog.labs.userAgent.browser.matchCoast_;goog.labs.userAgent.browser.isIosWebview=goog.labs.userAgent.browser.matchIosWebview_;goog.labs.userAgent.browser.isChrome=goog.labs.userAgent.browser.matchChrome_;goog.labs.userAgent.browser.isAndroidBrowser=goog.labs.userAgent.browser.matchAndroidBrowser_;goog.labs.userAgent.browser.isSilk=function(){return goog.labs.userAgent.util.matchUserAgent("Silk")};goog.labs.userAgent.browser.getVersion=function(){var e=goog.labs.userAgent.util.getUserAgent();if(goog.labs.userAgent.browser.isIE())return goog.labs.userAgent.browser.getIEVersion_(e);var o=goog.labs.userAgent.util.extractVersionTuples(e);var t={};goog.array.forEach(o,(function(e){var o=e[0];var i=e[1];t[o]=i}));var i=goog.partial(goog.object.containsKey,t);function r(e){var o=goog.array.find(e,i);return t[o]||""}if(goog.labs.userAgent.browser.isOpera())return r(["Version","Opera"]);if(goog.labs.userAgent.browser.isEdge())return r(["Edge"]);if(goog.labs.userAgent.browser.isChrome())return r(["Chrome","CriOS"]);var n=o[2];return n&&n[1]||""};goog.labs.userAgent.browser.isVersionOrHigher=function(e){return goog.string.compareVersions(goog.labs.userAgent.browser.getVersion(),e)>=0};goog.labs.userAgent.browser.getIEVersion_=function(e){var o=/rv: *([\d\.]*)/.exec(e);if(o&&o[1])return o[1];var t="";var i=/MSIE +([\d\.]+)/.exec(e);if(i&&i[1]){var r=/Trident\/(\d.\d)/.exec(e);if("7.0"==i[1])if(r&&r[1])switch(r[1]){case"4.0":t="8.0";break;case"5.0":t="9.0";break;case"6.0":t="10.0";break;case"7.0":t="11.0";break}else t="7.0";else t=i[1]}return t};goog.provide("goog.labs.userAgent.engine");goog.require("goog.array");goog.require("goog.labs.userAgent.util");goog.require("goog.string");goog.labs.userAgent.engine.isPresto=function(){return goog.labs.userAgent.util.matchUserAgent("Presto")};goog.labs.userAgent.engine.isTrident=function(){return goog.labs.userAgent.util.matchUserAgent("Trident")||goog.labs.userAgent.util.matchUserAgent("MSIE")};goog.labs.userAgent.engine.isEdge=function(){return goog.labs.userAgent.util.matchUserAgent("Edge")};goog.labs.userAgent.engine.isWebKit=function(){return goog.labs.userAgent.util.matchUserAgentIgnoreCase("WebKit")&&!goog.labs.userAgent.engine.isEdge()};goog.labs.userAgent.engine.isGecko=function(){return goog.labs.userAgent.util.matchUserAgent("Gecko")&&!goog.labs.userAgent.engine.isWebKit()&&!goog.labs.userAgent.engine.isTrident()&&!goog.labs.userAgent.engine.isEdge()};goog.labs.userAgent.engine.getVersion=function(){var e=goog.labs.userAgent.util.getUserAgent();if(e){var o=goog.labs.userAgent.util.extractVersionTuples(e);var t=goog.labs.userAgent.engine.getEngineTuple_(o);if(t){if("Gecko"==t[0])return goog.labs.userAgent.engine.getVersionForKey_(o,"Firefox");return t[1]}var i=o[0];var r;if(i&&(r=i[2])){var n=/Trident\/([^\s;]+)/.exec(r);if(n)return n[1]}}return""};goog.labs.userAgent.engine.getEngineTuple_=function(e){if(!goog.labs.userAgent.engine.isEdge())return e[1];for(var o=0;o<e.length;o++){var t=e[o];if("Edge"==t[0])return t}};goog.labs.userAgent.engine.isVersionOrHigher=function(e){return goog.string.compareVersions(goog.labs.userAgent.engine.getVersion(),e)>=0};goog.labs.userAgent.engine.getVersionForKey_=function(e,o){var t=goog.array.find(e,(function(e){return o==e[0]}));return t&&t[1]||""};goog.provide("goog.labs.userAgent.platform");goog.require("goog.labs.userAgent.util");goog.require("goog.string");goog.labs.userAgent.platform.isAndroid=function(){return goog.labs.userAgent.util.matchUserAgent("Android")};goog.labs.userAgent.platform.isIpod=function(){return goog.labs.userAgent.util.matchUserAgent("iPod")};goog.labs.userAgent.platform.isIphone=function(){return goog.labs.userAgent.util.matchUserAgent("iPhone")&&!goog.labs.userAgent.util.matchUserAgent("iPod")&&!goog.labs.userAgent.util.matchUserAgent("iPad")};goog.labs.userAgent.platform.isIpad=function(){return goog.labs.userAgent.util.matchUserAgent("iPad")};goog.labs.userAgent.platform.isIos=function(){return goog.labs.userAgent.platform.isIphone()||goog.labs.userAgent.platform.isIpad()||goog.labs.userAgent.platform.isIpod()};goog.labs.userAgent.platform.isMacintosh=function(){return goog.labs.userAgent.util.matchUserAgent("Macintosh")};goog.labs.userAgent.platform.isLinux=function(){return goog.labs.userAgent.util.matchUserAgent("Linux")};goog.labs.userAgent.platform.isWindows=function(){return goog.labs.userAgent.util.matchUserAgent("Windows")};goog.labs.userAgent.platform.isChromeOS=function(){return goog.labs.userAgent.util.matchUserAgent("CrOS")};goog.labs.userAgent.platform.isChromecast=function(){return goog.labs.userAgent.util.matchUserAgent("CrKey")};goog.labs.userAgent.platform.getVersion=function(){var e=goog.labs.userAgent.util.getUserAgent();var o="",t;if(goog.labs.userAgent.platform.isWindows()){t=/Windows (?:NT|Phone) ([0-9.]+)/;var i=t.exec(e);if(i)o=i[1];else o="0.0"}else if(goog.labs.userAgent.platform.isIos()){t=/(?:iPhone|iPod|iPad|CPU)\s+OS\s+(\S+)/;var i=t.exec(e);o=i&&i[1].replace(/_/g,".")}else if(goog.labs.userAgent.platform.isMacintosh()){t=/Mac OS X ([0-9_.]+)/;var i=t.exec(e);o=i?i[1].replace(/_/g,"."):"10"}else if(goog.labs.userAgent.platform.isAndroid()){t=/Android\s+([^\);]+)(\)|;)/;var i=t.exec(e);o=i&&i[1]}else if(goog.labs.userAgent.platform.isChromeOS()){t=/(?:CrOS\s+(?:i686|x86_64)\s+([0-9.]+))/;var i=t.exec(e);o=i&&i[1]}return o||""};goog.labs.userAgent.platform.isVersionOrHigher=function(e){return goog.string.compareVersions(goog.labs.userAgent.platform.getVersion(),e)>=0};goog.provide("goog.labs.userAgent.util");goog.require("goog.string");goog.labs.userAgent.util.getNativeUserAgentString_=function(){var e=goog.labs.userAgent.util.getNavigator_();if(e){var o=e.userAgent;if(o)return o}return""};goog.labs.userAgent.util.getNavigator_=function(){return goog.global.navigator};goog.labs.userAgent.util.userAgent_=goog.labs.userAgent.util.getNativeUserAgentString_();goog.labs.userAgent.util.setUserAgent=function(e){goog.labs.userAgent.util.userAgent_=e||goog.labs.userAgent.util.getNativeUserAgentString_()};goog.labs.userAgent.util.getUserAgent=function(){return goog.labs.userAgent.util.userAgent_};goog.labs.userAgent.util.matchUserAgent=function(e){var o=goog.labs.userAgent.util.getUserAgent();return goog.string.contains(o,e)};goog.labs.userAgent.util.matchUserAgentIgnoreCase=function(e){var o=goog.labs.userAgent.util.getUserAgent();return goog.string.caseInsensitiveContains(o,e)};goog.labs.userAgent.util.extractVersionTuples=function(e){var o=new RegExp("(\\w[\\w ]+)"+"/"+"([^\\s]+)"+"\\s*"+"(?:\\((.*?)\\))?","g");var t=[];var i;while(i=o.exec(e))t.push([i[1],i[2],i[3]||void 0]);return t};goog.provide("goog.userAgent");goog.require("goog.labs.userAgent.browser");goog.require("goog.labs.userAgent.engine");goog.require("goog.labs.userAgent.platform");goog.require("goog.labs.userAgent.util");goog.require("goog.reflect");goog.require("goog.string");goog.define("goog.userAgent.ASSUME_IE",false);goog.define("goog.userAgent.ASSUME_EDGE",false);goog.define("goog.userAgent.ASSUME_GECKO",false);goog.define("goog.userAgent.ASSUME_WEBKIT",false);goog.define("goog.userAgent.ASSUME_MOBILE_WEBKIT",false);goog.define("goog.userAgent.ASSUME_OPERA",false);goog.define("goog.userAgent.ASSUME_ANY_VERSION",false);goog.userAgent.BROWSER_KNOWN_=goog.userAgent.ASSUME_IE||goog.userAgent.ASSUME_EDGE||goog.userAgent.ASSUME_GECKO||goog.userAgent.ASSUME_MOBILE_WEBKIT||goog.userAgent.ASSUME_WEBKIT||goog.userAgent.ASSUME_OPERA;goog.userAgent.getUserAgentString=function(){return goog.labs.userAgent.util.getUserAgent()};goog.userAgent.getNavigatorTyped=function(){return goog.global["navigator"]||null};goog.userAgent.getNavigator=function(){return goog.userAgent.getNavigatorTyped()};goog.userAgent.OPERA=goog.userAgent.BROWSER_KNOWN_?goog.userAgent.ASSUME_OPERA:goog.labs.userAgent.browser.isOpera();goog.userAgent.IE=goog.userAgent.BROWSER_KNOWN_?goog.userAgent.ASSUME_IE:goog.labs.userAgent.browser.isIE();goog.userAgent.EDGE=goog.userAgent.BROWSER_KNOWN_?goog.userAgent.ASSUME_EDGE:goog.labs.userAgent.engine.isEdge();goog.userAgent.EDGE_OR_IE=goog.userAgent.EDGE||goog.userAgent.IE;goog.userAgent.GECKO=goog.userAgent.BROWSER_KNOWN_?goog.userAgent.ASSUME_GECKO:goog.labs.userAgent.engine.isGecko();goog.userAgent.WEBKIT=goog.userAgent.BROWSER_KNOWN_?goog.userAgent.ASSUME_WEBKIT||goog.userAgent.ASSUME_MOBILE_WEBKIT:goog.labs.userAgent.engine.isWebKit();goog.userAgent.isMobile_=function(){return goog.userAgent.WEBKIT&&goog.labs.userAgent.util.matchUserAgent("Mobile")};goog.userAgent.MOBILE=goog.userAgent.ASSUME_MOBILE_WEBKIT||goog.userAgent.isMobile_();goog.userAgent.SAFARI=goog.userAgent.WEBKIT;goog.userAgent.determinePlatform_=function(){var e=goog.userAgent.getNavigatorTyped();return e&&e.platform||""};goog.userAgent.PLATFORM=goog.userAgent.determinePlatform_();goog.define("goog.userAgent.ASSUME_MAC",false);goog.define("goog.userAgent.ASSUME_WINDOWS",false);goog.define("goog.userAgent.ASSUME_LINUX",false);goog.define("goog.userAgent.ASSUME_X11",false);goog.define("goog.userAgent.ASSUME_ANDROID",false);goog.define("goog.userAgent.ASSUME_IPHONE",false);goog.define("goog.userAgent.ASSUME_IPAD",false);goog.define("goog.userAgent.ASSUME_IPOD",false);goog.userAgent.PLATFORM_KNOWN_=goog.userAgent.ASSUME_MAC||goog.userAgent.ASSUME_WINDOWS||goog.userAgent.ASSUME_LINUX||goog.userAgent.ASSUME_X11||goog.userAgent.ASSUME_ANDROID||goog.userAgent.ASSUME_IPHONE||goog.userAgent.ASSUME_IPAD||goog.userAgent.ASSUME_IPOD;goog.userAgent.MAC=goog.userAgent.PLATFORM_KNOWN_?goog.userAgent.ASSUME_MAC:goog.labs.userAgent.platform.isMacintosh();goog.userAgent.WINDOWS=goog.userAgent.PLATFORM_KNOWN_?goog.userAgent.ASSUME_WINDOWS:goog.labs.userAgent.platform.isWindows();goog.userAgent.isLegacyLinux_=function(){return goog.labs.userAgent.platform.isLinux()||goog.labs.userAgent.platform.isChromeOS()};goog.userAgent.LINUX=goog.userAgent.PLATFORM_KNOWN_?goog.userAgent.ASSUME_LINUX:goog.userAgent.isLegacyLinux_();goog.userAgent.isX11_=function(){var e=goog.userAgent.getNavigatorTyped();return!!e&&goog.string.contains(e["appVersion"]||"","X11")};goog.userAgent.X11=goog.userAgent.PLATFORM_KNOWN_?goog.userAgent.ASSUME_X11:goog.userAgent.isX11_();goog.userAgent.ANDROID=goog.userAgent.PLATFORM_KNOWN_?goog.userAgent.ASSUME_ANDROID:goog.labs.userAgent.platform.isAndroid();goog.userAgent.IPHONE=goog.userAgent.PLATFORM_KNOWN_?goog.userAgent.ASSUME_IPHONE:goog.labs.userAgent.platform.isIphone();goog.userAgent.IPAD=goog.userAgent.PLATFORM_KNOWN_?goog.userAgent.ASSUME_IPAD:goog.labs.userAgent.platform.isIpad();goog.userAgent.IPOD=goog.userAgent.PLATFORM_KNOWN_?goog.userAgent.ASSUME_IPOD:goog.labs.userAgent.platform.isIpod();goog.userAgent.IOS=goog.userAgent.PLATFORM_KNOWN_?goog.userAgent.ASSUME_IPHONE||goog.userAgent.ASSUME_IPAD||goog.userAgent.ASSUME_IPOD:goog.labs.userAgent.platform.isIos();goog.userAgent.determineVersion_=function(){var e="";var o=goog.userAgent.getVersionRegexResult_();if(o)e=o?o[1]:"";if(goog.userAgent.IE){var t=goog.userAgent.getDocumentMode_();if(null!=t&&t>parseFloat(e))return String(t)}return e};goog.userAgent.getVersionRegexResult_=function(){var e=goog.userAgent.getUserAgentString();if(goog.userAgent.GECKO)return/rv\:([^\);]+)(\)|;)/.exec(e);if(goog.userAgent.EDGE)return/Edge\/([\d\.]+)/.exec(e);if(goog.userAgent.IE)return/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(e);if(goog.userAgent.WEBKIT)return/WebKit\/(\S+)/.exec(e);if(goog.userAgent.OPERA)return/(?:Version)[ \/]?(\S+)/.exec(e);return};goog.userAgent.getDocumentMode_=function(){var e=goog.global["document"];return e?e["documentMode"]:void 0};goog.userAgent.VERSION=goog.userAgent.determineVersion_();goog.userAgent.compare=function(e,o){return goog.string.compareVersions(e,o)};goog.userAgent.isVersionOrHigherCache_={};goog.userAgent.isVersionOrHigher=function(e){return goog.userAgent.ASSUME_ANY_VERSION||goog.reflect.cache(goog.userAgent.isVersionOrHigherCache_,e,(function(){return goog.string.compareVersions(goog.userAgent.VERSION,e)>=0}))};goog.userAgent.isVersion=goog.userAgent.isVersionOrHigher;goog.userAgent.isDocumentModeOrHigher=function(e){return Number(goog.userAgent.DOCUMENT_MODE)>=e};goog.userAgent.isDocumentMode=goog.userAgent.isDocumentModeOrHigher;goog.userAgent.DOCUMENT_MODE=function(){var e=goog.global["document"];var o=goog.userAgent.getDocumentMode_();if(!e||!goog.userAgent.IE)return;return o||("CSS1Compat"==e["compatMode"]?parseInt(goog.userAgent.VERSION,10):5)}();goog.provide("goog.userAgent.platform");goog.require("goog.string");goog.require("goog.userAgent");goog.userAgent.platform.determineVersion_=function(){var e;if(goog.userAgent.WINDOWS){e=/Windows NT ([0-9.]+)/;var o=e.exec(goog.userAgent.getUserAgentString());if(o)return o[1];else return"0"}else if(goog.userAgent.MAC){e=/10[_.][0-9_.]+/;var o=e.exec(goog.userAgent.getUserAgentString());return o?o[0].replace(/_/g,"."):"10"}else if(goog.userAgent.ANDROID){e=/Android\s+([^\);]+)(\)|;)/;var o=e.exec(goog.userAgent.getUserAgentString());return o?o[1]:""}else if(goog.userAgent.IPHONE||goog.userAgent.IPAD||goog.userAgent.IPOD){e=/(?:iPhone|CPU)\s+OS\s+(\S+)/;var o=e.exec(goog.userAgent.getUserAgentString());return o?o[1].replace(/_/g,"."):""}return""};goog.userAgent.platform.VERSION=goog.userAgent.platform.determineVersion_();goog.userAgent.platform.isVersion=function(e){return goog.string.compareVersions(goog.userAgent.platform.VERSION,e)>=0};goog.provide("goog.userAgent.product");goog.require("goog.labs.userAgent.browser");goog.require("goog.labs.userAgent.platform");goog.require("goog.userAgent");goog.define("goog.userAgent.product.ASSUME_FIREFOX",false);goog.define("goog.userAgent.product.ASSUME_IPHONE",false);goog.define("goog.userAgent.product.ASSUME_IPAD",false);goog.define("goog.userAgent.product.ASSUME_ANDROID",false);goog.define("goog.userAgent.product.ASSUME_CHROME",false);goog.define("goog.userAgent.product.ASSUME_SAFARI",false);goog.userAgent.product.PRODUCT_KNOWN_=goog.userAgent.ASSUME_IE||goog.userAgent.ASSUME_EDGE||goog.userAgent.ASSUME_OPERA||goog.userAgent.product.ASSUME_FIREFOX||goog.userAgent.product.ASSUME_IPHONE||goog.userAgent.product.ASSUME_IPAD||goog.userAgent.product.ASSUME_ANDROID||goog.userAgent.product.ASSUME_CHROME||goog.userAgent.product.ASSUME_SAFARI;goog.userAgent.product.OPERA=goog.userAgent.OPERA;goog.userAgent.product.IE=goog.userAgent.IE;goog.userAgent.product.EDGE=goog.userAgent.EDGE;goog.userAgent.product.FIREFOX=goog.userAgent.product.PRODUCT_KNOWN_?goog.userAgent.product.ASSUME_FIREFOX:goog.labs.userAgent.browser.isFirefox();goog.userAgent.product.isIphoneOrIpod_=function(){return goog.labs.userAgent.platform.isIphone()||goog.labs.userAgent.platform.isIpod()};goog.userAgent.product.IPHONE=goog.userAgent.product.PRODUCT_KNOWN_?goog.userAgent.product.ASSUME_IPHONE:goog.userAgent.product.isIphoneOrIpod_();goog.userAgent.product.IPAD=goog.userAgent.product.PRODUCT_KNOWN_?goog.userAgent.product.ASSUME_IPAD:goog.labs.userAgent.platform.isIpad();goog.userAgent.product.ANDROID=goog.userAgent.product.PRODUCT_KNOWN_?goog.userAgent.product.ASSUME_ANDROID:goog.labs.userAgent.browser.isAndroidBrowser();goog.userAgent.product.CHROME=goog.userAgent.product.PRODUCT_KNOWN_?goog.userAgent.product.ASSUME_CHROME:goog.labs.userAgent.browser.isChrome();goog.userAgent.product.isSafariDesktop_=function(){return goog.labs.userAgent.browser.isSafari()&&!goog.labs.userAgent.platform.isIos()};goog.userAgent.product.SAFARI=goog.userAgent.product.PRODUCT_KNOWN_?goog.userAgent.product.ASSUME_SAFARI:goog.userAgent.product.isSafariDesktop_();goog.provide("goog.userAgent.product.isVersion");goog.require("goog.labs.userAgent.platform");goog.require("goog.string");goog.require("goog.userAgent");goog.require("goog.userAgent.product");goog.userAgent.product.determineVersion_=function(){if(goog.userAgent.product.FIREFOX)return goog.userAgent.product.getFirstRegExpGroup_(/Firefox\/([0-9.]+)/);if(goog.userAgent.product.IE||goog.userAgent.product.EDGE||goog.userAgent.product.OPERA)return goog.userAgent.VERSION;if(goog.userAgent.product.CHROME){if(goog.labs.userAgent.platform.isIos())return goog.userAgent.product.getFirstRegExpGroup_(/CriOS\/([0-9.]+)/);return goog.userAgent.product.getFirstRegExpGroup_(/Chrome\/([0-9.]+)/)}if(goog.userAgent.product.SAFARI&&!goog.labs.userAgent.platform.isIos())return goog.userAgent.product.getFirstRegExpGroup_(/Version\/([0-9.]+)/);if(goog.userAgent.product.IPHONE||goog.userAgent.product.IPAD){var e=goog.userAgent.product.execRegExp_(/Version\/(\S+).*Mobile\/(\S+)/);if(e)return e[1]+"."+e[2]}else if(goog.userAgent.product.ANDROID){var o=goog.userAgent.product.getFirstRegExpGroup_(/Android\s+([0-9.]+)/);if(o)return o;return goog.userAgent.product.getFirstRegExpGroup_(/Version\/([0-9.]+)/)}return""};goog.userAgent.product.getFirstRegExpGroup_=function(e){var o=goog.userAgent.product.execRegExp_(e);return o?o[1]:""};goog.userAgent.product.execRegExp_=function(e){return e.exec(goog.userAgent.getUserAgentString())};goog.userAgent.product.VERSION=goog.userAgent.product.determineVersion_();goog.userAgent.product.isVersion=function(e){return goog.string.compareVersions(goog.userAgent.product.VERSION,e)>=0};goog.provide("goog.dom.animationFrame.polyfill");goog.define("goog.dom.animationFrame.polyfill.ENABLED",true);goog.dom.animationFrame.polyfill.install=function(){if(goog.dom.animationFrame.polyfill.ENABLED){var e=["ms","moz","webkit","o"];for(var o=0,t;t=e[o]&&!goog.global.requestAnimationFrame;++o){goog.global.requestAnimationFrame=goog.global[t+"RequestAnimationFrame"];goog.global.cancelAnimationFrame=goog.global[t+"CancelAnimationFrame"]||goog.global[t+"CancelRequestAnimationFrame"]}if(!goog.global.requestAnimationFrame){var i=0;goog.global.requestAnimationFrame=function(e){var o=(new Date).getTime();var t=Math.max(0,16-(o-i));i=o+t;return goog.global.setTimeout((function(){e(o+t)}),t)};if(!goog.global.cancelAnimationFrame)goog.global.cancelAnimationFrame=function(e){clearTimeout(e)}}}};goog.provide("goog.dom.asserts");goog.require("goog.asserts");goog.dom.asserts.assertIsLocation=function(e){if(goog.asserts.ENABLE_ASSERTS){var o=goog.dom.asserts.getWindow_(e);if("undefined"!=typeof o.Location&&"undefined"!=typeof o.Element)goog.asserts.assert(e&&(e instanceof o.Location||!(e instanceof o.Element)),"Argument is not a Location (or a non-Element mock); got: %s",goog.dom.asserts.debugStringForType_(e))}return e};goog.dom.asserts.assertIsElementType_=function(e,o){if(goog.asserts.ENABLE_ASSERTS){var t=goog.dom.asserts.getWindow_(e);if("undefined"!=typeof t[o]&&"undefined"!=typeof t.Location&&"undefined"!=typeof t.Element)goog.asserts.assert(e&&(e instanceof t[o]||!(e instanceof t.Location||e instanceof t.Element)),"Argument is not a %s (or a non-Element, non-Location mock); got: %s",o,goog.dom.asserts.debugStringForType_(e))}return e};goog.dom.asserts.assertIsHTMLAnchorElement=function(e){return goog.dom.asserts.assertIsElementType_(e,"HTMLAnchorElement")};goog.dom.asserts.assertIsHTMLButtonElement=function(e){return goog.dom.asserts.assertIsElementType_(e,"HTMLButtonElement")};goog.dom.asserts.assertIsHTMLLinkElement=function(e){return goog.dom.asserts.assertIsElementType_(e,"HTMLLinkElement")};goog.dom.asserts.assertIsHTMLImageElement=function(e){return goog.dom.asserts.assertIsElementType_(e,"HTMLImageElement")};goog.dom.asserts.assertIsHTMLVideoElement=function(e){return goog.dom.asserts.assertIsElementType_(e,"HTMLVideoElement")};goog.dom.asserts.assertIsHTMLInputElement=function(e){return goog.dom.asserts.assertIsElementType_(e,"HTMLInputElement")};goog.dom.asserts.assertIsHTMLEmbedElement=function(e){return goog.dom.asserts.assertIsElementType_(e,"HTMLEmbedElement")};goog.dom.asserts.assertIsHTMLFormElement=function(e){return goog.dom.asserts.assertIsElementType_(e,"HTMLFormElement")};goog.dom.asserts.assertIsHTMLFrameElement=function(e){return goog.dom.asserts.assertIsElementType_(e,"HTMLFrameElement")};goog.dom.asserts.assertIsHTMLIFrameElement=function(e){return goog.dom.asserts.assertIsElementType_(e,"HTMLIFrameElement")};goog.dom.asserts.assertIsHTMLObjectElement=function(e){return goog.dom.asserts.assertIsElementType_(e,"HTMLObjectElement")};goog.dom.asserts.assertIsHTMLScriptElement=function(e){return goog.dom.asserts.assertIsElementType_(e,"HTMLScriptElement")};goog.dom.asserts.debugStringForType_=function(e){if(goog.isObject(e))return e.constructor.displayName||e.constructor.name||Object.prototype.toString.call(e);else return void 0===e?"undefined":null===e?"null":typeof e};goog.dom.asserts.getWindow_=function(e){var o=e&&e.ownerDocument;var t=o&&(o.defaultView||o.parentWindow);return t||goog.global};goog.provide("goog.dom.BrowserFeature");goog.require("goog.userAgent");goog.dom.BrowserFeature={CAN_ADD_NAME_OR_TYPE_ATTRIBUTES:!goog.userAgent.IE||goog.userAgent.isDocumentModeOrHigher(9),CAN_USE_CHILDREN_ATTRIBUTE:!goog.userAgent.GECKO&&!goog.userAgent.IE||goog.userAgent.IE&&goog.userAgent.isDocumentModeOrHigher(9)||goog.userAgent.GECKO&&goog.userAgent.isVersionOrHigher("1.9.1"),CAN_USE_INNER_TEXT:goog.userAgent.IE&&!goog.userAgent.isVersionOrHigher("9"),CAN_USE_PARENT_ELEMENT_PROPERTY:goog.userAgent.IE||goog.userAgent.OPERA||goog.userAgent.WEBKIT,INNER_HTML_NEEDS_SCOPED_ELEMENT:goog.userAgent.IE,LEGACY_IE_RANGES:goog.userAgent.IE&&!goog.userAgent.isDocumentModeOrHigher(9)};goog.provide("goog.dom.classlist");goog.require("goog.array");goog.define("goog.dom.classlist.ALWAYS_USE_DOM_TOKEN_LIST",false);goog.dom.classlist.get=function(e){if(goog.dom.classlist.ALWAYS_USE_DOM_TOKEN_LIST||e.classList)return e.classList;var o=e.className;return goog.isString(o)&&o.match(/\S+/g)||[]};goog.dom.classlist.set=function(e,o){e.className=o};goog.dom.classlist.contains=function(e,o){if(goog.dom.classlist.ALWAYS_USE_DOM_TOKEN_LIST||e.classList)return e.classList.contains(o);return goog.array.contains(goog.dom.classlist.get(e),o)};goog.dom.classlist.add=function(e,o){if(goog.dom.classlist.ALWAYS_USE_DOM_TOKEN_LIST||e.classList){e.classList.add(o);return}if(!goog.dom.classlist.contains(e,o))e.className+=e.className.length>0?" "+o:o};goog.dom.classlist.addAll=function(e,o){if(goog.dom.classlist.ALWAYS_USE_DOM_TOKEN_LIST||e.classList){goog.array.forEach(o,(function(o){goog.dom.classlist.add(e,o)}));return}var t={};goog.array.forEach(goog.dom.classlist.get(e),(function(e){t[e]=true}));goog.array.forEach(o,(function(e){t[e]=true}));e.className="";for(var i in t)e.className+=e.className.length>0?" "+i:i};goog.dom.classlist.remove=function(e,o){if(goog.dom.classlist.ALWAYS_USE_DOM_TOKEN_LIST||e.classList){e.classList.remove(o);return}if(goog.dom.classlist.contains(e,o))e.className=goog.array.filter(goog.dom.classlist.get(e),(function(e){return e!=o})).join(" ")};goog.dom.classlist.removeAll=function(e,o){if(goog.dom.classlist.ALWAYS_USE_DOM_TOKEN_LIST||e.classList){goog.array.forEach(o,(function(o){goog.dom.classlist.remove(e,o)}));return}e.className=goog.array.filter(goog.dom.classlist.get(e),(function(e){return!goog.array.contains(o,e)})).join(" ")};goog.dom.classlist.enable=function(e,o,t){if(t)goog.dom.classlist.add(e,o);else goog.dom.classlist.remove(e,o)};goog.dom.classlist.enableAll=function(e,o,t){var i=t?goog.dom.classlist.addAll:goog.dom.classlist.removeAll;i(e,o)};goog.dom.classlist.swap=function(e,o,t){if(goog.dom.classlist.contains(e,o)){goog.dom.classlist.remove(e,o);goog.dom.classlist.add(e,t);return true}return false};goog.dom.classlist.toggle=function(e,o){var t=!goog.dom.classlist.contains(e,o);goog.dom.classlist.enable(e,o,t);return t};goog.dom.classlist.addRemove=function(e,o,t){goog.dom.classlist.remove(e,o);goog.dom.classlist.add(e,t)};goog.provide("goog.dom");goog.provide("goog.dom.Appendable");goog.provide("goog.dom.DomHelper");goog.require("goog.array");goog.require("goog.asserts");goog.require("goog.dom.BrowserFeature");goog.require("goog.dom.NodeType");goog.require("goog.dom.TagName");goog.require("goog.dom.safe");goog.require("goog.html.SafeHtml");goog.require("goog.html.uncheckedconversions");goog.require("goog.math.Coordinate");goog.require("goog.math.Size");goog.require("goog.object");goog.require("goog.string");goog.require("goog.string.Unicode");goog.require("goog.userAgent");goog.define("goog.dom.ASSUME_QUIRKS_MODE",false);goog.define("goog.dom.ASSUME_STANDARDS_MODE",false);goog.dom.COMPAT_MODE_KNOWN_=goog.dom.ASSUME_QUIRKS_MODE||goog.dom.ASSUME_STANDARDS_MODE;goog.dom.getDomHelper=function(e){return e?new goog.dom.DomHelper(goog.dom.getOwnerDocument(e)):goog.dom.defaultDomHelper_||(goog.dom.defaultDomHelper_=new goog.dom.DomHelper)};goog.dom.defaultDomHelper_;goog.dom.getDocument=function(){return document};goog.dom.getElement=function(e){return goog.dom.getElementHelper_(document,e)};goog.dom.getElementHelper_=function(e,o){return goog.isString(o)?e.getElementById(o):o};goog.dom.getRequiredElement=function(e){return goog.dom.getRequiredElementHelper_(document,e)};goog.dom.getRequiredElementHelper_=function(e,o){goog.asserts.assertString(o);var t=goog.dom.getElementHelper_(e,o);t=goog.asserts.assertElement(t,"No element found with id: "+o);return t};goog.dom.$=goog.dom.getElement;goog.dom.getElementsByTagName=function(e,o){var t=o||document;return t.getElementsByTagName(String(e))};goog.dom.getElementsByTagNameAndClass=function(e,o,t){return goog.dom.getElementsByTagNameAndClass_(document,e,o,t)};goog.dom.getElementByTagNameAndClass=function(e,o,t){return goog.dom.getElementByTagNameAndClass_(document,e,o,t)};goog.dom.getElementsByClass=function(e,o){var t=o||document;if(goog.dom.canUseQuerySelector_(t))return t.querySelectorAll("."+e);return goog.dom.getElementsByTagNameAndClass_(document,"*",e,o)};goog.dom.getElementByClass=function(e,o){var t=o||document;var i=null;if(t.getElementsByClassName)i=t.getElementsByClassName(e)[0];else i=goog.dom.getElementByTagNameAndClass_(document,"*",e,o);return i||null};goog.dom.getRequiredElementByClass=function(e,o){var t=goog.dom.getElementByClass(e,o);return goog.asserts.assert(t,"No element found with className: "+e)};goog.dom.canUseQuerySelector_=function(e){return!!(e.querySelectorAll&&e.querySelector)};goog.dom.getElementsByTagNameAndClass_=function(e,o,t,i){var r=i||e;var n=o&&"*"!=o?String(o).toUpperCase():"";if(goog.dom.canUseQuerySelector_(r)&&(n||t)){var l=n+(t?"."+t:"");return r.querySelectorAll(l)}if(t&&r.getElementsByClassName){var s=r.getElementsByClassName(t);if(n){var g={};var a=0;for(var c=0,u;u=s[c];c++)if(n==u.nodeName)g[a++]=u;g.length=a;return g}else return s}var s=r.getElementsByTagName(n||"*");if(t){var g={};var a=0;for(var c=0,u;u=s[c];c++){var h=u.className;if("function"==typeof h.split&&goog.array.contains(h.split(/\s+/),t))g[a++]=u}g.length=a;return g}else return s};goog.dom.getElementByTagNameAndClass_=function(e,o,t,i){var r=i||e;var n=o&&"*"!=o?String(o).toUpperCase():"";if(goog.dom.canUseQuerySelector_(r)&&(n||t))return r.querySelector(n+(t?"."+t:""));var l=goog.dom.getElementsByTagNameAndClass_(e,o,t,i);return l[0]||null};goog.dom.$$=goog.dom.getElementsByTagNameAndClass;goog.dom.setProperties=function(e,o){goog.object.forEach(o,(function(o,t){if(o&&o.implementsGoogStringTypedString)o=o.getTypedStringValue();if("style"==t)e.style.cssText=o;else if("class"==t)e.className=o;else if("for"==t)e.htmlFor=o;else if(goog.dom.DIRECT_ATTRIBUTE_MAP_.hasOwnProperty(t))e.setAttribute(goog.dom.DIRECT_ATTRIBUTE_MAP_[t],o);else if(goog.string.startsWith(t,"aria-")||goog.string.startsWith(t,"data-"))e.setAttribute(t,o);else e[t]=o}))};goog.dom.DIRECT_ATTRIBUTE_MAP_={cellpadding:"cellPadding",cellspacing:"cellSpacing",colspan:"colSpan",frameborder:"frameBorder",height:"height",maxlength:"maxLength",nonce:"nonce",role:"role",rowspan:"rowSpan",type:"type",usemap:"useMap",valign:"vAlign",width:"width"};goog.dom.getViewportSize=function(e){return goog.dom.getViewportSize_(e||window)};goog.dom.getViewportSize_=function(e){var o=e.document;var t=goog.dom.isCss1CompatMode_(o)?o.documentElement:o.body;return new goog.math.Size(t.clientWidth,t.clientHeight)};goog.dom.getDocumentHeight=function(){return goog.dom.getDocumentHeight_(window)};goog.dom.getDocumentHeightForWindow=function(e){return goog.dom.getDocumentHeight_(e)};goog.dom.getDocumentHeight_=function(e){var o=e.document;var t=0;if(o){var i=o.body;var r=o.documentElement;if(!(r&&i))return 0;var n=goog.dom.getViewportSize_(e).height;if(goog.dom.isCss1CompatMode_(o)&&r.scrollHeight)t=r.scrollHeight!=n?r.scrollHeight:r.offsetHeight;else{var l=r.scrollHeight;var s=r.offsetHeight;if(r.clientHeight!=s){l=i.scrollHeight;s=i.offsetHeight}if(l>n)t=l>s?l:s;else t=l<s?l:s}}return t};goog.dom.getPageScroll=function(e){var o=e||goog.global||window;return goog.dom.getDomHelper(o.document).getDocumentScroll()};goog.dom.getDocumentScroll=function(){return goog.dom.getDocumentScroll_(document)};goog.dom.getDocumentScroll_=function(e){var o=goog.dom.getDocumentScrollElement_(e);var t=goog.dom.getWindow_(e);if(goog.userAgent.IE&&goog.userAgent.isVersionOrHigher("10")&&t.pageYOffset!=o.scrollTop)return new goog.math.Coordinate(o.scrollLeft,o.scrollTop);return new goog.math.Coordinate(t.pageXOffset||o.scrollLeft,t.pageYOffset||o.scrollTop)};goog.dom.getDocumentScrollElement=function(){return goog.dom.getDocumentScrollElement_(document)};goog.dom.getDocumentScrollElement_=function(e){if(e.scrollingElement)return e.scrollingElement;if(!goog.userAgent.WEBKIT&&goog.dom.isCss1CompatMode_(e))return e.documentElement;return e.body||e.documentElement};goog.dom.getWindow=function(e){return e?goog.dom.getWindow_(e):window};goog.dom.getWindow_=function(e){return e.parentWindow||e.defaultView};goog.dom.createDom=function(e,o,t){return goog.dom.createDom_(document,arguments)};goog.dom.createDom_=function(e,o){var t=String(o[0]);var i=o[1];if(!goog.dom.BrowserFeature.CAN_ADD_NAME_OR_TYPE_ATTRIBUTES&&i&&(i.name||i.type)){var r=["<",t];if(i.name)r.push(' name="',goog.string.htmlEscape(i.name),'"');if(i.type){r.push(' type="',goog.string.htmlEscape(i.type),'"');var n={};goog.object.extend(n,i);delete n["type"];i=n}r.push(">");t=r.join("")}var l=e.createElement(t);if(i)if(goog.isString(i))l.className=i;else if(goog.isArray(i))l.className=i.join(" ");else goog.dom.setProperties(l,i);if(o.length>2)goog.dom.append_(e,l,o,2);return l};goog.dom.append_=function(e,o,t,i){function r(t){if(t)o.appendChild(goog.isString(t)?e.createTextNode(t):t)}for(var n=i;n<t.length;n++){var l=t[n];if(goog.isArrayLike(l)&&!goog.dom.isNodeLike(l))goog.array.forEach(goog.dom.isNodeList(l)?goog.array.toArray(l):l,r);else r(l)}};goog.dom.$dom=goog.dom.createDom;goog.dom.createElement=function(e){return goog.dom.createElement_(document,e)};goog.dom.createElement_=function(e,o){return e.createElement(String(o))};goog.dom.createTextNode=function(e){return document.createTextNode(String(e))};goog.dom.createTable=function(e,o,t){return goog.dom.createTable_(document,e,o,!!t)};goog.dom.createTable_=function(e,o,t,i){var r=goog.dom.createElement_(e,goog.dom.TagName.TABLE);var n=r.appendChild(goog.dom.createElement_(e,goog.dom.TagName.TBODY));for(var l=0;l<o;l++){var s=goog.dom.createElement_(e,goog.dom.TagName.TR);for(var g=0;g<t;g++){var a=goog.dom.createElement_(e,goog.dom.TagName.TD);if(i)goog.dom.setTextContent(a,goog.string.Unicode.NBSP);s.appendChild(a)}n.appendChild(s)}return r};goog.dom.constHtmlToNode=function(e){var o=goog.array.map(arguments,goog.string.Const.unwrap);var t=goog.html.uncheckedconversions.safeHtmlFromStringKnownToSatisfyTypeContract(goog.string.Const.from("Constant HTML string, that gets turned into a "+"Node later, so it will be automatically balanced."),o.join(""));return goog.dom.safeHtmlToNode(t)};goog.dom.safeHtmlToNode=function(e){return goog.dom.safeHtmlToNode_(document,e)};goog.dom.safeHtmlToNode_=function(e,o){var t=goog.dom.createElement_(e,goog.dom.TagName.DIV);if(goog.dom.BrowserFeature.INNER_HTML_NEEDS_SCOPED_ELEMENT){goog.dom.safe.setInnerHtml(t,goog.html.SafeHtml.concat(goog.html.SafeHtml.BR,o));t.removeChild(t.firstChild)}else goog.dom.safe.setInnerHtml(t,o);return goog.dom.childrenToNode_(e,t)};goog.dom.childrenToNode_=function(e,o){if(1==o.childNodes.length)return o.removeChild(o.firstChild);else{var t=e.createDocumentFragment();while(o.firstChild)t.appendChild(o.firstChild);return t}};goog.dom.isCss1CompatMode=function(){return goog.dom.isCss1CompatMode_(document)};goog.dom.isCss1CompatMode_=function(e){if(goog.dom.COMPAT_MODE_KNOWN_)return goog.dom.ASSUME_STANDARDS_MODE;return"CSS1Compat"==e.compatMode};goog.dom.canHaveChildren=function(e){if(e.nodeType!=goog.dom.NodeType.ELEMENT)return false;switch(e.tagName){case String(goog.dom.TagName.APPLET):case String(goog.dom.TagName.AREA):case String(goog.dom.TagName.BASE):case String(goog.dom.TagName.BR):case String(goog.dom.TagName.COL):case String(goog.dom.TagName.COMMAND):case String(goog.dom.TagName.EMBED):case String(goog.dom.TagName.FRAME):case String(goog.dom.TagName.HR):case String(goog.dom.TagName.IMG):case String(goog.dom.TagName.INPUT):case String(goog.dom.TagName.IFRAME):case String(goog.dom.TagName.ISINDEX):case String(goog.dom.TagName.KEYGEN):case String(goog.dom.TagName.LINK):case String(goog.dom.TagName.NOFRAMES):case String(goog.dom.TagName.NOSCRIPT):case String(goog.dom.TagName.META):case String(goog.dom.TagName.OBJECT):case String(goog.dom.TagName.PARAM):case String(goog.dom.TagName.SCRIPT):case String(goog.dom.TagName.SOURCE):case String(goog.dom.TagName.STYLE):case String(goog.dom.TagName.TRACK):case String(goog.dom.TagName.WBR):return false}return true};goog.dom.appendChild=function(e,o){e.appendChild(o)};goog.dom.append=function(e,o){goog.dom.append_(goog.dom.getOwnerDocument(e),e,arguments,1)};goog.dom.removeChildren=function(e){var o;while(o=e.firstChild)e.removeChild(o)};goog.dom.insertSiblingBefore=function(e,o){if(o.parentNode)o.parentNode.insertBefore(e,o)};goog.dom.insertSiblingAfter=function(e,o){if(o.parentNode)o.parentNode.insertBefore(e,o.nextSibling)};goog.dom.insertChildAt=function(e,o,t){e.insertBefore(o,e.childNodes[t]||null)};goog.dom.removeNode=function(e){return e&&e.parentNode?e.parentNode.removeChild(e):null};goog.dom.replaceNode=function(e,o){var t=o.parentNode;if(t)t.replaceChild(e,o)};goog.dom.flattenElement=function(e){var o,t=e.parentNode;if(t&&t.nodeType!=goog.dom.NodeType.DOCUMENT_FRAGMENT)if(e.removeNode)return e.removeNode(false);else{while(o=e.firstChild)t.insertBefore(o,e);return goog.dom.removeNode(e)}};goog.dom.getChildren=function(e){if(goog.dom.BrowserFeature.CAN_USE_CHILDREN_ATTRIBUTE&&void 0!=e.children)return e.children;return goog.array.filter(e.childNodes,(function(e){return e.nodeType==goog.dom.NodeType.ELEMENT}))};goog.dom.getFirstElementChild=function(e){if(goog.isDef(e.firstElementChild))return e.firstElementChild;return goog.dom.getNextElementNode_(e.firstChild,true)};goog.dom.getLastElementChild=function(e){if(goog.isDef(e.lastElementChild))return e.lastElementChild;return goog.dom.getNextElementNode_(e.lastChild,false)};goog.dom.getNextElementSibling=function(e){if(goog.isDef(e.nextElementSibling))return e.nextElementSibling;return goog.dom.getNextElementNode_(e.nextSibling,true)};goog.dom.getPreviousElementSibling=function(e){if(goog.isDef(e.previousElementSibling))return e.previousElementSibling;return goog.dom.getNextElementNode_(e.previousSibling,false)};goog.dom.getNextElementNode_=function(e,o){while(e&&e.nodeType!=goog.dom.NodeType.ELEMENT)e=o?e.nextSibling:e.previousSibling;return e};goog.dom.getNextNode=function(e){if(!e)return null;if(e.firstChild)return e.firstChild;while(e&&!e.nextSibling)e=e.parentNode;return e?e.nextSibling:null};goog.dom.getPreviousNode=function(e){if(!e)return null;if(!e.previousSibling)return e.parentNode;e=e.previousSibling;while(e&&e.lastChild)e=e.lastChild;return e};goog.dom.isNodeLike=function(e){return goog.isObject(e)&&e.nodeType>0};goog.dom.isElement=function(e){return goog.isObject(e)&&e.nodeType==goog.dom.NodeType.ELEMENT};goog.dom.isWindow=function(e){return goog.isObject(e)&&e["window"]==e};goog.dom.getParentElement=function(e){var o;if(goog.dom.BrowserFeature.CAN_USE_PARENT_ELEMENT_PROPERTY){var t=goog.userAgent.IE&&goog.userAgent.isVersionOrHigher("9")&&!goog.userAgent.isVersionOrHigher("10");if(!(t&&goog.global["SVGElement"]&&e instanceof goog.global["SVGElement"])){o=e.parentElement;if(o)return o}}o=e.parentNode;return goog.dom.isElement(o)?o:null};goog.dom.contains=function(e,o){if(!e||!o)return false;if(e.contains&&o.nodeType==goog.dom.NodeType.ELEMENT)return e==o||e.contains(o);if("undefined"!=typeof e.compareDocumentPosition)return e==o||Boolean(16&e.compareDocumentPosition(o));while(o&&e!=o)o=o.parentNode;return o==e};goog.dom.compareNodeOrder=function(e,o){if(e==o)return 0;if(e.compareDocumentPosition)return 2&e.compareDocumentPosition(o)?1:-1;if(goog.userAgent.IE&&!goog.userAgent.isDocumentModeOrHigher(9)){if(e.nodeType==goog.dom.NodeType.DOCUMENT)return-1;if(o.nodeType==goog.dom.NodeType.DOCUMENT)return 1}if("sourceIndex"in e||e.parentNode&&"sourceIndex"in e.parentNode){var t=e.nodeType==goog.dom.NodeType.ELEMENT;var i=o.nodeType==goog.dom.NodeType.ELEMENT;if(t&&i)return e.sourceIndex-o.sourceIndex;else{var r=e.parentNode;var n=o.parentNode;if(r==n)return goog.dom.compareSiblingOrder_(e,o);if(!t&&goog.dom.contains(r,o))return-1*goog.dom.compareParentsDescendantNodeIe_(e,o);if(!i&&goog.dom.contains(n,e))return goog.dom.compareParentsDescendantNodeIe_(o,e);return(t?e.sourceIndex:r.sourceIndex)-(i?o.sourceIndex:n.sourceIndex)}}var l=goog.dom.getOwnerDocument(e);var s,g;s=l.createRange();s.selectNode(e);s.collapse(true);g=l.createRange();g.selectNode(o);g.collapse(true);return s.compareBoundaryPoints(goog.global["Range"].START_TO_END,g)};goog.dom.compareParentsDescendantNodeIe_=function(e,o){var t=e.parentNode;if(t==o)return-1;var i=o;while(i.parentNode!=t)i=i.parentNode;return goog.dom.compareSiblingOrder_(i,e)};goog.dom.compareSiblingOrder_=function(e,o){var t=o;while(t=t.previousSibling)if(t==e)return-1;return 1};goog.dom.findCommonAncestor=function(e){var o,t=arguments.length;if(!t)return null;else if(1==t)return arguments[0];var i=[];var r=1/0;for(o=0;o<t;o++){var n=[];var l=arguments[o];while(l){n.unshift(l);l=l.parentNode}i.push(n);r=Math.min(r,n.length)}var s=null;for(o=0;o<r;o++){var g=i[0][o];for(var a=1;a<t;a++)if(g!=i[a][o])return s;s=g}return s};goog.dom.getOwnerDocument=function(e){goog.asserts.assert(e,"Node cannot be null or undefined.");return e.nodeType==goog.dom.NodeType.DOCUMENT?e:e.ownerDocument||e.document};goog.dom.getFrameContentDocument=function(e){return e.contentDocument||e.contentWindow.document};goog.dom.getFrameContentWindow=function(e){try{return e.contentWindow||(e.contentDocument?goog.dom.getWindow(e.contentDocument):null)}catch(e){}return null};goog.dom.setTextContent=function(e,o){goog.asserts.assert(null!=e,"goog.dom.setTextContent expects a non-null value for node");if("textContent"in e)e.textContent=o;else if(e.nodeType==goog.dom.NodeType.TEXT)e.data=String(o);else if(e.firstChild&&e.firstChild.nodeType==goog.dom.NodeType.TEXT){while(e.lastChild!=e.firstChild)e.removeChild(e.lastChild);e.firstChild.data=String(o)}else{goog.dom.removeChildren(e);var t=goog.dom.getOwnerDocument(e);e.appendChild(t.createTextNode(String(o)))}};goog.dom.getOuterHtml=function(e){goog.asserts.assert(null!==e,"goog.dom.getOuterHtml expects a non-null value for element");if("outerHTML"in e)return e.outerHTML;else{var o=goog.dom.getOwnerDocument(e);var t=goog.dom.createElement_(o,goog.dom.TagName.DIV);t.appendChild(e.cloneNode(true));return t.innerHTML}};goog.dom.findNode=function(e,o){var t=[];var i=goog.dom.findNodes_(e,o,t,true);return i?t[0]:void 0};goog.dom.findNodes=function(e,o){var t=[];goog.dom.findNodes_(e,o,t,false);return t};goog.dom.findNodes_=function(e,o,t,i){if(null!=e){var r=e.firstChild;while(r){if(o(r)){t.push(r);if(i)return true}if(goog.dom.findNodes_(r,o,t,i))return true;r=r.nextSibling}}return false};goog.dom.TAGS_TO_IGNORE_={SCRIPT:1,STYLE:1,HEAD:1,IFRAME:1,OBJECT:1};goog.dom.PREDEFINED_TAG_VALUES_={IMG:" ",BR:"\n"};goog.dom.isFocusableTabIndex=function(e){return goog.dom.hasSpecifiedTabIndex_(e)&&goog.dom.isTabIndexFocusable_(e)};goog.dom.setFocusableTabIndex=function(e,o){if(o)e.tabIndex=0;else{e.tabIndex=-1;e.removeAttribute("tabIndex")}};goog.dom.isFocusable=function(e){var o;if(goog.dom.nativelySupportsFocus_(e))o=!e.disabled&&(!goog.dom.hasSpecifiedTabIndex_(e)||goog.dom.isTabIndexFocusable_(e));else o=goog.dom.isFocusableTabIndex(e);return o&&goog.userAgent.IE?goog.dom.hasNonZeroBoundingRect_(e):o};goog.dom.hasSpecifiedTabIndex_=function(e){if(goog.userAgent.IE&&!goog.userAgent.isVersionOrHigher("9")){var o=e.getAttributeNode("tabindex");return goog.isDefAndNotNull(o)&&o.specified}else return e.hasAttribute("tabindex")};goog.dom.isTabIndexFocusable_=function(e){var o=e.tabIndex;return goog.isNumber(o)&&o>=0&&o<32768};goog.dom.nativelySupportsFocus_=function(e){return e.tagName==goog.dom.TagName.A||e.tagName==goog.dom.TagName.INPUT||e.tagName==goog.dom.TagName.TEXTAREA||e.tagName==goog.dom.TagName.SELECT||e.tagName==goog.dom.TagName.BUTTON};goog.dom.hasNonZeroBoundingRect_=function(e){var o;if(!goog.isFunction(e["getBoundingClientRect"])||goog.userAgent.IE&&null==e.parentElement)o={height:e.offsetHeight,width:e.offsetWidth};else o=e.getBoundingClientRect();return goog.isDefAndNotNull(o)&&o.height>0&&o.width>0};goog.dom.getTextContent=function(e){var o;if(goog.dom.BrowserFeature.CAN_USE_INNER_TEXT&&null!==e&&"innerText"in e)o=goog.string.canonicalizeNewlines(e.innerText);else{var t=[];goog.dom.getTextContent_(e,t,true);o=t.join("")}o=o.replace(/ \xAD /g," ").replace(/\xAD/g,"");o=o.replace(/\u200B/g,"");if(!goog.dom.BrowserFeature.CAN_USE_INNER_TEXT)o=o.replace(/ +/g," ");if(" "!=o)o=o.replace(/^\s*/,"");return o};goog.dom.getRawTextContent=function(e){var o=[];goog.dom.getTextContent_(e,o,false);return o.join("")};goog.dom.getTextContent_=function(e,o,t){if(e.nodeName in goog.dom.TAGS_TO_IGNORE_);else if(e.nodeType==goog.dom.NodeType.TEXT)if(t)o.push(String(e.nodeValue).replace(/(\r\n|\r|\n)/g,""));else o.push(e.nodeValue);else if(e.nodeName in goog.dom.PREDEFINED_TAG_VALUES_)o.push(goog.dom.PREDEFINED_TAG_VALUES_[e.nodeName]);else{var i=e.firstChild;while(i){goog.dom.getTextContent_(i,o,t);i=i.nextSibling}}};goog.dom.getNodeTextLength=function(e){return goog.dom.getTextContent(e).length};goog.dom.getNodeTextOffset=function(e,o){var t=o||goog.dom.getOwnerDocument(e).body;var i=[];while(e&&e!=t){var r=e;while(r=r.previousSibling)i.unshift(goog.dom.getTextContent(r));e=e.parentNode}return goog.string.trimLeft(i.join("")).replace(/ +/g," ").length};goog.dom.getNodeAtOffset=function(e,o,t){var i=[e],r=0,n=null;while(i.length>0&&r<o){n=i.pop();if(n.nodeName in goog.dom.TAGS_TO_IGNORE_);else if(n.nodeType==goog.dom.NodeType.TEXT){var l=n.nodeValue.replace(/(\r\n|\r|\n)/g,"").replace(/ +/g," ");r+=l.length}else if(n.nodeName in goog.dom.PREDEFINED_TAG_VALUES_)r+=goog.dom.PREDEFINED_TAG_VALUES_[n.nodeName].length;else for(var s=n.childNodes.length-1;s>=0;s--)i.push(n.childNodes[s])}if(goog.isObject(t)){t.remainder=n?n.nodeValue.length+o-r-1:0;t.node=n}return n};goog.dom.isNodeList=function(e){if(e&&"number"==typeof e.length)if(goog.isObject(e))return"function"==typeof e.item||"string"==typeof e.item;else if(goog.isFunction(e))return"function"==typeof e.item;return false};goog.dom.getAncestorByTagNameAndClass=function(e,o,t,i){if(!o&&!t)return null;var r=o?String(o).toUpperCase():null;return goog.dom.getAncestor(e,(function(e){return(!r||e.nodeName==r)&&(!t||goog.isString(e.className)&&goog.array.contains(e.className.split(/\s+/),t))}),true,i)};goog.dom.getAncestorByClass=function(e,o,t){return goog.dom.getAncestorByTagNameAndClass(e,null,o,t)};goog.dom.getAncestor=function(e,o,t,i){if(e&&!t)e=e.parentNode;var r=0;while(e&&(null==i||r<=i)){goog.asserts.assert("parentNode"!=e.name);if(o(e))return e;e=e.parentNode;r++}return null};goog.dom.getActiveElement=function(e){try{var o=e&&e.activeElement;return o&&o.nodeName?o:null}catch(e){return null}};goog.dom.getPixelRatio=function(){var e=goog.dom.getWindow();if(goog.isDef(e.devicePixelRatio))return e.devicePixelRatio;else if(e.matchMedia)return goog.dom.matchesPixelRatio_(3)||goog.dom.matchesPixelRatio_(2)||goog.dom.matchesPixelRatio_(1.5)||goog.dom.matchesPixelRatio_(1)||.75;return 1};goog.dom.matchesPixelRatio_=function(e){var o=goog.dom.getWindow();var t=96;var i="(min-resolution: "+e+"dppx),"+"(min--moz-device-pixel-ratio: "+e+"),"+"(min-resolution: "+e*t+"dpi)";return o.matchMedia(i).matches?e:0};goog.dom.getCanvasContext2D=function(e){return e.getContext("2d")};goog.dom.DomHelper=function(e){this.document_=e||goog.global.document||document};goog.dom.DomHelper.prototype.getDomHelper=goog.dom.getDomHelper;goog.dom.DomHelper.prototype.setDocument=function(e){this.document_=e};goog.dom.DomHelper.prototype.getDocument=function(){return this.document_};goog.dom.DomHelper.prototype.getElement=function(e){return goog.dom.getElementHelper_(this.document_,e)};goog.dom.DomHelper.prototype.getRequiredElement=function(e){return goog.dom.getRequiredElementHelper_(this.document_,e)};goog.dom.DomHelper.prototype.$=goog.dom.DomHelper.prototype.getElement;goog.dom.DomHelper.prototype.getElementsByTagName=function(e,o){var t=o||this.document_;return t.getElementsByTagName(String(e))};goog.dom.DomHelper.prototype.getElementsByTagNameAndClass=function(e,o,t){return goog.dom.getElementsByTagNameAndClass_(this.document_,e,o,t)};goog.dom.DomHelper.prototype.getElementByTagNameAndClass=function(e,o,t){return goog.dom.getElementByTagNameAndClass_(this.document_,e,o,t)};goog.dom.DomHelper.prototype.getElementsByClass=function(e,o){var t=o||this.document_;return goog.dom.getElementsByClass(e,t)};goog.dom.DomHelper.prototype.getElementByClass=function(e,o){var t=o||this.document_;return goog.dom.getElementByClass(e,t)};goog.dom.DomHelper.prototype.getRequiredElementByClass=function(e,o){var t=o||this.document_;return goog.dom.getRequiredElementByClass(e,t)};goog.dom.DomHelper.prototype.$$=goog.dom.DomHelper.prototype.getElementsByTagNameAndClass;goog.dom.DomHelper.prototype.setProperties=goog.dom.setProperties;goog.dom.DomHelper.prototype.getViewportSize=function(e){return goog.dom.getViewportSize(e||this.getWindow())};goog.dom.DomHelper.prototype.getDocumentHeight=function(){return goog.dom.getDocumentHeight_(this.getWindow())};goog.dom.Appendable;goog.dom.DomHelper.prototype.createDom=function(e,o,t){return goog.dom.createDom_(this.document_,arguments)};goog.dom.DomHelper.prototype.$dom=goog.dom.DomHelper.prototype.createDom;goog.dom.DomHelper.prototype.createElement=function(e){return goog.dom.createElement_(this.document_,e)};goog.dom.DomHelper.prototype.createTextNode=function(e){return this.document_.createTextNode(String(e))};goog.dom.DomHelper.prototype.createTable=function(e,o,t){return goog.dom.createTable_(this.document_,e,o,!!t)};goog.dom.DomHelper.prototype.safeHtmlToNode=function(e){return goog.dom.safeHtmlToNode_(this.document_,e)};goog.dom.DomHelper.prototype.isCss1CompatMode=function(){return goog.dom.isCss1CompatMode_(this.document_)};goog.dom.DomHelper.prototype.getWindow=function(){return goog.dom.getWindow_(this.document_)};goog.dom.DomHelper.prototype.getDocumentScrollElement=function(){return goog.dom.getDocumentScrollElement_(this.document_)};goog.dom.DomHelper.prototype.getDocumentScroll=function(){return goog.dom.getDocumentScroll_(this.document_)};goog.dom.DomHelper.prototype.getActiveElement=function(e){return goog.dom.getActiveElement(e||this.document_)};goog.dom.DomHelper.prototype.appendChild=goog.dom.appendChild;goog.dom.DomHelper.prototype.append=goog.dom.append;goog.dom.DomHelper.prototype.canHaveChildren=goog.dom.canHaveChildren;goog.dom.DomHelper.prototype.removeChildren=goog.dom.removeChildren;goog.dom.DomHelper.prototype.insertSiblingBefore=goog.dom.insertSiblingBefore;goog.dom.DomHelper.prototype.insertSiblingAfter=goog.dom.insertSiblingAfter;goog.dom.DomHelper.prototype.insertChildAt=goog.dom.insertChildAt;goog.dom.DomHelper.prototype.removeNode=goog.dom.removeNode;goog.dom.DomHelper.prototype.replaceNode=goog.dom.replaceNode;goog.dom.DomHelper.prototype.flattenElement=goog.dom.flattenElement;goog.dom.DomHelper.prototype.getChildren=goog.dom.getChildren;goog.dom.DomHelper.prototype.getFirstElementChild=goog.dom.getFirstElementChild;goog.dom.DomHelper.prototype.getLastElementChild=goog.dom.getLastElementChild;goog.dom.DomHelper.prototype.getNextElementSibling=goog.dom.getNextElementSibling;goog.dom.DomHelper.prototype.getPreviousElementSibling=goog.dom.getPreviousElementSibling;goog.dom.DomHelper.prototype.getNextNode=goog.dom.getNextNode;goog.dom.DomHelper.prototype.getPreviousNode=goog.dom.getPreviousNode;goog.dom.DomHelper.prototype.isNodeLike=goog.dom.isNodeLike;goog.dom.DomHelper.prototype.isElement=goog.dom.isElement;goog.dom.DomHelper.prototype.isWindow=goog.dom.isWindow;goog.dom.DomHelper.prototype.getParentElement=goog.dom.getParentElement;goog.dom.DomHelper.prototype.contains=goog.dom.contains;goog.dom.DomHelper.prototype.compareNodeOrder=goog.dom.compareNodeOrder;goog.dom.DomHelper.prototype.findCommonAncestor=goog.dom.findCommonAncestor;goog.dom.DomHelper.prototype.getOwnerDocument=goog.dom.getOwnerDocument;goog.dom.DomHelper.prototype.getFrameContentDocument=goog.dom.getFrameContentDocument;goog.dom.DomHelper.prototype.getFrameContentWindow=goog.dom.getFrameContentWindow;goog.dom.DomHelper.prototype.setTextContent=goog.dom.setTextContent;goog.dom.DomHelper.prototype.getOuterHtml=goog.dom.getOuterHtml;goog.dom.DomHelper.prototype.findNode=goog.dom.findNode;goog.dom.DomHelper.prototype.findNodes=goog.dom.findNodes;goog.dom.DomHelper.prototype.isFocusableTabIndex=goog.dom.isFocusableTabIndex;goog.dom.DomHelper.prototype.setFocusableTabIndex=goog.dom.setFocusableTabIndex;goog.dom.DomHelper.prototype.isFocusable=goog.dom.isFocusable;goog.dom.DomHelper.prototype.getTextContent=goog.dom.getTextContent;goog.dom.DomHelper.prototype.getNodeTextLength=goog.dom.getNodeTextLength;goog.dom.DomHelper.prototype.getNodeTextOffset=goog.dom.getNodeTextOffset;goog.dom.DomHelper.prototype.getNodeAtOffset=goog.dom.getNodeAtOffset;goog.dom.DomHelper.prototype.isNodeList=goog.dom.isNodeList;goog.dom.DomHelper.prototype.getAncestorByTagNameAndClass=goog.dom.getAncestorByTagNameAndClass;goog.dom.DomHelper.prototype.getAncestorByClass=goog.dom.getAncestorByClass;goog.dom.DomHelper.prototype.getAncestor=goog.dom.getAncestor;goog.dom.DomHelper.prototype.getCanvasContext2D=goog.dom.getCanvasContext2D;goog.provide("goog.dom.HtmlElement");goog.dom.HtmlElement=function(){};goog.provide("goog.dom.TagIterator");goog.provide("goog.dom.TagWalkType");goog.require("goog.dom");goog.require("goog.dom.NodeType");goog.require("goog.iter.Iterator");goog.require("goog.iter.StopIteration");goog.dom.TagWalkType={START_TAG:1,OTHER:0,END_TAG:-1};goog.dom.TagIterator=function(e,o,t,i,r){this.reversed=!!o;this.node=null;this.tagType=goog.dom.TagWalkType.OTHER;this.depth;this.started_=false;this.constrained=!t;if(e)this.setPosition(e,i);this.depth=void 0!=r?r:this.tagType||0;if(this.reversed)this.depth*=-1};goog.inherits(goog.dom.TagIterator,goog.iter.Iterator);goog.dom.TagIterator.prototype.setPosition=function(e,o,t){this.node=e;if(e)if(goog.isNumber(o))this.tagType=o;else this.tagType=this.node.nodeType!=goog.dom.NodeType.ELEMENT?goog.dom.TagWalkType.OTHER:this.reversed?goog.dom.TagWalkType.END_TAG:goog.dom.TagWalkType.START_TAG;if(goog.isNumber(t))this.depth=t};goog.dom.TagIterator.prototype.copyFrom=function(e){this.node=e.node;this.tagType=e.tagType;this.depth=e.depth;this.reversed=e.reversed;this.constrained=e.constrained};goog.dom.TagIterator.prototype.clone=function(){return new goog.dom.TagIterator(this.node,this.reversed,!this.constrained,this.tagType,this.depth)};goog.dom.TagIterator.prototype.skipTag=function(){var e=this.reversed?goog.dom.TagWalkType.END_TAG:goog.dom.TagWalkType.START_TAG;if(this.tagType==e){this.tagType=-1*e;this.depth+=this.tagType*(this.reversed?-1:1)}};goog.dom.TagIterator.prototype.restartTag=function(){var e=this.reversed?goog.dom.TagWalkType.START_TAG:goog.dom.TagWalkType.END_TAG;if(this.tagType==e){this.tagType=-1*e;this.depth+=this.tagType*(this.reversed?-1:1)}};goog.dom.TagIterator.prototype.next=function(){var e;if(this.started_){if(!this.node||this.constrained&&0==this.depth)throw goog.iter.StopIteration;e=this.node;var o=this.reversed?goog.dom.TagWalkType.END_TAG:goog.dom.TagWalkType.START_TAG;if(this.tagType==o){var t=this.reversed?e.lastChild:e.firstChild;if(t)this.setPosition(t);else this.setPosition(e,-1*o)}else{var i=this.reversed?e.previousSibling:e.nextSibling;if(i)this.setPosition(i);else this.setPosition(e.parentNode,-1*o)}this.depth+=this.tagType*(this.reversed?-1:1)}else this.started_=true;e=this.node;if(!this.node)throw goog.iter.StopIteration;return e};goog.dom.TagIterator.prototype.isStarted=function(){return this.started_};goog.dom.TagIterator.prototype.isStartTag=function(){return this.tagType==goog.dom.TagWalkType.START_TAG};goog.dom.TagIterator.prototype.isEndTag=function(){return this.tagType==goog.dom.TagWalkType.END_TAG};goog.dom.TagIterator.prototype.isNonElement=function(){return this.tagType==goog.dom.TagWalkType.OTHER};goog.dom.TagIterator.prototype.equals=function(e){return e.node==this.node&&(!this.node||e.tagType==this.tagType)};goog.dom.TagIterator.prototype.splice=function(e){var o=this.node;this.restartTag();this.reversed=!this.reversed;goog.dom.TagIterator.prototype.next.call(this);this.reversed=!this.reversed;var t=goog.isArrayLike(arguments[0])?arguments[0]:arguments;for(var i=t.length-1;i>=0;i--)goog.dom.insertSiblingAfter(t[i],o);goog.dom.removeNode(o)};goog.provide("goog.dom.NodeIterator");goog.require("goog.dom.TagIterator");goog.dom.NodeIterator=function(e,o,t,i){goog.dom.TagIterator.call(this,e,o,t,null,i)};goog.inherits(goog.dom.NodeIterator,goog.dom.TagIterator);goog.dom.NodeIterator.prototype.next=function(){do{goog.dom.NodeIterator.superClass_.next.call(this)}while(this.isEndTag());return this.node};goog.provide("goog.dom.NodeType");goog.dom.NodeType={ELEMENT:1,ATTRIBUTE:2,TEXT:3,CDATA_SECTION:4,ENTITY_REFERENCE:5,ENTITY:6,PROCESSING_INSTRUCTION:7,COMMENT:8,DOCUMENT:9,DOCUMENT_TYPE:10,DOCUMENT_FRAGMENT:11,NOTATION:12};goog.provide("goog.dom.safe");goog.provide("goog.dom.safe.InsertAdjacentHtmlPosition");goog.require("goog.asserts");goog.require("goog.dom.asserts");goog.require("goog.html.SafeHtml");goog.require("goog.html.SafeScript");goog.require("goog.html.SafeStyle");goog.require("goog.html.SafeUrl");goog.require("goog.html.TrustedResourceUrl");goog.require("goog.string");goog.require("goog.string.Const");goog.dom.safe.InsertAdjacentHtmlPosition={AFTERBEGIN:"afterbegin",AFTEREND:"afterend",BEFOREBEGIN:"beforebegin",BEFOREEND:"beforeend"};goog.dom.safe.insertAdjacentHtml=function(e,o,t){e.insertAdjacentHTML(o,goog.html.SafeHtml.unwrap(t))};goog.dom.safe.SET_INNER_HTML_DISALLOWED_TAGS_={MATH:true,SCRIPT:true,STYLE:true,SVG:true,TEMPLATE:true};goog.dom.safe.setInnerHtml=function(e,o){if(goog.asserts.ENABLE_ASSERTS){var t=e.tagName.toUpperCase();if(goog.dom.safe.SET_INNER_HTML_DISALLOWED_TAGS_[t])throw new Error("goog.dom.safe.setInnerHtml cannot be used to set content of "+e.tagName+".")}e.innerHTML=goog.html.SafeHtml.unwrap(o)};goog.dom.safe.setOuterHtml=function(e,o){e.outerHTML=goog.html.SafeHtml.unwrap(o)};goog.dom.safe.setFormElementAction=function(e,o){var t;if(o instanceof goog.html.SafeUrl)t=o;else t=goog.html.SafeUrl.sanitizeAssertUnchanged(o);goog.dom.asserts.assertIsHTMLFormElement(e).action=goog.html.SafeUrl.unwrap(t)};goog.dom.safe.setButtonFormAction=function(e,o){var t;if(o instanceof goog.html.SafeUrl)t=o;else t=goog.html.SafeUrl.sanitizeAssertUnchanged(o);goog.dom.asserts.assertIsHTMLButtonElement(e).formAction=goog.html.SafeUrl.unwrap(t)};goog.dom.safe.setInputFormAction=function(e,o){var t;if(o instanceof goog.html.SafeUrl)t=o;else t=goog.html.SafeUrl.sanitizeAssertUnchanged(o);goog.dom.asserts.assertIsHTMLInputElement(e).formAction=goog.html.SafeUrl.unwrap(t)};goog.dom.safe.setStyle=function(e,o){e.style.cssText=goog.html.SafeStyle.unwrap(o)};goog.dom.safe.documentWrite=function(e,o){e.write(goog.html.SafeHtml.unwrap(o))};goog.dom.safe.setAnchorHref=function(e,o){goog.dom.asserts.assertIsHTMLAnchorElement(e);var t;if(o instanceof goog.html.SafeUrl)t=o;else t=goog.html.SafeUrl.sanitizeAssertUnchanged(o);e.href=goog.html.SafeUrl.unwrap(t)};goog.dom.safe.setImageSrc=function(e,o){goog.dom.asserts.assertIsHTMLImageElement(e);var t;if(o instanceof goog.html.SafeUrl)t=o;else t=goog.html.SafeUrl.sanitizeAssertUnchanged(o);e.src=goog.html.SafeUrl.unwrap(t)};goog.dom.safe.setVideoSrc=function(e,o){goog.dom.asserts.assertIsHTMLVideoElement(e);var t;if(o instanceof goog.html.SafeUrl)t=o;else t=goog.html.SafeUrl.sanitizeAssertUnchanged(o);e.src=goog.html.SafeUrl.unwrap(t)};goog.dom.safe.setEmbedSrc=function(e,o){goog.dom.asserts.assertIsHTMLEmbedElement(e);e.src=goog.html.TrustedResourceUrl.unwrap(o)};goog.dom.safe.setFrameSrc=function(e,o){goog.dom.asserts.assertIsHTMLFrameElement(e);e.src=goog.html.TrustedResourceUrl.unwrap(o)};goog.dom.safe.setIframeSrc=function(e,o){goog.dom.asserts.assertIsHTMLIFrameElement(e);e.src=goog.html.TrustedResourceUrl.unwrap(o)};goog.dom.safe.setIframeSrcdoc=function(e,o){goog.dom.asserts.assertIsHTMLIFrameElement(e);e.srcdoc=goog.html.SafeHtml.unwrap(o)};goog.dom.safe.setLinkHrefAndRel=function(e,o,t){goog.dom.asserts.assertIsHTMLLinkElement(e);e.rel=t;if(goog.string.caseInsensitiveContains(t,"stylesheet")){goog.asserts.assert(o instanceof goog.html.TrustedResourceUrl,'URL must be TrustedResourceUrl because "rel" contains "stylesheet"');e.href=goog.html.TrustedResourceUrl.unwrap(o)}else if(o instanceof goog.html.TrustedResourceUrl)e.href=goog.html.TrustedResourceUrl.unwrap(o);else if(o instanceof goog.html.SafeUrl)e.href=goog.html.SafeUrl.unwrap(o);else e.href=goog.html.SafeUrl.sanitizeAssertUnchanged(o).getTypedStringValue()};goog.dom.safe.setObjectData=function(e,o){goog.dom.asserts.assertIsHTMLObjectElement(e);e.data=goog.html.TrustedResourceUrl.unwrap(o)};goog.dom.safe.setScriptSrc=function(e,o){goog.dom.asserts.assertIsHTMLScriptElement(e);e.src=goog.html.TrustedResourceUrl.unwrap(o)};goog.dom.safe.setScriptContent=function(e,o){goog.dom.asserts.assertIsHTMLScriptElement(e);e.text=goog.html.SafeScript.unwrap(o)};goog.dom.safe.setLocationHref=function(e,o){goog.dom.asserts.assertIsLocation(e);var t;if(o instanceof goog.html.SafeUrl)t=o;else t=goog.html.SafeUrl.sanitizeAssertUnchanged(o);e.href=goog.html.SafeUrl.unwrap(t)};goog.dom.safe.replaceLocation=function(e,o){goog.dom.asserts.assertIsLocation(e);var t;if(o instanceof goog.html.SafeUrl)t=o;else t=goog.html.SafeUrl.sanitizeAssertUnchanged(o);e.replace(goog.html.SafeUrl.unwrap(t))};goog.dom.safe.openInWindow=function(e,o,t,i,r){var n;if(e instanceof goog.html.SafeUrl)n=e;else n=goog.html.SafeUrl.sanitizeAssertUnchanged(e);var l=o||window;return l.open(goog.html.SafeUrl.unwrap(n),t?goog.string.Const.unwrap(t):"",i,r)};goog.provide("goog.dom.TagName");goog.require("goog.dom.HtmlElement");goog.dom.TagName=function(e){this.tagName_=e};goog.dom.TagName.prototype.toString=function(){return this.tagName_};goog.dom.TagName.A=new goog.dom.TagName("A");goog.dom.TagName.ABBR=new goog.dom.TagName("ABBR");goog.dom.TagName.ACRONYM=new goog.dom.TagName("ACRONYM");goog.dom.TagName.ADDRESS=new goog.dom.TagName("ADDRESS");goog.dom.TagName.APPLET=new goog.dom.TagName("APPLET");goog.dom.TagName.AREA=new goog.dom.TagName("AREA");goog.dom.TagName.ARTICLE=new goog.dom.TagName("ARTICLE");goog.dom.TagName.ASIDE=new goog.dom.TagName("ASIDE");goog.dom.TagName.AUDIO=new goog.dom.TagName("AUDIO");goog.dom.TagName.B=new goog.dom.TagName("B");goog.dom.TagName.BASE=new goog.dom.TagName("BASE");goog.dom.TagName.BASEFONT=new goog.dom.TagName("BASEFONT");goog.dom.TagName.BDI=new goog.dom.TagName("BDI");goog.dom.TagName.BDO=new goog.dom.TagName("BDO");goog.dom.TagName.BIG=new goog.dom.TagName("BIG");goog.dom.TagName.BLOCKQUOTE=new goog.dom.TagName("BLOCKQUOTE");goog.dom.TagName.BODY=new goog.dom.TagName("BODY");goog.dom.TagName.BR=new goog.dom.TagName("BR");goog.dom.TagName.BUTTON=new goog.dom.TagName("BUTTON");goog.dom.TagName.CANVAS=new goog.dom.TagName("CANVAS");goog.dom.TagName.CAPTION=new goog.dom.TagName("CAPTION");goog.dom.TagName.CENTER=new goog.dom.TagName("CENTER");goog.dom.TagName.CITE=new goog.dom.TagName("CITE");goog.dom.TagName.CODE=new goog.dom.TagName("CODE");goog.dom.TagName.COL=new goog.dom.TagName("COL");goog.dom.TagName.COLGROUP=new goog.dom.TagName("COLGROUP");goog.dom.TagName.COMMAND=new goog.dom.TagName("COMMAND");goog.dom.TagName.DATA=new goog.dom.TagName("DATA");goog.dom.TagName.DATALIST=new goog.dom.TagName("DATALIST");goog.dom.TagName.DD=new goog.dom.TagName("DD");goog.dom.TagName.DEL=new goog.dom.TagName("DEL");goog.dom.TagName.DETAILS=new goog.dom.TagName("DETAILS");goog.dom.TagName.DFN=new goog.dom.TagName("DFN");goog.dom.TagName.DIALOG=new goog.dom.TagName("DIALOG");goog.dom.TagName.DIR=new goog.dom.TagName("DIR");goog.dom.TagName.DIV=new goog.dom.TagName("DIV");goog.dom.TagName.DL=new goog.dom.TagName("DL");goog.dom.TagName.DT=new goog.dom.TagName("DT");goog.dom.TagName.EM=new goog.dom.TagName("EM");goog.dom.TagName.EMBED=new goog.dom.TagName("EMBED");goog.dom.TagName.FIELDSET=new goog.dom.TagName("FIELDSET");goog.dom.TagName.FIGCAPTION=new goog.dom.TagName("FIGCAPTION");goog.dom.TagName.FIGURE=new goog.dom.TagName("FIGURE");goog.dom.TagName.FONT=new goog.dom.TagName("FONT");goog.dom.TagName.FOOTER=new goog.dom.TagName("FOOTER");goog.dom.TagName.FORM=new goog.dom.TagName("FORM");goog.dom.TagName.FRAME=new goog.dom.TagName("FRAME");goog.dom.TagName.FRAMESET=new goog.dom.TagName("FRAMESET");goog.dom.TagName.H1=new goog.dom.TagName("H1");goog.dom.TagName.H2=new goog.dom.TagName("H2");goog.dom.TagName.H3=new goog.dom.TagName("H3");goog.dom.TagName.H4=new goog.dom.TagName("H4");goog.dom.TagName.H5=new goog.dom.TagName("H5");goog.dom.TagName.H6=new goog.dom.TagName("H6");goog.dom.TagName.HEAD=new goog.dom.TagName("HEAD");goog.dom.TagName.HEADER=new goog.dom.TagName("HEADER");goog.dom.TagName.HGROUP=new goog.dom.TagName("HGROUP");goog.dom.TagName.HR=new goog.dom.TagName("HR");goog.dom.TagName.HTML=new goog.dom.TagName("HTML");goog.dom.TagName.I=new goog.dom.TagName("I");goog.dom.TagName.IFRAME=new goog.dom.TagName("IFRAME");goog.dom.TagName.IMG=new goog.dom.TagName("IMG");goog.dom.TagName.INPUT=new goog.dom.TagName("INPUT");goog.dom.TagName.INS=new goog.dom.TagName("INS");goog.dom.TagName.ISINDEX=new goog.dom.TagName("ISINDEX");goog.dom.TagName.KBD=new goog.dom.TagName("KBD");goog.dom.TagName.KEYGEN=new goog.dom.TagName("KEYGEN");goog.dom.TagName.LABEL=new goog.dom.TagName("LABEL");goog.dom.TagName.LEGEND=new goog.dom.TagName("LEGEND");goog.dom.TagName.LI=new goog.dom.TagName("LI");goog.dom.TagName.LINK=new goog.dom.TagName("LINK");goog.dom.TagName.MAIN=new goog.dom.TagName("MAIN");goog.dom.TagName.MAP=new goog.dom.TagName("MAP");goog.dom.TagName.MARK=new goog.dom.TagName("MARK");goog.dom.TagName.MATH=new goog.dom.TagName("MATH");goog.dom.TagName.MENU=new goog.dom.TagName("MENU");goog.dom.TagName.MENUITEM=new goog.dom.TagName("MENUITEM");goog.dom.TagName.META=new goog.dom.TagName("META");goog.dom.TagName.METER=new goog.dom.TagName("METER");goog.dom.TagName.NAV=new goog.dom.TagName("NAV");goog.dom.TagName.NOFRAMES=new goog.dom.TagName("NOFRAMES");goog.dom.TagName.NOSCRIPT=new goog.dom.TagName("NOSCRIPT");goog.dom.TagName.OBJECT=new goog.dom.TagName("OBJECT");goog.dom.TagName.OL=new goog.dom.TagName("OL");goog.dom.TagName.OPTGROUP=new goog.dom.TagName("OPTGROUP");goog.dom.TagName.OPTION=new goog.dom.TagName("OPTION");goog.dom.TagName.OUTPUT=new goog.dom.TagName("OUTPUT");goog.dom.TagName.P=new goog.dom.TagName("P");goog.dom.TagName.PARAM=new goog.dom.TagName("PARAM");goog.dom.TagName.PICTURE=new goog.dom.TagName("PICTURE");goog.dom.TagName.PRE=new goog.dom.TagName("PRE");goog.dom.TagName.PROGRESS=new goog.dom.TagName("PROGRESS");goog.dom.TagName.Q=new goog.dom.TagName("Q");goog.dom.TagName.RP=new goog.dom.TagName("RP");goog.dom.TagName.RT=new goog.dom.TagName("RT");goog.dom.TagName.RTC=new goog.dom.TagName("RTC");goog.dom.TagName.RUBY=new goog.dom.TagName("RUBY");goog.dom.TagName.S=new goog.dom.TagName("S");goog.dom.TagName.SAMP=new goog.dom.TagName("SAMP");goog.dom.TagName.SCRIPT=new goog.dom.TagName("SCRIPT");goog.dom.TagName.SECTION=new goog.dom.TagName("SECTION");goog.dom.TagName.SELECT=new goog.dom.TagName("SELECT");goog.dom.TagName.SMALL=new goog.dom.TagName("SMALL");goog.dom.TagName.SOURCE=new goog.dom.TagName("SOURCE");goog.dom.TagName.SPAN=new goog.dom.TagName("SPAN");goog.dom.TagName.STRIKE=new goog.dom.TagName("STRIKE");goog.dom.TagName.STRONG=new goog.dom.TagName("STRONG");goog.dom.TagName.STYLE=new goog.dom.TagName("STYLE");goog.dom.TagName.SUB=new goog.dom.TagName("SUB");goog.dom.TagName.SUMMARY=new goog.dom.TagName("SUMMARY");goog.dom.TagName.SUP=new goog.dom.TagName("SUP");goog.dom.TagName.SVG=new goog.dom.TagName("SVG");goog.dom.TagName.TABLE=new goog.dom.TagName("TABLE");goog.dom.TagName.TBODY=new goog.dom.TagName("TBODY");goog.dom.TagName.TD=new goog.dom.TagName("TD");goog.dom.TagName.TEMPLATE=new goog.dom.TagName("TEMPLATE");goog.dom.TagName.TEXTAREA=new goog.dom.TagName("TEXTAREA");goog.dom.TagName.TFOOT=new goog.dom.TagName("TFOOT");goog.dom.TagName.TH=new goog.dom.TagName("TH");goog.dom.TagName.THEAD=new goog.dom.TagName("THEAD");goog.dom.TagName.TIME=new goog.dom.TagName("TIME");goog.dom.TagName.TITLE=new goog.dom.TagName("TITLE");goog.dom.TagName.TR=new goog.dom.TagName("TR");goog.dom.TagName.TRACK=new goog.dom.TagName("TRACK");goog.dom.TagName.TT=new goog.dom.TagName("TT");goog.dom.TagName.U=new goog.dom.TagName("U");goog.dom.TagName.UL=new goog.dom.TagName("UL");goog.dom.TagName.VAR=new goog.dom.TagName("VAR");goog.dom.TagName.VIDEO=new goog.dom.TagName("VIDEO");goog.dom.TagName.WBR=new goog.dom.TagName("WBR");goog.provide("goog.dom.tags");goog.require("goog.object");goog.dom.tags.VOID_TAGS_=goog.object.createSet("area","base","br","col","command","embed","hr","img","input","keygen","link","meta","param","source","track","wbr");goog.dom.tags.isVoidTag=function(e){return true===goog.dom.tags.VOID_TAGS_[e]};goog.provide("goog.dom.vendor");goog.require("goog.string");goog.require("goog.userAgent");goog.dom.vendor.getVendorJsPrefix=function(){if(goog.userAgent.WEBKIT)return"Webkit";else if(goog.userAgent.GECKO)return"Moz";else if(goog.userAgent.IE)return"ms";else if(goog.userAgent.OPERA)return"O";return null};goog.dom.vendor.getVendorPrefix=function(){if(goog.userAgent.WEBKIT)return"-webkit";else if(goog.userAgent.GECKO)return"-moz";else if(goog.userAgent.IE)return"-ms";else if(goog.userAgent.OPERA)return"-o";return null};goog.dom.vendor.getPrefixedPropertyName=function(e,o){if(o&&e in o)return e;var t=goog.dom.vendor.getVendorJsPrefix();if(t){t=t.toLowerCase();var i=t+goog.string.toTitleCase(e);return!goog.isDef(o)||i in o?i:null}return null};goog.dom.vendor.getPrefixedEventType=function(e){var o=goog.dom.vendor.getVendorJsPrefix()||"";return(o+e).toLowerCase()};goog.provide("goog.events.Event");goog.provide("goog.events.EventLike");goog.require("goog.Disposable");goog.require("goog.events.EventId");goog.events.EventLike;goog.events.Event=function(e,o){this.type=e instanceof goog.events.EventId?String(e):e;this.target=o;this.currentTarget=this.target;this.propagationStopped_=false;this.defaultPrevented=false;this.returnValue_=true};goog.events.Event.prototype.stopPropagation=function(){this.propagationStopped_=true};goog.events.Event.prototype.preventDefault=function(){this.defaultPrevented=true;this.returnValue_=false};goog.events.Event.stopPropagation=function(e){e.stopPropagation()};goog.events.Event.preventDefault=function(e){e.preventDefault()};goog.provide("goog.events.BrowserEvent");goog.provide("goog.events.BrowserEvent.MouseButton");goog.provide("goog.events.BrowserEvent.PointerType");goog.require("goog.debug");goog.require("goog.events.BrowserFeature");goog.require("goog.events.Event");goog.require("goog.events.EventType");goog.require("goog.reflect");goog.require("goog.userAgent");goog.events.BrowserEvent=function(e,o){goog.events.BrowserEvent.base(this,"constructor",e?e.type:"");this.target=null;this.currentTarget=null;this.relatedTarget=null;this.offsetX=0;this.offsetY=0;this.clientX=0;this.clientY=0;this.screenX=0;this.screenY=0;this.button=0;this.key="";this.keyCode=0;this.charCode=0;this.ctrlKey=false;this.altKey=false;this.shiftKey=false;this.metaKey=false;this.state=null;this.platformModifierKey=false;this.pointerId=0;this.pointerType="";this.event_=null;if(e)this.init(e,o)};goog.inherits(goog.events.BrowserEvent,goog.events.Event);goog.events.BrowserEvent.MouseButton={LEFT:0,MIDDLE:1,RIGHT:2};goog.events.BrowserEvent.PointerType={MOUSE:"mouse",PEN:"pen",TOUCH:"touch"};goog.events.BrowserEvent.IEButtonMap=goog.debug.freeze([1,4,2]);goog.events.BrowserEvent.IE_BUTTON_MAP=goog.events.BrowserEvent.IEButtonMap;goog.events.BrowserEvent.IE_POINTER_TYPE_MAP=goog.debug.freeze({2:goog.events.BrowserEvent.PointerType.TOUCH,3:goog.events.BrowserEvent.PointerType.PEN,4:goog.events.BrowserEvent.PointerType.MOUSE});goog.events.BrowserEvent.prototype.init=function(e,o){var t=this.type=e.type;var i=e.changedTouches?e.changedTouches[0]:null;this.target=e.target||e.srcElement;this.currentTarget=o;var r=e.relatedTarget;if(r){if(goog.userAgent.GECKO)if(!goog.reflect.canAccessProperty(r,"nodeName"))r=null}else if(t==goog.events.EventType.MOUSEOVER)r=e.fromElement;else if(t==goog.events.EventType.MOUSEOUT)r=e.toElement;this.relatedTarget=r;if(!goog.isNull(i)){this.clientX=void 0!==i.clientX?i.clientX:i.pageX;this.clientY=void 0!==i.clientY?i.clientY:i.pageY;this.screenX=i.screenX||0;this.screenY=i.screenY||0}else{this.offsetX=goog.userAgent.WEBKIT||void 0!==e.offsetX?e.offsetX:e.layerX;this.offsetY=goog.userAgent.WEBKIT||void 0!==e.offsetY?e.offsetY:e.layerY;this.clientX=void 0!==e.clientX?e.clientX:e.pageX;this.clientY=void 0!==e.clientY?e.clientY:e.pageY;this.screenX=e.screenX||0;this.screenY=e.screenY||0}this.button=e.button;this.keyCode=e.keyCode||0;this.key=e.key||"";this.charCode=e.charCode||("keypress"==t?e.keyCode:0);this.ctrlKey=e.ctrlKey;this.altKey=e.altKey;this.shiftKey=e.shiftKey;this.metaKey=e.metaKey;this.platformModifierKey=goog.userAgent.MAC?e.metaKey:e.ctrlKey;this.pointerId=e.pointerId||0;this.pointerType=goog.events.BrowserEvent.getPointerType_(e);this.state=e.state;this.event_=e;if(e.defaultPrevented)this.preventDefault()};goog.events.BrowserEvent.prototype.isButton=function(e){if(!goog.events.BrowserFeature.HAS_W3C_BUTTON)if("click"==this.type)return e==goog.events.BrowserEvent.MouseButton.LEFT;else return!!(this.event_.button&goog.events.BrowserEvent.IE_BUTTON_MAP[e]);else return this.event_.button==e};goog.events.BrowserEvent.prototype.isMouseActionButton=function(){return this.isButton(goog.events.BrowserEvent.MouseButton.LEFT)&&!(goog.userAgent.WEBKIT&&goog.userAgent.MAC&&this.ctrlKey)};goog.events.BrowserEvent.prototype.stopPropagation=function(){goog.events.BrowserEvent.superClass_.stopPropagation.call(this);if(this.event_.stopPropagation)this.event_.stopPropagation();else this.event_.cancelBubble=true};goog.events.BrowserEvent.prototype.preventDefault=function(){goog.events.BrowserEvent.superClass_.preventDefault.call(this);var e=this.event_;if(!e.preventDefault){e.returnValue=false;if(goog.events.BrowserFeature.SET_KEY_CODE_TO_PREVENT_DEFAULT)try{var o=112;var t=123;if(e.ctrlKey||e.keyCode>=o&&e.keyCode<=t)e.keyCode=-1}catch(e){}}else e.preventDefault()};goog.events.BrowserEvent.prototype.getBrowserEvent=function(){return this.event_};goog.events.BrowserEvent.getPointerType_=function(e){if(goog.isString(e.pointerType))return e.pointerType;return goog.events.BrowserEvent.IE_POINTER_TYPE_MAP[e.pointerType]||""};goog.provide("goog.events.BrowserFeature");goog.require("goog.userAgent");goog.scope((function(){goog.events.BrowserFeature={HAS_W3C_BUTTON:!goog.userAgent.IE||goog.userAgent.isDocumentModeOrHigher(9),HAS_W3C_EVENT_SUPPORT:!goog.userAgent.IE||goog.userAgent.isDocumentModeOrHigher(9),SET_KEY_CODE_TO_PREVENT_DEFAULT:goog.userAgent.IE&&!goog.userAgent.isVersionOrHigher("9"),HAS_NAVIGATOR_ONLINE_PROPERTY:!goog.userAgent.WEBKIT||goog.userAgent.isVersionOrHigher("528"),HAS_HTML5_NETWORK_EVENT_SUPPORT:goog.userAgent.GECKO&&goog.userAgent.isVersionOrHigher("1.9b")||goog.userAgent.IE&&goog.userAgent.isVersionOrHigher("8")||goog.userAgent.OPERA&&goog.userAgent.isVersionOrHigher("9.5")||goog.userAgent.WEBKIT&&goog.userAgent.isVersionOrHigher("528"),HTML5_NETWORK_EVENTS_FIRE_ON_BODY:goog.userAgent.GECKO&&!goog.userAgent.isVersionOrHigher("8")||goog.userAgent.IE&&!goog.userAgent.isVersionOrHigher("9"),TOUCH_ENABLED:"ontouchstart"in goog.global||!!(goog.global["document"]&&document.documentElement&&"ontouchstart"in document.documentElement)||!!(goog.global["navigator"]&&(goog.global["navigator"]["maxTouchPoints"]||goog.global["navigator"]["msMaxTouchPoints"])),POINTER_EVENTS:"PointerEvent"in goog.global,MSPOINTER_EVENTS:"MSPointerEvent"in goog.global&&!!(goog.global["navigator"]&&goog.global["navigator"]["msPointerEnabled"]),PASSIVE_EVENTS:e((function(){if(!goog.global.addEventListener||!Object.defineProperty)return false;var e=false;var o=Object.defineProperty({},"passive",{get:function(){e=true}});goog.global.addEventListener("test",goog.nullFunction,o);goog.global.removeEventListener("test",goog.nullFunction,o);return e}))};function e(e){return{valueOf:e}.valueOf()}}));goog.provide("goog.events.EventHandler");goog.require("goog.Disposable");goog.require("goog.events");goog.require("goog.object");goog.forwardDeclare("goog.events.EventWrapper");goog.events.EventHandler=function(e){goog.Disposable.call(this);this.handler_=e;this.keys_={}};goog.inherits(goog.events.EventHandler,goog.Disposable);goog.events.EventHandler.typeArray_=[];goog.events.EventHandler.prototype.listen=function(e,o,t,i){var r=this;return r.listen_(e,o,t,i)};goog.events.EventHandler.prototype.listenWithScope=function(e,o,t,i,r){var n=this;return n.listen_(e,o,t,i,r)};goog.events.EventHandler.prototype.listen_=function(e,o,t,i,r){var n=this;if(!goog.isArray(o)){if(o)goog.events.EventHandler.typeArray_[0]=o.toString();o=goog.events.EventHandler.typeArray_}for(var l=0;l<o.length;l++){var s=goog.events.listen(e,o[l],t||n.handleEvent,i||false,r||n.handler_||n);if(!s)return n;var g=s.key;n.keys_[g]=s}return n};goog.events.EventHandler.prototype.listenOnce=function(e,o,t,i){var r=this;return r.listenOnce_(e,o,t,i)};goog.events.EventHandler.prototype.listenOnceWithScope=function(e,o,t,i,r){var n=this;return n.listenOnce_(e,o,t,i,r)};goog.events.EventHandler.prototype.listenOnce_=function(e,o,t,i,r){var n=this;if(goog.isArray(o))for(var l=0;l<o.length;l++)n.listenOnce_(e,o[l],t,i,r);else{var s=goog.events.listenOnce(e,o,t||n.handleEvent,i,r||n.handler_||n);if(!s)return n;var g=s.key;n.keys_[g]=s}return n};goog.events.EventHandler.prototype.listenWithWrapper=function(e,o,t,i){var r=this;return r.listenWithWrapper_(e,o,t,i)};goog.events.EventHandler.prototype.listenWithWrapperAndScope=function(e,o,t,i,r){var n=this;return n.listenWithWrapper_(e,o,t,i,r)};goog.events.EventHandler.prototype.listenWithWrapper_=function(e,o,t,i,r){var n=this;o.listen(e,t,i,r||n.handler_||n,n);return n};goog.events.EventHandler.prototype.getListenerCount=function(){var e=0;for(var o in this.keys_)if(Object.prototype.hasOwnProperty.call(this.keys_,o))e++;return e};goog.events.EventHandler.prototype.unlisten=function(e,o,t,i,r){var n=this;if(goog.isArray(o))for(var l=0;l<o.length;l++)n.unlisten(e,o[l],t,i,r);else{var s=goog.isObject(i)?!!i.capture:!!i;var g=goog.events.getListener(e,o,t||n.handleEvent,s,r||n.handler_||n);if(g){goog.events.unlistenByKey(g);delete n.keys_[g.key]}}return n};goog.events.EventHandler.prototype.unlistenWithWrapper=function(e,o,t,i,r){var n=this;o.unlisten(e,t,i,r||n.handler_||n,n);return n};goog.events.EventHandler.prototype.removeAll=function(){goog.object.forEach(this.keys_,(function(e,o){if(this.keys_.hasOwnProperty(o))goog.events.unlistenByKey(e)}),this);this.keys_={}};goog.events.EventHandler.prototype.disposeInternal=function(){goog.events.EventHandler.superClass_.disposeInternal.call(this);this.removeAll()};goog.events.EventHandler.prototype.handleEvent=function(e){throw new Error("EventHandler.handleEvent not implemented")};goog.provide("goog.events.EventId");goog.events.EventId=function(e){this.id=e};goog.events.EventId.prototype.toString=function(){return this.id};goog.provide("goog.events");goog.provide("goog.events.CaptureSimulationMode");goog.provide("goog.events.Key");goog.provide("goog.events.ListenableType");goog.require("goog.asserts");goog.require("goog.debug.entryPointRegistry");goog.require("goog.events.BrowserEvent");goog.require("goog.events.BrowserFeature");goog.require("goog.events.Listenable");goog.require("goog.events.ListenerMap");goog.forwardDeclare("goog.debug.ErrorHandler");goog.forwardDeclare("goog.events.EventWrapper");goog.events.Key;goog.events.ListenableType;goog.events.LISTENER_MAP_PROP_="closure_lm_"+(1e6*Math.random()|0);goog.events.onString_="on";goog.events.onStringMap_={};goog.events.CaptureSimulationMode={OFF_AND_FAIL:0,OFF_AND_SILENT:1,ON:2};goog.define("goog.events.CAPTURE_SIMULATION_MODE",2);goog.events.listenerCountEstimate_=0;goog.events.listen=function(e,o,t,i,r){if(i&&i.once)return goog.events.listenOnce(e,o,t,i,r);if(goog.isArray(o)){for(var n=0;n<o.length;n++)goog.events.listen(e,o[n],t,i,r);return null}t=goog.events.wrapListener(t);if(goog.events.Listenable.isImplementedBy(e)){var l=goog.isObject(i)?!!i.capture:!!i;return e.listen(o,t,l,r)}else return goog.events.listen_(e,o,t,false,i,r)};goog.events.listen_=function(e,o,t,i,r,n){if(!o)throw new Error("Invalid event type");var l=goog.isObject(r)?!!r.capture:!!r;if(l&&!goog.events.BrowserFeature.HAS_W3C_EVENT_SUPPORT)if(goog.events.CAPTURE_SIMULATION_MODE==goog.events.CaptureSimulationMode.OFF_AND_FAIL){goog.asserts.fail("Can not register capture listener in IE8-.");return null}else if(goog.events.CAPTURE_SIMULATION_MODE==goog.events.CaptureSimulationMode.OFF_AND_SILENT)return null;var s=goog.events.getListenerMap_(e);if(!s)e[goog.events.LISTENER_MAP_PROP_]=s=new goog.events.ListenerMap(e);var g=s.add(o,t,i,l,n);if(g.proxy)return g;var a=goog.events.getProxy();g.proxy=a;a.src=e;a.listener=g;if(e.addEventListener){if(!goog.events.BrowserFeature.PASSIVE_EVENTS)r=l;if(void 0===r)r=false;e.addEventListener(o.toString(),a,r)}else if(e.attachEvent)e.attachEvent(goog.events.getOnString_(o.toString()),a);else if(e.addListener&&e.removeListener){goog.asserts.assert("change"===o,"MediaQueryList only has a change event");e.addListener(a)}else throw new Error("addEventListener and attachEvent are unavailable.");goog.events.listenerCountEstimate_++;return g};goog.events.getProxy=function(){var e=goog.events.handleBrowserEvent_;var o=goog.events.BrowserFeature.HAS_W3C_EVENT_SUPPORT?function(t){return e.call(o.src,o.listener,t)}:function(t){var i=e.call(o.src,o.listener,t);if(!i)return i};return o};goog.events.listenOnce=function(e,o,t,i,r){if(goog.isArray(o)){for(var n=0;n<o.length;n++)goog.events.listenOnce(e,o[n],t,i,r);return null}t=goog.events.wrapListener(t);if(goog.events.Listenable.isImplementedBy(e)){var l=goog.isObject(i)?!!i.capture:!!i;return e.listenOnce(o,t,l,r)}else return goog.events.listen_(e,o,t,true,i,r)};goog.events.listenWithWrapper=function(e,o,t,i,r){o.listen(e,t,i,r)};goog.events.unlisten=function(e,o,t,i,r){if(goog.isArray(o)){for(var n=0;n<o.length;n++)goog.events.unlisten(e,o[n],t,i,r);return null}var l=goog.isObject(i)?!!i.capture:!!i;t=goog.events.wrapListener(t);if(goog.events.Listenable.isImplementedBy(e))return e.unlisten(o,t,l,r);if(!e)return false;var s=goog.events.getListenerMap_(e);if(s){var g=s.getListener(o,t,l,r);if(g)return goog.events.unlistenByKey(g)}return false};goog.events.unlistenByKey=function(e){if(goog.isNumber(e))return false;var o=e;if(!o||o.removed)return false;var t=o.src;if(goog.events.Listenable.isImplementedBy(t))return t.unlistenByKey(o);var i=o.type;var r=o.proxy;if(t.removeEventListener)t.removeEventListener(i,r,o.capture);else if(t.detachEvent)t.detachEvent(goog.events.getOnString_(i),r);else if(t.addListener&&t.removeListener)t.removeListener(r);goog.events.listenerCountEstimate_--;var n=goog.events.getListenerMap_(t);if(n){n.removeByKey(o);if(0==n.getTypeCount()){n.src=null;t[goog.events.LISTENER_MAP_PROP_]=null}}else o.markAsRemoved();return true};goog.events.unlistenWithWrapper=function(e,o,t,i,r){o.unlisten(e,t,i,r)};goog.events.removeAll=function(e,o){if(!e)return 0;if(goog.events.Listenable.isImplementedBy(e))return e.removeAllListeners(o);var t=goog.events.getListenerMap_(e);if(!t)return 0;var i=0;var r=o&&o.toString();for(var n in t.listeners)if(!r||n==r){var l=t.listeners[n].concat();for(var s=0;s<l.length;++s)if(goog.events.unlistenByKey(l[s]))++i}return i};goog.events.getListeners=function(e,o,t){if(goog.events.Listenable.isImplementedBy(e))return e.getListeners(o,t);else{if(!e)return[];var i=goog.events.getListenerMap_(e);return i?i.getListeners(o,t):[]}};goog.events.getListener=function(e,o,t,i,r){o=o;t=goog.events.wrapListener(t);var n=!!i;if(goog.events.Listenable.isImplementedBy(e))return e.getListener(o,t,n,r);if(!e)return null;var l=goog.events.getListenerMap_(e);if(l)return l.getListener(o,t,n,r);return null};goog.events.hasListener=function(e,o,t){if(goog.events.Listenable.isImplementedBy(e))return e.hasListener(o,t);var i=goog.events.getListenerMap_(e);return!!i&&i.hasListener(o,t)};goog.events.expose=function(e){var o=[];for(var t in e)if(e[t]&&e[t].id)o.push(t+" = "+e[t]+" ("+e[t].id+")");else o.push(t+" = "+e[t]);return o.join("\n")};goog.events.getOnString_=function(e){if(e in goog.events.onStringMap_)return goog.events.onStringMap_[e];return goog.events.onStringMap_[e]=goog.events.onString_+e};goog.events.fireListeners=function(e,o,t,i){if(goog.events.Listenable.isImplementedBy(e))return e.fireListeners(o,t,i);return goog.events.fireListeners_(e,o,t,i)};goog.events.fireListeners_=function(e,o,t,i){var r=true;var n=goog.events.getListenerMap_(e);if(n){var l=n.listeners[o.toString()];if(l){l=l.concat();for(var s=0;s<l.length;s++){var g=l[s];if(g&&g.capture==t&&!g.removed){var a=goog.events.fireListener(g,i);r=r&&false!==a}}}}return r};goog.events.fireListener=function(e,o){var t=e.listener;var i=e.handler||e.src;if(e.callOnce)goog.events.unlistenByKey(e);return t.call(i,o)};goog.events.getTotalListenerCount=function(){return goog.events.listenerCountEstimate_};goog.events.dispatchEvent=function(e,o){goog.asserts.assert(goog.events.Listenable.isImplementedBy(e),"Can not use goog.events.dispatchEvent with "+"non-goog.events.Listenable instance.");return e.dispatchEvent(o)};goog.events.protectBrowserEventEntryPoint=function(e){goog.events.handleBrowserEvent_=e.protectEntryPoint(goog.events.handleBrowserEvent_)};goog.events.handleBrowserEvent_=function(e,o){if(e.removed)return true;if(!goog.events.BrowserFeature.HAS_W3C_EVENT_SUPPORT){var t=o||goog.getObjectByName("window.event");var i=new goog.events.BrowserEvent(t,this);var r=true;if(goog.events.CAPTURE_SIMULATION_MODE==goog.events.CaptureSimulationMode.ON){if(!goog.events.isMarkedIeEvent_(t)){goog.events.markIeEvent_(t);var n=[];for(var l=i.currentTarget;l;l=l.parentNode)n.push(l);var s=e.type;for(var g=n.length-1;!i.propagationStopped_&&g>=0;g--){i.currentTarget=n[g];var a=goog.events.fireListeners_(n[g],s,true,i);r=r&&a}for(var g=0;!i.propagationStopped_&&g<n.length;g++){i.currentTarget=n[g];var a=goog.events.fireListeners_(n[g],s,false,i);r=r&&a}}}else r=goog.events.fireListener(e,i);return r}return goog.events.fireListener(e,new goog.events.BrowserEvent(o,this))};goog.events.markIeEvent_=function(e){var o=false;if(0==e.keyCode)try{e.keyCode=-1;return}catch(e){o=true}if(o||void 0==e.returnValue)e.returnValue=true};goog.events.isMarkedIeEvent_=function(e){return e.keyCode<0||void 0!=e.returnValue};goog.events.uniqueIdCounter_=0;goog.events.getUniqueId=function(e){return e+"_"+goog.events.uniqueIdCounter_++};goog.events.getListenerMap_=function(e){var o=e[goog.events.LISTENER_MAP_PROP_];return o instanceof goog.events.ListenerMap?o:null};goog.events.LISTENER_WRAPPER_PROP_="__closure_events_fn_"+(1e9*Math.random()>>>0);goog.events.wrapListener=function(e){goog.asserts.assert(e,"Listener can not be null.");if(goog.isFunction(e))return e;goog.asserts.assert(e.handleEvent,"An object listener must have handleEvent method.");if(!e[goog.events.LISTENER_WRAPPER_PROP_])e[goog.events.LISTENER_WRAPPER_PROP_]=function(o){return e.handleEvent(o)};return e[goog.events.LISTENER_WRAPPER_PROP_]};goog.debug.entryPointRegistry.register((function(e){goog.events.handleBrowserEvent_=e(goog.events.handleBrowserEvent_)}));goog.provide("goog.events.Listenable");goog.provide("goog.events.ListenableKey");goog.require("goog.events.EventId");goog.forwardDeclare("goog.events.EventLike");goog.forwardDeclare("goog.events.EventTarget");goog.events.Listenable=function(){};goog.events.Listenable.IMPLEMENTED_BY_PROP="closure_listenable_"+(1e6*Math.random()|0);goog.events.Listenable.addImplementation=function(e){e.prototype[goog.events.Listenable.IMPLEMENTED_BY_PROP]=true};goog.events.Listenable.isImplementedBy=function(e){return!!(e&&e[goog.events.Listenable.IMPLEMENTED_BY_PROP])};goog.events.Listenable.prototype.listen;goog.events.Listenable.prototype.listenOnce;goog.events.Listenable.prototype.unlisten;goog.events.Listenable.prototype.unlistenByKey;goog.events.Listenable.prototype.dispatchEvent;goog.events.Listenable.prototype.removeAllListeners;goog.events.Listenable.prototype.getParentEventTarget;goog.events.Listenable.prototype.fireListeners;goog.events.Listenable.prototype.getListeners;goog.events.Listenable.prototype.getListener;goog.events.Listenable.prototype.hasListener;goog.events.ListenableKey=function(){};goog.events.ListenableKey.counter_=0;goog.events.ListenableKey.reserveKey=function(){return++goog.events.ListenableKey.counter_};goog.events.ListenableKey.prototype.src;goog.events.ListenableKey.prototype.type;goog.events.ListenableKey.prototype.listener;goog.events.ListenableKey.prototype.capture;goog.events.ListenableKey.prototype.handler;goog.events.ListenableKey.prototype.key;goog.provide("goog.events.EventTarget");goog.require("goog.Disposable");goog.require("goog.asserts");goog.require("goog.events");goog.require("goog.events.Event");goog.require("goog.events.Listenable");goog.require("goog.events.ListenerMap");goog.require("goog.object");goog.events.EventTarget=function(){goog.Disposable.call(this);this.eventTargetListeners_=new goog.events.ListenerMap(this);this.actualEventTarget_=this;this.parentEventTarget_=null};goog.inherits(goog.events.EventTarget,goog.Disposable);goog.events.Listenable.addImplementation(goog.events.EventTarget);goog.events.EventTarget.MAX_ANCESTORS_=1e3;goog.events.EventTarget.prototype.getParentEventTarget=function(){return this.parentEventTarget_};goog.events.EventTarget.prototype.setParentEventTarget=function(e){this.parentEventTarget_=e};goog.events.EventTarget.prototype.addEventListener=function(e,o,t,i){goog.events.listen(this,e,o,t,i)};goog.events.EventTarget.prototype.removeEventListener=function(e,o,t,i){goog.events.unlisten(this,e,o,t,i)};goog.events.EventTarget.prototype.dispatchEvent=function(e){this.assertInitialized_();var o,t=this.getParentEventTarget();if(t){o=[];var i=1;for(;t;t=t.getParentEventTarget()){o.push(t);goog.asserts.assert(++i<goog.events.EventTarget.MAX_ANCESTORS_,"infinite loop")}}return goog.events.EventTarget.dispatchEventInternal_(this.actualEventTarget_,e,o)};goog.events.EventTarget.prototype.disposeInternal=function(){goog.events.EventTarget.superClass_.disposeInternal.call(this);this.removeAllListeners();this.parentEventTarget_=null};goog.events.EventTarget.prototype.listen=function(e,o,t,i){this.assertInitialized_();return this.eventTargetListeners_.add(String(e),o,false,t,i)};goog.events.EventTarget.prototype.listenOnce=function(e,o,t,i){return this.eventTargetListeners_.add(String(e),o,true,t,i)};goog.events.EventTarget.prototype.unlisten=function(e,o,t,i){return this.eventTargetListeners_.remove(String(e),o,t,i)};goog.events.EventTarget.prototype.unlistenByKey=function(e){return this.eventTargetListeners_.removeByKey(e)};goog.events.EventTarget.prototype.removeAllListeners=function(e){if(!this.eventTargetListeners_)return 0;return this.eventTargetListeners_.removeAll(e)};goog.events.EventTarget.prototype.fireListeners=function(e,o,t){var i=this.eventTargetListeners_.listeners[String(e)];if(!i)return true;i=i.concat();var r=true;for(var n=0;n<i.length;++n){var l=i[n];if(l&&!l.removed&&l.capture==o){var s=l.listener;var g=l.handler||l.src;if(l.callOnce)this.unlistenByKey(l);r=false!==s.call(g,t)&&r}}return r&&false!=t.returnValue_};goog.events.EventTarget.prototype.getListeners=function(e,o){return this.eventTargetListeners_.getListeners(String(e),o)};goog.events.EventTarget.prototype.getListener=function(e,o,t,i){return this.eventTargetListeners_.getListener(String(e),o,t,i)};goog.events.EventTarget.prototype.hasListener=function(e,o){var t=goog.isDef(e)?String(e):void 0;return this.eventTargetListeners_.hasListener(t,o)};goog.events.EventTarget.prototype.setTargetForTesting=function(e){this.actualEventTarget_=e};goog.events.EventTarget.prototype.assertInitialized_=function(){goog.asserts.assert(this.eventTargetListeners_,"Event target is not initialized. Did you call the superclass "+"(goog.events.EventTarget) constructor?")};goog.events.EventTarget.dispatchEventInternal_=function(e,o,t){var i=o.type||o;if(goog.isString(o))o=new goog.events.Event(o,e);else if(!(o instanceof goog.events.Event)){var r=o;o=new goog.events.Event(i,e);goog.object.extend(o,r)}else o.target=o.target||e;var n=true,l;if(t)for(var s=t.length-1;!o.propagationStopped_&&s>=0;s--){l=o.currentTarget=t[s];n=l.fireListeners(i,true,o)&&n}if(!o.propagationStopped_){l=o.currentTarget=e;n=l.fireListeners(i,true,o)&&n;if(!o.propagationStopped_)n=l.fireListeners(i,false,o)&&n}if(t)for(s=0;!o.propagationStopped_&&s<t.length;s++){l=o.currentTarget=t[s];n=l.fireListeners(i,false,o)&&n}return n};goog.provide("goog.events.EventType");goog.provide("goog.events.PointerFallbackEventType");goog.require("goog.events.BrowserFeature");goog.require("goog.userAgent");goog.events.getVendorPrefixedName_=function(e){return goog.userAgent.WEBKIT?"webkit"+e:goog.userAgent.OPERA?"o"+e.toLowerCase():e.toLowerCase()};goog.events.EventType={CLICK:"click",RIGHTCLICK:"rightclick",DBLCLICK:"dblclick",MOUSEDOWN:"mousedown",MOUSEUP:"mouseup",MOUSEOVER:"mouseover",MOUSEOUT:"mouseout",MOUSEMOVE:"mousemove",MOUSEENTER:"mouseenter",MOUSELEAVE:"mouseleave",SELECTIONCHANGE:"selectionchange",SELECTSTART:"selectstart",WHEEL:"wheel",KEYPRESS:"keypress",KEYDOWN:"keydown",KEYUP:"keyup",BLUR:"blur",FOCUS:"focus",DEACTIVATE:"deactivate",FOCUSIN:"focusin",FOCUSOUT:"focusout",CHANGE:"change",RESET:"reset",SELECT:"select",SUBMIT:"submit",INPUT:"input",PROPERTYCHANGE:"propertychange",DRAGSTART:"dragstart",DRAG:"drag",DRAGENTER:"dragenter",DRAGOVER:"dragover",DRAGLEAVE:"dragleave",DROP:"drop",DRAGEND:"dragend",TOUCHSTART:"touchstart",TOUCHMOVE:"touchmove",TOUCHEND:"touchend",TOUCHCANCEL:"touchcancel",BEFOREUNLOAD:"beforeunload",CONSOLEMESSAGE:"consolemessage",CONTEXTMENU:"contextmenu",DEVICECHANGE:"devicechange",DEVICEMOTION:"devicemotion",DEVICEORIENTATION:"deviceorientation",DOMCONTENTLOADED:"DOMContentLoaded",ERROR:"error",HELP:"help",LOAD:"load",LOSECAPTURE:"losecapture",ORIENTATIONCHANGE:"orientationchange",READYSTATECHANGE:"readystatechange",RESIZE:"resize",SCROLL:"scroll",UNLOAD:"unload",CANPLAY:"canplay",CANPLAYTHROUGH:"canplaythrough",DURATIONCHANGE:"durationchange",EMPTIED:"emptied",ENDED:"ended",LOADEDDATA:"loadeddata",LOADEDMETADATA:"loadedmetadata",PAUSE:"pause",PLAY:"play",PLAYING:"playing",RATECHANGE:"ratechange",SEEKED:"seeked",SEEKING:"seeking",STALLED:"stalled",SUSPEND:"suspend",TIMEUPDATE:"timeupdate",VOLUMECHANGE:"volumechange",WAITING:"waiting",SOURCEOPEN:"sourceopen",SOURCEENDED:"sourceended",SOURCECLOSED:"sourceclosed",ABORT:"abort",UPDATE:"update",UPDATESTART:"updatestart",UPDATEEND:"updateend",HASHCHANGE:"hashchange",PAGEHIDE:"pagehide",PAGESHOW:"pageshow",POPSTATE:"popstate",COPY:"copy",PASTE:"paste",CUT:"cut",BEFORECOPY:"beforecopy",BEFORECUT:"beforecut",BEFOREPASTE:"beforepaste",ONLINE:"online",OFFLINE:"offline",MESSAGE:"message",CONNECT:"connect",INSTALL:"install",ACTIVATE:"activate",FETCH:"fetch",FOREIGNFETCH:"foreignfetch",MESSAGEERROR:"messageerror",STATECHANGE:"statechange",UPDATEFOUND:"updatefound",CONTROLLERCHANGE:"controllerchange",ANIMATIONSTART:goog.events.getVendorPrefixedName_("AnimationStart"),ANIMATIONEND:goog.events.getVendorPrefixedName_("AnimationEnd"),ANIMATIONITERATION:goog.events.getVendorPrefixedName_("AnimationIteration"),TRANSITIONEND:goog.events.getVendorPrefixedName_("TransitionEnd"),POINTERDOWN:"pointerdown",POINTERUP:"pointerup",POINTERCANCEL:"pointercancel",POINTERMOVE:"pointermove",POINTEROVER:"pointerover",POINTEROUT:"pointerout",POINTERENTER:"pointerenter",POINTERLEAVE:"pointerleave",GOTPOINTERCAPTURE:"gotpointercapture",LOSTPOINTERCAPTURE:"lostpointercapture",MSGESTURECHANGE:"MSGestureChange",MSGESTUREEND:"MSGestureEnd",MSGESTUREHOLD:"MSGestureHold",MSGESTURESTART:"MSGestureStart",MSGESTURETAP:"MSGestureTap",MSGOTPOINTERCAPTURE:"MSGotPointerCapture",MSINERTIASTART:"MSInertiaStart",MSLOSTPOINTERCAPTURE:"MSLostPointerCapture",MSPOINTERCANCEL:"MSPointerCancel",MSPOINTERDOWN:"MSPointerDown",MSPOINTERENTER:"MSPointerEnter",MSPOINTERHOVER:"MSPointerHover",MSPOINTERLEAVE:"MSPointerLeave",MSPOINTERMOVE:"MSPointerMove",MSPOINTEROUT:"MSPointerOut",MSPOINTEROVER:"MSPointerOver",MSPOINTERUP:"MSPointerUp",TEXT:"text",TEXTINPUT:goog.userAgent.IE?"textinput":"textInput",COMPOSITIONSTART:"compositionstart",COMPOSITIONUPDATE:"compositionupdate",COMPOSITIONEND:"compositionend",BEFOREINPUT:"beforeinput",EXIT:"exit",LOADABORT:"loadabort",LOADCOMMIT:"loadcommit",LOADREDIRECT:"loadredirect",LOADSTART:"loadstart",LOADSTOP:"loadstop",RESPONSIVE:"responsive",SIZECHANGED:"sizechanged",UNRESPONSIVE:"unresponsive",VISIBILITYCHANGE:"visibilitychange",STORAGE:"storage",DOMSUBTREEMODIFIED:"DOMSubtreeModified",DOMNODEINSERTED:"DOMNodeInserted",DOMNODEREMOVED:"DOMNodeRemoved",DOMNODEREMOVEDFROMDOCUMENT:"DOMNodeRemovedFromDocument",DOMNODEINSERTEDINTODOCUMENT:"DOMNodeInsertedIntoDocument",DOMATTRMODIFIED:"DOMAttrModified",DOMCHARACTERDATAMODIFIED:"DOMCharacterDataModified",BEFOREPRINT:"beforeprint",AFTERPRINT:"afterprint",BEFOREINSTALLPROMPT:"beforeinstallprompt",APPINSTALLED:"appinstalled"};goog.events.getPointerFallbackEventName_=function(e,o,t){if(goog.events.BrowserFeature.POINTER_EVENTS)return e;if(goog.events.BrowserFeature.MSPOINTER_EVENTS)return o;return t};goog.events.PointerFallbackEventType={POINTERDOWN:goog.events.getPointerFallbackEventName_(goog.events.EventType.POINTERDOWN,goog.events.EventType.MSPOINTERDOWN,goog.events.EventType.MOUSEDOWN),POINTERUP:goog.events.getPointerFallbackEventName_(goog.events.EventType.POINTERUP,goog.events.EventType.MSPOINTERUP,goog.events.EventType.MOUSEUP),POINTERCANCEL:goog.events.getPointerFallbackEventName_(goog.events.EventType.POINTERCANCEL,goog.events.EventType.MSPOINTERCANCEL,"mousecancel"),POINTERMOVE:goog.events.getPointerFallbackEventName_(goog.events.EventType.POINTERMOVE,goog.events.EventType.MSPOINTERMOVE,goog.events.EventType.MOUSEMOVE),POINTEROVER:goog.events.getPointerFallbackEventName_(goog.events.EventType.POINTEROVER,goog.events.EventType.MSPOINTEROVER,goog.events.EventType.MOUSEOVER),POINTEROUT:goog.events.getPointerFallbackEventName_(goog.events.EventType.POINTEROUT,goog.events.EventType.MSPOINTEROUT,goog.events.EventType.MOUSEOUT),POINTERENTER:goog.events.getPointerFallbackEventName_(goog.events.EventType.POINTERENTER,goog.events.EventType.MSPOINTERENTER,goog.events.EventType.MOUSEENTER),POINTERLEAVE:goog.events.getPointerFallbackEventName_(goog.events.EventType.POINTERLEAVE,goog.events.EventType.MSPOINTERLEAVE,goog.events.EventType.MOUSELEAVE)};goog.provide("goog.events.FocusHandler");goog.provide("goog.events.FocusHandler.EventType");goog.require("goog.events");goog.require("goog.events.BrowserEvent");goog.require("goog.events.EventTarget");goog.require("goog.userAgent");goog.events.FocusHandler=function(e){goog.events.EventTarget.call(this);this.element_=e;var o=goog.userAgent.IE?"focusin":"focus";var t=goog.userAgent.IE?"focusout":"blur";this.listenKeyIn_=goog.events.listen(this.element_,o,this,!goog.userAgent.IE);this.listenKeyOut_=goog.events.listen(this.element_,t,this,!goog.userAgent.IE)};goog.inherits(goog.events.FocusHandler,goog.events.EventTarget);goog.events.FocusHandler.EventType={FOCUSIN:"focusin",FOCUSOUT:"focusout"};goog.events.FocusHandler.prototype.handleEvent=function(e){var o=e.getBrowserEvent();var t=new goog.events.BrowserEvent(o);t.type="focusin"==e.type||"focus"==e.type?goog.events.FocusHandler.EventType.FOCUSIN:goog.events.FocusHandler.EventType.FOCUSOUT;this.dispatchEvent(t)};goog.events.FocusHandler.prototype.disposeInternal=function(){goog.events.FocusHandler.superClass_.disposeInternal.call(this);goog.events.unlistenByKey(this.listenKeyIn_);goog.events.unlistenByKey(this.listenKeyOut_);delete this.element_};goog.provide("goog.events.KeyCodes");goog.require("goog.userAgent");goog.forwardDeclare("goog.events.BrowserEvent");goog.events.KeyCodes={WIN_KEY_FF_LINUX:0,MAC_ENTER:3,BACKSPACE:8,TAB:9,NUM_CENTER:12,ENTER:13,SHIFT:16,CTRL:17,ALT:18,PAUSE:19,CAPS_LOCK:20,ESC:27,SPACE:32,PAGE_UP:33,PAGE_DOWN:34,END:35,HOME:36,LEFT:37,UP:38,RIGHT:39,DOWN:40,PLUS_SIGN:43,PRINT_SCREEN:44,INSERT:45,DELETE:46,ZERO:48,ONE:49,TWO:50,THREE:51,FOUR:52,FIVE:53,SIX:54,SEVEN:55,EIGHT:56,NINE:57,FF_SEMICOLON:59,FF_EQUALS:61,FF_DASH:173,QUESTION_MARK:63,AT_SIGN:64,A:65,B:66,C:67,D:68,E:69,F:70,G:71,H:72,I:73,J:74,K:75,L:76,M:77,N:78,O:79,P:80,Q:81,R:82,S:83,T:84,U:85,V:86,W:87,X:88,Y:89,Z:90,META:91,WIN_KEY_RIGHT:92,CONTEXT_MENU:93,NUM_ZERO:96,NUM_ONE:97,NUM_TWO:98,NUM_THREE:99,NUM_FOUR:100,NUM_FIVE:101,NUM_SIX:102,NUM_SEVEN:103,NUM_EIGHT:104,NUM_NINE:105,NUM_MULTIPLY:106,NUM_PLUS:107,NUM_MINUS:109,NUM_PERIOD:110,NUM_DIVISION:111,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,NUMLOCK:144,SCROLL_LOCK:145,FIRST_MEDIA_KEY:166,LAST_MEDIA_KEY:183,SEMICOLON:186,DASH:189,EQUALS:187,COMMA:188,PERIOD:190,SLASH:191,APOSTROPHE:192,TILDE:192,SINGLE_QUOTE:222,OPEN_SQUARE_BRACKET:219,BACKSLASH:220,CLOSE_SQUARE_BRACKET:221,WIN_KEY:224,MAC_FF_META:224,MAC_WK_CMD_LEFT:91,MAC_WK_CMD_RIGHT:93,WIN_IME:229,VK_NONAME:252,PHANTOM:255};goog.events.KeyCodes.isTextModifyingKeyEvent=function(e){if(e.altKey&&!e.ctrlKey||e.metaKey||e.keyCode>=goog.events.KeyCodes.F1&&e.keyCode<=goog.events.KeyCodes.F12)return false;switch(e.keyCode){case goog.events.KeyCodes.ALT:case goog.events.KeyCodes.CAPS_LOCK:case goog.events.KeyCodes.CONTEXT_MENU:case goog.events.KeyCodes.CTRL:case goog.events.KeyCodes.DOWN:case goog.events.KeyCodes.END:case goog.events.KeyCodes.ESC:case goog.events.KeyCodes.HOME:case goog.events.KeyCodes.INSERT:case goog.events.KeyCodes.LEFT:case goog.events.KeyCodes.MAC_FF_META:case goog.events.KeyCodes.META:case goog.events.KeyCodes.NUMLOCK:case goog.events.KeyCodes.NUM_CENTER:case goog.events.KeyCodes.PAGE_DOWN:case goog.events.KeyCodes.PAGE_UP:case goog.events.KeyCodes.PAUSE:case goog.events.KeyCodes.PHANTOM:case goog.events.KeyCodes.PRINT_SCREEN:case goog.events.KeyCodes.RIGHT:case goog.events.KeyCodes.SCROLL_LOCK:case goog.events.KeyCodes.SHIFT:case goog.events.KeyCodes.UP:case goog.events.KeyCodes.VK_NONAME:case goog.events.KeyCodes.WIN_KEY:case goog.events.KeyCodes.WIN_KEY_RIGHT:return false;case goog.events.KeyCodes.WIN_KEY_FF_LINUX:return!goog.userAgent.GECKO;default:return e.keyCode<goog.events.KeyCodes.FIRST_MEDIA_KEY||e.keyCode>goog.events.KeyCodes.LAST_MEDIA_KEY}};goog.events.KeyCodes.firesKeyPressEvent=function(e,o,t,i,r,n){if(!goog.userAgent.IE&&!goog.userAgent.EDGE&&!(goog.userAgent.WEBKIT&&goog.userAgent.isVersionOrHigher("525")))return true;if(goog.userAgent.MAC&&r)return goog.events.KeyCodes.isCharacterKey(e);if(r&&!i)return false;if(goog.isNumber(o))o=goog.events.KeyCodes.normalizeKeyCode(o);var l=o==goog.events.KeyCodes.CTRL||o==goog.events.KeyCodes.ALT||goog.userAgent.MAC&&o==goog.events.KeyCodes.META;var s=o==goog.events.KeyCodes.SHIFT&&(i||n);if((!t||goog.userAgent.MAC)&&l||goog.userAgent.MAC&&s)return false;if((goog.userAgent.WEBKIT||goog.userAgent.EDGE)&&i&&t)switch(e){case goog.events.KeyCodes.BACKSLASH:case goog.events.KeyCodes.OPEN_SQUARE_BRACKET:case goog.events.KeyCodes.CLOSE_SQUARE_BRACKET:case goog.events.KeyCodes.TILDE:case goog.events.KeyCodes.SEMICOLON:case goog.events.KeyCodes.DASH:case goog.events.KeyCodes.EQUALS:case goog.events.KeyCodes.COMMA:case goog.events.KeyCodes.PERIOD:case goog.events.KeyCodes.SLASH:case goog.events.KeyCodes.APOSTROPHE:case goog.events.KeyCodes.SINGLE_QUOTE:return false}if(goog.userAgent.IE&&i&&o==e)return false;switch(e){case goog.events.KeyCodes.ENTER:return true;case goog.events.KeyCodes.ESC:return!(goog.userAgent.WEBKIT||goog.userAgent.EDGE)}return goog.events.KeyCodes.isCharacterKey(e)};goog.events.KeyCodes.isCharacterKey=function(e){if(e>=goog.events.KeyCodes.ZERO&&e<=goog.events.KeyCodes.NINE)return true;if(e>=goog.events.KeyCodes.NUM_ZERO&&e<=goog.events.KeyCodes.NUM_MULTIPLY)return true;if(e>=goog.events.KeyCodes.A&&e<=goog.events.KeyCodes.Z)return true;if((goog.userAgent.WEBKIT||goog.userAgent.EDGE)&&0==e)return true;switch(e){case goog.events.KeyCodes.SPACE:case goog.events.KeyCodes.PLUS_SIGN:case goog.events.KeyCodes.QUESTION_MARK:case goog.events.KeyCodes.AT_SIGN:case goog.events.KeyCodes.NUM_PLUS:case goog.events.KeyCodes.NUM_MINUS:case goog.events.KeyCodes.NUM_PERIOD:case goog.events.KeyCodes.NUM_DIVISION:case goog.events.KeyCodes.SEMICOLON:case goog.events.KeyCodes.FF_SEMICOLON:case goog.events.KeyCodes.DASH:case goog.events.KeyCodes.EQUALS:case goog.events.KeyCodes.FF_EQUALS:case goog.events.KeyCodes.COMMA:case goog.events.KeyCodes.PERIOD:case goog.events.KeyCodes.SLASH:case goog.events.KeyCodes.APOSTROPHE:case goog.events.KeyCodes.SINGLE_QUOTE:case goog.events.KeyCodes.OPEN_SQUARE_BRACKET:case goog.events.KeyCodes.BACKSLASH:case goog.events.KeyCodes.CLOSE_SQUARE_BRACKET:return true;default:return false}};goog.events.KeyCodes.normalizeKeyCode=function(e){if(goog.userAgent.GECKO)return goog.events.KeyCodes.normalizeGeckoKeyCode(e);else if(goog.userAgent.MAC&&goog.userAgent.WEBKIT)return goog.events.KeyCodes.normalizeMacWebKitKeyCode(e);else return e};goog.events.KeyCodes.normalizeGeckoKeyCode=function(e){switch(e){case goog.events.KeyCodes.FF_EQUALS:return goog.events.KeyCodes.EQUALS;case goog.events.KeyCodes.FF_SEMICOLON:return goog.events.KeyCodes.SEMICOLON;case goog.events.KeyCodes.FF_DASH:return goog.events.KeyCodes.DASH;case goog.events.KeyCodes.MAC_FF_META:return goog.events.KeyCodes.META;case goog.events.KeyCodes.WIN_KEY_FF_LINUX:return goog.events.KeyCodes.WIN_KEY;default:return e}};goog.events.KeyCodes.normalizeMacWebKitKeyCode=function(e){switch(e){case goog.events.KeyCodes.MAC_WK_CMD_RIGHT:return goog.events.KeyCodes.META;default:return e}};goog.provide("goog.events.KeyEvent");goog.provide("goog.events.KeyHandler");goog.provide("goog.events.KeyHandler.EventType");goog.require("goog.events");goog.require("goog.events.BrowserEvent");goog.require("goog.events.EventTarget");goog.require("goog.events.EventType");goog.require("goog.events.KeyCodes");goog.require("goog.userAgent");goog.events.KeyHandler=function(e,o){goog.events.EventTarget.call(this);if(e)this.attach(e,o)};goog.inherits(goog.events.KeyHandler,goog.events.EventTarget);goog.events.KeyHandler.prototype.element_=null;goog.events.KeyHandler.prototype.keyPressKey_=null;goog.events.KeyHandler.prototype.keyDownKey_=null;goog.events.KeyHandler.prototype.keyUpKey_=null;goog.events.KeyHandler.prototype.lastKey_=-1;goog.events.KeyHandler.prototype.keyCode_=-1;goog.events.KeyHandler.prototype.altKey_=false;goog.events.KeyHandler.EventType={KEY:"key"};goog.events.KeyHandler.safariKey_={3:goog.events.KeyCodes.ENTER,12:goog.events.KeyCodes.NUMLOCK,63232:goog.events.KeyCodes.UP,63233:goog.events.KeyCodes.DOWN,63234:goog.events.KeyCodes.LEFT,63235:goog.events.KeyCodes.RIGHT,63236:goog.events.KeyCodes.F1,63237:goog.events.KeyCodes.F2,63238:goog.events.KeyCodes.F3,63239:goog.events.KeyCodes.F4,63240:goog.events.KeyCodes.F5,63241:goog.events.KeyCodes.F6,63242:goog.events.KeyCodes.F7,63243:goog.events.KeyCodes.F8,63244:goog.events.KeyCodes.F9,63245:goog.events.KeyCodes.F10,63246:goog.events.KeyCodes.F11,63247:goog.events.KeyCodes.F12,63248:goog.events.KeyCodes.PRINT_SCREEN,63272:goog.events.KeyCodes.DELETE,63273:goog.events.KeyCodes.HOME,63275:goog.events.KeyCodes.END,63276:goog.events.KeyCodes.PAGE_UP,63277:goog.events.KeyCodes.PAGE_DOWN,63289:goog.events.KeyCodes.NUMLOCK,63302:goog.events.KeyCodes.INSERT};goog.events.KeyHandler.keyIdentifier_={Up:goog.events.KeyCodes.UP,Down:goog.events.KeyCodes.DOWN,Left:goog.events.KeyCodes.LEFT,Right:goog.events.KeyCodes.RIGHT,Enter:goog.events.KeyCodes.ENTER,F1:goog.events.KeyCodes.F1,F2:goog.events.KeyCodes.F2,F3:goog.events.KeyCodes.F3,F4:goog.events.KeyCodes.F4,F5:goog.events.KeyCodes.F5,F6:goog.events.KeyCodes.F6,F7:goog.events.KeyCodes.F7,F8:goog.events.KeyCodes.F8,F9:goog.events.KeyCodes.F9,F10:goog.events.KeyCodes.F10,F11:goog.events.KeyCodes.F11,F12:goog.events.KeyCodes.F12,"U+007F":goog.events.KeyCodes.DELETE,Home:goog.events.KeyCodes.HOME,End:goog.events.KeyCodes.END,PageUp:goog.events.KeyCodes.PAGE_UP,PageDown:goog.events.KeyCodes.PAGE_DOWN,Insert:goog.events.KeyCodes.INSERT};goog.events.KeyHandler.USES_KEYDOWN_=goog.userAgent.IE||goog.userAgent.EDGE||goog.userAgent.WEBKIT&&goog.userAgent.isVersionOrHigher("525");goog.events.KeyHandler.SAVE_ALT_FOR_KEYPRESS_=goog.userAgent.MAC&&goog.userAgent.GECKO;goog.events.KeyHandler.prototype.handleKeyDown_=function(e){if(goog.userAgent.WEBKIT||goog.userAgent.EDGE)if(this.lastKey_==goog.events.KeyCodes.CTRL&&!e.ctrlKey||this.lastKey_==goog.events.KeyCodes.ALT&&!e.altKey||goog.userAgent.MAC&&this.lastKey_==goog.events.KeyCodes.META&&!e.metaKey)this.resetState();if(-1==this.lastKey_)if(e.ctrlKey&&e.keyCode!=goog.events.KeyCodes.CTRL)this.lastKey_=goog.events.KeyCodes.CTRL;else if(e.altKey&&e.keyCode!=goog.events.KeyCodes.ALT)this.lastKey_=goog.events.KeyCodes.ALT;else if(e.metaKey&&e.keyCode!=goog.events.KeyCodes.META)this.lastKey_=goog.events.KeyCodes.META;if(goog.events.KeyHandler.USES_KEYDOWN_&&!goog.events.KeyCodes.firesKeyPressEvent(e.keyCode,this.lastKey_,e.shiftKey,e.ctrlKey,e.altKey,e.metaKey))this.handleEvent(e);else{this.keyCode_=goog.events.KeyCodes.normalizeKeyCode(e.keyCode);if(goog.events.KeyHandler.SAVE_ALT_FOR_KEYPRESS_)this.altKey_=e.altKey}};goog.events.KeyHandler.prototype.resetState=function(){this.lastKey_=-1;this.keyCode_=-1};goog.events.KeyHandler.prototype.handleKeyup_=function(e){this.resetState();this.altKey_=e.altKey};goog.events.KeyHandler.prototype.handleEvent=function(e){var o=e.getBrowserEvent();var t,i;var r=o.altKey;if(goog.userAgent.IE&&e.type==goog.events.EventType.KEYPRESS){t=this.keyCode_;i=t!=goog.events.KeyCodes.ENTER&&t!=goog.events.KeyCodes.ESC?o.keyCode:0}else if((goog.userAgent.WEBKIT||goog.userAgent.EDGE)&&e.type==goog.events.EventType.KEYPRESS){t=this.keyCode_;i=o.charCode>=0&&o.charCode<63232&&goog.events.KeyCodes.isCharacterKey(t)?o.charCode:0}else if(goog.userAgent.OPERA&&!goog.userAgent.WEBKIT){t=this.keyCode_;i=goog.events.KeyCodes.isCharacterKey(t)?o.keyCode:0}else{t=o.keyCode||this.keyCode_;i=o.charCode||0;if(goog.events.KeyHandler.SAVE_ALT_FOR_KEYPRESS_)r=this.altKey_;if(goog.userAgent.MAC&&i==goog.events.KeyCodes.QUESTION_MARK&&t==goog.events.KeyCodes.WIN_KEY)t=goog.events.KeyCodes.SLASH}t=goog.events.KeyCodes.normalizeKeyCode(t);var n=t;if(t){if(t>=63232&&t in goog.events.KeyHandler.safariKey_)n=goog.events.KeyHandler.safariKey_[t];else if(25==t&&e.shiftKey)n=9}else if(o.keyIdentifier&&o.keyIdentifier in goog.events.KeyHandler.keyIdentifier_)n=goog.events.KeyHandler.keyIdentifier_[o.keyIdentifier];var l=n==this.lastKey_;this.lastKey_=n;var s=new goog.events.KeyEvent(n,i,l,o);s.altKey=r;this.dispatchEvent(s)};goog.events.KeyHandler.prototype.getElement=function(){return this.element_};goog.events.KeyHandler.prototype.attach=function(e,o){if(this.keyUpKey_)this.detach();this.element_=e;this.keyPressKey_=goog.events.listen(this.element_,goog.events.EventType.KEYPRESS,this,o);this.keyDownKey_=goog.events.listen(this.element_,goog.events.EventType.KEYDOWN,this.handleKeyDown_,o,this);this.keyUpKey_=goog.events.listen(this.element_,goog.events.EventType.KEYUP,this.handleKeyup_,o,this)};goog.events.KeyHandler.prototype.detach=function(){if(this.keyPressKey_){goog.events.unlistenByKey(this.keyPressKey_);goog.events.unlistenByKey(this.keyDownKey_);goog.events.unlistenByKey(this.keyUpKey_);this.keyPressKey_=null;this.keyDownKey_=null;this.keyUpKey_=null}this.element_=null;this.lastKey_=-1;this.keyCode_=-1};goog.events.KeyHandler.prototype.disposeInternal=function(){goog.events.KeyHandler.superClass_.disposeInternal.call(this);this.detach()};goog.events.KeyEvent=function(e,o,t,i){goog.events.BrowserEvent.call(this,i);this.type=goog.events.KeyHandler.EventType.KEY;this.keyCode=e;this.charCode=o;this.repeat=t};goog.inherits(goog.events.KeyEvent,goog.events.BrowserEvent);goog.provide("goog.events.Listener");goog.require("goog.events.ListenableKey");goog.events.Listener=function(e,o,t,i,r,n){if(goog.events.Listener.ENABLE_MONITORING)this.creationStack=(new Error).stack;this.listener=e;this.proxy=o;this.src=t;this.type=i;this.capture=!!r;this.handler=n;this.key=goog.events.ListenableKey.reserveKey();this.callOnce=false;this.removed=false};goog.define("goog.events.Listener.ENABLE_MONITORING",false);goog.events.Listener.prototype.creationStack;goog.events.Listener.prototype.markAsRemoved=function(){this.removed=true;this.listener=null;this.proxy=null;this.src=null;this.handler=null};goog.provide("goog.events.ListenerMap");goog.require("goog.array");goog.require("goog.events.Listener");goog.require("goog.object");goog.events.ListenerMap=function(e){this.src=e;this.listeners={};this.typeCount_=0};goog.events.ListenerMap.prototype.getTypeCount=function(){return this.typeCount_};goog.events.ListenerMap.prototype.getListenerCount=function(){var e=0;for(var o in this.listeners)e+=this.listeners[o].length;return e};goog.events.ListenerMap.prototype.add=function(e,o,t,i,r){var n=e.toString();var l=this.listeners[n];if(!l){l=this.listeners[n]=[];this.typeCount_++}var s;var g=goog.events.ListenerMap.findListenerIndex_(l,o,i,r);if(g>-1){s=l[g];if(!t)s.callOnce=false}else{s=new goog.events.Listener(o,null,this.src,n,!!i,r);s.callOnce=t;l.push(s)}return s};goog.events.ListenerMap.prototype.remove=function(e,o,t,i){var r=e.toString();if(!(r in this.listeners))return false;var n=this.listeners[r];var l=goog.events.ListenerMap.findListenerIndex_(n,o,t,i);if(l>-1){var s=n[l];s.markAsRemoved();goog.array.removeAt(n,l);if(0==n.length){delete this.listeners[r];this.typeCount_--}return true}return false};goog.events.ListenerMap.prototype.removeByKey=function(e){var o=e.type;if(!(o in this.listeners))return false;var t=goog.array.remove(this.listeners[o],e);if(t){e.markAsRemoved();if(0==this.listeners[o].length){delete this.listeners[o];this.typeCount_--}}return t};goog.events.ListenerMap.prototype.removeAll=function(e){var o=e&&e.toString();var t=0;for(var i in this.listeners)if(!o||i==o){var r=this.listeners[i];for(var n=0;n<r.length;n++){++t;r[n].markAsRemoved()}delete this.listeners[i];this.typeCount_--}return t};goog.events.ListenerMap.prototype.getListeners=function(e,o){var t=this.listeners[e.toString()];var i=[];if(t)for(var r=0;r<t.length;++r){var n=t[r];if(n.capture==o)i.push(n)}return i};goog.events.ListenerMap.prototype.getListener=function(e,o,t,i){var r=this.listeners[e.toString()];var n=-1;if(r)n=goog.events.ListenerMap.findListenerIndex_(r,o,t,i);return n>-1?r[n]:null};goog.events.ListenerMap.prototype.hasListener=function(e,o){var t=goog.isDef(e);var i=t?e.toString():"";var r=goog.isDef(o);return goog.object.some(this.listeners,(function(e,n){for(var l=0;l<e.length;++l)if((!t||e[l].type==i)&&(!r||e[l].capture==o))return true;return false}))};goog.events.ListenerMap.findListenerIndex_=function(e,o,t,i){for(var r=0;r<e.length;++r){var n=e[r];if(!n.removed&&n.listener==o&&n.capture==!!t&&n.handler==i)return r}return-1};goog.provide("goog.events.MouseWheelEvent");goog.provide("goog.events.MouseWheelHandler");goog.provide("goog.events.MouseWheelHandler.EventType");goog.require("goog.dom");goog.require("goog.events");goog.require("goog.events.BrowserEvent");goog.require("goog.events.EventTarget");goog.require("goog.math");goog.require("goog.style");goog.require("goog.userAgent");goog.events.MouseWheelHandler=function(e,o){goog.events.EventTarget.call(this);this.element_=e;var t=goog.dom.isElement(this.element_)?this.element_:this.element_?this.element_.body:null;this.isRtl_=!!t&&goog.style.isRightToLeft(t);var i=goog.userAgent.GECKO?"DOMMouseScroll":"mousewheel";this.listenKey_=goog.events.listen(this.element_,i,this,o)};goog.inherits(goog.events.MouseWheelHandler,goog.events.EventTarget);goog.events.MouseWheelHandler.EventType={MOUSEWHEEL:"mousewheel"};goog.events.MouseWheelHandler.prototype.maxDeltaX_;goog.events.MouseWheelHandler.prototype.maxDeltaY_;goog.events.MouseWheelHandler.prototype.setMaxDeltaX=function(e){this.maxDeltaX_=e};goog.events.MouseWheelHandler.prototype.setMaxDeltaY=function(e){this.maxDeltaY_=e};goog.events.MouseWheelHandler.prototype.handleEvent=function(e){var o=0;var t=0;var i=0;var r=e.getBrowserEvent();if("mousewheel"==r.type){var n=40;i=goog.events.MouseWheelHandler.smartScale_(-r.wheelDelta,n);if(goog.isDef(r.wheelDeltaX)){o=goog.events.MouseWheelHandler.smartScale_(-r.wheelDeltaX,n);t=goog.events.MouseWheelHandler.smartScale_(-r.wheelDeltaY,n)}else t=i}else{i=r.detail;if(i>100)i=3;else if(i<-100)i=-3;if(goog.isDef(r.axis)&&r.axis===r.HORIZONTAL_AXIS)o=i;else t=i}if(goog.isNumber(this.maxDeltaX_))o=goog.math.clamp(o,-this.maxDeltaX_,this.maxDeltaX_);if(goog.isNumber(this.maxDeltaY_))t=goog.math.clamp(t,-this.maxDeltaY_,this.maxDeltaY_);if(this.isRtl_)o=-o;var l=new goog.events.MouseWheelEvent(i,r,o,t);this.dispatchEvent(l)};goog.events.MouseWheelHandler.smartScale_=function(e,o){if(goog.userAgent.WEBKIT&&(goog.userAgent.MAC||goog.userAgent.LINUX)&&e%o!=0)return e;else return e/o};goog.events.MouseWheelHandler.prototype.disposeInternal=function(){goog.events.MouseWheelHandler.superClass_.disposeInternal.call(this);goog.events.unlistenByKey(this.listenKey_);this.listenKey_=null};goog.events.MouseWheelEvent=function(e,o,t,i){goog.events.BrowserEvent.call(this,o);this.type=goog.events.MouseWheelHandler.EventType.MOUSEWHEEL;this.detail=e;this.deltaX=t;this.deltaY=i};goog.inherits(goog.events.MouseWheelEvent,goog.events.BrowserEvent);goog.provide("goog.fs.url");goog.fs.url.createObjectUrl=function(e){return goog.fs.url.getUrlObject_().createObjectURL(e)};goog.fs.url.revokeObjectUrl=function(e){goog.fs.url.getUrlObject_().revokeObjectURL(e)};goog.fs.url.UrlObject_;goog.fs.url.getUrlObject_=function(){var e=goog.fs.url.findUrlObject_();if(null!=e)return e;else throw new Error("This browser doesn't seem to support blob URLs")};goog.fs.url.findUrlObject_=function(){if(goog.isDef(goog.global.URL)&&goog.isDef(goog.global.URL.createObjectURL))return goog.global.URL;else if(goog.isDef(goog.global.webkitURL)&&goog.isDef(goog.global.webkitURL.createObjectURL))return goog.global.webkitURL;else if(goog.isDef(goog.global.createObjectURL))return goog.global;else return null};goog.fs.url.browserSupportsObjectUrls=function(){return null!=goog.fs.url.findUrlObject_()};goog.provide("goog.fx.Transition");goog.provide("goog.fx.Transition.EventType");goog.fx.Transition=function(){};goog.fx.Transition.EventType={PLAY:"play",BEGIN:"begin",RESUME:"resume",END:"end",STOP:"stop",FINISH:"finish",PAUSE:"pause"};goog.fx.Transition.prototype.play;goog.fx.Transition.prototype.stop;goog.provide("goog.fx.TransitionBase");goog.provide("goog.fx.TransitionBase.State");goog.require("goog.events.EventTarget");goog.require("goog.fx.Transition");goog.fx.TransitionBase=function(){goog.fx.TransitionBase.base(this,"constructor");this.state_=goog.fx.TransitionBase.State.STOPPED;this.startTime=null;this.endTime=null};goog.inherits(goog.fx.TransitionBase,goog.events.EventTarget);goog.fx.TransitionBase.State={STOPPED:0,PAUSED:-1,PLAYING:1};goog.fx.TransitionBase.prototype.play=goog.abstractMethod;goog.fx.TransitionBase.prototype.stop=goog.abstractMethod;goog.fx.TransitionBase.prototype.pause=goog.abstractMethod;goog.fx.TransitionBase.prototype.getStateInternal=function(){return this.state_};goog.fx.TransitionBase.prototype.setStatePlaying=function(){this.state_=goog.fx.TransitionBase.State.PLAYING};goog.fx.TransitionBase.prototype.setStatePaused=function(){this.state_=goog.fx.TransitionBase.State.PAUSED};goog.fx.TransitionBase.prototype.setStateStopped=function(){this.state_=goog.fx.TransitionBase.State.STOPPED};goog.fx.TransitionBase.prototype.isPlaying=function(){return this.state_==goog.fx.TransitionBase.State.PLAYING};goog.fx.TransitionBase.prototype.isPaused=function(){return this.state_==goog.fx.TransitionBase.State.PAUSED};goog.fx.TransitionBase.prototype.isStopped=function(){return this.state_==goog.fx.TransitionBase.State.STOPPED};goog.fx.TransitionBase.prototype.onBegin=function(){this.dispatchAnimationEvent(goog.fx.Transition.EventType.BEGIN)};goog.fx.TransitionBase.prototype.onEnd=function(){this.dispatchAnimationEvent(goog.fx.Transition.EventType.END)};goog.fx.TransitionBase.prototype.onFinish=function(){this.dispatchAnimationEvent(goog.fx.Transition.EventType.FINISH)};goog.fx.TransitionBase.prototype.onPause=function(){this.dispatchAnimationEvent(goog.fx.Transition.EventType.PAUSE)};goog.fx.TransitionBase.prototype.onPlay=function(){this.dispatchAnimationEvent(goog.fx.Transition.EventType.PLAY)};goog.fx.TransitionBase.prototype.onResume=function(){this.dispatchAnimationEvent(goog.fx.Transition.EventType.RESUME)};goog.fx.TransitionBase.prototype.onStop=function(){this.dispatchAnimationEvent(goog.fx.Transition.EventType.STOP)};goog.fx.TransitionBase.prototype.dispatchAnimationEvent=function(e){this.dispatchEvent(e)};goog.provide("goog.fx.anim");goog.provide("goog.fx.anim.Animated");goog.require("goog.async.AnimationDelay");goog.require("goog.async.Delay");goog.require("goog.object");goog.fx.anim.Animated=function(){};goog.fx.anim.Animated.prototype.onAnimationFrame;goog.fx.anim.TIMEOUT=goog.async.AnimationDelay.TIMEOUT;goog.fx.anim.activeAnimations_={};goog.fx.anim.animationWindow_=null;goog.fx.anim.animationDelay_=null;goog.fx.anim.registerAnimation=function(e){var o=goog.getUid(e);if(!(o in goog.fx.anim.activeAnimations_))goog.fx.anim.activeAnimations_[o]=e;goog.fx.anim.requestAnimationFrame_()};goog.fx.anim.unregisterAnimation=function(e){var o=goog.getUid(e);delete goog.fx.anim.activeAnimations_[o];if(goog.object.isEmpty(goog.fx.anim.activeAnimations_))goog.fx.anim.cancelAnimationFrame_()};goog.fx.anim.tearDown=function(){goog.fx.anim.animationWindow_=null;goog.dispose(goog.fx.anim.animationDelay_);goog.fx.anim.animationDelay_=null;goog.fx.anim.activeAnimations_={}};goog.fx.anim.setAnimationWindow=function(e){var o=goog.fx.anim.animationDelay_&&goog.fx.anim.animationDelay_.isActive();goog.dispose(goog.fx.anim.animationDelay_);goog.fx.anim.animationDelay_=null;goog.fx.anim.animationWindow_=e;if(o)goog.fx.anim.requestAnimationFrame_()};goog.fx.anim.requestAnimationFrame_=function(){if(!goog.fx.anim.animationDelay_)if(goog.fx.anim.animationWindow_)goog.fx.anim.animationDelay_=new goog.async.AnimationDelay((function(e){goog.fx.anim.cycleAnimations_(e)}),goog.fx.anim.animationWindow_);else goog.fx.anim.animationDelay_=new goog.async.Delay((function(){goog.fx.anim.cycleAnimations_(goog.now())}),goog.fx.anim.TIMEOUT);var e=goog.fx.anim.animationDelay_;if(!e.isActive())e.start()};goog.fx.anim.cancelAnimationFrame_=function(){if(goog.fx.anim.animationDelay_)goog.fx.anim.animationDelay_.stop()};goog.fx.anim.cycleAnimations_=function(e){goog.object.forEach(goog.fx.anim.activeAnimations_,(function(o){o.onAnimationFrame(e)}));if(!goog.object.isEmpty(goog.fx.anim.activeAnimations_))goog.fx.anim.requestAnimationFrame_()};goog.provide("goog.fx.Animation");goog.provide("goog.fx.Animation.EventType");goog.provide("goog.fx.Animation.State");goog.provide("goog.fx.AnimationEvent");goog.require("goog.array");goog.require("goog.asserts");goog.require("goog.events.Event");goog.require("goog.fx.Transition");goog.require("goog.fx.TransitionBase");goog.require("goog.fx.anim");goog.require("goog.fx.anim.Animated");goog.fx.Animation=function(e,o,t,i){goog.fx.Animation.base(this,"constructor");if(!goog.isArray(e)||!goog.isArray(o))throw new Error("Start and end parameters must be arrays");if(e.length!=o.length)throw new Error("Start and end points must be the same length");this.startPoint=e;this.endPoint=o;this.duration=t;this.accel_=i;this.coords=[];this.useRightPositioningForRtl_=false;this.fps_=0;this.progress=0;this.lastFrame=null};goog.inherits(goog.fx.Animation,goog.fx.TransitionBase);goog.fx.Animation.prototype.getDuration=function(){return this.duration};goog.fx.Animation.prototype.enableRightPositioningForRtl=function(e){this.useRightPositioningForRtl_=e};goog.fx.Animation.prototype.isRightPositioningForRtlEnabled=function(){return this.useRightPositioningForRtl_};goog.fx.Animation.EventType={PLAY:goog.fx.Transition.EventType.PLAY,BEGIN:goog.fx.Transition.EventType.BEGIN,RESUME:goog.fx.Transition.EventType.RESUME,END:goog.fx.Transition.EventType.END,STOP:goog.fx.Transition.EventType.STOP,FINISH:goog.fx.Transition.EventType.FINISH,PAUSE:goog.fx.Transition.EventType.PAUSE,ANIMATE:"animate",DESTROY:"destroy"};goog.fx.Animation.TIMEOUT=goog.fx.anim.TIMEOUT;goog.fx.Animation.State=goog.fx.TransitionBase.State;goog.fx.Animation.setAnimationWindow=function(e){goog.fx.anim.setAnimationWindow(e)};goog.fx.Animation.prototype.play=function(e){if(e||this.isStopped()){this.progress=0;this.coords=this.startPoint}else if(this.isPlaying())return false;goog.fx.anim.unregisterAnimation(this);var o=goog.now();this.startTime=o;if(this.isPaused())this.startTime-=this.duration*this.progress;this.endTime=this.startTime+this.duration;this.lastFrame=this.startTime;if(!this.progress)this.onBegin();this.onPlay();if(this.isPaused())this.onResume();this.setStatePlaying();goog.fx.anim.registerAnimation(this);this.cycle(o);return true};goog.fx.Animation.prototype.stop=function(e){goog.fx.anim.unregisterAnimation(this);this.setStateStopped();if(e)this.progress=1;this.updateCoords_(this.progress);this.onStop();this.onEnd()};goog.fx.Animation.prototype.pause=function(){if(this.isPlaying()){goog.fx.anim.unregisterAnimation(this);this.setStatePaused();this.onPause()}};goog.fx.Animation.prototype.getProgress=function(){return this.progress};goog.fx.Animation.prototype.setProgress=function(e){this.progress=e;if(this.isPlaying()){var o=goog.now();this.startTime=o-this.duration*this.progress;this.endTime=this.startTime+this.duration}};goog.fx.Animation.prototype.disposeInternal=function(){if(!this.isStopped())this.stop(false);this.onDestroy();goog.fx.Animation.base(this,"disposeInternal")};goog.fx.Animation.prototype.destroy=function(){this.dispose()};goog.fx.Animation.prototype.onAnimationFrame=function(e){this.cycle(e)};goog.fx.Animation.prototype.cycle=function(e){goog.asserts.assertNumber(this.startTime);goog.asserts.assertNumber(this.endTime);goog.asserts.assertNumber(this.lastFrame);if(e<this.startTime){this.endTime=e+this.endTime-this.startTime;this.startTime=e}this.progress=(e-this.startTime)/(this.endTime-this.startTime);if(this.progress>1)this.progress=1;this.fps_=1e3/(e-this.lastFrame);this.lastFrame=e;this.updateCoords_(this.progress);if(1==this.progress){this.setStateStopped();goog.fx.anim.unregisterAnimation(this);this.onFinish();this.onEnd()}else if(this.isPlaying())this.onAnimate()};goog.fx.Animation.prototype.updateCoords_=function(e){if(goog.isFunction(this.accel_))e=this.accel_(e);this.coords=new Array(this.startPoint.length);for(var o=0;o<this.startPoint.length;o++)this.coords[o]=(this.endPoint[o]-this.startPoint[o])*e+this.startPoint[o]};goog.fx.Animation.prototype.onAnimate=function(){this.dispatchAnimationEvent(goog.fx.Animation.EventType.ANIMATE)};goog.fx.Animation.prototype.onDestroy=function(){this.dispatchAnimationEvent(goog.fx.Animation.EventType.DESTROY)};goog.fx.Animation.prototype.dispatchAnimationEvent=function(e){this.dispatchEvent(new goog.fx.AnimationEvent(e,this))};goog.fx.AnimationEvent=function(e,o){goog.fx.AnimationEvent.base(this,"constructor",e);this.coords=o.coords;this.x=o.coords[0];this.y=o.coords[1];this.z=o.coords[2];this.duration=o.duration;this.progress=o.getProgress();this.fps=o.fps_;this.state=o.getStateInternal();this.anim=o};goog.inherits(goog.fx.AnimationEvent,goog.events.Event);goog.fx.AnimationEvent.prototype.coordsAsInts=function(){return goog.array.map(this.coords,Math.round)};goog.provide("goog.fx.AnimationParallelQueue");goog.provide("goog.fx.AnimationQueue");goog.provide("goog.fx.AnimationSerialQueue");goog.require("goog.array");goog.require("goog.asserts");goog.require("goog.events");goog.require("goog.fx.Animation");goog.require("goog.fx.Transition");goog.require("goog.fx.TransitionBase");goog.fx.AnimationQueue=function(){goog.fx.AnimationQueue.base(this,"constructor");this.queue=[]};goog.inherits(goog.fx.AnimationQueue,goog.fx.TransitionBase);goog.fx.AnimationQueue.prototype.add=function(e){goog.asserts.assert(this.isStopped(),"Not allowed to add animations to a running animation queue.");if(goog.array.contains(this.queue,e))return;this.queue.push(e);goog.events.listen(e,goog.fx.Transition.EventType.FINISH,this.onAnimationFinish,false,this)};goog.fx.AnimationQueue.prototype.remove=function(e){goog.asserts.assert(this.isStopped(),"Not allowed to remove animations from a running animation queue.");if(goog.array.remove(this.queue,e))goog.events.unlisten(e,goog.fx.Transition.EventType.FINISH,this.onAnimationFinish,false,this)};goog.fx.AnimationQueue.prototype.onAnimationFinish=goog.abstractMethod;goog.fx.AnimationQueue.prototype.disposeInternal=function(){goog.array.forEach(this.queue,(function(e){e.dispose()}));this.queue.length=0;goog.fx.AnimationQueue.base(this,"disposeInternal")};goog.fx.AnimationParallelQueue=function(){goog.fx.AnimationParallelQueue.base(this,"constructor");this.finishedCounter_=0};goog.inherits(goog.fx.AnimationParallelQueue,goog.fx.AnimationQueue);goog.fx.AnimationParallelQueue.prototype.play=function(e){if(0==this.queue.length)return false;if(e||this.isStopped()){this.finishedCounter_=0;this.onBegin()}else if(this.isPlaying())return false;this.onPlay();if(this.isPaused())this.onResume();var o=this.isPaused()&&!e;this.startTime=goog.now();this.endTime=null;this.setStatePlaying();goog.array.forEach(this.queue,(function(t){if(!o||t.isPaused())t.play(e)}));return true};goog.fx.AnimationParallelQueue.prototype.pause=function(){if(this.isPlaying()){goog.array.forEach(this.queue,(function(e){if(e.isPlaying())e.pause()}));this.setStatePaused();this.onPause()}};goog.fx.AnimationParallelQueue.prototype.stop=function(e){goog.array.forEach(this.queue,(function(o){if(!o.isStopped())o.stop(e)}));this.setStateStopped();this.endTime=goog.now();this.onStop();this.onEnd()};goog.fx.AnimationParallelQueue.prototype.onAnimationFinish=function(e){this.finishedCounter_++;if(this.finishedCounter_==this.queue.length){this.endTime=goog.now();this.setStateStopped();this.onFinish();this.onEnd()}};goog.fx.AnimationSerialQueue=function(){goog.fx.AnimationSerialQueue.base(this,"constructor");this.current_=0};goog.inherits(goog.fx.AnimationSerialQueue,goog.fx.AnimationQueue);goog.fx.AnimationSerialQueue.prototype.play=function(e){if(0==this.queue.length)return false;if(e||this.isStopped()){if(this.current_<this.queue.length&&!this.queue[this.current_].isStopped())this.queue[this.current_].stop(false);this.current_=0;this.onBegin()}else if(this.isPlaying())return false;this.onPlay();if(this.isPaused())this.onResume();this.startTime=goog.now();this.endTime=null;this.setStatePlaying();this.queue[this.current_].play(e);return true};goog.fx.AnimationSerialQueue.prototype.pause=function(){if(this.isPlaying()){this.queue[this.current_].pause();this.setStatePaused();this.onPause()}};goog.fx.AnimationSerialQueue.prototype.stop=function(e){this.setStateStopped();this.endTime=goog.now();if(e)for(var o=this.current_;o<this.queue.length;++o){var t=this.queue[o];if(t.isStopped())t.play();if(!t.isStopped())t.stop(true)}else if(this.current_<this.queue.length)this.queue[this.current_].stop(false);this.onStop();this.onEnd()};goog.fx.AnimationSerialQueue.prototype.onAnimationFinish=function(e){if(this.isPlaying()){this.current_++;if(this.current_<this.queue.length)this.queue[this.current_].play();else{this.endTime=goog.now();this.setStateStopped();this.onFinish();this.onEnd()}}};goog.provide("goog.fx.dom");goog.provide("goog.fx.dom.BgColorTransform");goog.provide("goog.fx.dom.ColorTransform");goog.provide("goog.fx.dom.Fade");goog.provide("goog.fx.dom.FadeIn");goog.provide("goog.fx.dom.FadeInAndShow");goog.provide("goog.fx.dom.FadeOut");goog.provide("goog.fx.dom.FadeOutAndHide");goog.provide("goog.fx.dom.PredefinedEffect");goog.provide("goog.fx.dom.Resize");goog.provide("goog.fx.dom.ResizeHeight");goog.provide("goog.fx.dom.ResizeWidth");goog.provide("goog.fx.dom.Scroll");goog.provide("goog.fx.dom.Slide");goog.provide("goog.fx.dom.SlideFrom");goog.provide("goog.fx.dom.Swipe");goog.require("goog.color");goog.require("goog.events");goog.require("goog.fx.Animation");goog.require("goog.fx.Transition");goog.require("goog.style");goog.require("goog.style.bidi");goog.forwardDeclare("goog.events.EventHandler");goog.fx.dom.PredefinedEffect=function(e,o,t,i,r){goog.fx.Animation.call(this,o,t,i,r);this.element=e;this.rightToLeft_};goog.inherits(goog.fx.dom.PredefinedEffect,goog.fx.Animation);goog.fx.dom.PredefinedEffect.prototype.updateStyle=goog.nullFunction;goog.fx.dom.PredefinedEffect.prototype.isRightToLeft=function(){if(!goog.isDef(this.rightToLeft_))this.rightToLeft_=goog.style.isRightToLeft(this.element);return this.rightToLeft_};goog.fx.dom.PredefinedEffect.prototype.onAnimate=function(){this.updateStyle();goog.fx.dom.PredefinedEffect.superClass_.onAnimate.call(this)};goog.fx.dom.PredefinedEffect.prototype.onEnd=function(){this.updateStyle();goog.fx.dom.PredefinedEffect.superClass_.onEnd.call(this)};goog.fx.dom.PredefinedEffect.prototype.onBegin=function(){this.updateStyle();goog.fx.dom.PredefinedEffect.superClass_.onBegin.call(this)};goog.fx.dom.Slide=function(e,o,t,i,r){if(2!=o.length||2!=t.length)throw new Error("Start and end points must be 2D");goog.fx.dom.PredefinedEffect.apply(this,arguments)};goog.inherits(goog.fx.dom.Slide,goog.fx.dom.PredefinedEffect);goog.fx.dom.Slide.prototype.updateStyle=function(){var e=this.isRightPositioningForRtlEnabled()&&this.isRightToLeft()?"right":"left";this.element.style[e]=Math.round(this.coords[0])+"px";this.element.style.top=Math.round(this.coords[1])+"px"};goog.fx.dom.SlideFrom=function(e,o,t,i){this.startPoint;var r=this.isRightPositioningForRtlEnabled()?goog.style.bidi.getOffsetStart(e):e.offsetLeft;var n=[r,e.offsetTop];goog.fx.dom.Slide.call(this,e,n,o,t,i)};goog.inherits(goog.fx.dom.SlideFrom,goog.fx.dom.Slide);goog.fx.dom.SlideFrom.prototype.onBegin=function(){var e=this.isRightPositioningForRtlEnabled()?goog.style.bidi.getOffsetStart(this.element):this.element.offsetLeft;this.startPoint=[e,this.element.offsetTop];goog.fx.dom.SlideFrom.superClass_.onBegin.call(this)};goog.fx.dom.Swipe=function(e,o,t,i,r){if(2!=o.length||2!=t.length)throw new Error("Start and end points must be 2D");goog.fx.dom.PredefinedEffect.apply(this,arguments);this.maxWidth_=Math.max(this.endPoint[0],this.startPoint[0]);this.maxHeight_=Math.max(this.endPoint[1],this.startPoint[1])};goog.inherits(goog.fx.dom.Swipe,goog.fx.dom.PredefinedEffect);goog.fx.dom.Swipe.prototype.updateStyle=function(){var e=this.coords[0];var o=this.coords[1];this.clip_(Math.round(e),Math.round(o),this.maxWidth_,this.maxHeight_);this.element.style.width=Math.round(e)+"px";var t=this.isRightPositioningForRtlEnabled()&&this.isRightToLeft()?"marginRight":"marginLeft";this.element.style[t]=Math.round(e)-this.maxWidth_+"px";this.element.style.marginTop=Math.round(o)-this.maxHeight_+"px"};goog.fx.dom.Swipe.prototype.clip_=function(e,o,t,i){this.element.style.clip="rect("+(i-o)+"px "+t+"px "+i+"px "+(t-e)+"px)"};goog.fx.dom.Scroll=function(e,o,t,i,r){if(2!=o.length||2!=t.length)throw new Error("Start and end points must be 2D");goog.fx.dom.PredefinedEffect.apply(this,arguments)};goog.inherits(goog.fx.dom.Scroll,goog.fx.dom.PredefinedEffect);goog.fx.dom.Scroll.prototype.updateStyle=function(){if(this.isRightPositioningForRtlEnabled())goog.style.bidi.setScrollOffset(this.element,Math.round(this.coords[0]));else this.element.scrollLeft=Math.round(this.coords[0]);this.element.scrollTop=Math.round(this.coords[1])};goog.fx.dom.Resize=function(e,o,t,i,r){if(2!=o.length||2!=t.length)throw new Error("Start and end points must be 2D");goog.fx.dom.PredefinedEffect.apply(this,arguments)};goog.inherits(goog.fx.dom.Resize,goog.fx.dom.PredefinedEffect);goog.fx.dom.Resize.prototype.updateStyle=function(){this.element.style.width=Math.round(this.coords[0])+"px";this.element.style.height=Math.round(this.coords[1])+"px"};goog.fx.dom.ResizeWidth=function(e,o,t,i,r){goog.fx.dom.PredefinedEffect.call(this,e,[o],[t],i,r)};goog.inherits(goog.fx.dom.ResizeWidth,goog.fx.dom.PredefinedEffect);goog.fx.dom.ResizeWidth.prototype.updateStyle=function(){this.element.style.width=Math.round(this.coords[0])+"px"};goog.fx.dom.ResizeHeight=function(e,o,t,i,r){goog.fx.dom.PredefinedEffect.call(this,e,[o],[t],i,r)};goog.inherits(goog.fx.dom.ResizeHeight,goog.fx.dom.PredefinedEffect);goog.fx.dom.ResizeHeight.prototype.updateStyle=function(){this.element.style.height=Math.round(this.coords[0])+"px"};goog.fx.dom.Fade=function(e,o,t,i,r){if(goog.isNumber(o))o=[o];if(goog.isNumber(t))t=[t];goog.fx.dom.Fade.base(this,"constructor",e,o,t,i,r);if(1!=o.length||1!=t.length)throw new Error("Start and end points must be 1D");this.lastOpacityUpdate_=goog.fx.dom.Fade.OPACITY_UNSET_};goog.inherits(goog.fx.dom.Fade,goog.fx.dom.PredefinedEffect);goog.fx.dom.Fade.TOLERANCE_=1/1024;goog.fx.dom.Fade.OPACITY_UNSET_=-1;goog.fx.dom.Fade.prototype.updateStyle=function(){var e=this.coords[0];var o=Math.abs(e-this.lastOpacityUpdate_);if(o>=goog.fx.dom.Fade.TOLERANCE_){goog.style.setOpacity(this.element,e);this.lastOpacityUpdate_=e}};goog.fx.dom.Fade.prototype.onBegin=function(){this.lastOpacityUpdate_=goog.fx.dom.Fade.OPACITY_UNSET_;goog.fx.dom.Fade.base(this,"onBegin")};goog.fx.dom.Fade.prototype.onEnd=function(){this.lastOpacityUpdate_=goog.fx.dom.Fade.OPACITY_UNSET_;goog.fx.dom.Fade.base(this,"onEnd")};goog.fx.dom.Fade.prototype.show=function(){this.element.style.display=""};goog.fx.dom.Fade.prototype.hide=function(){this.element.style.display="none"};goog.fx.dom.FadeOut=function(e,o,t){goog.fx.dom.Fade.call(this,e,1,0,o,t)};goog.inherits(goog.fx.dom.FadeOut,goog.fx.dom.Fade);goog.fx.dom.FadeIn=function(e,o,t){goog.fx.dom.Fade.call(this,e,0,1,o,t)};goog.inherits(goog.fx.dom.FadeIn,goog.fx.dom.Fade);goog.fx.dom.FadeOutAndHide=function(e,o,t){goog.fx.dom.Fade.call(this,e,1,0,o,t)};goog.inherits(goog.fx.dom.FadeOutAndHide,goog.fx.dom.Fade);goog.fx.dom.FadeOutAndHide.prototype.onBegin=function(){this.show();goog.fx.dom.FadeOutAndHide.superClass_.onBegin.call(this)};goog.fx.dom.FadeOutAndHide.prototype.onEnd=function(){this.hide();goog.fx.dom.FadeOutAndHide.superClass_.onEnd.call(this)};goog.fx.dom.FadeInAndShow=function(e,o,t){goog.fx.dom.Fade.call(this,e,0,1,o,t)};goog.inherits(goog.fx.dom.FadeInAndShow,goog.fx.dom.Fade);goog.fx.dom.FadeInAndShow.prototype.onBegin=function(){this.show();goog.fx.dom.FadeInAndShow.superClass_.onBegin.call(this)};goog.fx.dom.BgColorTransform=function(e,o,t,i,r){if(3!=o.length||3!=t.length)throw new Error("Start and end points must be 3D");goog.fx.dom.PredefinedEffect.apply(this,arguments)};goog.inherits(goog.fx.dom.BgColorTransform,goog.fx.dom.PredefinedEffect);goog.fx.dom.BgColorTransform.prototype.setColor=function(){var e=[];for(var o=0;o<this.coords.length;o++)e[o]=Math.round(this.coords[o]);var t="rgb("+e.join(",")+")";this.element.style.backgroundColor=t};goog.fx.dom.BgColorTransform.prototype.updateStyle=function(){this.setColor()};goog.fx.dom.bgColorFadeIn=function(e,o,t,i){var r=e.style.backgroundColor||"";var n=goog.style.getBackgroundColor(e);var l;if(n&&"transparent"!=n&&"rgba(0, 0, 0, 0)"!=n)l=goog.color.hexToRgb(goog.color.parse(n).hex);else l=[255,255,255];var s=new goog.fx.dom.BgColorTransform(e,o,l,t);function g(){e.style.backgroundColor=r}if(i)i.listen(s,goog.fx.Transition.EventType.END,g);else goog.events.listen(s,goog.fx.Transition.EventType.END,g);s.play()};goog.fx.dom.ColorTransform=function(e,o,t,i,r){if(3!=o.length||3!=t.length)throw new Error("Start and end points must be 3D");goog.fx.dom.PredefinedEffect.apply(this,arguments)};goog.inherits(goog.fx.dom.ColorTransform,goog.fx.dom.PredefinedEffect);goog.fx.dom.ColorTransform.prototype.updateStyle=function(){var e=[];for(var o=0;o<this.coords.length;o++)e[o]=Math.round(this.coords[o]);var t="rgb("+e.join(",")+")";this.element.style.color=t};goog.provide("goog.fx.DragEvent");goog.provide("goog.fx.Dragger");goog.provide("goog.fx.Dragger.EventType");goog.require("goog.dom");goog.require("goog.dom.TagName");goog.require("goog.events");goog.require("goog.events.Event");goog.require("goog.events.EventHandler");goog.require("goog.events.EventTarget");goog.require("goog.events.EventType");goog.require("goog.math.Coordinate");goog.require("goog.math.Rect");goog.require("goog.style");goog.require("goog.style.bidi");goog.require("goog.userAgent");goog.fx.Dragger=function(e,o,t){goog.fx.Dragger.base(this,"constructor");this.target=e;this.handle=o||e;this.limits=t||new goog.math.Rect(NaN,NaN,NaN,NaN);this.document_=goog.dom.getOwnerDocument(e);this.eventHandler_=new goog.events.EventHandler(this);this.registerDisposable(this.eventHandler_);this.rightToLeft_;this.clientX=0;this.clientY=0;this.screenX=0;this.screenY=0;this.startX=0;this.startY=0;this.deltaX=0;this.deltaY=0;this.pageScroll;this.enabled_=true;this.dragging_=false;this.preventMouseDown_=true;this.hysteresisDistanceSquared_=0;this.scrollTarget_;this.ieDragStartCancellingOn_=false;this.useRightPositioningForRtl_=false;goog.events.listen(this.handle,[goog.events.EventType.TOUCHSTART,goog.events.EventType.MOUSEDOWN],this.startDrag,false,this);this.useSetCapture_=goog.fx.Dragger.HAS_SET_CAPTURE_};goog.inherits(goog.fx.Dragger,goog.events.EventTarget);goog.tagUnsealableClass(goog.fx.Dragger);goog.fx.Dragger.HAS_SET_CAPTURE_=goog.global.document&&goog.global.document.documentElement&&!!goog.global.document.documentElement.setCapture&&!!goog.global.document.releaseCapture;goog.fx.Dragger.cloneNode=function(e){var o=e.cloneNode(true),t=goog.dom.getElementsByTagName(goog.dom.TagName.TEXTAREA,e),i=goog.dom.getElementsByTagName(goog.dom.TagName.TEXTAREA,o);for(var r=0;r<t.length;r++)i[r].value=t[r].value;switch(e.tagName){case String(goog.dom.TagName.TR):return goog.dom.createDom(goog.dom.TagName.TABLE,null,goog.dom.createDom(goog.dom.TagName.TBODY,null,o));case String(goog.dom.TagName.TD):case String(goog.dom.TagName.TH):return goog.dom.createDom(goog.dom.TagName.TABLE,null,goog.dom.createDom(goog.dom.TagName.TBODY,null,goog.dom.createDom(goog.dom.TagName.TR,null,o)));case String(goog.dom.TagName.TEXTAREA):o.value=e.value;default:return o}};goog.fx.Dragger.EventType={EARLY_CANCEL:"earlycancel",START:"start",BEFOREDRAG:"beforedrag",DRAG:"drag",END:"end"};goog.fx.Dragger.prototype.setAllowSetCapture=function(e){this.useSetCapture_=e&&goog.fx.Dragger.HAS_SET_CAPTURE_};goog.fx.Dragger.prototype.enableRightPositioningForRtl=function(e){this.useRightPositioningForRtl_=e};goog.fx.Dragger.prototype.getHandler=function(){var e=this;return e.eventHandler_};goog.fx.Dragger.prototype.setLimits=function(e){this.limits=e||new goog.math.Rect(NaN,NaN,NaN,NaN)};goog.fx.Dragger.prototype.setHysteresis=function(e){this.hysteresisDistanceSquared_=Math.pow(e,2)};goog.fx.Dragger.prototype.getHysteresis=function(){return Math.sqrt(this.hysteresisDistanceSquared_)};goog.fx.Dragger.prototype.setScrollTarget=function(e){this.scrollTarget_=e};goog.fx.Dragger.prototype.setCancelIeDragStart=function(e){this.ieDragStartCancellingOn_=e};goog.fx.Dragger.prototype.getEnabled=function(){return this.enabled_};goog.fx.Dragger.prototype.setEnabled=function(e){this.enabled_=e};goog.fx.Dragger.prototype.setPreventMouseDown=function(e){this.preventMouseDown_=e};goog.fx.Dragger.prototype.disposeInternal=function(){goog.fx.Dragger.superClass_.disposeInternal.call(this);goog.events.unlisten(this.handle,[goog.events.EventType.TOUCHSTART,goog.events.EventType.MOUSEDOWN],this.startDrag,false,this);this.cleanUpAfterDragging_();this.target=null;this.handle=null};goog.fx.Dragger.prototype.isRightToLeft_=function(){if(!goog.isDef(this.rightToLeft_))this.rightToLeft_=goog.style.isRightToLeft(this.target);return this.rightToLeft_};goog.fx.Dragger.prototype.startDrag=function(e){var o=e.type==goog.events.EventType.MOUSEDOWN;if(this.enabled_&&!this.dragging_&&(!o||e.isMouseActionButton())){if(0==this.hysteresisDistanceSquared_)if(this.fireDragStart_(e)){this.dragging_=true;if(this.preventMouseDown_&&o)e.preventDefault()}else return;else if(this.preventMouseDown_&&o)e.preventDefault();this.setupDragHandlers();this.clientX=this.startX=e.clientX;this.clientY=this.startY=e.clientY;this.screenX=e.screenX;this.screenY=e.screenY;this.computeInitialPosition();this.pageScroll=goog.dom.getDomHelper(this.document_).getDocumentScroll()}else this.dispatchEvent(goog.fx.Dragger.EventType.EARLY_CANCEL)};goog.fx.Dragger.prototype.setupDragHandlers=function(){var e=this.document_;var o=e.documentElement;var t=!this.useSetCapture_;this.eventHandler_.listen(e,[goog.events.EventType.TOUCHMOVE,goog.events.EventType.MOUSEMOVE],this.handleMove_,{capture:t,passive:false});this.eventHandler_.listen(e,[goog.events.EventType.TOUCHEND,goog.events.EventType.MOUSEUP],this.endDrag,t);if(this.useSetCapture_){o.setCapture(false);this.eventHandler_.listen(o,goog.events.EventType.LOSECAPTURE,this.endDrag)}else this.eventHandler_.listen(goog.dom.getWindow(e),goog.events.EventType.BLUR,this.endDrag);if(goog.userAgent.IE&&this.ieDragStartCancellingOn_)this.eventHandler_.listen(e,goog.events.EventType.DRAGSTART,goog.events.Event.preventDefault);if(this.scrollTarget_)this.eventHandler_.listen(this.scrollTarget_,goog.events.EventType.SCROLL,this.onScroll_,t)};goog.fx.Dragger.prototype.fireDragStart_=function(e){return this.dispatchEvent(new goog.fx.DragEvent(goog.fx.Dragger.EventType.START,this,e.clientX,e.clientY,e))};goog.fx.Dragger.prototype.cleanUpAfterDragging_=function(){this.eventHandler_.removeAll();if(this.useSetCapture_)this.document_.releaseCapture()};goog.fx.Dragger.prototype.endDrag=function(e,o){this.cleanUpAfterDragging_();if(this.dragging_){this.dragging_=false;var t=this.limitX(this.deltaX);var i=this.limitY(this.deltaY);var r=o||e.type==goog.events.EventType.TOUCHCANCEL;this.dispatchEvent(new goog.fx.DragEvent(goog.fx.Dragger.EventType.END,this,e.clientX,e.clientY,e,t,i,r))}else this.dispatchEvent(goog.fx.Dragger.EventType.EARLY_CANCEL)};goog.fx.Dragger.prototype.endDragCancel=function(e){this.endDrag(e,true)};goog.fx.Dragger.prototype.handleMove_=function(e){if(this.enabled_){var o=this.useRightPositioningForRtl_&&this.isRightToLeft_()?-1:1;var t=o*(e.clientX-this.clientX);var i=e.clientY-this.clientY;this.clientX=e.clientX;this.clientY=e.clientY;this.screenX=e.screenX;this.screenY=e.screenY;if(!this.dragging_){var r=this.startX-this.clientX;var n=this.startY-this.clientY;var l=r*r+n*n;if(l>this.hysteresisDistanceSquared_)if(this.fireDragStart_(e))this.dragging_=true;else{if(!this.isDisposed())this.endDrag(e);return}}var s=this.calculatePosition_(t,i);var g=s.x;var a=s.y;if(this.dragging_){var c=this.dispatchEvent(new goog.fx.DragEvent(goog.fx.Dragger.EventType.BEFOREDRAG,this,e.clientX,e.clientY,e,g,a));if(c){this.doDrag(e,g,a,false);e.preventDefault()}}}};goog.fx.Dragger.prototype.calculatePosition_=function(e,o){var t=goog.dom.getDomHelper(this.document_).getDocumentScroll();e+=t.x-this.pageScroll.x;o+=t.y-this.pageScroll.y;this.pageScroll=t;this.deltaX+=e;this.deltaY+=o;var i=this.limitX(this.deltaX);var r=this.limitY(this.deltaY);return new goog.math.Coordinate(i,r)};goog.fx.Dragger.prototype.onScroll_=function(e){var o=this.calculatePosition_(0,0);e.clientX=this.clientX;e.clientY=this.clientY;this.doDrag(e,o.x,o.y,true)};goog.fx.Dragger.prototype.doDrag=function(e,o,t,i){this.defaultAction(o,t);this.dispatchEvent(new goog.fx.DragEvent(goog.fx.Dragger.EventType.DRAG,this,e.clientX,e.clientY,e,o,t))};goog.fx.Dragger.prototype.limitX=function(e){var o=this.limits;var t=!isNaN(o.left)?o.left:null;var i=!isNaN(o.width)?o.width:0;var r=null!=t?t+i:1/0;var n=null!=t?t:-1/0;return Math.min(r,Math.max(n,e))};goog.fx.Dragger.prototype.limitY=function(e){var o=this.limits;var t=!isNaN(o.top)?o.top:null;var i=!isNaN(o.height)?o.height:0;var r=null!=t?t+i:1/0;var n=null!=t?t:-1/0;return Math.min(r,Math.max(n,e))};goog.fx.Dragger.prototype.computeInitialPosition=function(){this.deltaX=this.useRightPositioningForRtl_?goog.style.bidi.getOffsetStart(this.target):this.target.offsetLeft;this.deltaY=this.target.offsetTop};goog.fx.Dragger.prototype.defaultAction=function(e,o){if(this.useRightPositioningForRtl_&&this.isRightToLeft_())this.target.style.right=e+"px";else this.target.style.left=e+"px";this.target.style.top=o+"px"};goog.fx.Dragger.prototype.isDragging=function(){return this.dragging_};goog.fx.DragEvent=function(e,o,t,i,r,n,l,s){goog.events.Event.call(this,e);this.clientX=t;this.clientY=i;this.browserEvent=r;this.left=goog.isDef(n)?n:o.deltaX;this.top=goog.isDef(l)?l:o.deltaY;this.dragger=o;this.dragCanceled=!!s};goog.inherits(goog.fx.DragEvent,goog.events.Event);goog.provide("goog.html.SafeUrl");goog.require("goog.asserts");goog.require("goog.fs.url");goog.require("goog.html.TrustedResourceUrl");goog.require("goog.i18n.bidi.Dir");goog.require("goog.i18n.bidi.DirectionalString");goog.require("goog.string");goog.require("goog.string.Const");goog.require("goog.string.TypedString");goog.html.SafeUrl=function(){this.privateDoNotAccessOrElseSafeHtmlWrappedValue_="";this.SAFE_URL_TYPE_MARKER_GOOG_HTML_SECURITY_PRIVATE_=goog.html.SafeUrl.TYPE_MARKER_GOOG_HTML_SECURITY_PRIVATE_};goog.html.SafeUrl.INNOCUOUS_STRING="about:invalid#zClosurez";goog.html.SafeUrl.prototype.implementsGoogStringTypedString=true;goog.html.SafeUrl.prototype.getTypedStringValue=function(){return this.privateDoNotAccessOrElseSafeHtmlWrappedValue_};goog.html.SafeUrl.prototype.implementsGoogI18nBidiDirectionalString=true;goog.html.SafeUrl.prototype.getDirection=function(){return goog.i18n.bidi.Dir.LTR};if(goog.DEBUG)goog.html.SafeUrl.prototype.toString=function(){return"SafeUrl{"+this.privateDoNotAccessOrElseSafeHtmlWrappedValue_+"}"};goog.html.SafeUrl.unwrap=function(e){if(e instanceof goog.html.SafeUrl&&e.constructor===goog.html.SafeUrl&&e.SAFE_URL_TYPE_MARKER_GOOG_HTML_SECURITY_PRIVATE_===goog.html.SafeUrl.TYPE_MARKER_GOOG_HTML_SECURITY_PRIVATE_)return e.privateDoNotAccessOrElseSafeHtmlWrappedValue_;else{goog.asserts.fail("expected object of type SafeUrl, got '"+e+"' of type "+goog.typeOf(e));return"type_error:SafeUrl"}};goog.html.SafeUrl.fromConstant=function(e){return goog.html.SafeUrl.createSafeUrlSecurityPrivateDoNotAccessOrElse(goog.string.Const.unwrap(e))};goog.html.SAFE_MIME_TYPE_PATTERN_=new RegExp("^(?:audio/(?:3gpp|3gpp2|aac|midi|mp4|mpeg|ogg|x-m4a|x-wav|webm)|"+"image/(?:bmp|gif|jpeg|jpg|png|tiff|webp)|"+"text/csv|"+"video/(?:mpeg|mp4|ogg|webm|quicktime))$","i");goog.html.SafeUrl.fromBlob=function(e){var o=goog.html.SAFE_MIME_TYPE_PATTERN_.test(e.type)?goog.fs.url.createObjectUrl(e):goog.html.SafeUrl.INNOCUOUS_STRING;return goog.html.SafeUrl.createSafeUrlSecurityPrivateDoNotAccessOrElse(o)};goog.html.DATA_URL_PATTERN_=/^data:([^;,]*);base64,[a-z0-9+\/]+=*$/i;goog.html.SafeUrl.fromDataUrl=function(e){var o=e.match(goog.html.DATA_URL_PATTERN_);var t=o&&goog.html.SAFE_MIME_TYPE_PATTERN_.test(o[1]);return goog.html.SafeUrl.createSafeUrlSecurityPrivateDoNotAccessOrElse(t?e:goog.html.SafeUrl.INNOCUOUS_STRING)};goog.html.SafeUrl.fromTelUrl=function(e){if(!goog.string.caseInsensitiveStartsWith(e,"tel:"))e=goog.html.SafeUrl.INNOCUOUS_STRING;return goog.html.SafeUrl.createSafeUrlSecurityPrivateDoNotAccessOrElse(e)};goog.html.SafeUrl.fromTrustedResourceUrl=function(e){return goog.html.SafeUrl.createSafeUrlSecurityPrivateDoNotAccessOrElse(goog.html.TrustedResourceUrl.unwrap(e))};goog.html.SAFE_URL_PATTERN_=/^(?:(?:https?|mailto|ftp):|[^:/?#]*(?:[/?#]|$))/i;goog.html.SafeUrl.sanitize=function(e){if(e instanceof goog.html.SafeUrl)return e;else if(e.implementsGoogStringTypedString)e=e.getTypedStringValue();else e=String(e);if(!goog.html.SAFE_URL_PATTERN_.test(e))e=goog.html.SafeUrl.INNOCUOUS_STRING;return goog.html.SafeUrl.createSafeUrlSecurityPrivateDoNotAccessOrElse(e)};goog.html.SafeUrl.sanitizeAssertUnchanged=function(e){if(e instanceof goog.html.SafeUrl)return e;else if(e.implementsGoogStringTypedString)e=e.getTypedStringValue();else e=String(e);if(!goog.asserts.assert(goog.html.SAFE_URL_PATTERN_.test(e)))e=goog.html.SafeUrl.INNOCUOUS_STRING;return goog.html.SafeUrl.createSafeUrlSecurityPrivateDoNotAccessOrElse(e)};goog.html.SafeUrl.TYPE_MARKER_GOOG_HTML_SECURITY_PRIVATE_={};goog.html.SafeUrl.createSafeUrlSecurityPrivateDoNotAccessOrElse=function(e){var o=new goog.html.SafeUrl;o.privateDoNotAccessOrElseSafeHtmlWrappedValue_=e;return o};goog.html.SafeUrl.ABOUT_BLANK=goog.html.SafeUrl.createSafeUrlSecurityPrivateDoNotAccessOrElse("about:blank");goog.provide("goog.html.SafeHtml");goog.require("goog.array");goog.require("goog.asserts");goog.require("goog.dom.TagName");goog.require("goog.dom.tags");goog.require("goog.html.SafeScript");goog.require("goog.html.SafeStyle");goog.require("goog.html.SafeStyleSheet");goog.require("goog.html.SafeUrl");goog.require("goog.html.TrustedResourceUrl");goog.require("goog.i18n.bidi.Dir");goog.require("goog.i18n.bidi.DirectionalString");goog.require("goog.labs.userAgent.browser");goog.require("goog.object");goog.require("goog.string");goog.require("goog.string.Const");goog.require("goog.string.TypedString");goog.html.SafeHtml=function(){this.privateDoNotAccessOrElseSafeHtmlWrappedValue_="";this.SAFE_HTML_TYPE_MARKER_GOOG_HTML_SECURITY_PRIVATE_=goog.html.SafeHtml.TYPE_MARKER_GOOG_HTML_SECURITY_PRIVATE_;this.dir_=null};goog.html.SafeHtml.prototype.implementsGoogI18nBidiDirectionalString=true;goog.html.SafeHtml.prototype.getDirection=function(){return this.dir_};goog.html.SafeHtml.prototype.implementsGoogStringTypedString=true;goog.html.SafeHtml.prototype.getTypedStringValue=function(){return this.privateDoNotAccessOrElseSafeHtmlWrappedValue_};if(goog.DEBUG)goog.html.SafeHtml.prototype.toString=function(){return"SafeHtml{"+this.privateDoNotAccessOrElseSafeHtmlWrappedValue_+"}"};goog.html.SafeHtml.unwrap=function(e){if(e instanceof goog.html.SafeHtml&&e.constructor===goog.html.SafeHtml&&e.SAFE_HTML_TYPE_MARKER_GOOG_HTML_SECURITY_PRIVATE_===goog.html.SafeHtml.TYPE_MARKER_GOOG_HTML_SECURITY_PRIVATE_)return e.privateDoNotAccessOrElseSafeHtmlWrappedValue_;else{goog.asserts.fail("expected object of type SafeHtml, got '"+e+"' of type "+goog.typeOf(e));return"type_error:SafeHtml"}};goog.html.SafeHtml.TextOrHtml_;goog.html.SafeHtml.htmlEscape=function(e){if(e instanceof goog.html.SafeHtml)return e;var o=null;if(e.implementsGoogI18nBidiDirectionalString)o=e.getDirection();var t;if(e.implementsGoogStringTypedString)t=e.getTypedStringValue();else t=String(e);return goog.html.SafeHtml.createSafeHtmlSecurityPrivateDoNotAccessOrElse(goog.string.htmlEscape(t),o)};goog.html.SafeHtml.htmlEscapePreservingNewlines=function(e){if(e instanceof goog.html.SafeHtml)return e;var o=goog.html.SafeHtml.htmlEscape(e);return goog.html.SafeHtml.createSafeHtmlSecurityPrivateDoNotAccessOrElse(goog.string.newLineToBr(goog.html.SafeHtml.unwrap(o)),o.getDirection())};goog.html.SafeHtml.htmlEscapePreservingNewlinesAndSpaces=function(e){if(e instanceof goog.html.SafeHtml)return e;var o=goog.html.SafeHtml.htmlEscape(e);return goog.html.SafeHtml.createSafeHtmlSecurityPrivateDoNotAccessOrElse(goog.string.whitespaceEscape(goog.html.SafeHtml.unwrap(o)),o.getDirection())};goog.html.SafeHtml.from=goog.html.SafeHtml.htmlEscape;goog.html.SafeHtml.VALID_NAMES_IN_TAG_=/^[a-zA-Z0-9-]+$/;goog.html.SafeHtml.URL_ATTRIBUTES_=goog.object.createSet("action","cite","data","formaction","href","manifest","poster","src");goog.html.SafeHtml.NOT_ALLOWED_TAG_NAMES_=goog.object.createSet(goog.dom.TagName.APPLET,goog.dom.TagName.BASE,goog.dom.TagName.EMBED,goog.dom.TagName.IFRAME,goog.dom.TagName.LINK,goog.dom.TagName.MATH,goog.dom.TagName.META,goog.dom.TagName.OBJECT,goog.dom.TagName.SCRIPT,goog.dom.TagName.STYLE,goog.dom.TagName.SVG,goog.dom.TagName.TEMPLATE);goog.html.SafeHtml.AttributeValue;goog.html.SafeHtml.create=function(e,o,t){goog.html.SafeHtml.verifyTagName(String(e));return goog.html.SafeHtml.createSafeHtmlTagSecurityPrivateDoNotAccessOrElse(String(e),o,t)};goog.html.SafeHtml.verifyTagName=function(e){if(!goog.html.SafeHtml.VALID_NAMES_IN_TAG_.test(e))throw new Error("Invalid tag name <"+e+">.");if(e.toUpperCase()in goog.html.SafeHtml.NOT_ALLOWED_TAG_NAMES_)throw new Error("Tag name <"+e+"> is not allowed for SafeHtml.")};goog.html.SafeHtml.createIframe=function(e,o,t,i){if(e)goog.html.TrustedResourceUrl.unwrap(e);var r={};r["src"]=e||null;r["srcdoc"]=o&&goog.html.SafeHtml.unwrap(o);var n={sandbox:""};var l=goog.html.SafeHtml.combineAttributes(r,n,t);return goog.html.SafeHtml.createSafeHtmlTagSecurityPrivateDoNotAccessOrElse("iframe",l,i)};goog.html.SafeHtml.createSandboxIframe=function(e,o,t,i){if(!goog.html.SafeHtml.canUseSandboxIframe())throw new Error("The browser does not support sandboxed iframes.");var r={};if(e)r["src"]=goog.html.SafeUrl.unwrap(goog.html.SafeUrl.sanitize(e));else r["src"]=null;r["srcdoc"]=o||null;r["sandbox"]="";var n=goog.html.SafeHtml.combineAttributes(r,{},t);return goog.html.SafeHtml.createSafeHtmlTagSecurityPrivateDoNotAccessOrElse("iframe",n,i)};goog.html.SafeHtml.canUseSandboxIframe=function(){return goog.global["HTMLIFrameElement"]&&"sandbox"in goog.global["HTMLIFrameElement"].prototype};goog.html.SafeHtml.createScriptSrc=function(e,o){goog.html.TrustedResourceUrl.unwrap(e);var t={src:e};var i={};var r=goog.html.SafeHtml.combineAttributes(t,i,o);return goog.html.SafeHtml.createSafeHtmlTagSecurityPrivateDoNotAccessOrElse("script",r)};goog.html.SafeHtml.createScript=function(e,o){for(var t in o){var i=t.toLowerCase();if("language"==i||"src"==i||"text"==i||"type"==i)throw new Error('Cannot set "'+i+'" attribute')}var r="";e=goog.array.concat(e);for(var n=0;n<e.length;n++)r+=goog.html.SafeScript.unwrap(e[n]);var l=goog.html.SafeHtml.createSafeHtmlSecurityPrivateDoNotAccessOrElse(r,goog.i18n.bidi.Dir.NEUTRAL);return goog.html.SafeHtml.createSafeHtmlTagSecurityPrivateDoNotAccessOrElse("script",o,l)};goog.html.SafeHtml.createStyle=function(e,o){var t={type:"text/css"};var i={};var r=goog.html.SafeHtml.combineAttributes(t,i,o);var n="";e=goog.array.concat(e);for(var l=0;l<e.length;l++)n+=goog.html.SafeStyleSheet.unwrap(e[l]);var s=goog.html.SafeHtml.createSafeHtmlSecurityPrivateDoNotAccessOrElse(n,goog.i18n.bidi.Dir.NEUTRAL);return goog.html.SafeHtml.createSafeHtmlTagSecurityPrivateDoNotAccessOrElse("style",r,s)};goog.html.SafeHtml.createMetaRefresh=function(e,o){var t=goog.html.SafeUrl.unwrap(goog.html.SafeUrl.sanitize(e));if(goog.labs.userAgent.browser.isIE()||goog.labs.userAgent.browser.isEdge())if(goog.string.contains(t,";"))t="'"+t.replace(/'/g,"%27")+"'";var i={"http-equiv":"refresh",content:(o||0)+"; url="+t};return goog.html.SafeHtml.createSafeHtmlTagSecurityPrivateDoNotAccessOrElse("meta",i)};goog.html.SafeHtml.getAttrNameAndValue_=function(e,o,t){if(t instanceof goog.string.Const)t=goog.string.Const.unwrap(t);else if("style"==o.toLowerCase())t=goog.html.SafeHtml.getStyleValue_(t);else if(/^on/i.test(o))throw new Error('Attribute "'+o+'" requires goog.string.Const value, "'+t+'" given.');else if(o.toLowerCase()in goog.html.SafeHtml.URL_ATTRIBUTES_)if(t instanceof goog.html.TrustedResourceUrl)t=goog.html.TrustedResourceUrl.unwrap(t);else if(t instanceof goog.html.SafeUrl)t=goog.html.SafeUrl.unwrap(t);else if(goog.isString(t))t=goog.html.SafeUrl.sanitize(t).getTypedStringValue();else throw new Error('Attribute "'+o+'" on tag "'+e+'" requires goog.html.SafeUrl, goog.string.Const, or string,'+' value "'+t+'" given.');if(t.implementsGoogStringTypedString)t=t.getTypedStringValue();goog.asserts.assert(goog.isString(t)||goog.isNumber(t),"String or number value expected, got "+typeof t+" with value: "+t);return o+'="'+goog.string.htmlEscape(String(t))+'"'};goog.html.SafeHtml.getStyleValue_=function(e){if(!goog.isObject(e))throw new Error('The "style" attribute requires goog.html.SafeStyle or map '+"of style properties, "+typeof e+" given: "+e);if(!(e instanceof goog.html.SafeStyle))e=goog.html.SafeStyle.create(e);return goog.html.SafeStyle.unwrap(e)};goog.html.SafeHtml.createWithDir=function(e,o,t,i){var r=goog.html.SafeHtml.create(o,t,i);r.dir_=e;return r};goog.html.SafeHtml.concat=function(e){var o=goog.i18n.bidi.Dir.NEUTRAL;var t="";var i=function(e){if(goog.isArray(e))goog.array.forEach(e,i);else{var r=goog.html.SafeHtml.htmlEscape(e);t+=goog.html.SafeHtml.unwrap(r);var n=r.getDirection();if(o==goog.i18n.bidi.Dir.NEUTRAL)o=n;else if(n!=goog.i18n.bidi.Dir.NEUTRAL&&o!=n)o=null}};goog.array.forEach(arguments,i);return goog.html.SafeHtml.createSafeHtmlSecurityPrivateDoNotAccessOrElse(t,o)};goog.html.SafeHtml.concatWithDir=function(e,o){var t=goog.html.SafeHtml.concat(goog.array.slice(arguments,1));t.dir_=e;return t};goog.html.SafeHtml.TYPE_MARKER_GOOG_HTML_SECURITY_PRIVATE_={};goog.html.SafeHtml.createSafeHtmlSecurityPrivateDoNotAccessOrElse=function(e,o){return(new goog.html.SafeHtml).initSecurityPrivateDoNotAccessOrElse_(e,o)};goog.html.SafeHtml.prototype.initSecurityPrivateDoNotAccessOrElse_=function(e,o){this.privateDoNotAccessOrElseSafeHtmlWrappedValue_=e;this.dir_=o;return this};goog.html.SafeHtml.createSafeHtmlTagSecurityPrivateDoNotAccessOrElse=function(e,o,t){var i=null;var r="<"+e;r+=goog.html.SafeHtml.stringifyAttributes(e,o);var n=t;if(!goog.isDefAndNotNull(n))n=[];else if(!goog.isArray(n))n=[n];if(goog.dom.tags.isVoidTag(e.toLowerCase())){goog.asserts.assert(!n.length,"Void tag <"+e+"> does not allow content.");r+=">"}else{var l=goog.html.SafeHtml.concat(n);r+=">"+goog.html.SafeHtml.unwrap(l)+"</"+e+">";i=l.getDirection()}var s=o&&o["dir"];if(s)if(/^(ltr|rtl|auto)$/i.test(s))i=goog.i18n.bidi.Dir.NEUTRAL;else i=null;return goog.html.SafeHtml.createSafeHtmlSecurityPrivateDoNotAccessOrElse(r,i)};goog.html.SafeHtml.stringifyAttributes=function(e,o){var t="";if(o)for(var i in o){if(!goog.html.SafeHtml.VALID_NAMES_IN_TAG_.test(i))throw new Error('Invalid attribute name "'+i+'".');var r=o[i];if(!goog.isDefAndNotNull(r))continue;t+=" "+goog.html.SafeHtml.getAttrNameAndValue_(e,i,r)}return t};goog.html.SafeHtml.combineAttributes=function(e,o,t){var i={};var r;for(r in e){goog.asserts.assert(r.toLowerCase()==r,"Must be lower case");i[r]=e[r]}for(r in o){goog.asserts.assert(r.toLowerCase()==r,"Must be lower case");i[r]=o[r]}for(r in t){var n=r.toLowerCase();if(n in e)throw new Error('Cannot override "'+n+'" attribute, got "'+r+'" with value "'+t[r]+'"');if(n in o)delete i[n];i[r]=t[r]}return i};goog.html.SafeHtml.DOCTYPE_HTML=goog.html.SafeHtml.createSafeHtmlSecurityPrivateDoNotAccessOrElse("<!DOCTYPE html>",goog.i18n.bidi.Dir.NEUTRAL);goog.html.SafeHtml.EMPTY=goog.html.SafeHtml.createSafeHtmlSecurityPrivateDoNotAccessOrElse("",goog.i18n.bidi.Dir.NEUTRAL);goog.html.SafeHtml.BR=goog.html.SafeHtml.createSafeHtmlSecurityPrivateDoNotAccessOrElse("<br>",goog.i18n.bidi.Dir.NEUTRAL);goog.provide("goog.html.SafeScript");goog.require("goog.asserts");goog.require("goog.string.Const");goog.require("goog.string.TypedString");goog.html.SafeScript=function(){this.privateDoNotAccessOrElseSafeScriptWrappedValue_="";this.SAFE_SCRIPT_TYPE_MARKER_GOOG_HTML_SECURITY_PRIVATE_=goog.html.SafeScript.TYPE_MARKER_GOOG_HTML_SECURITY_PRIVATE_};goog.html.SafeScript.prototype.implementsGoogStringTypedString=true;goog.html.SafeScript.TYPE_MARKER_GOOG_HTML_SECURITY_PRIVATE_={};goog.html.SafeScript.fromConstant=function(e){var o=goog.string.Const.unwrap(e);if(0===o.length)return goog.html.SafeScript.EMPTY;return goog.html.SafeScript.createSafeScriptSecurityPrivateDoNotAccessOrElse(o)};goog.html.SafeScript.fromConstantAndArgs=function(e,o){var t=[];for(var i=1;i<arguments.length;i++)t.push(goog.html.SafeScript.stringify_(arguments[i]));return goog.html.SafeScript.createSafeScriptSecurityPrivateDoNotAccessOrElse("("+goog.string.Const.unwrap(e)+")("+t.join(", ")+");")};goog.html.SafeScript.prototype.getTypedStringValue=function(){return this.privateDoNotAccessOrElseSafeScriptWrappedValue_};if(goog.DEBUG)goog.html.SafeScript.prototype.toString=function(){return"SafeScript{"+this.privateDoNotAccessOrElseSafeScriptWrappedValue_+"}"};goog.html.SafeScript.unwrap=function(e){if(e instanceof goog.html.SafeScript&&e.constructor===goog.html.SafeScript&&e.SAFE_SCRIPT_TYPE_MARKER_GOOG_HTML_SECURITY_PRIVATE_===goog.html.SafeScript.TYPE_MARKER_GOOG_HTML_SECURITY_PRIVATE_)return e.privateDoNotAccessOrElseSafeScriptWrappedValue_;else{goog.asserts.fail("expected object of type SafeScript, got '"+e+"' of type "+goog.typeOf(e));return"type_error:SafeScript"}};goog.html.SafeScript.stringify_=function(e){var o=JSON.stringify(e);return o.replace(/</g,"\\x3c")};goog.html.SafeScript.createSafeScriptSecurityPrivateDoNotAccessOrElse=function(e){return(new goog.html.SafeScript).initSecurityPrivateDoNotAccessOrElse_(e)};goog.html.SafeScript.prototype.initSecurityPrivateDoNotAccessOrElse_=function(e){this.privateDoNotAccessOrElseSafeScriptWrappedValue_=e;return this};goog.html.SafeScript.EMPTY=goog.html.SafeScript.createSafeScriptSecurityPrivateDoNotAccessOrElse("");goog.provide("goog.html.SafeStyle");goog.require("goog.array");goog.require("goog.asserts");goog.require("goog.html.SafeUrl");goog.require("goog.string");goog.require("goog.string.Const");goog.require("goog.string.TypedString");goog.html.SafeStyle=function(){this.privateDoNotAccessOrElseSafeStyleWrappedValue_="";this.SAFE_STYLE_TYPE_MARKER_GOOG_HTML_SECURITY_PRIVATE_=goog.html.SafeStyle.TYPE_MARKER_GOOG_HTML_SECURITY_PRIVATE_};goog.html.SafeStyle.prototype.implementsGoogStringTypedString=true;goog.html.SafeStyle.TYPE_MARKER_GOOG_HTML_SECURITY_PRIVATE_={};goog.html.SafeStyle.fromConstant=function(e){var o=goog.string.Const.unwrap(e);if(0===o.length)return goog.html.SafeStyle.EMPTY;goog.html.SafeStyle.checkStyle_(o);goog.asserts.assert(goog.string.endsWith(o,";"),"Last character of style string is not ';': "+o);goog.asserts.assert(goog.string.contains(o,":"),"Style string must contain at least one ':', to "+'specify a "name: value" pair: '+o);return goog.html.SafeStyle.createSafeStyleSecurityPrivateDoNotAccessOrElse(o)};goog.html.SafeStyle.checkStyle_=function(e){goog.asserts.assert(!/[<>]/.test(e),"Forbidden characters in style string: "+e)};goog.html.SafeStyle.prototype.getTypedStringValue=function(){return this.privateDoNotAccessOrElseSafeStyleWrappedValue_};if(goog.DEBUG)goog.html.SafeStyle.prototype.toString=function(){return"SafeStyle{"+this.privateDoNotAccessOrElseSafeStyleWrappedValue_+"}"};goog.html.SafeStyle.unwrap=function(e){if(e instanceof goog.html.SafeStyle&&e.constructor===goog.html.SafeStyle&&e.SAFE_STYLE_TYPE_MARKER_GOOG_HTML_SECURITY_PRIVATE_===goog.html.SafeStyle.TYPE_MARKER_GOOG_HTML_SECURITY_PRIVATE_)return e.privateDoNotAccessOrElseSafeStyleWrappedValue_;else{goog.asserts.fail("expected object of type SafeStyle, got '"+e+"' of type "+goog.typeOf(e));return"type_error:SafeStyle"}};goog.html.SafeStyle.createSafeStyleSecurityPrivateDoNotAccessOrElse=function(e){return(new goog.html.SafeStyle).initSecurityPrivateDoNotAccessOrElse_(e)};goog.html.SafeStyle.prototype.initSecurityPrivateDoNotAccessOrElse_=function(e){this.privateDoNotAccessOrElseSafeStyleWrappedValue_=e;return this};goog.html.SafeStyle.EMPTY=goog.html.SafeStyle.createSafeStyleSecurityPrivateDoNotAccessOrElse("");goog.html.SafeStyle.INNOCUOUS_STRING="zClosurez";goog.html.SafeStyle.PropertyValue;goog.html.SafeStyle.PropertyMap;goog.html.SafeStyle.create=function(e){var o="";for(var t in e){if(!/^[-_a-zA-Z0-9]+$/.test(t))throw new Error("Name allows only [-_a-zA-Z0-9], got: "+t);var i=e[t];if(null==i)continue;if(goog.isArray(i))i=goog.array.map(i,goog.html.SafeStyle.sanitizePropertyValue_).join(" ");else i=goog.html.SafeStyle.sanitizePropertyValue_(i);o+=t+":"+i+";"}if(!o)return goog.html.SafeStyle.EMPTY;goog.html.SafeStyle.checkStyle_(o);return goog.html.SafeStyle.createSafeStyleSecurityPrivateDoNotAccessOrElse(o)};goog.html.SafeStyle.sanitizePropertyValue_=function(e){if(e instanceof goog.html.SafeUrl){var o=goog.html.SafeUrl.unwrap(e);return'url("'+o.replace(/</g,"%3c").replace(/[\\"]/g,"\\$&")+'")'}var t=e instanceof goog.string.Const?goog.string.Const.unwrap(e):goog.html.SafeStyle.sanitizePropertyValueString_(String(e));goog.asserts.assert(!/[{;}]/.test(t),"Value does not allow [{;}].");return t};goog.html.SafeStyle.sanitizePropertyValueString_=function(e){var o=e.replace(goog.html.SafeUrl.FUNCTIONS_RE_,"$1").replace(goog.html.SafeUrl.URL_RE_,"url");if(!goog.html.SafeStyle.VALUE_RE_.test(o)){goog.asserts.fail("String value allows only "+goog.html.SafeStyle.VALUE_ALLOWED_CHARS_+" and simple functions, got: "+e);return goog.html.SafeStyle.INNOCUOUS_STRING}else if(!goog.html.SafeStyle.hasBalancedQuotes_(e)){goog.asserts.fail("String value requires balanced quotes, got: "+e);return goog.html.SafeStyle.INNOCUOUS_STRING}return goog.html.SafeStyle.sanitizeUrl_(e)};goog.html.SafeStyle.hasBalancedQuotes_=function(e){var o=true;var t=true;for(var i=0;i<e.length;i++){var r=e.charAt(i);if("'"==r&&t)o=!o;else if('"'==r&&o)t=!t}return o&&t};goog.html.SafeStyle.VALUE_ALLOWED_CHARS_="[-,.\"'%_!# a-zA-Z0-9]";goog.html.SafeStyle.VALUE_RE_=new RegExp("^"+goog.html.SafeStyle.VALUE_ALLOWED_CHARS_+"+$");goog.html.SafeUrl.URL_RE_=new RegExp("\\b(url\\([ \t\n]*)("+"'[ -&(-\\[\\]-~]*'"+'|"[ !#-\\[\\]-~]*"'+"|[!#-&*-\\[\\]-~]*"+")([ \t\n]*\\))","g");goog.html.SafeUrl.FUNCTIONS_RE_=new RegExp("\\b(hsl|hsla|rgb|rgba|(rotate|scale|translate)(X|Y|Z|3d)?)"+"\\([-0-9a-z.%, ]+\\)","g");goog.html.SafeStyle.sanitizeUrl_=function(e){return e.replace(goog.html.SafeUrl.URL_RE_,(function(e,o,t,i){var r="";t=t.replace(/^(['"])(.*)\1$/,(function(e,o,t){r=o;return t}));var n=goog.html.SafeUrl.sanitize(t).getTypedStringValue();return o+r+n+r+i}))};goog.html.SafeStyle.concat=function(e){var o="";var t=function(e){if(goog.isArray(e))goog.array.forEach(e,t);else o+=goog.html.SafeStyle.unwrap(e)};goog.array.forEach(arguments,t);if(!o)return goog.html.SafeStyle.EMPTY;return goog.html.SafeStyle.createSafeStyleSecurityPrivateDoNotAccessOrElse(o)};goog.provide("goog.html.SafeStyleSheet");goog.require("goog.array");goog.require("goog.asserts");goog.require("goog.html.SafeStyle");goog.require("goog.object");goog.require("goog.string");goog.require("goog.string.Const");goog.require("goog.string.TypedString");goog.html.SafeStyleSheet=function(){this.privateDoNotAccessOrElseSafeStyleSheetWrappedValue_="";this.SAFE_STYLE_SHEET_TYPE_MARKER_GOOG_HTML_SECURITY_PRIVATE_=goog.html.SafeStyleSheet.TYPE_MARKER_GOOG_HTML_SECURITY_PRIVATE_};goog.html.SafeStyleSheet.prototype.implementsGoogStringTypedString=true;goog.html.SafeStyleSheet.TYPE_MARKER_GOOG_HTML_SECURITY_PRIVATE_={};goog.html.SafeStyleSheet.createRule=function(e,o){if(goog.string.contains(e,"<"))throw new Error("Selector does not allow '<', got: "+e);var t=e.replace(/('|")((?!\1)[^\r\n\f\\]|\\[\s\S])*\1/g,"");if(!/^[-_a-zA-Z0-9#.:* ,>+~[\]()=^$|]+$/.test(t))throw new Error("Selector allows only [-_a-zA-Z0-9#.:* ,>+~[\\]()=^$|] and "+"strings, got: "+e);if(!goog.html.SafeStyleSheet.hasBalancedBrackets_(t))throw new Error("() and [] in selector must be balanced, got: "+e);if(!(o instanceof goog.html.SafeStyle))o=goog.html.SafeStyle.create(o);var i=e+"{"+goog.html.SafeStyle.unwrap(o)+"}";return goog.html.SafeStyleSheet.createSafeStyleSheetSecurityPrivateDoNotAccessOrElse(i)};goog.html.SafeStyleSheet.hasBalancedBrackets_=function(e){var o={"(":")","[":"]"};var t=[];for(var i=0;i<e.length;i++){var r=e[i];if(o[r])t.push(o[r]);else if(goog.object.contains(o,r))if(t.pop()!=r)return false}return 0==t.length};goog.html.SafeStyleSheet.concat=function(e){var o="";var t=function(e){if(goog.isArray(e))goog.array.forEach(e,t);else o+=goog.html.SafeStyleSheet.unwrap(e)};goog.array.forEach(arguments,t);return goog.html.SafeStyleSheet.createSafeStyleSheetSecurityPrivateDoNotAccessOrElse(o)};goog.html.SafeStyleSheet.fromConstant=function(e){var o=goog.string.Const.unwrap(e);if(0===o.length)return goog.html.SafeStyleSheet.EMPTY;goog.asserts.assert(!goog.string.contains(o,"<"),"Forbidden '<' character in style sheet string: "+o);return goog.html.SafeStyleSheet.createSafeStyleSheetSecurityPrivateDoNotAccessOrElse(o)};goog.html.SafeStyleSheet.prototype.getTypedStringValue=function(){return this.privateDoNotAccessOrElseSafeStyleSheetWrappedValue_};if(goog.DEBUG)goog.html.SafeStyleSheet.prototype.toString=function(){return"SafeStyleSheet{"+this.privateDoNotAccessOrElseSafeStyleSheetWrappedValue_+"}"};goog.html.SafeStyleSheet.unwrap=function(e){if(e instanceof goog.html.SafeStyleSheet&&e.constructor===goog.html.SafeStyleSheet&&e.SAFE_STYLE_SHEET_TYPE_MARKER_GOOG_HTML_SECURITY_PRIVATE_===goog.html.SafeStyleSheet.TYPE_MARKER_GOOG_HTML_SECURITY_PRIVATE_)return e.privateDoNotAccessOrElseSafeStyleSheetWrappedValue_;else{goog.asserts.fail("expected object of type SafeStyleSheet, got '"+e+"' of type "+goog.typeOf(e));return"type_error:SafeStyleSheet"}};goog.html.SafeStyleSheet.createSafeStyleSheetSecurityPrivateDoNotAccessOrElse=function(e){return(new goog.html.SafeStyleSheet).initSecurityPrivateDoNotAccessOrElse_(e)};goog.html.SafeStyleSheet.prototype.initSecurityPrivateDoNotAccessOrElse_=function(e){this.privateDoNotAccessOrElseSafeStyleSheetWrappedValue_=e;return this};goog.html.SafeStyleSheet.EMPTY=goog.html.SafeStyleSheet.createSafeStyleSheetSecurityPrivateDoNotAccessOrElse("");goog.provide("goog.html.TrustedResourceUrl");goog.require("goog.asserts");goog.require("goog.i18n.bidi.Dir");goog.require("goog.i18n.bidi.DirectionalString");goog.require("goog.string.Const");goog.require("goog.string.TypedString");goog.html.TrustedResourceUrl=function(){this.privateDoNotAccessOrElseTrustedResourceUrlWrappedValue_="";this.TRUSTED_RESOURCE_URL_TYPE_MARKER_GOOG_HTML_SECURITY_PRIVATE_=goog.html.TrustedResourceUrl.TYPE_MARKER_GOOG_HTML_SECURITY_PRIVATE_};goog.html.TrustedResourceUrl.prototype.implementsGoogStringTypedString=true;goog.html.TrustedResourceUrl.prototype.getTypedStringValue=function(){return this.privateDoNotAccessOrElseTrustedResourceUrlWrappedValue_};goog.html.TrustedResourceUrl.prototype.implementsGoogI18nBidiDirectionalString=true;goog.html.TrustedResourceUrl.prototype.getDirection=function(){return goog.i18n.bidi.Dir.LTR};goog.html.TrustedResourceUrl.prototype.cloneWithParams=function(e){var o=goog.html.TrustedResourceUrl.unwrap(this);var t=/\?/.test(o)?"&":"?";for(var i in e){var r=goog.isArray(e[i])?e[i]:[e[i]];for(var n=0;n<r.length;n++){if(null==r[n])continue;o+=t+encodeURIComponent(i)+"="+encodeURIComponent(String(r[n]));t="&"}}return goog.html.TrustedResourceUrl.createTrustedResourceUrlSecurityPrivateDoNotAccessOrElse(o)};if(goog.DEBUG)goog.html.TrustedResourceUrl.prototype.toString=function(){return"TrustedResourceUrl{"+this.privateDoNotAccessOrElseTrustedResourceUrlWrappedValue_+"}"};goog.html.TrustedResourceUrl.unwrap=function(e){if(e instanceof goog.html.TrustedResourceUrl&&e.constructor===goog.html.TrustedResourceUrl&&e.TRUSTED_RESOURCE_URL_TYPE_MARKER_GOOG_HTML_SECURITY_PRIVATE_===goog.html.TrustedResourceUrl.TYPE_MARKER_GOOG_HTML_SECURITY_PRIVATE_)return e.privateDoNotAccessOrElseTrustedResourceUrlWrappedValue_;else{goog.asserts.fail("expected object of type TrustedResourceUrl, got '"+e+"' of type "+goog.typeOf(e));return"type_error:TrustedResourceUrl"}};goog.html.TrustedResourceUrl.format=function(e,o){var t=goog.string.Const.unwrap(e);if(!goog.html.TrustedResourceUrl.BASE_URL_.test(t))throw new Error("Invalid TrustedResourceUrl format: "+t);var i=t.replace(goog.html.TrustedResourceUrl.FORMAT_MARKER_,(function(e,i){if(!Object.prototype.hasOwnProperty.call(o,i))throw new Error('Found marker, "'+i+'", in format string, "'+t+'", but no valid label mapping found '+"in args: "+JSON.stringify(o));var r=o[i];if(r instanceof goog.string.Const)return goog.string.Const.unwrap(r);else return encodeURIComponent(String(r))}));return goog.html.TrustedResourceUrl.createTrustedResourceUrlSecurityPrivateDoNotAccessOrElse(i)};goog.html.TrustedResourceUrl.FORMAT_MARKER_=/%{(\w+)}/g;goog.html.TrustedResourceUrl.BASE_URL_=/^(?:https:)?\/\/[0-9a-z.:[\]-]+\/|^\/[^\/\\]|^about:blank#/i;goog.html.TrustedResourceUrl.formatWithParams=function(e,o,t){var i=goog.html.TrustedResourceUrl.format(e,o);return i.cloneWithParams(t)};goog.html.TrustedResourceUrl.fromConstant=function(e){return goog.html.TrustedResourceUrl.createTrustedResourceUrlSecurityPrivateDoNotAccessOrElse(goog.string.Const.unwrap(e))};goog.html.TrustedResourceUrl.fromConstants=function(e){var o="";for(var t=0;t<e.length;t++)o+=goog.string.Const.unwrap(e[t]);return goog.html.TrustedResourceUrl.createTrustedResourceUrlSecurityPrivateDoNotAccessOrElse(o)};goog.html.TrustedResourceUrl.TYPE_MARKER_GOOG_HTML_SECURITY_PRIVATE_={};goog.html.TrustedResourceUrl.createTrustedResourceUrlSecurityPrivateDoNotAccessOrElse=function(e){var o=new goog.html.TrustedResourceUrl;o.privateDoNotAccessOrElseTrustedResourceUrlWrappedValue_=e;return o};goog.provide("goog.html.uncheckedconversions");goog.require("goog.asserts");goog.require("goog.html.SafeHtml");goog.require("goog.html.SafeScript");goog.require("goog.html.SafeStyle");goog.require("goog.html.SafeStyleSheet");goog.require("goog.html.SafeUrl");goog.require("goog.html.TrustedResourceUrl");goog.require("goog.string");goog.require("goog.string.Const");goog.html.uncheckedconversions.safeHtmlFromStringKnownToSatisfyTypeContract=function(e,o,t){goog.asserts.assertString(goog.string.Const.unwrap(e),"must provide justification");goog.asserts.assert(!goog.string.isEmptyOrWhitespace(goog.string.Const.unwrap(e)),"must provide non-empty justification");return goog.html.SafeHtml.createSafeHtmlSecurityPrivateDoNotAccessOrElse(o,t||null)};goog.html.uncheckedconversions.safeScriptFromStringKnownToSatisfyTypeContract=function(e,o){goog.asserts.assertString(goog.string.Const.unwrap(e),"must provide justification");goog.asserts.assert(!goog.string.isEmptyOrWhitespace(goog.string.Const.unwrap(e)),"must provide non-empty justification");return goog.html.SafeScript.createSafeScriptSecurityPrivateDoNotAccessOrElse(o)};goog.html.uncheckedconversions.safeStyleFromStringKnownToSatisfyTypeContract=function(e,o){goog.asserts.assertString(goog.string.Const.unwrap(e),"must provide justification");goog.asserts.assert(!goog.string.isEmptyOrWhitespace(goog.string.Const.unwrap(e)),"must provide non-empty justification");return goog.html.SafeStyle.createSafeStyleSecurityPrivateDoNotAccessOrElse(o)};goog.html.uncheckedconversions.safeStyleSheetFromStringKnownToSatisfyTypeContract=function(e,o){goog.asserts.assertString(goog.string.Const.unwrap(e),"must provide justification");goog.asserts.assert(!goog.string.isEmptyOrWhitespace(goog.string.Const.unwrap(e)),"must provide non-empty justification");return goog.html.SafeStyleSheet.createSafeStyleSheetSecurityPrivateDoNotAccessOrElse(o)};goog.html.uncheckedconversions.safeUrlFromStringKnownToSatisfyTypeContract=function(e,o){goog.asserts.assertString(goog.string.Const.unwrap(e),"must provide justification");goog.asserts.assert(!goog.string.isEmptyOrWhitespace(goog.string.Const.unwrap(e)),"must provide non-empty justification");return goog.html.SafeUrl.createSafeUrlSecurityPrivateDoNotAccessOrElse(o)};goog.html.uncheckedconversions.trustedResourceUrlFromStringKnownToSatisfyTypeContract=function(e,o){goog.asserts.assertString(goog.string.Const.unwrap(e),"must provide justification");goog.asserts.assert(!goog.string.isEmptyOrWhitespace(goog.string.Const.unwrap(e)),"must provide non-empty justification");return goog.html.TrustedResourceUrl.createTrustedResourceUrlSecurityPrivateDoNotAccessOrElse(o)};goog.provide("goog.log");goog.provide("goog.log.Level");goog.provide("goog.log.LogRecord");goog.provide("goog.log.Logger");goog.require("goog.debug");goog.require("goog.debug.LogManager");goog.require("goog.debug.LogRecord");goog.require("goog.debug.Logger");goog.define("goog.log.ENABLED",goog.debug.LOGGING_ENABLED);goog.log.ROOT_LOGGER_NAME=goog.debug.Logger.ROOT_LOGGER_NAME;goog.log.Logger=goog.debug.Logger;goog.log.Level=goog.debug.Logger.Level;goog.log.LogRecord=goog.debug.LogRecord;goog.log.getLogger=function(e,o){if(goog.log.ENABLED){var t=goog.debug.LogManager.getLogger(e);if(o&&t)t.setLevel(o);return t}else return null};goog.log.addHandler=function(e,o){if(goog.log.ENABLED&&e)e.addHandler(o)};goog.log.removeHandler=function(e,o){if(goog.log.ENABLED&&e)return e.removeHandler(o);else return false};goog.log.log=function(e,o,t,i){if(goog.log.ENABLED&&e)e.log(o,t,i)};goog.log.error=function(e,o,t){if(goog.log.ENABLED&&e)e.severe(o,t)};goog.log.warning=function(e,o,t){if(goog.log.ENABLED&&e)e.warning(o,t)};goog.log.info=function(e,o,t){if(goog.log.ENABLED&&e)e.info(o,t)};goog.log.fine=function(e,o,t){if(goog.log.ENABLED&&e)e.fine(o,t)};goog.provide("goog.math.Box");goog.require("goog.asserts");goog.require("goog.math.Coordinate");goog.math.Box=function(e,o,t,i){this.top=e;this.right=o;this.bottom=t;this.left=i};goog.math.Box.boundingBox=function(e){var o=new goog.math.Box(arguments[0].y,arguments[0].x,arguments[0].y,arguments[0].x);for(var t=1;t<arguments.length;t++)o.expandToIncludeCoordinate(arguments[t]);return o};goog.math.Box.prototype.getWidth=function(){return this.right-this.left};goog.math.Box.prototype.getHeight=function(){return this.bottom-this.top};goog.math.Box.prototype.clone=function(){return new goog.math.Box(this.top,this.right,this.bottom,this.left)};if(goog.DEBUG)goog.math.Box.prototype.toString=function(){return"("+this.top+"t, "+this.right+"r, "+this.bottom+"b, "+this.left+"l)"};goog.math.Box.prototype.contains=function(e){return goog.math.Box.contains(this,e)};goog.math.Box.prototype.expand=function(e,o,t,i){if(goog.isObject(e)){this.top-=e.top;this.right+=e.right;this.bottom+=e.bottom;this.left-=e.left}else{this.top-=e;this.right+=Number(o);this.bottom+=Number(t);this.left-=Number(i)}return this};goog.math.Box.prototype.expandToInclude=function(e){this.left=Math.min(this.left,e.left);this.top=Math.min(this.top,e.top);this.right=Math.max(this.right,e.right);this.bottom=Math.max(this.bottom,e.bottom)};goog.math.Box.prototype.expandToIncludeCoordinate=function(e){this.top=Math.min(this.top,e.y);this.right=Math.max(this.right,e.x);this.bottom=Math.max(this.bottom,e.y);this.left=Math.min(this.left,e.x)};goog.math.Box.equals=function(e,o){if(e==o)return true;if(!e||!o)return false;return e.top==o.top&&e.right==o.right&&e.bottom==o.bottom&&e.left==o.left};goog.math.Box.contains=function(e,o){if(!e||!o)return false;if(o instanceof goog.math.Box)return o.left>=e.left&&o.right<=e.right&&o.top>=e.top&&o.bottom<=e.bottom;return o.x>=e.left&&o.x<=e.right&&o.y>=e.top&&o.y<=e.bottom};goog.math.Box.relativePositionX=function(e,o){if(o.x<e.left)return o.x-e.left;else if(o.x>e.right)return o.x-e.right;return 0};goog.math.Box.relativePositionY=function(e,o){if(o.y<e.top)return o.y-e.top;else if(o.y>e.bottom)return o.y-e.bottom;return 0};goog.math.Box.distance=function(e,o){var t=goog.math.Box.relativePositionX(e,o);var i=goog.math.Box.relativePositionY(e,o);return Math.sqrt(t*t+i*i)};goog.math.Box.intersects=function(e,o){return e.left<=o.right&&o.left<=e.right&&e.top<=o.bottom&&o.top<=e.bottom};goog.math.Box.intersectsWithPadding=function(e,o,t){return e.left<=o.right+t&&o.left<=e.right+t&&e.top<=o.bottom+t&&o.top<=e.bottom+t};goog.math.Box.prototype.ceil=function(){this.top=Math.ceil(this.top);this.right=Math.ceil(this.right);this.bottom=Math.ceil(this.bottom);this.left=Math.ceil(this.left);return this};goog.math.Box.prototype.floor=function(){this.top=Math.floor(this.top);this.right=Math.floor(this.right);this.bottom=Math.floor(this.bottom);this.left=Math.floor(this.left);return this};goog.math.Box.prototype.round=function(){this.top=Math.round(this.top);this.right=Math.round(this.right);this.bottom=Math.round(this.bottom);this.left=Math.round(this.left);return this};goog.math.Box.prototype.translate=function(e,o){if(e instanceof goog.math.Coordinate){this.left+=e.x;this.right+=e.x;this.top+=e.y;this.bottom+=e.y}else{goog.asserts.assertNumber(e);this.left+=e;this.right+=e;if(goog.isNumber(o)){this.top+=o;this.bottom+=o}}return this};goog.math.Box.prototype.scale=function(e,o){var t=goog.isNumber(o)?o:e;this.left*=e;this.right*=e;this.top*=t;this.bottom*=t;return this};goog.provide("goog.math.Coordinate");goog.require("goog.math");goog.math.Coordinate=function(e,o){this.x=goog.isDef(e)?e:0;this.y=goog.isDef(o)?o:0};goog.math.Coordinate.prototype.clone=function(){return new goog.math.Coordinate(this.x,this.y)};if(goog.DEBUG)goog.math.Coordinate.prototype.toString=function(){return"("+this.x+", "+this.y+")"};goog.math.Coordinate.prototype.equals=function(e){return e instanceof goog.math.Coordinate&&goog.math.Coordinate.equals(this,e)};goog.math.Coordinate.equals=function(e,o){if(e==o)return true;if(!e||!o)return false;return e.x==o.x&&e.y==o.y};goog.math.Coordinate.distance=function(e,o){var t=e.x-o.x;var i=e.y-o.y;return Math.sqrt(t*t+i*i)};goog.math.Coordinate.magnitude=function(e){return Math.sqrt(e.x*e.x+e.y*e.y)};goog.math.Coordinate.azimuth=function(e){return goog.math.angle(0,0,e.x,e.y)};goog.math.Coordinate.squaredDistance=function(e,o){var t=e.x-o.x;var i=e.y-o.y;return t*t+i*i};goog.math.Coordinate.difference=function(e,o){return new goog.math.Coordinate(e.x-o.x,e.y-o.y)};goog.math.Coordinate.sum=function(e,o){return new goog.math.Coordinate(e.x+o.x,e.y+o.y)};goog.math.Coordinate.prototype.ceil=function(){this.x=Math.ceil(this.x);this.y=Math.ceil(this.y);return this};goog.math.Coordinate.prototype.floor=function(){this.x=Math.floor(this.x);this.y=Math.floor(this.y);return this};goog.math.Coordinate.prototype.round=function(){this.x=Math.round(this.x);this.y=Math.round(this.y);return this};goog.math.Coordinate.prototype.translate=function(e,o){if(e instanceof goog.math.Coordinate){this.x+=e.x;this.y+=e.y}else{this.x+=Number(e);if(goog.isNumber(o))this.y+=o}return this};goog.math.Coordinate.prototype.scale=function(e,o){var t=goog.isNumber(o)?o:e;this.x*=e;this.y*=t;return this};goog.math.Coordinate.prototype.rotateRadians=function(e,o){var t=o||new goog.math.Coordinate(0,0);var i=this.x;var r=this.y;var n=Math.cos(e);var l=Math.sin(e);this.x=(i-t.x)*n-(r-t.y)*l+t.x;this.y=(i-t.x)*l+(r-t.y)*n+t.y};goog.math.Coordinate.prototype.rotateDegrees=function(e,o){this.rotateRadians(goog.math.toRadians(e),o)};goog.provide("goog.math.IRect");goog.math.IRect=function(){};goog.math.IRect.prototype.left;goog.math.IRect.prototype.top;goog.math.IRect.prototype.width;goog.math.IRect.prototype.height;goog.provide("goog.math");goog.require("goog.array");goog.require("goog.asserts");goog.math.randomInt=function(e){return Math.floor(Math.random()*e)};goog.math.uniformRandom=function(e,o){return e+Math.random()*(o-e)};goog.math.clamp=function(e,o,t){return Math.min(Math.max(e,o),t)};goog.math.modulo=function(e,o){var t=e%o;return t*o<0?t+o:t};goog.math.lerp=function(e,o,t){return e+t*(o-e)};goog.math.nearlyEquals=function(e,o,t){return Math.abs(e-o)<=(t||1e-6)};goog.math.standardAngle=function(e){return goog.math.modulo(e,360)};goog.math.standardAngleInRadians=function(e){return goog.math.modulo(e,2*Math.PI)};goog.math.toRadians=function(e){return e*Math.PI/180};goog.math.toDegrees=function(e){return 180*e/Math.PI};goog.math.angleDx=function(e,o){return o*Math.cos(goog.math.toRadians(e))};goog.math.angleDy=function(e,o){return o*Math.sin(goog.math.toRadians(e))};goog.math.angle=function(e,o,t,i){return goog.math.standardAngle(goog.math.toDegrees(Math.atan2(i-o,t-e)))};goog.math.angleDifference=function(e,o){var t=goog.math.standardAngle(o)-goog.math.standardAngle(e);if(t>180)t-=360;else if(t<=-180)t=360+t;return t};goog.math.sign=function(e){if(e>0)return 1;if(e<0)return-1;return e};goog.math.longestCommonSubsequence=function(e,o,t,i){var r=t||function(e,o){return e==o};var n=i||function(o,t){return e[o]};var l=e.length;var s=o.length;var g=[];for(var a=0;a<l+1;a++){g[a]=[];g[a][0]=0}for(var c=0;c<s+1;c++)g[0][c]=0;for(a=1;a<=l;a++)for(c=1;c<=s;c++)if(r(e[a-1],o[c-1]))g[a][c]=g[a-1][c-1]+1;else g[a][c]=Math.max(g[a-1][c],g[a][c-1]);var u=[];var a=l,c=s;while(a>0&&c>0)if(r(e[a-1],o[c-1])){u.unshift(n(a-1,c-1));a--;c--}else if(g[a-1][c]>g[a][c-1])a--;else c--;return u};goog.math.sum=function(e){return goog.array.reduce(arguments,(function(e,o){return e+o}),0)};goog.math.average=function(e){return goog.math.sum.apply(null,arguments)/arguments.length};goog.math.sampleVariance=function(e){var o=arguments.length;if(o<2)return 0;var t=goog.math.average.apply(null,arguments);var i=goog.math.sum.apply(null,goog.array.map(arguments,(function(e){return Math.pow(e-t,2)})))/(o-1);return i};goog.math.standardDeviation=function(e){return Math.sqrt(goog.math.sampleVariance.apply(null,arguments))};goog.math.isInt=function(e){return isFinite(e)&&e%1==0};goog.math.isFiniteNumber=function(e){return isFinite(e)};goog.math.isNegativeZero=function(e){return 0==e&&1/e<0};goog.math.log10Floor=function(e){if(e>0){var o=Math.round(Math.log(e)*Math.LOG10E);return o-(parseFloat("1e"+o)>e?1:0)}return 0==e?-1/0:NaN};goog.math.safeFloor=function(e,o){goog.asserts.assert(!goog.isDef(o)||o>0);return Math.floor(e+(o||2e-15))};goog.math.safeCeil=function(e,o){goog.asserts.assert(!goog.isDef(o)||o>0);return Math.ceil(e-(o||2e-15))};goog.provide("goog.math.Rect");goog.require("goog.asserts");goog.require("goog.math.Box");goog.require("goog.math.Coordinate");goog.require("goog.math.IRect");goog.require("goog.math.Size");goog.math.Rect=function(e,o,t,i){this.left=e;this.top=o;this.width=t;this.height=i};goog.math.Rect.prototype.clone=function(){return new goog.math.Rect(this.left,this.top,this.width,this.height)};goog.math.Rect.prototype.toBox=function(){var e=this.left+this.width;var o=this.top+this.height;return new goog.math.Box(this.top,e,o,this.left)};goog.math.Rect.createFromPositionAndSize=function(e,o){return new goog.math.Rect(e.x,e.y,o.width,o.height)};goog.math.Rect.createFromBox=function(e){return new goog.math.Rect(e.left,e.top,e.right-e.left,e.bottom-e.top)};if(goog.DEBUG)goog.math.Rect.prototype.toString=function(){return"("+this.left+", "+this.top+" - "+this.width+"w x "+this.height+"h)"};goog.math.Rect.equals=function(e,o){if(e==o)return true;if(!e||!o)return false;return e.left==o.left&&e.width==o.width&&e.top==o.top&&e.height==o.height};goog.math.Rect.prototype.intersection=function(e){var o=Math.max(this.left,e.left);var t=Math.min(this.left+this.width,e.left+e.width);if(o<=t){var i=Math.max(this.top,e.top);var r=Math.min(this.top+this.height,e.top+e.height);if(i<=r){this.left=o;this.top=i;this.width=t-o;this.height=r-i;return true}}return false};goog.math.Rect.intersection=function(e,o){var t=Math.max(e.left,o.left);var i=Math.min(e.left+e.width,o.left+o.width);if(t<=i){var r=Math.max(e.top,o.top);var n=Math.min(e.top+e.height,o.top+o.height);if(r<=n)return new goog.math.Rect(t,r,i-t,n-r)}return null};goog.math.Rect.intersects=function(e,o){return e.left<=o.left+o.width&&o.left<=e.left+e.width&&e.top<=o.top+o.height&&o.top<=e.top+e.height};goog.math.Rect.prototype.intersects=function(e){return goog.math.Rect.intersects(this,e)};goog.math.Rect.difference=function(e,o){var t=goog.math.Rect.intersection(e,o);if(!t||!t.height||!t.width)return[e.clone()];var i=[];var r=e.top;var n=e.height;var l=e.left+e.width;var s=e.top+e.height;var g=o.left+o.width;var a=o.top+o.height;if(o.top>e.top){i.push(new goog.math.Rect(e.left,e.top,e.width,o.top-e.top));r=o.top;n-=o.top-e.top}if(a<s){i.push(new goog.math.Rect(e.left,a,e.width,s-a));n=a-r}if(o.left>e.left)i.push(new goog.math.Rect(e.left,r,o.left-e.left,n));if(g<l)i.push(new goog.math.Rect(g,r,l-g,n));return i};goog.math.Rect.prototype.difference=function(e){return goog.math.Rect.difference(this,e)};goog.math.Rect.prototype.boundingRect=function(e){var o=Math.max(this.left+this.width,e.left+e.width);var t=Math.max(this.top+this.height,e.top+e.height);this.left=Math.min(this.left,e.left);this.top=Math.min(this.top,e.top);this.width=o-this.left;this.height=t-this.top};goog.math.Rect.boundingRect=function(e,o){if(!e||!o)return null;var t=new goog.math.Rect(e.left,e.top,e.width,e.height);t.boundingRect(o);return t};goog.math.Rect.prototype.contains=function(e){if(e instanceof goog.math.Coordinate)return e.x>=this.left&&e.x<=this.left+this.width&&e.y>=this.top&&e.y<=this.top+this.height;else return this.left<=e.left&&this.left+this.width>=e.left+e.width&&this.top<=e.top&&this.top+this.height>=e.top+e.height};goog.math.Rect.prototype.squaredDistance=function(e){var o=e.x<this.left?this.left-e.x:Math.max(e.x-(this.left+this.width),0);var t=e.y<this.top?this.top-e.y:Math.max(e.y-(this.top+this.height),0);return o*o+t*t};goog.math.Rect.prototype.distance=function(e){return Math.sqrt(this.squaredDistance(e))};goog.math.Rect.prototype.getSize=function(){return new goog.math.Size(this.width,this.height)};goog.math.Rect.prototype.getTopLeft=function(){return new goog.math.Coordinate(this.left,this.top)};goog.math.Rect.prototype.getCenter=function(){return new goog.math.Coordinate(this.left+this.width/2,this.top+this.height/2)};goog.math.Rect.prototype.getBottomRight=function(){return new goog.math.Coordinate(this.left+this.width,this.top+this.height)};goog.math.Rect.prototype.ceil=function(){this.left=Math.ceil(this.left);this.top=Math.ceil(this.top);this.width=Math.ceil(this.width);this.height=Math.ceil(this.height);return this};goog.math.Rect.prototype.floor=function(){this.left=Math.floor(this.left);this.top=Math.floor(this.top);this.width=Math.floor(this.width);this.height=Math.floor(this.height);return this};goog.math.Rect.prototype.round=function(){this.left=Math.round(this.left);this.top=Math.round(this.top);this.width=Math.round(this.width);this.height=Math.round(this.height);return this};goog.math.Rect.prototype.translate=function(e,o){if(e instanceof goog.math.Coordinate){this.left+=e.x;this.top+=e.y}else{this.left+=goog.asserts.assertNumber(e);if(goog.isNumber(o))this.top+=o}return this};goog.math.Rect.prototype.scale=function(e,o){var t=goog.isNumber(o)?o:e;this.left*=e;this.width*=e;this.top*=t;this.height*=t;return this};goog.provide("goog.math.Size");goog.math.Size=function(e,o){this.width=e;this.height=o};goog.math.Size.equals=function(e,o){if(e==o)return true;if(!e||!o)return false;return e.width==o.width&&e.height==o.height};goog.math.Size.prototype.clone=function(){return new goog.math.Size(this.width,this.height)};if(goog.DEBUG)goog.math.Size.prototype.toString=function(){return"("+this.width+" x "+this.height+")"};goog.math.Size.prototype.getLongest=function(){return Math.max(this.width,this.height)};goog.math.Size.prototype.getShortest=function(){return Math.min(this.width,this.height)};goog.math.Size.prototype.area=function(){return this.width*this.height};goog.math.Size.prototype.perimeter=function(){return 2*(this.width+this.height)};goog.math.Size.prototype.aspectRatio=function(){return this.width/this.height};goog.math.Size.prototype.isEmpty=function(){return!this.area()};goog.math.Size.prototype.ceil=function(){this.width=Math.ceil(this.width);this.height=Math.ceil(this.height);return this};goog.math.Size.prototype.fitsInside=function(e){return this.width<=e.width&&this.height<=e.height};goog.math.Size.prototype.floor=function(){this.width=Math.floor(this.width);this.height=Math.floor(this.height);return this};goog.math.Size.prototype.round=function(){this.width=Math.round(this.width);this.height=Math.round(this.height);return this};goog.math.Size.prototype.scale=function(e,o){var t=goog.isNumber(o)?o:e;this.width*=e;this.height*=t;return this};goog.math.Size.prototype.scaleToCover=function(e){var o=this.aspectRatio()<=e.aspectRatio()?e.width/this.width:e.height/this.height;return this.scale(o)};goog.math.Size.prototype.scaleToFit=function(e){var o=this.aspectRatio()>e.aspectRatio()?e.width/this.width:e.height/this.height;return this.scale(o)};goog.provide("goog.Thenable");goog.forwardDeclare("goog.Promise");goog.Thenable=function(){};goog.Thenable.prototype.then=function(e,o,t){};goog.Thenable.IMPLEMENTED_BY_PROP="$goog_Thenable";goog.Thenable.addImplementation=function(e){e.prototype["then"]=e.prototype.then;e.prototype[goog.Thenable.IMPLEMENTED_BY_PROP]=true};goog.Thenable.isImplementedBy=function(e){if(!e)return false;try{if(COMPILED)return!!e[goog.Thenable.IMPLEMENTED_BY_PROP];return!!e.$goog_Thenable}catch(e){return false}};goog.provide("goog.Promise");goog.require("goog.Thenable");goog.require("goog.asserts");goog.require("goog.async.FreeList");goog.require("goog.async.run");goog.require("goog.async.throwException");goog.require("goog.debug.Error");goog.require("goog.promise.Resolver");goog.Promise=function(e,o){this.state_=goog.Promise.State_.PENDING;this.result_=void 0;this.parent_=null;this.callbackEntries_=null;this.callbackEntriesTail_=null;this.executing_=false;if(goog.Promise.UNHANDLED_REJECTION_DELAY>0)this.unhandledRejectionId_=0;else if(0==goog.Promise.UNHANDLED_REJECTION_DELAY)this.hadUnhandledRejection_=false;if(goog.Promise.LONG_STACK_TRACES){this.stack_=[];this.addStackTrace_(new Error("created"));this.currentStep_=0}if(e!=goog.nullFunction)try{var t=this;e.call(o,(function(e){t.resolve_(goog.Promise.State_.FULFILLED,e)}),(function(e){if(goog.DEBUG&&!(e instanceof goog.Promise.CancellationError))try{if(e instanceof Error)throw e;else throw new Error("Promise rejected.")}catch(e){}t.resolve_(goog.Promise.State_.REJECTED,e)}))}catch(e){this.resolve_(goog.Promise.State_.REJECTED,e)}};goog.define("goog.Promise.LONG_STACK_TRACES",false);goog.define("goog.Promise.UNHANDLED_REJECTION_DELAY",0);goog.Promise.State_={PENDING:0,BLOCKED:1,FULFILLED:2,REJECTED:3};goog.Promise.CallbackEntry_=function(){this.child=null;this.onFulfilled=null;this.onRejected=null;this.context=null;this.next=null;this.always=false};goog.Promise.CallbackEntry_.prototype.reset=function(){this.child=null;this.onFulfilled=null;this.onRejected=null;this.context=null;this.always=false};goog.define("goog.Promise.DEFAULT_MAX_UNUSED",100);goog.Promise.freelist_=new goog.async.FreeList((function(){return new goog.Promise.CallbackEntry_}),(function(e){e.reset()}),goog.Promise.DEFAULT_MAX_UNUSED);goog.Promise.getCallbackEntry_=function(e,o,t){var i=goog.Promise.freelist_.get();i.onFulfilled=e;i.onRejected=o;i.context=t;return i};goog.Promise.returnEntry_=function(e){goog.Promise.freelist_.put(e)};goog.Promise.resolve=function(e){if(e instanceof goog.Promise)return e;var o=new goog.Promise(goog.nullFunction);o.resolve_(goog.Promise.State_.FULFILLED,e);return o};goog.Promise.reject=function(e){return new goog.Promise((function(o,t){t(e)}))};goog.Promise.resolveThen_=function(e,o,t){var i=goog.Promise.maybeThen_(e,o,t,null);if(!i)goog.async.run(goog.partial(o,e))};goog.Promise.race=function(e){return new goog.Promise((function(o,t){if(!e.length)o(void 0);for(var i=0,r;i<e.length;i++){r=e[i];goog.Promise.resolveThen_(r,o,t)}}))};goog.Promise.all=function(e){return new goog.Promise((function(o,t){var i=e.length;var r=[];if(!i){o(r);return}var n=function(e,t){i--;r[e]=t;if(0==i)o(r)};var l=function(e){t(e)};for(var s=0,g;s<e.length;s++){g=e[s];goog.Promise.resolveThen_(g,goog.partial(n,s),l)}}))};goog.Promise.allSettled=function(e){return new goog.Promise((function(o,t){var i=e.length;var r=[];if(!i){o(r);return}var n=function(e,t,n){i--;r[e]=t?{fulfilled:true,value:n}:{fulfilled:false,reason:n};if(0==i)o(r)};for(var l=0,s;l<e.length;l++){s=e[l];goog.Promise.resolveThen_(s,goog.partial(n,l,true),goog.partial(n,l,false))}}))};goog.Promise.firstFulfilled=function(e){return new goog.Promise((function(o,t){var i=e.length;var r=[];if(!i){o(void 0);return}var n=function(e){o(e)};var l=function(e,o){i--;r[e]=o;if(0==i)t(r)};for(var s=0,g;s<e.length;s++){g=e[s];goog.Promise.resolveThen_(g,n,goog.partial(l,s))}}))};goog.Promise.withResolver=function(){var e,o;var t=new goog.Promise((function(t,i){e=t;o=i}));return new goog.Promise.Resolver_(t,e,o)};goog.Promise.prototype.then=function(e,o,t){if(null!=e)goog.asserts.assertFunction(e,"opt_onFulfilled should be a function.");if(null!=o)goog.asserts.assertFunction(o,"opt_onRejected should be a function. Did you pass opt_context "+"as the second argument instead of the third?");if(goog.Promise.LONG_STACK_TRACES)this.addStackTrace_(new Error("then"));return this.addChildPromise_(goog.isFunction(e)?e:null,goog.isFunction(o)?o:null,t)};goog.Thenable.addImplementation(goog.Promise);goog.Promise.prototype.thenVoid=function(e,o,t){if(null!=e)goog.asserts.assertFunction(e,"opt_onFulfilled should be a function.");if(null!=o)goog.asserts.assertFunction(o,"opt_onRejected should be a function. Did you pass opt_context "+"as the second argument instead of the third?");if(goog.Promise.LONG_STACK_TRACES)this.addStackTrace_(new Error("then"));this.addCallbackEntry_(goog.Promise.getCallbackEntry_(e||goog.nullFunction,o||null,t))};goog.Promise.prototype.thenAlways=function(e,o){if(goog.Promise.LONG_STACK_TRACES)this.addStackTrace_(new Error("thenAlways"));var t=goog.Promise.getCallbackEntry_(e,e,o);t.always=true;this.addCallbackEntry_(t);return this};goog.Promise.prototype.thenCatch=function(e,o){if(goog.Promise.LONG_STACK_TRACES)this.addStackTrace_(new Error("thenCatch"));return this.addChildPromise_(null,e,o)};goog.Promise.prototype.cancel=function(e){if(this.state_==goog.Promise.State_.PENDING)goog.async.run((function(){var o=new goog.Promise.CancellationError(e);this.cancelInternal_(o)}),this)};goog.Promise.prototype.cancelInternal_=function(e){if(this.state_==goog.Promise.State_.PENDING)if(this.parent_){this.parent_.cancelChild_(this,e);this.parent_=null}else this.resolve_(goog.Promise.State_.REJECTED,e)};goog.Promise.prototype.cancelChild_=function(e,o){if(!this.callbackEntries_)return;var t=0;var i=null;var r=null;for(var n=this.callbackEntries_;n;n=n.next){if(!n.always){t++;if(n.child==e)i=n;if(i&&t>1)break}if(!i)r=n}if(i)if(this.state_==goog.Promise.State_.PENDING&&1==t)this.cancelInternal_(o);else{if(r)this.removeEntryAfter_(r);else this.popEntry_();this.executeCallback_(i,goog.Promise.State_.REJECTED,o)}};goog.Promise.prototype.addCallbackEntry_=function(e){if(!this.hasEntry_()&&(this.state_==goog.Promise.State_.FULFILLED||this.state_==goog.Promise.State_.REJECTED))this.scheduleCallbacks_();this.queueEntry_(e)};goog.Promise.prototype.addChildPromise_=function(e,o,t){var i=goog.Promise.getCallbackEntry_(null,null,null);i.child=new goog.Promise((function(r,n){i.onFulfilled=e?function(o){try{var i=e.call(t,o);r(i)}catch(e){n(e)}}:r;i.onRejected=o?function(e){try{var i=o.call(t,e);if(!goog.isDef(i)&&e instanceof goog.Promise.CancellationError)n(e);else r(i)}catch(e){n(e)}}:n}));i.child.parent_=this;this.addCallbackEntry_(i);return i.child};goog.Promise.prototype.unblockAndFulfill_=function(e){goog.asserts.assert(this.state_==goog.Promise.State_.BLOCKED);this.state_=goog.Promise.State_.PENDING;this.resolve_(goog.Promise.State_.FULFILLED,e)};goog.Promise.prototype.unblockAndReject_=function(e){goog.asserts.assert(this.state_==goog.Promise.State_.BLOCKED);this.state_=goog.Promise.State_.PENDING;this.resolve_(goog.Promise.State_.REJECTED,e)};goog.Promise.prototype.resolve_=function(e,o){if(this.state_!=goog.Promise.State_.PENDING)return;if(this===o){e=goog.Promise.State_.REJECTED;o=new TypeError("Promise cannot resolve to itself")}this.state_=goog.Promise.State_.BLOCKED;var t=goog.Promise.maybeThen_(o,this.unblockAndFulfill_,this.unblockAndReject_,this);if(t)return;this.result_=o;this.state_=e;this.parent_=null;this.scheduleCallbacks_();if(e==goog.Promise.State_.REJECTED&&!(o instanceof goog.Promise.CancellationError))goog.Promise.addUnhandledRejection_(this,o)};goog.Promise.maybeThen_=function(e,o,t,i){if(e instanceof goog.Promise){e.thenVoid(o,t,i);return true}else if(goog.Thenable.isImplementedBy(e)){e=e;e.then(o,t,i);return true}else if(goog.isObject(e))try{var r=e["then"];if(goog.isFunction(r)){goog.Promise.tryThen_(e,r,o,t,i);return true}}catch(e){t.call(i,e);return true}return false};goog.Promise.tryThen_=function(e,o,t,i,r){var n=false;var l=function(e){if(!n){n=true;t.call(r,e)}};var s=function(e){if(!n){n=true;i.call(r,e)}};try{o.call(e,l,s)}catch(e){s(e)}};goog.Promise.prototype.scheduleCallbacks_=function(){if(!this.executing_){this.executing_=true;goog.async.run(this.executeCallbacks_,this)}};goog.Promise.prototype.hasEntry_=function(){return!!this.callbackEntries_};goog.Promise.prototype.queueEntry_=function(e){goog.asserts.assert(null!=e.onFulfilled);if(this.callbackEntriesTail_){this.callbackEntriesTail_.next=e;this.callbackEntriesTail_=e}else{this.callbackEntries_=e;this.callbackEntriesTail_=e}};goog.Promise.prototype.popEntry_=function(){var e=null;if(this.callbackEntries_){e=this.callbackEntries_;this.callbackEntries_=e.next;e.next=null}if(!this.callbackEntries_)this.callbackEntriesTail_=null;if(null!=e)goog.asserts.assert(null!=e.onFulfilled);return e};goog.Promise.prototype.removeEntryAfter_=function(e){goog.asserts.assert(this.callbackEntries_);goog.asserts.assert(null!=e);if(e.next==this.callbackEntriesTail_)this.callbackEntriesTail_=e;e.next=e.next.next};goog.Promise.prototype.executeCallbacks_=function(){var e=null;while(e=this.popEntry_()){if(goog.Promise.LONG_STACK_TRACES)this.currentStep_++;this.executeCallback_(e,this.state_,this.result_)}this.executing_=false};goog.Promise.prototype.executeCallback_=function(e,o,t){if(o==goog.Promise.State_.REJECTED&&e.onRejected&&!e.always)this.removeUnhandledRejection_();if(e.child){e.child.parent_=null;goog.Promise.invokeCallback_(e,o,t)}else try{e.always?e.onFulfilled.call(e.context):goog.Promise.invokeCallback_(e,o,t)}catch(e){goog.Promise.handleRejection_.call(null,e)}goog.Promise.returnEntry_(e)};goog.Promise.invokeCallback_=function(e,o,t){if(o==goog.Promise.State_.FULFILLED)e.onFulfilled.call(e.context,t);else if(e.onRejected)e.onRejected.call(e.context,t)};goog.Promise.prototype.addStackTrace_=function(e){if(goog.Promise.LONG_STACK_TRACES&&goog.isString(e.stack)){var o=e.stack.split("\n",4)[3];var t=e.message;t+=Array(11-t.length).join(" ");this.stack_.push(t+o)}};goog.Promise.prototype.appendLongStack_=function(e){if(goog.Promise.LONG_STACK_TRACES&&e&&goog.isString(e.stack)&&this.stack_.length){var o=["Promise trace:"];for(var t=this;t;t=t.parent_){for(var i=this.currentStep_;i>=0;i--)o.push(t.stack_[i]);o.push("Value: "+"["+(t.state_==goog.Promise.State_.REJECTED?"REJECTED":"FULFILLED")+"] "+"<"+String(t.result_)+">")}e.stack+="\n\n"+o.join("\n")}};goog.Promise.prototype.removeUnhandledRejection_=function(){if(goog.Promise.UNHANDLED_REJECTION_DELAY>0)for(var e=this;e&&e.unhandledRejectionId_;e=e.parent_){goog.global.clearTimeout(e.unhandledRejectionId_);e.unhandledRejectionId_=0}else if(0==goog.Promise.UNHANDLED_REJECTION_DELAY)for(var e=this;e&&e.hadUnhandledRejection_;e=e.parent_)e.hadUnhandledRejection_=false};goog.Promise.addUnhandledRejection_=function(e,o){if(goog.Promise.UNHANDLED_REJECTION_DELAY>0)e.unhandledRejectionId_=goog.global.setTimeout((function(){e.appendLongStack_(o);goog.Promise.handleRejection_.call(null,o)}),goog.Promise.UNHANDLED_REJECTION_DELAY);else if(0==goog.Promise.UNHANDLED_REJECTION_DELAY){e.hadUnhandledRejection_=true;goog.async.run((function(){if(e.hadUnhandledRejection_){e.appendLongStack_(o);goog.Promise.handleRejection_.call(null,o)}}))}};goog.Promise.handleRejection_=goog.async.throwException;goog.Promise.setUnhandledRejectionHandler=function(e){goog.Promise.handleRejection_=e};goog.Promise.CancellationError=function(e){goog.Promise.CancellationError.base(this,"constructor",e)};goog.inherits(goog.Promise.CancellationError,goog.debug.Error);goog.Promise.CancellationError.prototype.name="cancel";goog.Promise.Resolver_=function(e,o,t){this.promise=e;this.resolve=o;this.reject=t};goog.provide("goog.promise.Resolver");goog.forwardDeclare("goog.Promise");goog.promise.Resolver=function(){};goog.promise.Resolver.prototype.promise;goog.promise.Resolver.prototype.resolve;goog.promise.Resolver.prototype.reject;goog.provide("goog.structs");goog.require("goog.array");goog.require("goog.object");goog.structs.getCount=function(e){if(e.getCount&&"function"==typeof e.getCount)return e.getCount();if(goog.isArrayLike(e)||goog.isString(e))return e.length;return goog.object.getCount(e)};goog.structs.getValues=function(e){if(e.getValues&&"function"==typeof e.getValues)return e.getValues();if(goog.isString(e))return e.split("");if(goog.isArrayLike(e)){var o=[];var t=e.length;for(var i=0;i<t;i++)o.push(e[i]);return o}return goog.object.getValues(e)};goog.structs.getKeys=function(e){if(e.getKeys&&"function"==typeof e.getKeys)return e.getKeys();if(e.getValues&&"function"==typeof e.getValues)return;if(goog.isArrayLike(e)||goog.isString(e)){var o=[];var t=e.length;for(var i=0;i<t;i++)o.push(i);return o}return goog.object.getKeys(e)};goog.structs.contains=function(e,o){if(e.contains&&"function"==typeof e.contains)return e.contains(o);if(e.containsValue&&"function"==typeof e.containsValue)return e.containsValue(o);if(goog.isArrayLike(e)||goog.isString(e))return goog.array.contains(e,o);return goog.object.containsValue(e,o)};goog.structs.isEmpty=function(e){if(e.isEmpty&&"function"==typeof e.isEmpty)return e.isEmpty();if(goog.isArrayLike(e)||goog.isString(e))return goog.array.isEmpty(e);return goog.object.isEmpty(e)};goog.structs.clear=function(e){if(e.clear&&"function"==typeof e.clear)e.clear();else if(goog.isArrayLike(e))goog.array.clear(e);else goog.object.clear(e)};goog.structs.forEach=function(e,o,t){if(e.forEach&&"function"==typeof e.forEach)e.forEach(o,t);else if(goog.isArrayLike(e)||goog.isString(e))goog.array.forEach(e,o,t);else{var i=goog.structs.getKeys(e);var r=goog.structs.getValues(e);var n=r.length;for(var l=0;l<n;l++)o.call(t,r[l],i&&i[l],e)}};goog.structs.filter=function(e,o,t){if("function"==typeof e.filter)return e.filter(o,t);if(goog.isArrayLike(e)||goog.isString(e))return goog.array.filter(e,o,t);var i;var r=goog.structs.getKeys(e);var n=goog.structs.getValues(e);var l=n.length;if(r){i={};for(var s=0;s<l;s++)if(o.call(t,n[s],r[s],e))i[r[s]]=n[s]}else{i=[];for(var s=0;s<l;s++)if(o.call(t,n[s],void 0,e))i.push(n[s])}return i};goog.structs.map=function(e,o,t){if("function"==typeof e.map)return e.map(o,t);if(goog.isArrayLike(e)||goog.isString(e))return goog.array.map(e,o,t);var i;var r=goog.structs.getKeys(e);var n=goog.structs.getValues(e);var l=n.length;if(r){i={};for(var s=0;s<l;s++)i[r[s]]=o.call(t,n[s],r[s],e)}else{i=[];for(var s=0;s<l;s++)i[s]=o.call(t,n[s],void 0,e)}return i};goog.structs.some=function(e,o,t){if("function"==typeof e.some)return e.some(o,t);if(goog.isArrayLike(e)||goog.isString(e))return goog.array.some(e,o,t);var i=goog.structs.getKeys(e);var r=goog.structs.getValues(e);var n=r.length;for(var l=0;l<n;l++)if(o.call(t,r[l],i&&i[l],e))return true;return false};goog.structs.every=function(e,o,t){if("function"==typeof e.every)return e.every(o,t);if(goog.isArrayLike(e)||goog.isString(e))return goog.array.every(e,o,t);var i=goog.structs.getKeys(e);var r=goog.structs.getValues(e);var n=r.length;for(var l=0;l<n;l++)if(!o.call(t,r[l],i&&i[l],e))return false;return true};goog.provide("goog.structs.Trie");goog.require("goog.object");goog.require("goog.structs");goog.structs.Trie=function(e){this.value_=void 0;this.childNodes_={};if(e)this.setAll(e)};goog.structs.Trie.prototype.set=function(e,o){this.setOrAdd_(e,o,false)};goog.structs.Trie.prototype.add=function(e,o){this.setOrAdd_(e,o,true)};goog.structs.Trie.prototype.setOrAdd_=function(e,o,t){var i=this;for(var r=0;r<e.length;r++){var n=e.charAt(r);if(!i.childNodes_[n])i.childNodes_[n]=new goog.structs.Trie;i=i.childNodes_[n]}if(t&&void 0!==i.value_)throw new Error('The collection already contains the key "'+e+'"');else i.value_=o};goog.structs.Trie.prototype.setAll=function(e){var o=goog.structs.getKeys(e);var t=goog.structs.getValues(e);for(var i=0;i<o.length;i++)this.set(o[i],t[i])};goog.structs.Trie.prototype.getChildNode_=function(e){var o=this;for(var t=0;t<e.length;t++){var i=e.charAt(t);o=o.childNodes_[i];if(!o)return}return o};goog.structs.Trie.prototype.get=function(e){var o=this.getChildNode_(e);return o?o.value_:void 0};goog.structs.Trie.prototype.getKeyAndPrefixes=function(e,o){var t=this;var i={};var r=o||0;if(void 0!==t.value_)i[r]=t.value_;for(;r<e.length;r++){var n=e.charAt(r);if(!(n in t.childNodes_))break;t=t.childNodes_[n];if(void 0!==t.value_)i[r]=t.value_}return i};goog.structs.Trie.prototype.getValues=function(){var e=[];this.getValuesInternal_(e);return e};goog.structs.Trie.prototype.getValuesInternal_=function(e){if(void 0!==this.value_)e.push(this.value_);for(var o in this.childNodes_)this.childNodes_[o].getValuesInternal_(e)};goog.structs.Trie.prototype.getKeys=function(e){var o=[];if(e){var t=this;for(var i=0;i<e.length;i++){var r=e.charAt(i);if(!t.childNodes_[r])return[];t=t.childNodes_[r]}t.getKeysInternal_(e,o)}else this.getKeysInternal_("",o);return o};goog.structs.Trie.prototype.getKeysInternal_=function(e,o){if(void 0!==this.value_)o.push(e);for(var t in this.childNodes_)this.childNodes_[t].getKeysInternal_(e+t,o)};goog.structs.Trie.prototype.containsKey=function(e){return void 0!==this.get(e)};goog.structs.Trie.prototype.containsPrefix=function(e){if(0==e.length)return!this.isEmpty();return!!this.getChildNode_(e)};goog.structs.Trie.prototype.containsValue=function(e){if(this.value_===e)return true;for(var o in this.childNodes_)if(this.childNodes_[o].containsValue(e))return true;return false};goog.structs.Trie.prototype.clear=function(){this.childNodes_={};this.value_=void 0};goog.structs.Trie.prototype.remove=function(e){var o=this;var t=[];for(var i=0;i<e.length;i++){var r=e.charAt(i);if(!o.childNodes_[r])throw new Error('The collection does not have the key "'+e+'"');t.push([o,r]);o=o.childNodes_[r]}var n=o.value_;delete o.value_;while(t.length>0){var l=t.pop();var s=l[0];var r=l[1];if(s.childNodes_[r].isEmpty())delete s.childNodes_[r];else break}return n};goog.structs.Trie.prototype.clone=function(){return new goog.structs.Trie(this)};goog.structs.Trie.prototype.getCount=function(){return goog.structs.getCount(this.getValues())};goog.structs.Trie.prototype.isEmpty=function(){return void 0===this.value_&&goog.object.isEmpty(this.childNodes_)};goog.provide("goog.style.bidi");goog.require("goog.dom");goog.require("goog.style");goog.require("goog.userAgent");goog.require("goog.userAgent.platform");goog.require("goog.userAgent.product");goog.require("goog.userAgent.product.isVersion");goog.style.bidi.getScrollLeft=function(e){var o=goog.style.isRightToLeft(e);if(o&&goog.style.bidi.usesNegativeScrollLeftInRtl_())return-e.scrollLeft;else if(o&&!(goog.userAgent.EDGE_OR_IE&&goog.userAgent.isVersionOrHigher("8"))){var t=goog.style.getComputedOverflowX(e);if("visible"==t)return e.scrollLeft;else return e.scrollWidth-e.clientWidth-e.scrollLeft}return e.scrollLeft};goog.style.bidi.getOffsetStart=function(e){e=e;var o=e.offsetLeft;var t=e.offsetParent;if(!t&&"fixed"==goog.style.getComputedPosition(e))t=goog.dom.getOwnerDocument(e).documentElement;if(!t)return o;if(goog.userAgent.GECKO&&!goog.userAgent.isVersionOrHigher(58)){var i=goog.style.getBorderBox(t);o+=i.left}else if(goog.userAgent.isDocumentModeOrHigher(8)&&!goog.userAgent.isDocumentModeOrHigher(9)){var i=goog.style.getBorderBox(t);o-=i.left}if(goog.style.isRightToLeft(t)){var r=o+e.offsetWidth;return t.clientWidth-r}return o};goog.style.bidi.setScrollOffset=function(e,o){o=Math.max(o,0);if(!goog.style.isRightToLeft(e))e.scrollLeft=o;else if(goog.style.bidi.usesNegativeScrollLeftInRtl_())e.scrollLeft=-o;else if(!(goog.userAgent.EDGE_OR_IE&&goog.userAgent.isVersionOrHigher("8")))e.scrollLeft=e.scrollWidth-o-e.clientWidth;else e.scrollLeft=o};goog.style.bidi.usesNegativeScrollLeftInRtl_=function(){var e=goog.userAgent.product.SAFARI&&goog.userAgent.product.isVersion(10);var o=goog.userAgent.IOS&&goog.userAgent.platform.isVersion(10);return goog.userAgent.GECKO||e||o};goog.style.bidi.setPosition=function(e,o,t,i){if(!goog.isNull(t))e.style.top=t+"px";if(i){e.style.right=o+"px";e.style.left=""}else{e.style.left=o+"px";e.style.right=""}};goog.provide("goog.style");goog.require("goog.array");goog.require("goog.asserts");goog.require("goog.dom");goog.require("goog.dom.NodeType");goog.require("goog.dom.TagName");goog.require("goog.dom.vendor");goog.require("goog.html.SafeStyleSheet");goog.require("goog.math.Box");goog.require("goog.math.Coordinate");goog.require("goog.math.Rect");goog.require("goog.math.Size");goog.require("goog.object");goog.require("goog.reflect");goog.require("goog.string");goog.require("goog.userAgent");goog.forwardDeclare("goog.events.Event");goog.style.setStyle=function(e,o,t){if(goog.isString(o))goog.style.setStyle_(e,t,o);else for(var i in o)goog.style.setStyle_(e,o[i],i)};goog.style.setStyle_=function(e,o,t){var i=goog.style.getVendorJsStyleName_(e,t);if(i)e.style[i]=o};goog.style.styleNameCache_={};goog.style.getVendorJsStyleName_=function(e,o){var t=goog.style.styleNameCache_[o];if(!t){var i=goog.string.toCamelCase(o);t=i;if(void 0===e.style[i]){var r=goog.dom.vendor.getVendorJsPrefix()+goog.string.toTitleCase(i);if(void 0!==e.style[r])t=r}goog.style.styleNameCache_[o]=t}return t};goog.style.getVendorStyleName_=function(e,o){var t=goog.string.toCamelCase(o);if(void 0===e.style[t]){var i=goog.dom.vendor.getVendorJsPrefix()+goog.string.toTitleCase(t);if(void 0!==e.style[i])return goog.dom.vendor.getVendorPrefix()+"-"+o}return o};goog.style.getStyle=function(e,o){var t=e.style[goog.string.toCamelCase(o)];if("undefined"!==typeof t)return t;return e.style[goog.style.getVendorJsStyleName_(e,o)]||""};goog.style.getComputedStyle=function(e,o){var t=goog.dom.getOwnerDocument(e);if(t.defaultView&&t.defaultView.getComputedStyle){var i=t.defaultView.getComputedStyle(e,null);if(i)return i[o]||i.getPropertyValue(o)||""}return""};goog.style.getCascadedStyle=function(e,o){return e.currentStyle?e.currentStyle[o]:null};goog.style.getStyle_=function(e,o){return goog.style.getComputedStyle(e,o)||goog.style.getCascadedStyle(e,o)||e.style&&e.style[o]};goog.style.getComputedBoxSizing=function(e){return goog.style.getStyle_(e,"boxSizing")||goog.style.getStyle_(e,"MozBoxSizing")||goog.style.getStyle_(e,"WebkitBoxSizing")||null};goog.style.getComputedPosition=function(e){return goog.style.getStyle_(e,"position")};goog.style.getBackgroundColor=function(e){return goog.style.getStyle_(e,"backgroundColor")};goog.style.getComputedOverflowX=function(e){return goog.style.getStyle_(e,"overflowX")};goog.style.getComputedOverflowY=function(e){return goog.style.getStyle_(e,"overflowY")};goog.style.getComputedZIndex=function(e){return goog.style.getStyle_(e,"zIndex")};goog.style.getComputedTextAlign=function(e){return goog.style.getStyle_(e,"textAlign")};goog.style.getComputedCursor=function(e){return goog.style.getStyle_(e,"cursor")};goog.style.getComputedTransform=function(e){var o=goog.style.getVendorStyleName_(e,"transform");return goog.style.getStyle_(e,o)||goog.style.getStyle_(e,"transform")};goog.style.setPosition=function(e,o,t){var i,r;if(o instanceof goog.math.Coordinate){i=o.x;r=o.y}else{i=o;r=t}e.style.left=goog.style.getPixelStyleValue_(i,false);e.style.top=goog.style.getPixelStyleValue_(r,false)};goog.style.getPosition=function(e){return new goog.math.Coordinate(e.offsetLeft,e.offsetTop)};goog.style.getClientViewportElement=function(e){var o;if(e)o=goog.dom.getOwnerDocument(e);else o=goog.dom.getDocument();if(goog.userAgent.IE&&!goog.userAgent.isDocumentModeOrHigher(9)&&!goog.dom.getDomHelper(o).isCss1CompatMode())return o.body;return o.documentElement};goog.style.getViewportPageOffset=function(e){var o=e.body;var t=e.documentElement;var i=o.scrollLeft||t.scrollLeft;var r=o.scrollTop||t.scrollTop;return new goog.math.Coordinate(i,r)};goog.style.getBoundingClientRect_=function(e){var o;try{o=e.getBoundingClientRect()}catch(e){return{left:0,top:0,right:0,bottom:0}}if(goog.userAgent.IE&&e.ownerDocument.body){var t=e.ownerDocument;o.left-=t.documentElement.clientLeft+t.body.clientLeft;o.top-=t.documentElement.clientTop+t.body.clientTop}return o};goog.style.getOffsetParent=function(e){if(goog.userAgent.IE&&!goog.userAgent.isDocumentModeOrHigher(8)){goog.asserts.assert(e&&"offsetParent"in e);return e.offsetParent}var o=goog.dom.getOwnerDocument(e);var t=goog.style.getStyle_(e,"position");var i="fixed"==t||"absolute"==t;for(var r=e.parentNode;r&&r!=o;r=r.parentNode){if(r.nodeType==goog.dom.NodeType.DOCUMENT_FRAGMENT&&r.host)r=r.host;t=goog.style.getStyle_(r,"position");i=i&&"static"==t&&r!=o.documentElement&&r!=o.body;if(!i&&(r.scrollWidth>r.clientWidth||r.scrollHeight>r.clientHeight||"fixed"==t||"absolute"==t||"relative"==t))return r}return null};goog.style.getVisibleRectForElement=function(e){var o=new goog.math.Box(0,1/0,1/0,0);var t=goog.dom.getDomHelper(e);var i=t.getDocument().body;var r=t.getDocument().documentElement;var n=t.getDocumentScrollElement();for(var l=e;l=goog.style.getOffsetParent(l);)if((!goog.userAgent.IE||0!=l.clientWidth)&&(!goog.userAgent.WEBKIT||0!=l.clientHeight||l!=i)&&l!=i&&l!=r&&"visible"!=goog.style.getStyle_(l,"overflow")){var s=goog.style.getPageOffset(l);var g=goog.style.getClientLeftTop(l);s.x+=g.x;s.y+=g.y;o.top=Math.max(o.top,s.y);o.right=Math.min(o.right,s.x+l.clientWidth);o.bottom=Math.min(o.bottom,s.y+l.clientHeight);o.left=Math.max(o.left,s.x)}var a=n.scrollLeft,c=n.scrollTop;o.left=Math.max(o.left,a);o.top=Math.max(o.top,c);var u=t.getViewportSize();o.right=Math.min(o.right,a+u.width);o.bottom=Math.min(o.bottom,c+u.height);return o.top>=0&&o.left>=0&&o.bottom>o.top&&o.right>o.left?o:null};goog.style.getContainerOffsetToScrollInto=function(e,o,t){var i=o||goog.dom.getDocumentScrollElement();var r=goog.style.getPageOffset(e);var n=goog.style.getPageOffset(i);var l=goog.style.getBorderBox(i);if(i==goog.dom.getDocumentScrollElement()){var s=r.x-i.scrollLeft;var g=r.y-i.scrollTop;if(goog.userAgent.IE&&!goog.userAgent.isDocumentModeOrHigher(10)){s+=l.left;g+=l.top}}else{var s=r.x-n.x-l.left;var g=r.y-n.y-l.top}var a=goog.style.getSizeWithDisplay_(e);var c=i.clientWidth-a.width;var u=i.clientHeight-a.height;var h=i.scrollLeft;var d=i.scrollTop;if(t){h+=s-c/2;d+=g-u/2}else{h+=Math.min(s,Math.max(s-c,0));d+=Math.min(g,Math.max(g-u,0))}return new goog.math.Coordinate(h,d)};goog.style.scrollIntoContainerView=function(e,o,t){var i=o||goog.dom.getDocumentScrollElement();var r=goog.style.getContainerOffsetToScrollInto(e,i,t);i.scrollLeft=r.x;i.scrollTop=r.y};goog.style.getClientLeftTop=function(e){return new goog.math.Coordinate(e.clientLeft,e.clientTop)};goog.style.getPageOffset=function(e){var o=goog.dom.getOwnerDocument(e);goog.asserts.assertObject(e,"Parameter is required");var t=new goog.math.Coordinate(0,0);var i=goog.style.getClientViewportElement(o);if(e==i)return t;var r=goog.style.getBoundingClientRect_(e);var n=goog.dom.getDomHelper(o).getDocumentScroll();t.x=r.left+n.x;t.y=r.top+n.y;return t};goog.style.getPageOffsetLeft=function(e){return goog.style.getPageOffset(e).x};goog.style.getPageOffsetTop=function(e){return goog.style.getPageOffset(e).y};goog.style.getFramedPageOffset=function(e,o){var t=new goog.math.Coordinate(0,0);var i=goog.dom.getWindow(goog.dom.getOwnerDocument(e));if(!goog.reflect.canAccessProperty(i,"parent"))return t;var r=e;do{var n=i==o?goog.style.getPageOffset(r):goog.style.getClientPositionForElement_(goog.asserts.assert(r));t.x+=n.x;t.y+=n.y}while(i&&i!=o&&i!=i.parent&&(r=i.frameElement)&&(i=i.parent));return t};goog.style.translateRectForAnotherFrame=function(e,o,t){if(o.getDocument()!=t.getDocument()){var i=o.getDocument().body;var r=goog.style.getFramedPageOffset(i,t.getWindow());r=goog.math.Coordinate.difference(r,goog.style.getPageOffset(i));if(goog.userAgent.IE&&!goog.userAgent.isDocumentModeOrHigher(9)&&!o.isCss1CompatMode())r=goog.math.Coordinate.difference(r,o.getDocumentScroll());e.left+=r.x;e.top+=r.y}};goog.style.getRelativePosition=function(e,o){var t=goog.style.getClientPosition(e);var i=goog.style.getClientPosition(o);return new goog.math.Coordinate(t.x-i.x,t.y-i.y)};goog.style.getClientPositionForElement_=function(e){var o=goog.style.getBoundingClientRect_(e);return new goog.math.Coordinate(o.left,o.top)};goog.style.getClientPosition=function(e){goog.asserts.assert(e);if(e.nodeType==goog.dom.NodeType.ELEMENT)return goog.style.getClientPositionForElement_(e);else{var o=e.changedTouches?e.changedTouches[0]:e;return new goog.math.Coordinate(o.clientX,o.clientY)}};goog.style.setPageOffset=function(e,o,t){var i=goog.style.getPageOffset(e);if(o instanceof goog.math.Coordinate){t=o.y;o=o.x}var r=goog.asserts.assertNumber(o)-i.x;var n=Number(t)-i.y;goog.style.setPosition(e,e.offsetLeft+r,e.offsetTop+n)};goog.style.setSize=function(e,o,t){var i;if(o instanceof goog.math.Size){i=o.height;o=o.width}else{if(void 0==t)throw new Error("missing height argument");i=t}goog.style.setWidth(e,o);goog.style.setHeight(e,i)};goog.style.getPixelStyleValue_=function(e,o){if("number"==typeof e)e=(o?Math.round(e):e)+"px";return e};goog.style.setHeight=function(e,o){e.style.height=goog.style.getPixelStyleValue_(o,true)};goog.style.setWidth=function(e,o){e.style.width=goog.style.getPixelStyleValue_(o,true)};goog.style.getSize=function(e){return goog.style.evaluateWithTemporaryDisplay_(goog.style.getSizeWithDisplay_,e)};goog.style.evaluateWithTemporaryDisplay_=function(e,o){if("none"!=goog.style.getStyle_(o,"display"))return e(o);var t=o.style;var i=t.display;var r=t.visibility;var n=t.position;t.visibility="hidden";t.position="absolute";t.display="inline";var l=e(o);t.display=i;t.position=n;t.visibility=r;return l};goog.style.getSizeWithDisplay_=function(e){var o=e.offsetWidth;var t=e.offsetHeight;var i=goog.userAgent.WEBKIT&&!o&&!t;if((!goog.isDef(o)||i)&&e.getBoundingClientRect){var r=goog.style.getBoundingClientRect_(e);return new goog.math.Size(r.right-r.left,r.bottom-r.top)}return new goog.math.Size(o,t)};goog.style.getTransformedSize=function(e){if(!e.getBoundingClientRect)return null;var o=goog.style.evaluateWithTemporaryDisplay_(goog.style.getBoundingClientRect_,e);return new goog.math.Size(o.right-o.left,o.bottom-o.top)};goog.style.getBounds=function(e){var o=goog.style.getPageOffset(e);var t=goog.style.getSize(e);return new goog.math.Rect(o.x,o.y,t.width,t.height)};goog.style.toCamelCase=function(e){return goog.string.toCamelCase(String(e))};goog.style.toSelectorCase=function(e){return goog.string.toSelectorCase(e)};goog.style.getOpacity=function(e){goog.asserts.assert(e);var o=e.style;var t="";if("opacity"in o)t=o.opacity;else if("MozOpacity"in o)t=o.MozOpacity;else if("filter"in o){var i=o.filter.match(/alpha\(opacity=([\d.]+)\)/);if(i)t=String(i[1]/100)}return""==t?t:Number(t)};goog.style.setOpacity=function(e,o){goog.asserts.assert(e);var t=e.style;if("opacity"in t)t.opacity=o;else if("MozOpacity"in t)t.MozOpacity=o;else if("filter"in t)if(""===o)t.filter="";else t.filter="alpha(opacity="+100*Number(o)+")"};goog.style.setTransparentBackgroundImage=function(e,o){var t=e.style;if(goog.userAgent.IE&&!goog.userAgent.isVersionOrHigher("8"))t.filter="progid:DXImageTransform.Microsoft.AlphaImageLoader("+'src="'+o+'", sizingMethod="crop")';else{t.backgroundImage="url("+o+")";t.backgroundPosition="top left";t.backgroundRepeat="no-repeat"}};goog.style.clearTransparentBackgroundImage=function(e){var o=e.style;if("filter"in o)o.filter="";else o.backgroundImage="none"};goog.style.showElement=function(e,o){goog.style.setElementShown(e,o)};goog.style.setElementShown=function(e,o){e.style.display=o?"":"none"};goog.style.isElementShown=function(e){return"none"!=e.style.display};goog.style.installSafeStyleSheet=function(e,o){var t=goog.dom.getDomHelper(o);var i=t.getDocument();if(goog.userAgent.IE&&i.createStyleSheet){var r=i.createStyleSheet();goog.style.setSafeStyleSheet(r,e);return r}else{var n=t.getElementsByTagNameAndClass(goog.dom.TagName.HEAD)[0];if(!n){var l=t.getElementsByTagNameAndClass(goog.dom.TagName.BODY)[0];n=t.createDom(goog.dom.TagName.HEAD);l.parentNode.insertBefore(n,l)}var s=t.createDom(goog.dom.TagName.STYLE);goog.style.setSafeStyleSheet(s,e);t.appendChild(n,s);return s}};goog.style.uninstallStyles=function(e){var o=e.ownerNode||e.owningElement||e;goog.dom.removeNode(o)};goog.style.setSafeStyleSheet=function(e,o){var t=goog.html.SafeStyleSheet.unwrap(o);if(goog.userAgent.IE&&goog.isDef(e.cssText))e.cssText=t;else e.innerHTML=t};goog.style.setPreWrap=function(e){var o=e.style;if(goog.userAgent.IE&&!goog.userAgent.isVersionOrHigher("8")){o.whiteSpace="pre";o.wordWrap="break-word"}else if(goog.userAgent.GECKO)o.whiteSpace="-moz-pre-wrap";else o.whiteSpace="pre-wrap"};goog.style.setInlineBlock=function(e){var o=e.style;o.position="relative";if(goog.userAgent.IE&&!goog.userAgent.isVersionOrHigher("8")){o.zoom="1";o.display="inline"}else o.display="inline-block"};goog.style.isRightToLeft=function(e){return"rtl"==goog.style.getStyle_(e,"direction")};goog.style.unselectableStyle_=goog.userAgent.GECKO?"MozUserSelect":goog.userAgent.WEBKIT||goog.userAgent.EDGE?"WebkitUserSelect":null;goog.style.isUnselectable=function(e){if(goog.style.unselectableStyle_)return"none"==e.style[goog.style.unselectableStyle_].toLowerCase();else if(goog.userAgent.IE||goog.userAgent.OPERA)return"on"==e.getAttribute("unselectable");return false};goog.style.setUnselectable=function(e,o,t){var i=!t?e.getElementsByTagName("*"):null;var r=goog.style.unselectableStyle_;if(r){var n=o?"none":"";if(e.style)e.style[r]=n;if(i)for(var l=0,s;s=i[l];l++)if(s.style)s.style[r]=n}else if(goog.userAgent.IE||goog.userAgent.OPERA){var n=o?"on":"";e.setAttribute("unselectable",n);if(i)for(var l=0,s;s=i[l];l++)s.setAttribute("unselectable",n)}};goog.style.getBorderBoxSize=function(e){return new goog.math.Size(e.offsetWidth,e.offsetHeight)};goog.style.setBorderBoxSize=function(e,o){var t=goog.dom.getOwnerDocument(e);var i=goog.dom.getDomHelper(t).isCss1CompatMode();if(goog.userAgent.IE&&!goog.userAgent.isVersionOrHigher("10")&&(!i||!goog.userAgent.isVersionOrHigher("8"))){var r=e.style;if(i){var n=goog.style.getPaddingBox(e);var l=goog.style.getBorderBox(e);r.pixelWidth=o.width-l.left-n.left-n.right-l.right;r.pixelHeight=o.height-l.top-n.top-n.bottom-l.bottom}else{r.pixelWidth=o.width;r.pixelHeight=o.height}}else goog.style.setBoxSizingSize_(e,o,"border-box")};goog.style.getContentBoxSize=function(e){var o=goog.dom.getOwnerDocument(e);var t=goog.userAgent.IE&&e.currentStyle;if(t&&goog.dom.getDomHelper(o).isCss1CompatMode()&&"auto"!=t.width&&"auto"!=t.height&&!t.boxSizing){var i=goog.style.getIePixelValue_(e,t.width,"width","pixelWidth");var r=goog.style.getIePixelValue_(e,t.height,"height","pixelHeight");return new goog.math.Size(i,r)}else{var n=goog.style.getBorderBoxSize(e);var l=goog.style.getPaddingBox(e);var s=goog.style.getBorderBox(e);return new goog.math.Size(n.width-s.left-l.left-l.right-s.right,n.height-s.top-l.top-l.bottom-s.bottom)}};goog.style.setContentBoxSize=function(e,o){var t=goog.dom.getOwnerDocument(e);var i=goog.dom.getDomHelper(t).isCss1CompatMode();if(goog.userAgent.IE&&!goog.userAgent.isVersionOrHigher("10")&&(!i||!goog.userAgent.isVersionOrHigher("8"))){var r=e.style;if(i){r.pixelWidth=o.width;r.pixelHeight=o.height}else{var n=goog.style.getPaddingBox(e);var l=goog.style.getBorderBox(e);r.pixelWidth=o.width+l.left+n.left+n.right+l.right;r.pixelHeight=o.height+l.top+n.top+n.bottom+l.bottom}}else goog.style.setBoxSizingSize_(e,o,"content-box")};goog.style.setBoxSizingSize_=function(e,o,t){var i=e.style;if(goog.userAgent.GECKO)i.MozBoxSizing=t;else if(goog.userAgent.WEBKIT)i.WebkitBoxSizing=t;else i.boxSizing=t;i.width=Math.max(o.width,0)+"px";i.height=Math.max(o.height,0)+"px"};goog.style.getIePixelValue_=function(e,o,t,i){if(/^\d+px?$/.test(o))return parseInt(o,10);else{var r=e.style[t];var n=e.runtimeStyle[t];e.runtimeStyle[t]=e.currentStyle[t];e.style[t]=o;var l=e.style[i];e.style[t]=r;e.runtimeStyle[t]=n;return+l}};goog.style.getIePixelDistance_=function(e,o){var t=goog.style.getCascadedStyle(e,o);return t?goog.style.getIePixelValue_(e,t,"left","pixelLeft"):0};goog.style.getBox_=function(e,o){if(goog.userAgent.IE){var t=goog.style.getIePixelDistance_(e,o+"Left");var i=goog.style.getIePixelDistance_(e,o+"Right");var r=goog.style.getIePixelDistance_(e,o+"Top");var n=goog.style.getIePixelDistance_(e,o+"Bottom");return new goog.math.Box(r,i,n,t)}else{var t=goog.style.getComputedStyle(e,o+"Left");var i=goog.style.getComputedStyle(e,o+"Right");var r=goog.style.getComputedStyle(e,o+"Top");var n=goog.style.getComputedStyle(e,o+"Bottom");return new goog.math.Box(parseFloat(r),parseFloat(i),parseFloat(n),parseFloat(t))}};goog.style.getPaddingBox=function(e){return goog.style.getBox_(e,"padding")};goog.style.getMarginBox=function(e){return goog.style.getBox_(e,"margin")};goog.style.ieBorderWidthKeywords_={thin:2,medium:4,thick:6};goog.style.getIePixelBorder_=function(e,o){if("none"==goog.style.getCascadedStyle(e,o+"Style"))return 0;var t=goog.style.getCascadedStyle(e,o+"Width");if(t in goog.style.ieBorderWidthKeywords_)return goog.style.ieBorderWidthKeywords_[t];return goog.style.getIePixelValue_(e,t,"left","pixelLeft")};goog.style.getBorderBox=function(e){if(goog.userAgent.IE&&!goog.userAgent.isDocumentModeOrHigher(9)){var o=goog.style.getIePixelBorder_(e,"borderLeft");var t=goog.style.getIePixelBorder_(e,"borderRight");var i=goog.style.getIePixelBorder_(e,"borderTop");var r=goog.style.getIePixelBorder_(e,"borderBottom");return new goog.math.Box(i,t,r,o)}else{var o=goog.style.getComputedStyle(e,"borderLeftWidth");var t=goog.style.getComputedStyle(e,"borderRightWidth");var i=goog.style.getComputedStyle(e,"borderTopWidth");var r=goog.style.getComputedStyle(e,"borderBottomWidth");return new goog.math.Box(parseFloat(i),parseFloat(t),parseFloat(r),parseFloat(o))}};goog.style.getFontFamily=function(e){var o=goog.dom.getOwnerDocument(e);var t="";if(o.body.createTextRange&&goog.dom.contains(o,e)){var i=o.body.createTextRange();i.moveToElementText(e);try{t=i.queryCommandValue("FontName")}catch(e){t=""}}if(!t)t=goog.style.getStyle_(e,"fontFamily");var r=t.split(",");if(r.length>1)t=r[0];return goog.string.stripQuotes(t,"\"'")};goog.style.lengthUnitRegex_=/[^\d]+$/;goog.style.getLengthUnits=function(e){var o=e.match(goog.style.lengthUnitRegex_);return o&&o[0]||null};goog.style.ABSOLUTE_CSS_LENGTH_UNITS_={cm:1,in:1,mm:1,pc:1,pt:1};goog.style.CONVERTIBLE_RELATIVE_CSS_UNITS_={em:1,ex:1};goog.style.getFontSize=function(e){var o=goog.style.getStyle_(e,"fontSize");var t=goog.style.getLengthUnits(o);if(o&&"px"==t)return parseInt(o,10);if(goog.userAgent.IE)if(String(t)in goog.style.ABSOLUTE_CSS_LENGTH_UNITS_)return goog.style.getIePixelValue_(e,o,"left","pixelLeft");else if(e.parentNode&&e.parentNode.nodeType==goog.dom.NodeType.ELEMENT&&String(t)in goog.style.CONVERTIBLE_RELATIVE_CSS_UNITS_){var i=e.parentNode;var r=goog.style.getStyle_(i,"fontSize");return goog.style.getIePixelValue_(i,o==r?"1em":o,"left","pixelLeft")}var n=goog.dom.createDom(goog.dom.TagName.SPAN,{style:"visibility:hidden;position:absolute;"+"line-height:0;padding:0;margin:0;border:0;height:1em;"});goog.dom.appendChild(e,n);o=n.offsetHeight;goog.dom.removeNode(n);return o};goog.style.parseStyleAttribute=function(e){var o={};goog.array.forEach(e.split(/\s*;\s*/),(function(e){var t=e.match(/\s*([\w-]+)\s*\:(.+)/);if(t){var i=t[1];var r=goog.string.trim(t[2]);o[goog.string.toCamelCase(i.toLowerCase())]=r}}));return o};goog.style.toStyleAttribute=function(e){var o=[];goog.object.forEach(e,(function(e,t){o.push(goog.string.toSelectorCase(t),":",e,";")}));return o.join("")};goog.style.setFloat=function(e,o){e.style[goog.userAgent.IE?"styleFloat":"cssFloat"]=o};goog.style.getFloat=function(e){return e.style[goog.userAgent.IE?"styleFloat":"cssFloat"]||""};goog.style.getScrollbarWidth=function(e){var o=goog.dom.createElement(goog.dom.TagName.DIV);if(e)o.className=e;o.style.cssText="overflow:auto;"+"position:absolute;top:0;width:100px;height:100px";var t=goog.dom.createElement(goog.dom.TagName.DIV);goog.style.setSize(t,"200px","200px");o.appendChild(t);goog.dom.appendChild(goog.dom.getDocument().body,o);var i=o.offsetWidth-o.clientWidth;goog.dom.removeNode(o);return i};goog.style.MATRIX_TRANSLATION_REGEX_=new RegExp("matrix\\([0-9\\.\\-]+, [0-9\\.\\-]+, "+"[0-9\\.\\-]+, [0-9\\.\\-]+, "+"([0-9\\.\\-]+)p?x?, ([0-9\\.\\-]+)p?x?\\)");goog.style.getCssTranslation=function(e){var o=goog.style.getComputedTransform(e);if(!o)return new goog.math.Coordinate(0,0);var t=o.match(goog.style.MATRIX_TRANSLATION_REGEX_);if(!t)return new goog.math.Coordinate(0,0);return new goog.math.Coordinate(parseFloat(t[1]),parseFloat(t[2]))};goog.provide("goog.Timer");goog.require("goog.Promise");goog.require("goog.events.EventTarget");goog.Timer=function(e,o){goog.events.EventTarget.call(this);this.interval_=e||1;this.timerObject_=o||goog.Timer.defaultTimerObject;this.boundTick_=goog.bind(this.tick_,this);this.last_=goog.now()};goog.inherits(goog.Timer,goog.events.EventTarget);goog.Timer.MAX_TIMEOUT_=2147483647;goog.Timer.INVALID_TIMEOUT_ID_=-1;goog.Timer.prototype.enabled=false;goog.Timer.defaultTimerObject=goog.global;goog.Timer.intervalScale=.8;goog.Timer.prototype.timer_=null;goog.Timer.prototype.getInterval=function(){return this.interval_};goog.Timer.prototype.setInterval=function(e){this.interval_=e;if(this.timer_&&this.enabled){this.stop();this.start()}else if(this.timer_)this.stop()};goog.Timer.prototype.tick_=function(){if(this.enabled){var e=goog.now()-this.last_;if(e>0&&e<this.interval_*goog.Timer.intervalScale){this.timer_=this.timerObject_.setTimeout(this.boundTick_,this.interval_-e);return}if(this.timer_){this.timerObject_.clearTimeout(this.timer_);this.timer_=null}this.dispatchTick();if(this.enabled){this.timer_=this.timerObject_.setTimeout(this.boundTick_,this.interval_);this.last_=goog.now()}}};goog.Timer.prototype.dispatchTick=function(){this.dispatchEvent(goog.Timer.TICK)};goog.Timer.prototype.start=function(){this.enabled=true;if(!this.timer_){this.timer_=this.timerObject_.setTimeout(this.boundTick_,this.interval_);this.last_=goog.now()}};goog.Timer.prototype.stop=function(){this.enabled=false;if(this.timer_){this.timerObject_.clearTimeout(this.timer_);this.timer_=null}};goog.Timer.prototype.disposeInternal=function(){goog.Timer.superClass_.disposeInternal.call(this);this.stop();delete this.timerObject_};goog.Timer.TICK="tick";goog.Timer.callOnce=function(e,o,t){if(goog.isFunction(e)){if(t)e=goog.bind(e,t)}else if(e&&"function"==typeof e.handleEvent)e=goog.bind(e.handleEvent,e);else throw new Error("Invalid listener argument");if(Number(o)>goog.Timer.MAX_TIMEOUT_)return goog.Timer.INVALID_TIMEOUT_ID_;else return goog.Timer.defaultTimerObject.setTimeout(e,o||0)};goog.Timer.clear=function(e){goog.Timer.defaultTimerObject.clearTimeout(e)};goog.Timer.promise=function(e,o){var t=null;return new goog.Promise((function(i,r){t=goog.Timer.callOnce((function(){i(o)}),e);if(t==goog.Timer.INVALID_TIMEOUT_ID_)r(new Error("Failed to schedule timer."))})).thenCatch((function(e){goog.Timer.clear(t);throw e}))};goog.provide("goog.a11y.aria.Role");goog.a11y.aria.Role={ALERT:"alert",ALERTDIALOG:"alertdialog",APPLICATION:"application",ARTICLE:"article",BANNER:"banner",BUTTON:"button",CHECKBOX:"checkbox",COLUMNHEADER:"columnheader",COMBOBOX:"combobox",COMPLEMENTARY:"complementary",CONTENTINFO:"contentinfo",DEFINITION:"definition",DIALOG:"dialog",DIRECTORY:"directory",DOCUMENT:"document",FORM:"form",GRID:"grid",GRIDCELL:"gridcell",GROUP:"group",HEADING:"heading",IMG:"img",LINK:"link",LIST:"list",LISTBOX:"listbox",LISTITEM:"listitem",LOG:"log",MAIN:"main",MARQUEE:"marquee",MATH:"math",MENU:"menu",MENUBAR:"menubar",MENU_ITEM:"menuitem",MENU_ITEM_CHECKBOX:"menuitemcheckbox",MENU_ITEM_RADIO:"menuitemradio",NAVIGATION:"navigation",NOTE:"note",OPTION:"option",PRESENTATION:"presentation",PROGRESSBAR:"progressbar",RADIO:"radio",RADIOGROUP:"radiogroup",REGION:"region",ROW:"row",ROWGROUP:"rowgroup",ROWHEADER:"rowheader",SCROLLBAR:"scrollbar",SEARCH:"search",SEPARATOR:"separator",SLIDER:"slider",SPINBUTTON:"spinbutton",STATUS:"status",TAB:"tab",TAB_LIST:"tablist",TAB_PANEL:"tabpanel",TEXTBOX:"textbox",TEXTINFO:"textinfo",TIMER:"timer",TOOLBAR:"toolbar",TOOLTIP:"tooltip",TREE:"tree",TREEGRID:"treegrid",TREEITEM:"treeitem"};goog.provide("goog.a11y.aria");goog.require("goog.a11y.aria.Role");goog.require("goog.a11y.aria.State");goog.require("goog.a11y.aria.datatables");goog.require("goog.array");goog.require("goog.asserts");goog.require("goog.dom");goog.require("goog.dom.TagName");goog.require("goog.object");goog.require("goog.string");goog.a11y.aria.ARIA_PREFIX_="aria-";goog.a11y.aria.ROLE_ATTRIBUTE_="role";goog.a11y.aria.TAGS_WITH_ASSUMED_ROLES_=goog.object.createSet([goog.dom.TagName.A,goog.dom.TagName.AREA,goog.dom.TagName.BUTTON,goog.dom.TagName.HEAD,goog.dom.TagName.INPUT,goog.dom.TagName.LINK,goog.dom.TagName.MENU,goog.dom.TagName.META,goog.dom.TagName.OPTGROUP,goog.dom.TagName.OPTION,goog.dom.TagName.PROGRESS,goog.dom.TagName.STYLE,goog.dom.TagName.SELECT,goog.dom.TagName.SOURCE,goog.dom.TagName.TEXTAREA,goog.dom.TagName.TITLE,goog.dom.TagName.TRACK]);goog.a11y.aria.CONTAINER_ROLES_=[goog.a11y.aria.Role.COMBOBOX,goog.a11y.aria.Role.GRID,goog.a11y.aria.Role.GROUP,goog.a11y.aria.Role.LISTBOX,goog.a11y.aria.Role.MENU,goog.a11y.aria.Role.MENUBAR,goog.a11y.aria.Role.RADIOGROUP,goog.a11y.aria.Role.ROW,goog.a11y.aria.Role.ROWGROUP,goog.a11y.aria.Role.TAB_LIST,goog.a11y.aria.Role.TEXTBOX,goog.a11y.aria.Role.TOOLBAR,goog.a11y.aria.Role.TREE,goog.a11y.aria.Role.TREEGRID];goog.a11y.aria.setRole=function(e,o){if(!o)goog.a11y.aria.removeRole(e);else{if(goog.asserts.ENABLE_ASSERTS)goog.asserts.assert(goog.object.containsValue(goog.a11y.aria.Role,o),"No such ARIA role "+o);e.setAttribute(goog.a11y.aria.ROLE_ATTRIBUTE_,o)}};goog.a11y.aria.getRole=function(e){var o=e.getAttribute(goog.a11y.aria.ROLE_ATTRIBUTE_);return o||null};goog.a11y.aria.removeRole=function(e){e.removeAttribute(goog.a11y.aria.ROLE_ATTRIBUTE_)};goog.a11y.aria.setState=function(e,o,t){if(goog.isArray(t))t=t.join(" ");var i=goog.a11y.aria.getAriaAttributeName_(o);if(""===t||void 0==t){var r=goog.a11y.aria.datatables.getDefaultValuesMap();if(o in r)e.setAttribute(i,r[o]);else e.removeAttribute(i)}else e.setAttribute(i,t)};goog.a11y.aria.toggleState=function(e,o){var t=goog.a11y.aria.getState(e,o);if(!goog.string.isEmptyOrWhitespace(goog.string.makeSafe(t))&&!("true"==t||"false"==t)){goog.a11y.aria.removeState(e,o);return}goog.a11y.aria.setState(e,o,"true"==t?"false":"true")};goog.a11y.aria.removeState=function(e,o){e.removeAttribute(goog.a11y.aria.getAriaAttributeName_(o))};goog.a11y.aria.getState=function(e,o){var t=e.getAttribute(goog.a11y.aria.getAriaAttributeName_(o));var i=null==t||void 0==t;return i?"":String(t)};goog.a11y.aria.getActiveDescendant=function(e){var o=goog.a11y.aria.getState(e,goog.a11y.aria.State.ACTIVEDESCENDANT);return goog.dom.getOwnerDocument(e).getElementById(o)};goog.a11y.aria.setActiveDescendant=function(e,o){var t="";if(o){t=o.id;goog.asserts.assert(t,"The active element should have an id.")}goog.a11y.aria.setState(e,goog.a11y.aria.State.ACTIVEDESCENDANT,t)};goog.a11y.aria.getLabel=function(e){return goog.a11y.aria.getState(e,goog.a11y.aria.State.LABEL)};goog.a11y.aria.setLabel=function(e,o){goog.a11y.aria.setState(e,goog.a11y.aria.State.LABEL,o)};goog.a11y.aria.assertRoleIsSetInternalUtil=function(e,o){if(goog.a11y.aria.TAGS_WITH_ASSUMED_ROLES_[e.tagName])return;var t=goog.a11y.aria.getRole(e);goog.asserts.assert(null!=t,"The element ARIA role cannot be null.");goog.asserts.assert(goog.array.contains(o,t),"Non existing or incorrect role set for element."+'The role set is "'+t+'". The role should be any of "'+o+'". Check the ARIA specification for more details '+"http://www.w3.org/TR/wai-aria/roles.")};goog.a11y.aria.getStateBoolean=function(e,o){var t=e.getAttribute(goog.a11y.aria.getAriaAttributeName_(o));goog.asserts.assert(goog.isBoolean(t)||null==t||"true"==t||"false"==t);if(null==t)return t;return goog.isBoolean(t)?t:"true"==t};goog.a11y.aria.getStateNumber=function(e,o){var t=e.getAttribute(goog.a11y.aria.getAriaAttributeName_(o));goog.asserts.assert((null==t||!isNaN(Number(t)))&&!goog.isBoolean(t));return null==t?null:Number(t)};goog.a11y.aria.getStateString=function(e,o){var t=e.getAttribute(goog.a11y.aria.getAriaAttributeName_(o));goog.asserts.assert((null==t||goog.isString(t))&&(""==t||isNaN(Number(t)))&&"true"!=t&&"false"!=t);return null==t||""==t?null:t};goog.a11y.aria.getStringArrayStateInternalUtil=function(e,o){var t=e.getAttribute(goog.a11y.aria.getAriaAttributeName_(o));return goog.a11y.aria.splitStringOnWhitespace_(t)};goog.a11y.aria.hasState=function(e,o){return e.hasAttribute(goog.a11y.aria.getAriaAttributeName_(o))};goog.a11y.aria.isContainerRole=function(e){var o=goog.a11y.aria.getRole(e);return goog.array.contains(goog.a11y.aria.CONTAINER_ROLES_,o)};goog.a11y.aria.splitStringOnWhitespace_=function(e){return e?e.split(/\s+/):[]};goog.a11y.aria.getAriaAttributeName_=function(e){if(goog.asserts.ENABLE_ASSERTS){goog.asserts.assert(e,"ARIA attribute cannot be empty.");goog.asserts.assert(goog.object.containsValue(goog.a11y.aria.State,e),"No such ARIA attribute "+e)}return goog.a11y.aria.ARIA_PREFIX_+e};goog.provide("goog.a11y.aria.AutoCompleteValues");goog.provide("goog.a11y.aria.CheckedValues");goog.provide("goog.a11y.aria.DropEffectValues");goog.provide("goog.a11y.aria.ExpandedValues");goog.provide("goog.a11y.aria.GrabbedValues");goog.provide("goog.a11y.aria.InvalidValues");goog.provide("goog.a11y.aria.LivePriority");goog.provide("goog.a11y.aria.OrientationValues");goog.provide("goog.a11y.aria.PressedValues");goog.provide("goog.a11y.aria.RelevantValues");goog.provide("goog.a11y.aria.SelectedValues");goog.provide("goog.a11y.aria.SortValues");goog.provide("goog.a11y.aria.State");goog.a11y.aria.State={ACTIVEDESCENDANT:"activedescendant",ATOMIC:"atomic",AUTOCOMPLETE:"autocomplete",BUSY:"busy",CHECKED:"checked",COLINDEX:"colindex",CONTROLS:"controls",DESCRIBEDBY:"describedby",DISABLED:"disabled",DROPEFFECT:"dropeffect",EXPANDED:"expanded",FLOWTO:"flowto",GRABBED:"grabbed",HASPOPUP:"haspopup",HIDDEN:"hidden",INVALID:"invalid",LABEL:"label",LABELLEDBY:"labelledby",LEVEL:"level",LIVE:"live",MULTILINE:"multiline",MULTISELECTABLE:"multiselectable",ORIENTATION:"orientation",OWNS:"owns",POSINSET:"posinset",PRESSED:"pressed",READONLY:"readonly",RELEVANT:"relevant",REQUIRED:"required",ROWINDEX:"rowindex",SELECTED:"selected",SETSIZE:"setsize",SORT:"sort",VALUEMAX:"valuemax",VALUEMIN:"valuemin",VALUENOW:"valuenow",VALUETEXT:"valuetext"};goog.a11y.aria.AutoCompleteValues={INLINE:"inline",LIST:"list",BOTH:"both",NONE:"none"};goog.a11y.aria.DropEffectValues={COPY:"copy",MOVE:"move",LINK:"link",EXECUTE:"execute",POPUP:"popup",NONE:"none"};goog.a11y.aria.LivePriority={OFF:"off",POLITE:"polite",ASSERTIVE:"assertive"};goog.a11y.aria.OrientationValues={VERTICAL:"vertical",HORIZONTAL:"horizontal"};goog.a11y.aria.RelevantValues={ADDITIONS:"additions",REMOVALS:"removals",TEXT:"text",ALL:"all"};goog.a11y.aria.SortValues={ASCENDING:"ascending",DESCENDING:"descending",NONE:"none",OTHER:"other"};goog.a11y.aria.CheckedValues={TRUE:"true",FALSE:"false",MIXED:"mixed",UNDEFINED:"undefined"};goog.a11y.aria.ExpandedValues={TRUE:"true",FALSE:"false",UNDEFINED:"undefined"};goog.a11y.aria.GrabbedValues={TRUE:"true",FALSE:"false",UNDEFINED:"undefined"};goog.a11y.aria.InvalidValues={FALSE:"false",TRUE:"true",GRAMMAR:"grammar",SPELLING:"spelling"};goog.a11y.aria.PressedValues={TRUE:"true",FALSE:"false",MIXED:"mixed",UNDEFINED:"undefined"};goog.a11y.aria.SelectedValues={TRUE:"true",FALSE:"false",UNDEFINED:"undefined"};goog.provide("goog.a11y.aria.datatables");goog.require("goog.a11y.aria.State");goog.require("goog.object");goog.a11y.aria.DefaultStateValueMap_;goog.a11y.aria.datatables.getDefaultValuesMap=function(){if(!goog.a11y.aria.DefaultStateValueMap_)goog.a11y.aria.DefaultStateValueMap_=goog.object.create(goog.a11y.aria.State.ATOMIC,false,goog.a11y.aria.State.AUTOCOMPLETE,"none",goog.a11y.aria.State.DROPEFFECT,"none",goog.a11y.aria.State.HASPOPUP,false,goog.a11y.aria.State.LIVE,"off",goog.a11y.aria.State.MULTILINE,false,goog.a11y.aria.State.MULTISELECTABLE,false,goog.a11y.aria.State.ORIENTATION,"vertical",goog.a11y.aria.State.READONLY,false,goog.a11y.aria.State.RELEVANT,"additions text",goog.a11y.aria.State.REQUIRED,false,goog.a11y.aria.State.SORT,"none",goog.a11y.aria.State.BUSY,false,goog.a11y.aria.State.DISABLED,false,goog.a11y.aria.State.HIDDEN,false,goog.a11y.aria.State.INVALID,"false");return goog.a11y.aria.DefaultStateValueMap_};goog.provide("goog.ui.IdGenerator");goog.ui.IdGenerator=function(){};goog.addSingletonGetter(goog.ui.IdGenerator);goog.ui.IdGenerator.prototype.nextId_=0;goog.ui.IdGenerator.prototype.getNextUniqueId=function(){return":"+(this.nextId_++).toString(36)};goog.provide("goog.ui.ControlRenderer");goog.require("goog.a11y.aria");goog.require("goog.a11y.aria.Role");goog.require("goog.a11y.aria.State");goog.require("goog.array");goog.require("goog.asserts");goog.require("goog.dom");goog.require("goog.dom.TagName");goog.require("goog.dom.classlist");goog.require("goog.object");goog.require("goog.string");goog.require("goog.style");goog.require("goog.ui.Component");goog.require("goog.ui.ControlContent");goog.require("goog.userAgent");goog.forwardDeclare("goog.ui.Control");goog.ui.ControlRenderer=function(){};goog.addSingletonGetter(goog.ui.ControlRenderer);goog.tagUnsealableClass(goog.ui.ControlRenderer);goog.ui.ControlRenderer.getCustomRenderer=function(e,o){var t=new e;t.getCssClass=function(){return o};return t};goog.ui.ControlRenderer.CSS_CLASS=goog.getCssName("goog-control");goog.ui.ControlRenderer.IE6_CLASS_COMBINATIONS=[];goog.ui.ControlRenderer.ariaAttributeMap_;goog.ui.ControlRenderer.TOGGLE_ARIA_STATE_MAP_=goog.object.create(goog.a11y.aria.Role.BUTTON,goog.a11y.aria.State.PRESSED,goog.a11y.aria.Role.CHECKBOX,goog.a11y.aria.State.CHECKED,goog.a11y.aria.Role.MENU_ITEM,goog.a11y.aria.State.SELECTED,goog.a11y.aria.Role.MENU_ITEM_CHECKBOX,goog.a11y.aria.State.CHECKED,goog.a11y.aria.Role.MENU_ITEM_RADIO,goog.a11y.aria.State.CHECKED,goog.a11y.aria.Role.RADIO,goog.a11y.aria.State.CHECKED,goog.a11y.aria.Role.TAB,goog.a11y.aria.State.SELECTED,goog.a11y.aria.Role.TREEITEM,goog.a11y.aria.State.SELECTED);goog.ui.ControlRenderer.prototype.getAriaRole=function(){return};goog.ui.ControlRenderer.prototype.createDom=function(e){var o=e.getDomHelper().createDom(goog.dom.TagName.DIV,this.getClassNames(e).join(" "),e.getContent());return o};goog.ui.ControlRenderer.prototype.getContentElement=function(e){return e};goog.ui.ControlRenderer.prototype.enableClassName=function(e,o,t){var i=e.getElement?e.getElement():e;if(i){var r=[o];if(goog.userAgent.IE&&!goog.userAgent.isVersionOrHigher("7")){r=this.getAppliedCombinedClassNames_(goog.dom.classlist.get(i),o);r.push(o)}goog.dom.classlist.enableAll(i,r,t)}};goog.ui.ControlRenderer.prototype.enableExtraClassName=function(e,o,t){this.enableClassName(e,o,t)};goog.ui.ControlRenderer.prototype.canDecorate=function(e){return true};goog.ui.ControlRenderer.prototype.decorate=function(e,o){if(o.id)e.setId(o.id);var t=this.getContentElement(o);if(t&&t.firstChild)e.setContentInternal(t.firstChild.nextSibling?goog.array.clone(t.childNodes):t.firstChild);else e.setContentInternal(null);var i=0;var r=this.getCssClass();var n=this.getStructuralCssClass();var l=false;var s=false;var g=false;var a=goog.array.toArray(goog.dom.classlist.get(o));goog.array.forEach(a,(function(e){if(!l&&e==r){l=true;if(n==r)s=true}else if(!s&&e==n)s=true;else i|=this.getStateFromClass(e);if(this.getStateFromClass(e)==goog.ui.Component.State.DISABLED){goog.asserts.assertElement(t);if(goog.dom.isFocusableTabIndex(t))goog.dom.setFocusableTabIndex(t,false)}}),this);e.setStateInternal(i);if(!l){a.push(r);if(n==r)s=true}if(!s)a.push(n);var c=e.getExtraClassNames();if(c)a.push.apply(a,c);if(goog.userAgent.IE&&!goog.userAgent.isVersionOrHigher("7")){var u=this.getAppliedCombinedClassNames_(a);if(u.length>0){a.push.apply(a,u);g=true}}if(!l||!s||c||g)goog.dom.classlist.set(o,a.join(" "));return o};goog.ui.ControlRenderer.prototype.initializeDom=function(e){if(e.isRightToLeft())this.setRightToLeft(e.getElement(),true);if(e.isEnabled())this.setFocusable(e,e.isVisible())};goog.ui.ControlRenderer.prototype.setAriaRole=function(e,o){var t=o||this.getAriaRole();if(t){goog.asserts.assert(e,"The element passed as a first parameter cannot be null.");var i=goog.a11y.aria.getRole(e);if(t==i)return;goog.a11y.aria.setRole(e,t)}};goog.ui.ControlRenderer.prototype.setAriaStates=function(e,o){goog.asserts.assert(e);goog.asserts.assert(o);var t=e.getAriaLabel();if(goog.isDefAndNotNull(t))this.setAriaLabel(o,t);if(!e.isVisible())goog.a11y.aria.setState(o,goog.a11y.aria.State.HIDDEN,!e.isVisible());if(!e.isEnabled())this.updateAriaState(o,goog.ui.Component.State.DISABLED,!e.isEnabled());if(e.isSupportedState(goog.ui.Component.State.SELECTED))this.updateAriaState(o,goog.ui.Component.State.SELECTED,e.isSelected());if(e.isSupportedState(goog.ui.Component.State.CHECKED))this.updateAriaState(o,goog.ui.Component.State.CHECKED,e.isChecked());if(e.isSupportedState(goog.ui.Component.State.OPENED))this.updateAriaState(o,goog.ui.Component.State.OPENED,e.isOpen())};goog.ui.ControlRenderer.prototype.setAriaLabel=function(e,o){goog.a11y.aria.setLabel(e,o)};goog.ui.ControlRenderer.prototype.setAllowTextSelection=function(e,o){goog.style.setUnselectable(e,!o,!goog.userAgent.IE&&!goog.userAgent.OPERA)};goog.ui.ControlRenderer.prototype.setRightToLeft=function(e,o){this.enableClassName(e,goog.getCssName(this.getStructuralCssClass(),"rtl"),o)};goog.ui.ControlRenderer.prototype.isFocusable=function(e){var o;if(e.isSupportedState(goog.ui.Component.State.FOCUSED)&&(o=e.getKeyEventTarget()))return goog.dom.isFocusableTabIndex(o);return false};goog.ui.ControlRenderer.prototype.setFocusable=function(e,o){var t;if(e.isSupportedState(goog.ui.Component.State.FOCUSED)&&(t=e.getKeyEventTarget())){if(!o&&e.isFocused()){try{t.blur()}catch(e){}if(e.isFocused())e.handleBlur(null)}if(goog.dom.isFocusableTabIndex(t)!=o)goog.dom.setFocusableTabIndex(t,o)}};goog.ui.ControlRenderer.prototype.setVisible=function(e,o){goog.style.setElementShown(e,o);if(e)goog.a11y.aria.setState(e,goog.a11y.aria.State.HIDDEN,!o)};goog.ui.ControlRenderer.prototype.setState=function(e,o,t){var i=e.getElement();if(i){var r=this.getClassForState(o);if(r)this.enableClassName(e,r,t);this.updateAriaState(i,o,t)}};goog.ui.ControlRenderer.prototype.updateAriaState=function(e,o,t){if(!goog.ui.ControlRenderer.ariaAttributeMap_)goog.ui.ControlRenderer.ariaAttributeMap_=goog.object.create(goog.ui.Component.State.DISABLED,goog.a11y.aria.State.DISABLED,goog.ui.Component.State.SELECTED,goog.a11y.aria.State.SELECTED,goog.ui.Component.State.CHECKED,goog.a11y.aria.State.CHECKED,goog.ui.Component.State.OPENED,goog.a11y.aria.State.EXPANDED);goog.asserts.assert(e,"The element passed as a first parameter cannot be null.");var i=goog.ui.ControlRenderer.getAriaStateForAriaRole_(e,goog.ui.ControlRenderer.ariaAttributeMap_[o]);if(i)goog.a11y.aria.setState(e,i,t)};goog.ui.ControlRenderer.getAriaStateForAriaRole_=function(e,o){var t=goog.a11y.aria.getRole(e);if(!t)return o;t=t;var i=goog.ui.ControlRenderer.TOGGLE_ARIA_STATE_MAP_[t]||o;return goog.ui.ControlRenderer.isAriaState_(o)?i:o};goog.ui.ControlRenderer.isAriaState_=function(e){return e==goog.a11y.aria.State.CHECKED||e==goog.a11y.aria.State.SELECTED};goog.ui.ControlRenderer.prototype.setContent=function(e,o){var t=this.getContentElement(e);if(t){goog.dom.removeChildren(t);if(o)if(goog.isString(o))goog.dom.setTextContent(t,o);else{var i=function(e){if(e){var o=goog.dom.getOwnerDocument(t);t.appendChild(goog.isString(e)?o.createTextNode(e):e)}};if(goog.isArray(o))goog.array.forEach(o,i);else if(goog.isArrayLike(o)&&!("nodeType"in o))goog.array.forEach(goog.array.clone(o),i);else i(o)}}};goog.ui.ControlRenderer.prototype.getKeyEventTarget=function(e){return e.getElement()};goog.ui.ControlRenderer.prototype.getCssClass=function(){return goog.ui.ControlRenderer.CSS_CLASS};goog.ui.ControlRenderer.prototype.getIe6ClassCombinations=function(){return[]};goog.ui.ControlRenderer.prototype.getStructuralCssClass=function(){return this.getCssClass()};goog.ui.ControlRenderer.prototype.getClassNames=function(e){var o=this.getCssClass();var t=[o];var i=this.getStructuralCssClass();if(i!=o)t.push(i);var r=this.getClassNamesForState(e.getState());t.push.apply(t,r);var n=e.getExtraClassNames();if(n)t.push.apply(t,n);if(goog.userAgent.IE&&!goog.userAgent.isVersionOrHigher("7"))t.push.apply(t,this.getAppliedCombinedClassNames_(t));return t};goog.ui.ControlRenderer.prototype.getAppliedCombinedClassNames_=function(e,o){var t=[];if(o)e=goog.array.concat(e,[o]);goog.array.forEach(this.getIe6ClassCombinations(),(function(i){if(goog.array.every(i,goog.partial(goog.array.contains,e))&&(!o||goog.array.contains(i,o)))t.push(i.join("_"))}));return t};goog.ui.ControlRenderer.prototype.getClassNamesForState=function(e){var o=[];while(e){var t=e&-e;o.push(this.getClassForState(t));e&=~t}return o};goog.ui.ControlRenderer.prototype.getClassForState=function(e){if(!this.classByState_)this.createClassByStateMap_();return this.classByState_[e]};goog.ui.ControlRenderer.prototype.getStateFromClass=function(e){if(!this.stateByClass_)this.createStateByClassMap_();var o=parseInt(this.stateByClass_[e],10);return isNaN(o)?0:o};goog.ui.ControlRenderer.prototype.createClassByStateMap_=function(){var e=this.getStructuralCssClass();var o=!goog.string.contains(goog.string.normalizeWhitespace(e)," ");goog.asserts.assert(o,"ControlRenderer has an invalid css class: '"+e+"'");this.classByState_=goog.object.create(goog.ui.Component.State.DISABLED,goog.getCssName(e,"disabled"),goog.ui.Component.State.HOVER,goog.getCssName(e,"hover"),goog.ui.Component.State.ACTIVE,goog.getCssName(e,"active"),goog.ui.Component.State.SELECTED,goog.getCssName(e,"selected"),goog.ui.Component.State.CHECKED,goog.getCssName(e,"checked"),goog.ui.Component.State.FOCUSED,goog.getCssName(e,"focused"),goog.ui.Component.State.OPENED,goog.getCssName(e,"open"))};goog.ui.ControlRenderer.prototype.createStateByClassMap_=function(){if(!this.classByState_)this.createClassByStateMap_();this.stateByClass_=goog.object.transpose(this.classByState_)};goog.provide("goog.ui.MenuHeaderRenderer");goog.require("goog.ui.ControlRenderer");goog.ui.MenuHeaderRenderer=function(){goog.ui.ControlRenderer.call(this)};goog.inherits(goog.ui.MenuHeaderRenderer,goog.ui.ControlRenderer);goog.addSingletonGetter(goog.ui.MenuHeaderRenderer);goog.ui.MenuHeaderRenderer.CSS_CLASS=goog.getCssName("goog-menuheader");goog.ui.MenuHeaderRenderer.prototype.getCssClass=function(){return goog.ui.MenuHeaderRenderer.CSS_CLASS};goog.provide("goog.ui.MenuItemRenderer");goog.require("goog.a11y.aria.Role");goog.require("goog.asserts");goog.require("goog.dom");goog.require("goog.dom.TagName");goog.require("goog.dom.classlist");goog.require("goog.ui.Component");goog.require("goog.ui.ControlRenderer");goog.ui.MenuItemRenderer=function(){goog.ui.ControlRenderer.call(this);this.classNameCache_=[]};goog.inherits(goog.ui.MenuItemRenderer,goog.ui.ControlRenderer);goog.addSingletonGetter(goog.ui.MenuItemRenderer);goog.ui.MenuItemRenderer.CSS_CLASS=goog.getCssName("goog-menuitem");goog.ui.MenuItemRenderer.CompositeCssClassIndex_={HOVER:0,CHECKBOX:1,CONTENT:2};goog.ui.MenuItemRenderer.prototype.getCompositeCssClass_=function(e){var o=this.classNameCache_[e];if(!o){switch(e){case goog.ui.MenuItemRenderer.CompositeCssClassIndex_.HOVER:o=goog.getCssName(this.getStructuralCssClass(),"highlight");break;case goog.ui.MenuItemRenderer.CompositeCssClassIndex_.CHECKBOX:o=goog.getCssName(this.getStructuralCssClass(),"checkbox");break;case goog.ui.MenuItemRenderer.CompositeCssClassIndex_.CONTENT:o=goog.getCssName(this.getStructuralCssClass(),"content");break}this.classNameCache_[e]=o}return o};goog.ui.MenuItemRenderer.prototype.getAriaRole=function(){return goog.a11y.aria.Role.MENU_ITEM};goog.ui.MenuItemRenderer.prototype.createDom=function(e){var o=e.getDomHelper().createDom(goog.dom.TagName.DIV,this.getClassNames(e).join(" "),this.createContent(e.getContent(),e.getDomHelper()));this.setEnableCheckBoxStructure(e,o,e.isSupportedState(goog.ui.Component.State.SELECTED)||e.isSupportedState(goog.ui.Component.State.CHECKED));return o};goog.ui.MenuItemRenderer.prototype.getContentElement=function(e){return e&&e.firstChild};goog.ui.MenuItemRenderer.prototype.decorate=function(e,o){goog.asserts.assert(o);if(!this.hasContentStructure(o))o.appendChild(this.createContent(o.childNodes,e.getDomHelper()));if(goog.dom.classlist.contains(o,goog.getCssName("goog-option"))){e.setCheckable(true);this.setCheckable(e,o,true)}return goog.ui.MenuItemRenderer.superClass_.decorate.call(this,e,o)};goog.ui.MenuItemRenderer.prototype.setContent=function(e,o){var t=this.getContentElement(e);var i=this.hasCheckBoxStructure(e)?t.firstChild:null;goog.ui.MenuItemRenderer.superClass_.setContent.call(this,e,o);if(i&&!this.hasCheckBoxStructure(e))t.insertBefore(i,t.firstChild||null)};goog.ui.MenuItemRenderer.prototype.hasContentStructure=function(e){var o=goog.dom.getFirstElementChild(e);var t=this.getCompositeCssClass_(goog.ui.MenuItemRenderer.CompositeCssClassIndex_.CONTENT);return!!o&&goog.dom.classlist.contains(o,t)};goog.ui.MenuItemRenderer.prototype.createContent=function(e,o){var t=this.getCompositeCssClass_(goog.ui.MenuItemRenderer.CompositeCssClassIndex_.CONTENT);return o.createDom(goog.dom.TagName.DIV,t,e)};goog.ui.MenuItemRenderer.prototype.setSelectable=function(e,o,t){if(e&&o)this.setEnableCheckBoxStructure(e,o,t)};goog.ui.MenuItemRenderer.prototype.setCheckable=function(e,o,t){if(e&&o)this.setEnableCheckBoxStructure(e,o,t)};goog.ui.MenuItemRenderer.prototype.hasCheckBoxStructure=function(e){var o=this.getContentElement(e);if(o){var t=o.firstChild;var i=this.getCompositeCssClass_(goog.ui.MenuItemRenderer.CompositeCssClassIndex_.CHECKBOX);return!!t&&goog.dom.isElement(t)&&goog.dom.classlist.contains(t,i)}return false};goog.ui.MenuItemRenderer.prototype.setEnableCheckBoxStructure=function(e,o,t){this.setAriaRole(o,e.getPreferredAriaRole());this.setAriaStates(e,o);if(t!=this.hasCheckBoxStructure(o)){goog.dom.classlist.enable(o,goog.getCssName("goog-option"),t);var i=this.getContentElement(o);if(t){var r=this.getCompositeCssClass_(goog.ui.MenuItemRenderer.CompositeCssClassIndex_.CHECKBOX);i.insertBefore(e.getDomHelper().createDom(goog.dom.TagName.DIV,r),i.firstChild||null)}else i.removeChild(i.firstChild)}};goog.ui.MenuItemRenderer.prototype.getClassForState=function(e){switch(e){case goog.ui.Component.State.HOVER:return this.getCompositeCssClass_(goog.ui.MenuItemRenderer.CompositeCssClassIndex_.HOVER);case goog.ui.Component.State.CHECKED:case goog.ui.Component.State.SELECTED:return goog.getCssName("goog-option-selected");default:return goog.ui.MenuItemRenderer.superClass_.getClassForState.call(this,e)}};goog.ui.MenuItemRenderer.prototype.getStateFromClass=function(e){var o=this.getCompositeCssClass_(goog.ui.MenuItemRenderer.CompositeCssClassIndex_.HOVER);switch(e){case goog.getCssName("goog-option-selected"):return goog.ui.Component.State.CHECKED;case o:return goog.ui.Component.State.HOVER;default:return goog.ui.MenuItemRenderer.superClass_.getStateFromClass.call(this,e)}};goog.ui.MenuItemRenderer.prototype.getCssClass=function(){return goog.ui.MenuItemRenderer.CSS_CLASS};goog.provide("goog.ui.MenuSeparatorRenderer");goog.require("goog.dom");goog.require("goog.dom.TagName");goog.require("goog.dom.classlist");goog.require("goog.ui.ControlRenderer");goog.ui.MenuSeparatorRenderer=function(){goog.ui.ControlRenderer.call(this)};goog.inherits(goog.ui.MenuSeparatorRenderer,goog.ui.ControlRenderer);goog.addSingletonGetter(goog.ui.MenuSeparatorRenderer);goog.ui.MenuSeparatorRenderer.CSS_CLASS=goog.getCssName("goog-menuseparator");goog.ui.MenuSeparatorRenderer.prototype.createDom=function(e){return e.getDomHelper().createDom(goog.dom.TagName.DIV,this.getCssClass())};goog.ui.MenuSeparatorRenderer.prototype.decorate=function(e,o){if(o.id)e.setId(o.id);if(o.tagName==goog.dom.TagName.HR){var t=o;o=this.createDom(e);goog.dom.insertSiblingBefore(o,t);goog.dom.removeNode(t)}else goog.dom.classlist.add(o,this.getCssClass());return o};goog.ui.MenuSeparatorRenderer.prototype.setContent=function(e,o){};goog.ui.MenuSeparatorRenderer.prototype.getCssClass=function(){return goog.ui.MenuSeparatorRenderer.CSS_CLASS};goog.provide("goog.ui.registry");goog.require("goog.asserts");goog.require("goog.dom.classlist");goog.forwardDeclare("goog.ui.Component");goog.forwardDeclare("goog.ui.ControlRenderer");goog.ui.registry.getDefaultRenderer=function(e){var o;var t;while(e){o=goog.getUid(e);if(t=goog.ui.registry.defaultRenderers_[o])break;e=e.superClass_?e.superClass_.constructor:null}if(t)return goog.isFunction(t.getInstance)?t.getInstance():new t;return null};goog.ui.registry.setDefaultRenderer=function(e,o){if(!goog.isFunction(e))throw new Error("Invalid component class "+e);if(!goog.isFunction(o))throw new Error("Invalid renderer class "+o);var t=goog.getUid(e);goog.ui.registry.defaultRenderers_[t]=o};goog.ui.registry.getDecoratorByClassName=function(e){return e in goog.ui.registry.decoratorFunctions_?goog.ui.registry.decoratorFunctions_[e]():null};goog.ui.registry.setDecoratorByClassName=function(e,o){if(!e)throw new Error("Invalid class name "+e);if(!goog.isFunction(o))throw new Error("Invalid decorator function "+o);goog.ui.registry.decoratorFunctions_[e]=o};goog.ui.registry.getDecorator=function(e){var o;goog.asserts.assert(e);var t=goog.dom.classlist.get(e);for(var i=0,r=t.length;i<r;i++)if(o=goog.ui.registry.getDecoratorByClassName(t[i]))return o;return null};goog.ui.registry.reset=function(){goog.ui.registry.defaultRenderers_={};goog.ui.registry.decoratorFunctions_={}};goog.ui.registry.defaultRenderers_={};goog.ui.registry.decoratorFunctions_={};goog.provide("goog.ui.Component");goog.provide("goog.ui.Component.Error");goog.provide("goog.ui.Component.EventType");goog.provide("goog.ui.Component.State");goog.require("goog.array");goog.require("goog.asserts");goog.require("goog.dom");goog.require("goog.dom.NodeType");goog.require("goog.dom.TagName");goog.require("goog.events.EventHandler");goog.require("goog.events.EventTarget");goog.require("goog.object");goog.require("goog.style");goog.require("goog.ui.IdGenerator");goog.ui.Component=function(e){goog.events.EventTarget.call(this);this.dom_=e||goog.dom.getDomHelper();this.rightToLeft_=goog.ui.Component.defaultRightToLeft_;this.id_=null;this.inDocument_=false;this.element_=null;this.googUiComponentHandler_=void 0;this.model_=null;this.parent_=null;this.children_=null;this.childIndex_=null;this.wasDecorated_=false};goog.inherits(goog.ui.Component,goog.events.EventTarget);goog.define("goog.ui.Component.ALLOW_DETACHED_DECORATION",false);goog.ui.Component.prototype.idGenerator_=goog.ui.IdGenerator.getInstance();goog.define("goog.ui.Component.DEFAULT_BIDI_DIR",0);goog.ui.Component.defaultRightToLeft_=1==goog.ui.Component.DEFAULT_BIDI_DIR?false:-1==goog.ui.Component.DEFAULT_BIDI_DIR?true:null;goog.ui.Component.EventType={BEFORE_SHOW:"beforeshow",SHOW:"show",HIDE:"hide",DISABLE:"disable",ENABLE:"enable",HIGHLIGHT:"highlight",UNHIGHLIGHT:"unhighlight",ACTIVATE:"activate",DEACTIVATE:"deactivate",SELECT:"select",UNSELECT:"unselect",CHECK:"check",UNCHECK:"uncheck",FOCUS:"focus",BLUR:"blur",OPEN:"open",CLOSE:"close",ENTER:"enter",LEAVE:"leave",ACTION:"action",CHANGE:"change"};goog.ui.Component.Error={NOT_SUPPORTED:"Method not supported",DECORATE_INVALID:"Invalid element to decorate",ALREADY_RENDERED:"Component already rendered",PARENT_UNABLE_TO_BE_SET:"Unable to set parent component",CHILD_INDEX_OUT_OF_BOUNDS:"Child component index out of bounds",NOT_OUR_CHILD:"Child is not in parent component",NOT_IN_DOCUMENT:"Operation not supported while component is not in document",STATE_INVALID:"Invalid component state"};goog.ui.Component.State={ALL:255,DISABLED:1,HOVER:2,ACTIVE:4,SELECTED:8,CHECKED:16,FOCUSED:32,OPENED:64};goog.ui.Component.getStateTransitionEvent=function(e,o){switch(e){case goog.ui.Component.State.DISABLED:return o?goog.ui.Component.EventType.DISABLE:goog.ui.Component.EventType.ENABLE;case goog.ui.Component.State.HOVER:return o?goog.ui.Component.EventType.HIGHLIGHT:goog.ui.Component.EventType.UNHIGHLIGHT;case goog.ui.Component.State.ACTIVE:return o?goog.ui.Component.EventType.ACTIVATE:goog.ui.Component.EventType.DEACTIVATE;case goog.ui.Component.State.SELECTED:return o?goog.ui.Component.EventType.SELECT:goog.ui.Component.EventType.UNSELECT;case goog.ui.Component.State.CHECKED:return o?goog.ui.Component.EventType.CHECK:goog.ui.Component.EventType.UNCHECK;case goog.ui.Component.State.FOCUSED:return o?goog.ui.Component.EventType.FOCUS:goog.ui.Component.EventType.BLUR;case goog.ui.Component.State.OPENED:return o?goog.ui.Component.EventType.OPEN:goog.ui.Component.EventType.CLOSE}throw new Error(goog.ui.Component.Error.STATE_INVALID)};goog.ui.Component.setDefaultRightToLeft=function(e){goog.ui.Component.defaultRightToLeft_=e};goog.ui.Component.prototype.getId=function(){return this.id_||(this.id_=this.idGenerator_.getNextUniqueId())};goog.ui.Component.prototype.setId=function(e){if(this.parent_&&this.parent_.childIndex_){goog.object.remove(this.parent_.childIndex_,this.id_);goog.object.add(this.parent_.childIndex_,e,this)}this.id_=e};goog.ui.Component.prototype.getElement=function(){return this.element_};goog.ui.Component.prototype.getElementStrict=function(){var e=this.element_;goog.asserts.assert(e,"Can not call getElementStrict before rendering/decorating.");return e};goog.ui.Component.prototype.setElementInternal=function(e){this.element_=e};goog.ui.Component.prototype.getElementsByClass=function(e){return this.element_?this.dom_.getElementsByClass(e,this.element_):[]};goog.ui.Component.prototype.getElementByClass=function(e){return this.element_?this.dom_.getElementByClass(e,this.element_):null};goog.ui.Component.prototype.getRequiredElementByClass=function(e){var o=this.getElementByClass(e);goog.asserts.assert(o,"Expected element in component with class: %s",e);return o};goog.ui.Component.prototype.getHandler=function(){var e=this;if(!e.googUiComponentHandler_)e.googUiComponentHandler_=new goog.events.EventHandler(e);return goog.asserts.assert(e.googUiComponentHandler_)};goog.ui.Component.prototype.setParent=function(e){if(this==e)throw new Error(goog.ui.Component.Error.PARENT_UNABLE_TO_BE_SET);if(e&&this.parent_&&this.id_&&this.parent_.getChild(this.id_)&&this.parent_!=e)throw new Error(goog.ui.Component.Error.PARENT_UNABLE_TO_BE_SET);this.parent_=e;goog.ui.Component.superClass_.setParentEventTarget.call(this,e)};goog.ui.Component.prototype.getParent=function(){return this.parent_};goog.ui.Component.prototype.setParentEventTarget=function(e){if(this.parent_&&this.parent_!=e)throw new Error(goog.ui.Component.Error.NOT_SUPPORTED);goog.ui.Component.superClass_.setParentEventTarget.call(this,e)};goog.ui.Component.prototype.getDomHelper=function(){return this.dom_};goog.ui.Component.prototype.isInDocument=function(){return this.inDocument_};goog.ui.Component.prototype.createDom=function(){this.element_=this.dom_.createElement(goog.dom.TagName.DIV)};goog.ui.Component.prototype.render=function(e){this.render_(e)};goog.ui.Component.prototype.renderBefore=function(e){this.render_(e.parentNode,e)};goog.ui.Component.prototype.render_=function(e,o){if(this.inDocument_)throw new Error(goog.ui.Component.Error.ALREADY_RENDERED);if(!this.element_)this.createDom();if(e)e.insertBefore(this.element_,o||null);else this.dom_.getDocument().body.appendChild(this.element_);if(!this.parent_||this.parent_.isInDocument())this.enterDocument()};goog.ui.Component.prototype.decorate=function(e){if(this.inDocument_)throw new Error(goog.ui.Component.Error.ALREADY_RENDERED);else if(e&&this.canDecorate(e)){this.wasDecorated_=true;var o=goog.dom.getOwnerDocument(e);if(!this.dom_||this.dom_.getDocument()!=o)this.dom_=goog.dom.getDomHelper(e);this.decorateInternal(e);if(!goog.ui.Component.ALLOW_DETACHED_DECORATION||goog.dom.contains(o,e))this.enterDocument()}else throw new Error(goog.ui.Component.Error.DECORATE_INVALID)};goog.ui.Component.prototype.canDecorate=function(e){return true};goog.ui.Component.prototype.wasDecorated=function(){return this.wasDecorated_};goog.ui.Component.prototype.decorateInternal=function(e){this.element_=e};goog.ui.Component.prototype.enterDocument=function(){this.inDocument_=true;this.forEachChild((function(e){if(!e.isInDocument()&&e.getElement())e.enterDocument()}))};goog.ui.Component.prototype.exitDocument=function(){this.forEachChild((function(e){if(e.isInDocument())e.exitDocument()}));if(this.googUiComponentHandler_)this.googUiComponentHandler_.removeAll();this.inDocument_=false};goog.ui.Component.prototype.disposeInternal=function(){if(this.inDocument_)this.exitDocument();if(this.googUiComponentHandler_){this.googUiComponentHandler_.dispose();delete this.googUiComponentHandler_}this.forEachChild((function(e){e.dispose()}));if(!this.wasDecorated_&&this.element_)goog.dom.removeNode(this.element_);this.children_=null;this.childIndex_=null;this.element_=null;this.model_=null;this.parent_=null;goog.ui.Component.superClass_.disposeInternal.call(this)};goog.ui.Component.prototype.makeId=function(e){return this.getId()+"."+e};goog.ui.Component.prototype.makeIds=function(e){var o={};for(var t in e)o[t]=this.makeId(e[t]);return o};goog.ui.Component.prototype.getModel=function(){return this.model_};goog.ui.Component.prototype.setModel=function(e){this.model_=e};goog.ui.Component.prototype.getFragmentFromId=function(e){return e.substring(this.getId().length+1)};goog.ui.Component.prototype.getElementByFragment=function(e){if(!this.inDocument_)throw new Error(goog.ui.Component.Error.NOT_IN_DOCUMENT);return this.dom_.getElement(this.makeId(e))};goog.ui.Component.prototype.addChild=function(e,o){this.addChildAt(e,this.getChildCount(),o)};goog.ui.Component.prototype.addChildAt=function(e,o,t){goog.asserts.assert(!!e,"Provided element must not be null.");if(e.inDocument_&&(t||!this.inDocument_))throw new Error(goog.ui.Component.Error.ALREADY_RENDERED);if(o<0||o>this.getChildCount())throw new Error(goog.ui.Component.Error.CHILD_INDEX_OUT_OF_BOUNDS);if(!this.childIndex_||!this.children_){this.childIndex_={};this.children_=[]}if(e.getParent()==this){goog.object.set(this.childIndex_,e.getId(),e);goog.array.remove(this.children_,e)}else goog.object.add(this.childIndex_,e.getId(),e);e.setParent(this);goog.array.insertAt(this.children_,e,o);if(e.inDocument_&&this.inDocument_&&e.getParent()==this){var i=this.getContentElement();var r=i.childNodes[o]||null;if(r!=e.getElement())i.insertBefore(e.getElement(),r)}else if(t){if(!this.element_)this.createDom();var n=this.getChildAt(o+1);e.render_(this.getContentElement(),n?n.element_:null)}else if(this.inDocument_&&!e.inDocument_&&e.element_&&e.element_.parentNode&&e.element_.parentNode.nodeType==goog.dom.NodeType.ELEMENT)e.enterDocument()};goog.ui.Component.prototype.getContentElement=function(){return this.element_};goog.ui.Component.prototype.isRightToLeft=function(){if(null==this.rightToLeft_)this.rightToLeft_=goog.style.isRightToLeft(this.inDocument_?this.element_:this.dom_.getDocument().body);return this.rightToLeft_};goog.ui.Component.prototype.setRightToLeft=function(e){if(this.inDocument_)throw new Error(goog.ui.Component.Error.ALREADY_RENDERED);this.rightToLeft_=e};goog.ui.Component.prototype.hasChildren=function(){return!!this.children_&&0!=this.children_.length};goog.ui.Component.prototype.getChildCount=function(){return this.children_?this.children_.length:0};goog.ui.Component.prototype.getChildIds=function(){var e=[];this.forEachChild((function(o){e.push(o.getId())}));return e};goog.ui.Component.prototype.getChild=function(e){return this.childIndex_&&e?goog.object.get(this.childIndex_,e)||null:null};goog.ui.Component.prototype.getChildAt=function(e){return this.children_?this.children_[e]||null:null};goog.ui.Component.prototype.forEachChild=function(e,o){if(this.children_)goog.array.forEach(this.children_,e,o)};goog.ui.Component.prototype.indexOfChild=function(e){return this.children_&&e?goog.array.indexOf(this.children_,e):-1};goog.ui.Component.prototype.removeChild=function(e,o){if(e){var t=goog.isString(e)?e:e.getId();e=this.getChild(t);if(t&&e){goog.object.remove(this.childIndex_,t);goog.array.remove(this.children_,e);if(o){e.exitDocument();if(e.element_)goog.dom.removeNode(e.element_)}e.setParent(null)}}if(!e)throw new Error(goog.ui.Component.Error.NOT_OUR_CHILD);return e};goog.ui.Component.prototype.removeChildAt=function(e,o){return this.removeChild(this.getChildAt(e),o)};goog.ui.Component.prototype.removeChildren=function(e){var o=[];while(this.hasChildren())o.push(this.removeChildAt(0,e));return o};goog.provide("goog.ui.Control");goog.require("goog.Disposable");goog.require("goog.array");goog.require("goog.dom");goog.require("goog.events.BrowserEvent");goog.require("goog.events.Event");goog.require("goog.events.EventHandler");goog.require("goog.events.EventType");goog.require("goog.events.KeyCodes");goog.require("goog.events.KeyHandler");goog.require("goog.string");goog.require("goog.ui.Component");goog.require("goog.ui.ControlContent");goog.require("goog.ui.ControlRenderer");goog.require("goog.ui.registry");goog.require("goog.userAgent");goog.ui.Control=function(e,o,t){goog.ui.Component.call(this,t);this.renderer_=o||goog.ui.registry.getDefaultRenderer(this.constructor);this.setContentInternal(goog.isDef(e)?e:null);this.ariaLabel_=null;this.ieMouseEventSequenceSimulator_};goog.inherits(goog.ui.Control,goog.ui.Component);goog.tagUnsealableClass(goog.ui.Control);goog.ui.Control.registerDecorator=goog.ui.registry.setDecoratorByClassName;goog.ui.Control.getDecorator=goog.ui.registry.getDecorator;goog.ui.Control.prototype.renderer_;goog.ui.Control.prototype.content_=null;goog.ui.Control.prototype.state_=0;goog.ui.Control.prototype.supportedStates_=goog.ui.Component.State.DISABLED|goog.ui.Component.State.HOVER|goog.ui.Component.State.ACTIVE|goog.ui.Component.State.FOCUSED;goog.ui.Control.prototype.autoStates_=goog.ui.Component.State.ALL;goog.ui.Control.prototype.statesWithTransitionEvents_=0;goog.ui.Control.prototype.visible_=true;goog.ui.Control.prototype.keyHandler_;goog.ui.Control.prototype.extraClassNames_=null;goog.ui.Control.prototype.handleMouseEvents_=true;goog.ui.Control.prototype.allowTextSelection_=false;goog.ui.Control.prototype.preferredAriaRole_=null;goog.ui.Control.prototype.isHandleMouseEvents=function(){return this.handleMouseEvents_};goog.ui.Control.prototype.setHandleMouseEvents=function(e){if(this.isInDocument()&&e!=this.handleMouseEvents_)this.enableMouseEventHandling_(e);this.handleMouseEvents_=e};goog.ui.Control.prototype.getKeyEventTarget=function(){return this.renderer_.getKeyEventTarget(this)};goog.ui.Control.prototype.getKeyHandler=function(){return this.keyHandler_||(this.keyHandler_=new goog.events.KeyHandler)};goog.ui.Control.prototype.getRenderer=function(){return this.renderer_};goog.ui.Control.prototype.setRenderer=function(e){if(this.isInDocument())throw new Error(goog.ui.Component.Error.ALREADY_RENDERED);if(this.getElement())this.setElementInternal(null);this.renderer_=e};goog.ui.Control.prototype.getExtraClassNames=function(){return this.extraClassNames_};goog.ui.Control.prototype.addClassName=function(e){if(e){if(this.extraClassNames_){if(!goog.array.contains(this.extraClassNames_,e))this.extraClassNames_.push(e)}else this.extraClassNames_=[e];this.renderer_.enableExtraClassName(this,e,true)}};goog.ui.Control.prototype.removeClassName=function(e){if(e&&this.extraClassNames_&&goog.array.remove(this.extraClassNames_,e)){if(0==this.extraClassNames_.length)this.extraClassNames_=null;this.renderer_.enableExtraClassName(this,e,false)}};goog.ui.Control.prototype.enableClassName=function(e,o){if(o)this.addClassName(e);else this.removeClassName(e)};goog.ui.Control.prototype.createDom=function(){var e=this.renderer_.createDom(this);this.setElementInternal(e);this.renderer_.setAriaRole(e,this.getPreferredAriaRole());if(!this.isAllowTextSelection())this.renderer_.setAllowTextSelection(e,false);if(!this.isVisible())this.renderer_.setVisible(e,false)};goog.ui.Control.prototype.getPreferredAriaRole=function(){return this.preferredAriaRole_};goog.ui.Control.prototype.setPreferredAriaRole=function(e){this.preferredAriaRole_=e};goog.ui.Control.prototype.getAriaLabel=function(){return this.ariaLabel_};goog.ui.Control.prototype.setAriaLabel=function(e){this.ariaLabel_=e;var o=this.getElement();if(o)this.renderer_.setAriaLabel(o,e)};goog.ui.Control.prototype.getContentElement=function(){return this.renderer_.getContentElement(this.getElement())};goog.ui.Control.prototype.canDecorate=function(e){return this.renderer_.canDecorate(e)};goog.ui.Control.prototype.decorateInternal=function(e){e=this.renderer_.decorate(this,e);this.setElementInternal(e);this.renderer_.setAriaRole(e,this.getPreferredAriaRole());if(!this.isAllowTextSelection())this.renderer_.setAllowTextSelection(e,false);this.visible_="none"!=e.style.display};goog.ui.Control.prototype.enterDocument=function(){goog.ui.Control.superClass_.enterDocument.call(this);this.renderer_.setAriaStates(this,this.getElementStrict());this.renderer_.initializeDom(this);if(this.supportedStates_&~goog.ui.Component.State.DISABLED){if(this.isHandleMouseEvents())this.enableMouseEventHandling_(true);if(this.isSupportedState(goog.ui.Component.State.FOCUSED)){var e=this.getKeyEventTarget();if(e){var o=this.getKeyHandler();o.attach(e);this.getHandler().listen(o,goog.events.KeyHandler.EventType.KEY,this.handleKeyEvent).listen(e,goog.events.EventType.FOCUS,this.handleFocus).listen(e,goog.events.EventType.BLUR,this.handleBlur)}}}};goog.ui.Control.prototype.enableMouseEventHandling_=function(e){var o=this.getHandler();var t=this.getElement();if(e){o.listen(t,goog.events.EventType.MOUSEOVER,this.handleMouseOver).listen(t,goog.events.EventType.MOUSEDOWN,this.handleMouseDown).listen(t,goog.events.EventType.MOUSEUP,this.handleMouseUp).listen(t,goog.events.EventType.MOUSEOUT,this.handleMouseOut);if(this.handleContextMenu!=goog.nullFunction)o.listen(t,goog.events.EventType.CONTEXTMENU,this.handleContextMenu);if(goog.userAgent.IE){if(!goog.userAgent.isVersionOrHigher(9))o.listen(t,goog.events.EventType.DBLCLICK,this.handleDblClick);if(!this.ieMouseEventSequenceSimulator_){this.ieMouseEventSequenceSimulator_=new goog.ui.Control.IeMouseEventSequenceSimulator_(this);this.registerDisposable(this.ieMouseEventSequenceSimulator_)}}}else{o.unlisten(t,goog.events.EventType.MOUSEOVER,this.handleMouseOver).unlisten(t,goog.events.EventType.MOUSEDOWN,this.handleMouseDown).unlisten(t,goog.events.EventType.MOUSEUP,this.handleMouseUp).unlisten(t,goog.events.EventType.MOUSEOUT,this.handleMouseOut);if(this.handleContextMenu!=goog.nullFunction)o.unlisten(t,goog.events.EventType.CONTEXTMENU,this.handleContextMenu);if(goog.userAgent.IE){if(!goog.userAgent.isVersionOrHigher(9))o.unlisten(t,goog.events.EventType.DBLCLICK,this.handleDblClick);goog.dispose(this.ieMouseEventSequenceSimulator_);this.ieMouseEventSequenceSimulator_=null}}};goog.ui.Control.prototype.exitDocument=function(){goog.ui.Control.superClass_.exitDocument.call(this);if(this.keyHandler_)this.keyHandler_.detach();if(this.isVisible()&&this.isEnabled())this.renderer_.setFocusable(this,false)};goog.ui.Control.prototype.disposeInternal=function(){goog.ui.Control.superClass_.disposeInternal.call(this);if(this.keyHandler_){this.keyHandler_.dispose();delete this.keyHandler_}delete this.renderer_;this.content_=null;this.extraClassNames_=null;this.ieMouseEventSequenceSimulator_=null};goog.ui.Control.prototype.getContent=function(){return this.content_};goog.ui.Control.prototype.setContent=function(e){this.renderer_.setContent(this.getElement(),e);this.setContentInternal(e)};goog.ui.Control.prototype.setContentInternal=function(e){this.content_=e};goog.ui.Control.prototype.getCaption=function(){var e=this.getContent();if(!e)return"";var o=goog.isString(e)?e:goog.isArray(e)?goog.array.map(e,goog.dom.getRawTextContent).join(""):goog.dom.getTextContent(e);return goog.string.collapseBreakingSpaces(o)};goog.ui.Control.prototype.setCaption=function(e){this.setContent(e)};goog.ui.Control.prototype.setRightToLeft=function(e){goog.ui.Control.superClass_.setRightToLeft.call(this,e);var o=this.getElement();if(o)this.renderer_.setRightToLeft(o,e)};goog.ui.Control.prototype.isAllowTextSelection=function(){return this.allowTextSelection_};goog.ui.Control.prototype.setAllowTextSelection=function(e){this.allowTextSelection_=e;var o=this.getElement();if(o)this.renderer_.setAllowTextSelection(o,e)};goog.ui.Control.prototype.isVisible=function(){return this.visible_};goog.ui.Control.prototype.setVisible=function(e,o){if(o||this.visible_!=e&&this.dispatchEvent(e?goog.ui.Component.EventType.SHOW:goog.ui.Component.EventType.HIDE)){var t=this.getElement();if(t)this.renderer_.setVisible(t,e);if(this.isEnabled())this.renderer_.setFocusable(this,e);this.visible_=e;return true}return false};goog.ui.Control.prototype.isEnabled=function(){return!this.hasState(goog.ui.Component.State.DISABLED)};goog.ui.Control.prototype.isParentDisabled_=function(){var e=this.getParent();return!!e&&"function"==typeof e.isEnabled&&!e.isEnabled()};goog.ui.Control.prototype.setEnabled=function(e){if(!this.isParentDisabled_()&&this.isTransitionAllowed(goog.ui.Component.State.DISABLED,!e)){if(!e){this.setActive(false);this.setHighlighted(false)}if(this.isVisible())this.renderer_.setFocusable(this,e);this.setState(goog.ui.Component.State.DISABLED,!e,true)}};goog.ui.Control.prototype.isHighlighted=function(){return this.hasState(goog.ui.Component.State.HOVER)};goog.ui.Control.prototype.setHighlighted=function(e){if(this.isTransitionAllowed(goog.ui.Component.State.HOVER,e))this.setState(goog.ui.Component.State.HOVER,e)};goog.ui.Control.prototype.isActive=function(){return this.hasState(goog.ui.Component.State.ACTIVE)};goog.ui.Control.prototype.setActive=function(e){if(this.isTransitionAllowed(goog.ui.Component.State.ACTIVE,e))this.setState(goog.ui.Component.State.ACTIVE,e)};goog.ui.Control.prototype.isSelected=function(){return this.hasState(goog.ui.Component.State.SELECTED)};goog.ui.Control.prototype.setSelected=function(e){if(this.isTransitionAllowed(goog.ui.Component.State.SELECTED,e))this.setState(goog.ui.Component.State.SELECTED,e)};goog.ui.Control.prototype.isChecked=function(){return this.hasState(goog.ui.Component.State.CHECKED)};goog.ui.Control.prototype.setChecked=function(e){if(this.isTransitionAllowed(goog.ui.Component.State.CHECKED,e))this.setState(goog.ui.Component.State.CHECKED,e)};goog.ui.Control.prototype.isFocused=function(){return this.hasState(goog.ui.Component.State.FOCUSED)};goog.ui.Control.prototype.setFocused=function(e){if(this.isTransitionAllowed(goog.ui.Component.State.FOCUSED,e))this.setState(goog.ui.Component.State.FOCUSED,e)};goog.ui.Control.prototype.isOpen=function(){return this.hasState(goog.ui.Component.State.OPENED)};goog.ui.Control.prototype.setOpen=function(e){if(this.isTransitionAllowed(goog.ui.Component.State.OPENED,e))this.setState(goog.ui.Component.State.OPENED,e)};goog.ui.Control.prototype.getState=function(){return this.state_};goog.ui.Control.prototype.hasState=function(e){return!!(this.state_&e)};goog.ui.Control.prototype.setState=function(e,o,t){if(!t&&e==goog.ui.Component.State.DISABLED){this.setEnabled(!o);return}if(this.isSupportedState(e)&&o!=this.hasState(e)){this.renderer_.setState(this,e,o);this.state_=o?this.state_|e:this.state_&~e}};goog.ui.Control.prototype.setStateInternal=function(e){this.state_=e};goog.ui.Control.prototype.isSupportedState=function(e){return!!(this.supportedStates_&e)};goog.ui.Control.prototype.setSupportedState=function(e,o){if(this.isInDocument()&&this.hasState(e)&&!o)throw new Error(goog.ui.Component.Error.ALREADY_RENDERED);if(!o&&this.hasState(e))this.setState(e,false);this.supportedStates_=o?this.supportedStates_|e:this.supportedStates_&~e};goog.ui.Control.prototype.isAutoState=function(e){return!!(this.autoStates_&e)&&this.isSupportedState(e)};goog.ui.Control.prototype.setAutoStates=function(e,o){this.autoStates_=o?this.autoStates_|e:this.autoStates_&~e};goog.ui.Control.prototype.isDispatchTransitionEvents=function(e){return!!(this.statesWithTransitionEvents_&e)&&this.isSupportedState(e)};goog.ui.Control.prototype.setDispatchTransitionEvents=function(e,o){this.statesWithTransitionEvents_=o?this.statesWithTransitionEvents_|e:this.statesWithTransitionEvents_&~e};goog.ui.Control.prototype.isTransitionAllowed=function(e,o){return this.isSupportedState(e)&&this.hasState(e)!=o&&(!(this.statesWithTransitionEvents_&e)||this.dispatchEvent(goog.ui.Component.getStateTransitionEvent(e,o)))&&!this.isDisposed()};goog.ui.Control.prototype.handleMouseOver=function(e){if(!goog.ui.Control.isMouseEventWithinElement_(e,this.getElement())&&this.dispatchEvent(goog.ui.Component.EventType.ENTER)&&this.isEnabled()&&this.isAutoState(goog.ui.Component.State.HOVER))this.setHighlighted(true)};goog.ui.Control.prototype.handleMouseOut=function(e){if(!goog.ui.Control.isMouseEventWithinElement_(e,this.getElement())&&this.dispatchEvent(goog.ui.Component.EventType.LEAVE)){if(this.isAutoState(goog.ui.Component.State.ACTIVE))this.setActive(false);if(this.isAutoState(goog.ui.Component.State.HOVER))this.setHighlighted(false)}};goog.ui.Control.prototype.handleContextMenu=goog.nullFunction;goog.ui.Control.isMouseEventWithinElement_=function(e,o){return!!e.relatedTarget&&goog.dom.contains(o,e.relatedTarget)};goog.ui.Control.prototype.handleMouseDown=function(e){if(this.isEnabled()){if(this.isAutoState(goog.ui.Component.State.HOVER))this.setHighlighted(true);if(e.isMouseActionButton()){if(this.isAutoState(goog.ui.Component.State.ACTIVE))this.setActive(true);if(this.renderer_&&this.renderer_.isFocusable(this))this.getKeyEventTarget().focus()}}if(!this.isAllowTextSelection()&&e.isMouseActionButton())e.preventDefault()};goog.ui.Control.prototype.handleMouseUp=function(e){if(this.isEnabled()){if(this.isAutoState(goog.ui.Component.State.HOVER))this.setHighlighted(true);if(this.isActive()&&this.performActionInternal(e)&&this.isAutoState(goog.ui.Component.State.ACTIVE))this.setActive(false)}};goog.ui.Control.prototype.handleDblClick=function(e){if(this.isEnabled())this.performActionInternal(e)};goog.ui.Control.prototype.performActionInternal=function(e){if(this.isAutoState(goog.ui.Component.State.CHECKED))this.setChecked(!this.isChecked());if(this.isAutoState(goog.ui.Component.State.SELECTED))this.setSelected(true);if(this.isAutoState(goog.ui.Component.State.OPENED))this.setOpen(!this.isOpen());var o=new goog.events.Event(goog.ui.Component.EventType.ACTION,this);if(e){o.altKey=e.altKey;o.ctrlKey=e.ctrlKey;o.metaKey=e.metaKey;o.shiftKey=e.shiftKey;o.platformModifierKey=e.platformModifierKey}return this.dispatchEvent(o)};goog.ui.Control.prototype.handleFocus=function(e){if(this.isAutoState(goog.ui.Component.State.FOCUSED))this.setFocused(true)};goog.ui.Control.prototype.handleBlur=function(e){if(this.isAutoState(goog.ui.Component.State.ACTIVE))this.setActive(false);if(this.isAutoState(goog.ui.Component.State.FOCUSED))this.setFocused(false)};goog.ui.Control.prototype.handleKeyEvent=function(e){if(this.isVisible()&&this.isEnabled()&&this.handleKeyEventInternal(e)){e.preventDefault();e.stopPropagation();return true}return false};goog.ui.Control.prototype.handleKeyEventInternal=function(e){return e.keyCode==goog.events.KeyCodes.ENTER&&this.performActionInternal(e)};goog.ui.registry.setDefaultRenderer(goog.ui.Control,goog.ui.ControlRenderer);goog.ui.registry.setDecoratorByClassName(goog.ui.ControlRenderer.CSS_CLASS,(function(){return new goog.ui.Control(null)}));goog.ui.Control.IeMouseEventSequenceSimulator_=function(e){goog.ui.Control.IeMouseEventSequenceSimulator_.base(this,"constructor");this.control_=e;this.clickExpected_=false;this.handler_=new goog.events.EventHandler(this);this.registerDisposable(this.handler_);var o=this.control_.getElementStrict();this.handler_.listen(o,goog.events.EventType.MOUSEDOWN,this.handleMouseDown_).listen(o,goog.events.EventType.MOUSEUP,this.handleMouseUp_).listen(o,goog.events.EventType.CLICK,this.handleClick_)};goog.inherits(goog.ui.Control.IeMouseEventSequenceSimulator_,goog.Disposable);goog.ui.Control.IeMouseEventSequenceSimulator_.SYNTHETIC_EVENTS_=!goog.userAgent.IE||goog.userAgent.isDocumentModeOrHigher(9);goog.ui.Control.IeMouseEventSequenceSimulator_.prototype.handleMouseDown_=function(){this.clickExpected_=false};goog.ui.Control.IeMouseEventSequenceSimulator_.prototype.handleMouseUp_=function(){this.clickExpected_=true};goog.ui.Control.IeMouseEventSequenceSimulator_.makeLeftMouseEvent_=function(e,o){if(!goog.ui.Control.IeMouseEventSequenceSimulator_.SYNTHETIC_EVENTS_){e.button=goog.events.BrowserEvent.MouseButton.LEFT;e.type=o;return e}var t=document.createEvent("MouseEvents");t.initMouseEvent(o,e.bubbles,e.cancelable,e.view||null,e.detail,e.screenX,e.screenY,e.clientX,e.clientY,e.ctrlKey,e.altKey,e.shiftKey,e.metaKey,goog.events.BrowserEvent.MouseButton.LEFT,e.relatedTarget||null);return t};goog.ui.Control.IeMouseEventSequenceSimulator_.prototype.handleClick_=function(e){if(this.clickExpected_){this.clickExpected_=false;return}var o=e;var t=o.getBrowserEvent();var i=t.button;var r=t.type;var n=goog.ui.Control.IeMouseEventSequenceSimulator_.makeLeftMouseEvent_(t,goog.events.EventType.MOUSEDOWN);this.control_.handleMouseDown(new goog.events.BrowserEvent(n,o.currentTarget));var l=goog.ui.Control.IeMouseEventSequenceSimulator_.makeLeftMouseEvent_(t,goog.events.EventType.MOUSEUP);this.control_.handleMouseUp(new goog.events.BrowserEvent(l,o.currentTarget));if(goog.ui.Control.IeMouseEventSequenceSimulator_.SYNTHETIC_EVENTS_)return;t.button=i;t.type=r};goog.ui.Control.IeMouseEventSequenceSimulator_.prototype.disposeInternal=function(){this.control_=null;goog.ui.Control.IeMouseEventSequenceSimulator_.base(this,"disposeInternal")};goog.provide("goog.ui.Palette");goog.require("goog.array");goog.require("goog.dom");goog.require("goog.events");goog.require("goog.events.EventType");goog.require("goog.events.KeyCodes");goog.require("goog.math.Size");goog.require("goog.ui.Component");goog.require("goog.ui.Control");goog.require("goog.ui.PaletteRenderer");goog.require("goog.ui.SelectionModel");goog.ui.Palette=function(e,o,t){goog.ui.Palette.base(this,"constructor",e,o||goog.ui.PaletteRenderer.getInstance(),t);this.setAutoStates(goog.ui.Component.State.CHECKED|goog.ui.Component.State.SELECTED|goog.ui.Component.State.OPENED,false);this.currentCellControl_=new goog.ui.Palette.CurrentCell_;this.currentCellControl_.setParentEventTarget(this);this.lastHighlightedIndex_=-1};goog.inherits(goog.ui.Palette,goog.ui.Control);goog.tagUnsealableClass(goog.ui.Palette);goog.ui.Palette.EventType={AFTER_HIGHLIGHT:goog.events.getUniqueId("afterhighlight")};goog.ui.Palette.prototype.size_=null;goog.ui.Palette.prototype.highlightedIndex_=-1;goog.ui.Palette.prototype.selectionModel_=null;goog.ui.Palette.prototype.disposeInternal=function(){goog.ui.Palette.superClass_.disposeInternal.call(this);if(this.selectionModel_){this.selectionModel_.dispose();this.selectionModel_=null}this.size_=null;this.currentCellControl_.dispose()};goog.ui.Palette.prototype.setContentInternal=function(e){var o=e;goog.ui.Palette.superClass_.setContentInternal.call(this,o);this.adjustSize_();if(this.selectionModel_){this.selectionModel_.clear();this.selectionModel_.addItems(o)}else{this.selectionModel_=new goog.ui.SelectionModel(o);this.selectionModel_.setSelectionHandler(goog.bind(this.selectItem_,this));this.getHandler().listen(this.selectionModel_,goog.events.EventType.SELECT,this.handleSelectionChange)}this.highlightedIndex_=-1};goog.ui.Palette.prototype.getCaption=function(){return""};goog.ui.Palette.prototype.setCaption=function(e){};goog.ui.Palette.prototype.handleMouseOver=function(e){goog.ui.Palette.superClass_.handleMouseOver.call(this,e);var o=this.getRenderer().getContainingItem(this,e.target);if(o&&e.relatedTarget&&goog.dom.contains(o,e.relatedTarget))return;if(o!=this.getHighlightedItem())this.setHighlightedItem(o)};goog.ui.Palette.prototype.handleMouseDown=function(e){goog.ui.Palette.superClass_.handleMouseDown.call(this,e);if(this.isActive()){var o=this.getRenderer().getContainingItem(this,e.target);if(o!=this.getHighlightedItem())this.setHighlightedItem(o)}};goog.ui.Palette.prototype.performActionInternal=function(e){var o=this.getHighlightedItem();if(o){if(e&&this.shouldSelectHighlightedItem_(e))this.setSelectedItem(o);return goog.ui.Palette.base(this,"performActionInternal",e)}return false};goog.ui.Palette.prototype.shouldSelectHighlightedItem_=function(e){if(!this.getSelectedItem())return true;else if("mouseup"!=e.type)return true;else return!!this.getRenderer().getContainingItem(this,e.target)};goog.ui.Palette.prototype.handleKeyEvent=function(e){var o=this.getContent();var t=o?o.length:0;var i=this.size_.width;if(0==t||!this.isEnabled())return false;if(e.keyCode==goog.events.KeyCodes.ENTER||e.keyCode==goog.events.KeyCodes.SPACE)return this.performActionInternal(e);if(e.keyCode==goog.events.KeyCodes.HOME){this.setHighlightedIndex(0);return true}else if(e.keyCode==goog.events.KeyCodes.END){this.setHighlightedIndex(t-1);return true}var r=this.highlightedIndex_<0?this.getSelectedIndex():this.highlightedIndex_;switch(e.keyCode){case goog.events.KeyCodes.LEFT:if(-1==r||0==r)r=t;this.setHighlightedIndex(r-1);e.preventDefault();return true;case goog.events.KeyCodes.RIGHT:if(r==t-1)r=-1;this.setHighlightedIndex(r+1);e.preventDefault();return true;case goog.events.KeyCodes.UP:if(-1==r)r=t+i-1;if(r>=i){this.setHighlightedIndex(r-i);e.preventDefault();return true}break;case goog.events.KeyCodes.DOWN:if(-1==r)r=-i;if(r<t-i){this.setHighlightedIndex(r+i);e.preventDefault();return true}break}return false};goog.ui.Palette.prototype.handleSelectionChange=function(e){};goog.ui.Palette.prototype.getSize=function(){return this.size_};goog.ui.Palette.prototype.setSize=function(e,o){if(this.getElement())throw new Error(goog.ui.Component.Error.ALREADY_RENDERED);this.size_=goog.isNumber(e)?new goog.math.Size(e,o):e;this.adjustSize_()};goog.ui.Palette.prototype.getHighlightedIndex=function(){return this.highlightedIndex_};goog.ui.Palette.prototype.getHighlightedItem=function(){var e=this.getContent();return e&&e[this.highlightedIndex_]};goog.ui.Palette.prototype.getHighlightedCellElement_=function(){return this.getRenderer().getCellForItem(this.getHighlightedItem())};goog.ui.Palette.prototype.setHighlightedIndex=function(e){if(e!=this.highlightedIndex_){this.highlightIndex_(this.highlightedIndex_,false);this.lastHighlightedIndex_=this.highlightedIndex_;this.highlightedIndex_=e;this.highlightIndex_(e,true);this.dispatchEvent(goog.ui.Palette.EventType.AFTER_HIGHLIGHT)}};goog.ui.Palette.prototype.setHighlightedItem=function(e){var o=this.getContent();this.setHighlightedIndex(o&&e?goog.array.indexOf(o,e):-1)};goog.ui.Palette.prototype.getSelectedIndex=function(){return this.selectionModel_?this.selectionModel_.getSelectedIndex():-1};goog.ui.Palette.prototype.getSelectedItem=function(){return this.selectionModel_?this.selectionModel_.getSelectedItem():null};goog.ui.Palette.prototype.setSelectedIndex=function(e){if(this.selectionModel_)this.selectionModel_.setSelectedIndex(e)};goog.ui.Palette.prototype.setSelectedItem=function(e){if(this.selectionModel_)this.selectionModel_.setSelectedItem(e)};goog.ui.Palette.prototype.highlightIndex_=function(e,o){if(this.getElement()){var t=this.getContent();if(t&&e>=0&&e<t.length){var i=this.getHighlightedCellElement_();if(this.currentCellControl_.getElement()!=i)this.currentCellControl_.setElementInternal(i);if(this.currentCellControl_.tryHighlight(o))this.getRenderer().highlightCell(this,t[e],o)}}};goog.ui.Palette.prototype.setHighlighted=function(e){if(e&&-1==this.highlightedIndex_)this.setHighlightedIndex(this.lastHighlightedIndex_>-1?this.lastHighlightedIndex_:0);else if(!e)this.setHighlightedIndex(-1);goog.ui.Palette.base(this,"setHighlighted",e)};goog.ui.Palette.prototype.selectItem_=function(e,o){if(this.getElement())this.getRenderer().selectCell(this,e,o)};goog.ui.Palette.prototype.adjustSize_=function(){var e=this.getContent();if(e)if(this.size_&&this.size_.width){var o=Math.ceil(e.length/this.size_.width);if(!goog.isNumber(this.size_.height)||this.size_.height<o)this.size_.height=o}else{var t=Math.ceil(Math.sqrt(e.length));this.size_=new goog.math.Size(t,t)}else this.size_=new goog.math.Size(0,0)};goog.ui.Palette.CurrentCell_=function(){goog.ui.Palette.CurrentCell_.base(this,"constructor",null);this.setDispatchTransitionEvents(goog.ui.Component.State.HOVER,true)};goog.inherits(goog.ui.Palette.CurrentCell_,goog.ui.Control);goog.ui.Palette.CurrentCell_.prototype.tryHighlight=function(e){this.setHighlighted(e);return this.isHighlighted()==e};goog.provide("goog.ui.ColorPalette");goog.require("goog.array");goog.require("goog.color");goog.require("goog.dom.TagName");goog.require("goog.style");goog.require("goog.ui.Palette");goog.require("goog.ui.PaletteRenderer");goog.ui.ColorPalette=function(e,o,t){this.colors_=e||[];goog.ui.Palette.call(this,null,o||goog.ui.PaletteRenderer.getInstance(),t);this.setColors(this.colors_)};goog.inherits(goog.ui.ColorPalette,goog.ui.Palette);goog.tagUnsealableClass(goog.ui.ColorPalette);goog.ui.ColorPalette.prototype.normalizedColors_=null;goog.ui.ColorPalette.prototype.labels_=null;goog.ui.ColorPalette.prototype.getColors=function(){return this.colors_};goog.ui.ColorPalette.prototype.setColors=function(e,o){this.colors_=e;this.labels_=o||null;this.normalizedColors_=null;this.setContent(this.createColorNodes())};goog.ui.ColorPalette.prototype.getSelectedColor=function(){var e=this.getSelectedItem();if(e){var o=goog.style.getStyle(e,"background-color");return goog.ui.ColorPalette.parseColor_(o)}else return null};goog.ui.ColorPalette.prototype.setSelectedColor=function(e){var o=goog.ui.ColorPalette.parseColor_(e);if(!this.normalizedColors_)this.normalizedColors_=goog.array.map(this.colors_,(function(e){return goog.ui.ColorPalette.parseColor_(e)}));this.setSelectedIndex(o?goog.array.indexOf(this.normalizedColors_,o):-1)};goog.ui.ColorPalette.prototype.createColorNodes=function(){return goog.array.map(this.colors_,(function(e,o){var t=this.getDomHelper().createDom(goog.dom.TagName.DIV,{class:goog.getCssName(this.getRenderer().getCssClass(),"colorswatch"),style:"background-color:"+e});if(this.labels_&&this.labels_[o])t.title=this.labels_[o];else t.title="#"==e.charAt(0)?"RGB ("+goog.color.hexToRgb(e).join(", ")+")":e;return t}),this)};goog.ui.ColorPalette.parseColor_=function(e){if(e)try{return goog.color.parse(e).hex}catch(e){}return null};goog.provide("goog.ui.ColorPicker");goog.provide("goog.ui.ColorPicker.EventType");goog.require("goog.ui.ColorPalette");goog.require("goog.ui.Component");goog.ui.ColorPicker=function(e,o){goog.ui.Component.call(this,e);this.colorPalette_=o||null;this.getHandler().listen(this,goog.ui.Component.EventType.ACTION,this.onColorPaletteAction_)};goog.inherits(goog.ui.ColorPicker,goog.ui.Component);goog.ui.ColorPicker.DEFAULT_NUM_COLS=5;goog.ui.ColorPicker.EventType={CHANGE:"change"};goog.ui.ColorPicker.prototype.focusable_=true;goog.ui.ColorPicker.prototype.getColors=function(){return this.colorPalette_?this.colorPalette_.getColors():null};goog.ui.ColorPicker.prototype.setColors=function(e){if(!this.colorPalette_)this.createColorPalette_(e);else this.colorPalette_.setColors(e)};goog.ui.ColorPicker.prototype.addColors=function(e){this.setColors(e)};goog.ui.ColorPicker.prototype.setSize=function(e){if(!this.colorPalette_)this.createColorPalette_([]);this.colorPalette_.setSize(e)};goog.ui.ColorPicker.prototype.getSize=function(){return this.colorPalette_?this.colorPalette_.getSize():null};goog.ui.ColorPicker.prototype.setColumnCount=function(e){this.setSize(e)};goog.ui.ColorPicker.prototype.getSelectedIndex=function(){return this.colorPalette_?this.colorPalette_.getSelectedIndex():-1};goog.ui.ColorPicker.prototype.setSelectedIndex=function(e){if(this.colorPalette_)this.colorPalette_.setSelectedIndex(e)};goog.ui.ColorPicker.prototype.getSelectedColor=function(){return this.colorPalette_?this.colorPalette_.getSelectedColor():null};goog.ui.ColorPicker.prototype.setSelectedColor=function(e){if(this.colorPalette_)this.colorPalette_.setSelectedColor(e)};goog.ui.ColorPicker.prototype.isFocusable=function(){return this.focusable_};goog.ui.ColorPicker.prototype.setFocusable=function(e){this.focusable_=e;if(this.colorPalette_)this.colorPalette_.setSupportedState(goog.ui.Component.State.FOCUSED,e)};goog.ui.ColorPicker.prototype.canDecorate=function(e){return false};goog.ui.ColorPicker.prototype.enterDocument=function(){goog.ui.ColorPicker.superClass_.enterDocument.call(this);if(this.colorPalette_)this.colorPalette_.render(this.getElement());this.getElement().unselectable="on"};goog.ui.ColorPicker.prototype.disposeInternal=function(){goog.ui.ColorPicker.superClass_.disposeInternal.call(this);if(this.colorPalette_){this.colorPalette_.dispose();this.colorPalette_=null}};goog.ui.ColorPicker.prototype.focus=function(){if(this.colorPalette_)this.colorPalette_.getElement().focus()};goog.ui.ColorPicker.prototype.onColorPaletteAction_=function(e){e.stopPropagation();this.dispatchEvent(goog.ui.ColorPicker.EventType.CHANGE)};goog.ui.ColorPicker.prototype.createColorPalette_=function(e){var o=new goog.ui.ColorPalette(e,null,this.getDomHelper());o.setSize(goog.ui.ColorPicker.DEFAULT_NUM_COLS);o.setSupportedState(goog.ui.Component.State.FOCUSED,this.focusable_);this.addChild(o);this.colorPalette_=o;if(this.isInDocument())this.colorPalette_.render(this.getElement())};goog.ui.ColorPicker.createSimpleColorGrid=function(e){var o=new goog.ui.ColorPicker(e);o.setSize(7);o.setColors(goog.ui.ColorPicker.SIMPLE_GRID_COLORS);return o};goog.ui.ColorPicker.SIMPLE_GRID_COLORS=["#ffffff","#cccccc","#c0c0c0","#999999","#666666","#333333","#000000","#ffcccc","#ff6666","#ff0000","#cc0000","#990000","#660000","#330000","#ffcc99","#ff9966","#ff9900","#ff6600","#cc6600","#993300","#663300","#ffff99","#ffff66","#ffcc66","#ffcc33","#cc9933","#996633","#663333","#ffffcc","#ffff33","#ffff00","#ffcc00","#999900","#666600","#333300","#99ff99","#66ff99","#33ff33","#33cc00","#009900","#006600","#003300","#99ffff","#33ffff","#66cccc","#00cccc","#339999","#336666","#003333","#ccffff","#66ffff","#33ccff","#3366ff","#3333ff","#000099","#000066","#ccccff","#9999ff","#6666cc","#6633ff","#6600cc","#333399","#330099","#ffccff","#ff99ff","#cc66cc","#cc33cc","#993399","#663366","#330033"];goog.provide("goog.ui.Container");goog.provide("goog.ui.Container.EventType");goog.provide("goog.ui.Container.Orientation");goog.require("goog.a11y.aria");goog.require("goog.a11y.aria.State");goog.require("goog.asserts");goog.require("goog.dom");goog.require("goog.events.EventType");goog.require("goog.events.KeyCodes");goog.require("goog.events.KeyHandler");goog.require("goog.object");goog.require("goog.style");goog.require("goog.ui.Component");goog.require("goog.ui.ContainerRenderer");goog.require("goog.ui.Control");goog.ui.Container=function(e,o,t){goog.ui.Component.call(this,t);this.renderer_=o||goog.ui.ContainerRenderer.getInstance();this.orientation_=e||this.renderer_.getDefaultOrientation()};goog.inherits(goog.ui.Container,goog.ui.Component);goog.tagUnsealableClass(goog.ui.Container);goog.ui.Container.EventType={AFTER_SHOW:"aftershow",AFTER_HIDE:"afterhide"};goog.ui.Container.Orientation={HORIZONTAL:"horizontal",VERTICAL:"vertical"};goog.ui.Container.prototype.keyEventTarget_=null;goog.ui.Container.prototype.keyHandler_=null;goog.ui.Container.prototype.renderer_=null;goog.ui.Container.prototype.orientation_=null;goog.ui.Container.prototype.visible_=true;goog.ui.Container.prototype.enabled_=true;goog.ui.Container.prototype.focusable_=true;goog.ui.Container.prototype.highlightedIndex_=-1;goog.ui.Container.prototype.openItem_=null;goog.ui.Container.prototype.mouseButtonPressed_=false;goog.ui.Container.prototype.allowFocusableChildren_=false;goog.ui.Container.prototype.openFollowsHighlight_=true;goog.ui.Container.prototype.childElementIdMap_=null;goog.ui.Container.prototype.getKeyEventTarget=function(){return this.keyEventTarget_||this.renderer_.getKeyEventTarget(this)};goog.ui.Container.prototype.setKeyEventTarget=function(e){if(this.focusable_){var o=this.getKeyEventTarget();var t=this.isInDocument();this.keyEventTarget_=e;var i=this.getKeyEventTarget();if(t){this.keyEventTarget_=o;this.enableFocusHandling_(false);this.keyEventTarget_=e;this.getKeyHandler().attach(i);this.enableFocusHandling_(true)}}else throw new Error("Can't set key event target for container "+"that doesn't support keyboard focus!")};goog.ui.Container.prototype.getKeyHandler=function(){return this.keyHandler_||(this.keyHandler_=new goog.events.KeyHandler(this.getKeyEventTarget()))};goog.ui.Container.prototype.getRenderer=function(){return this.renderer_};goog.ui.Container.prototype.setRenderer=function(e){if(this.getElement())throw new Error(goog.ui.Component.Error.ALREADY_RENDERED);this.renderer_=e};goog.ui.Container.prototype.createDom=function(){this.setElementInternal(this.renderer_.createDom(this))};goog.ui.Container.prototype.getContentElement=function(){return this.renderer_.getContentElement(this.getElement())};goog.ui.Container.prototype.canDecorate=function(e){return this.renderer_.canDecorate(e)};goog.ui.Container.prototype.decorateInternal=function(e){this.setElementInternal(this.renderer_.decorate(this,e));if("none"==e.style.display)this.visible_=false};goog.ui.Container.prototype.enterDocument=function(){goog.ui.Container.superClass_.enterDocument.call(this);this.forEachChild((function(e){if(e.isInDocument())this.registerChildId_(e)}),this);var e=this.getElement();this.renderer_.initializeDom(this);this.setVisible(this.visible_,true);this.getHandler().listen(this,goog.ui.Component.EventType.ENTER,this.handleEnterItem).listen(this,goog.ui.Component.EventType.HIGHLIGHT,this.handleHighlightItem).listen(this,goog.ui.Component.EventType.UNHIGHLIGHT,this.handleUnHighlightItem).listen(this,goog.ui.Component.EventType.OPEN,this.handleOpenItem).listen(this,goog.ui.Component.EventType.CLOSE,this.handleCloseItem).listen(e,goog.events.EventType.MOUSEDOWN,this.handleMouseDown).listen(goog.dom.getOwnerDocument(e),goog.events.EventType.MOUSEUP,this.handleDocumentMouseUp).listen(e,[goog.events.EventType.MOUSEDOWN,goog.events.EventType.MOUSEUP,goog.events.EventType.MOUSEOVER,goog.events.EventType.MOUSEOUT,goog.events.EventType.CONTEXTMENU],this.handleChildMouseEvents);if(this.isFocusable())this.enableFocusHandling_(true)};goog.ui.Container.prototype.enableFocusHandling_=function(e){var o=this.getHandler();var t=this.getKeyEventTarget();if(e)o.listen(t,goog.events.EventType.FOCUS,this.handleFocus).listen(t,goog.events.EventType.BLUR,this.handleBlur).listen(this.getKeyHandler(),goog.events.KeyHandler.EventType.KEY,this.handleKeyEvent);else o.unlisten(t,goog.events.EventType.FOCUS,this.handleFocus).unlisten(t,goog.events.EventType.BLUR,this.handleBlur).unlisten(this.getKeyHandler(),goog.events.KeyHandler.EventType.KEY,this.handleKeyEvent)};goog.ui.Container.prototype.exitDocument=function(){this.setHighlightedIndex(-1);if(this.openItem_)this.openItem_.setOpen(false);this.mouseButtonPressed_=false;goog.ui.Container.superClass_.exitDocument.call(this)};goog.ui.Container.prototype.disposeInternal=function(){goog.ui.Container.superClass_.disposeInternal.call(this);if(this.keyHandler_){this.keyHandler_.dispose();this.keyHandler_=null}this.keyEventTarget_=null;this.childElementIdMap_=null;this.openItem_=null;this.renderer_=null};goog.ui.Container.prototype.handleEnterItem=function(e){return true};goog.ui.Container.prototype.handleHighlightItem=function(e){var o=this.indexOfChild(e.target);if(o>-1&&o!=this.highlightedIndex_){var t=this.getHighlighted();if(t)t.setHighlighted(false);this.highlightedIndex_=o;t=this.getHighlighted();if(this.isMouseButtonPressed())t.setActive(true);if(this.openFollowsHighlight_&&this.openItem_&&t!=this.openItem_)if(t.isSupportedState(goog.ui.Component.State.OPENED))t.setOpen(true);else this.openItem_.setOpen(false)}var i=this.getElement();goog.asserts.assert(i,"The DOM element for the container cannot be null.");if(null!=e.target.getElement())goog.a11y.aria.setState(i,goog.a11y.aria.State.ACTIVEDESCENDANT,e.target.getElement().id)};goog.ui.Container.prototype.handleUnHighlightItem=function(e){if(e.target==this.getHighlighted())this.highlightedIndex_=-1;var o=this.getElement();goog.asserts.assert(o,"The DOM element for the container cannot be null.");goog.a11y.aria.removeState(o,goog.a11y.aria.State.ACTIVEDESCENDANT)};goog.ui.Container.prototype.handleOpenItem=function(e){var o=e.target;if(o&&o!=this.openItem_&&o.getParent()==this){if(this.openItem_)this.openItem_.setOpen(false);this.openItem_=o}};goog.ui.Container.prototype.handleCloseItem=function(e){if(e.target==this.openItem_)this.openItem_=null;var o=this.getElement();var t=e.target.getElement();if(o&&e.target.isHighlighted()&&t)goog.a11y.aria.setActiveDescendant(o,t)};goog.ui.Container.prototype.handleMouseDown=function(e){if(this.enabled_)this.setMouseButtonPressed(true);var o=this.getKeyEventTarget();if(o&&goog.dom.isFocusableTabIndex(o))o.focus();else e.preventDefault()};goog.ui.Container.prototype.handleDocumentMouseUp=function(e){this.setMouseButtonPressed(false)};goog.ui.Container.prototype.handleChildMouseEvents=function(e){var o=this.getOwnerControl(e.target);if(o)switch(e.type){case goog.events.EventType.MOUSEDOWN:o.handleMouseDown(e);break;case goog.events.EventType.MOUSEUP:o.handleMouseUp(e);break;case goog.events.EventType.MOUSEOVER:o.handleMouseOver(e);break;case goog.events.EventType.MOUSEOUT:o.handleMouseOut(e);break;case goog.events.EventType.CONTEXTMENU:o.handleContextMenu(e);break}};goog.ui.Container.prototype.getOwnerControl=function(e){if(this.childElementIdMap_){var o=this.getElement();while(e&&e!==o){var t=e.id;if(t in this.childElementIdMap_)return this.childElementIdMap_[t];e=e.parentNode}}return null};goog.ui.Container.prototype.handleFocus=function(e){};goog.ui.Container.prototype.handleBlur=function(e){this.setHighlightedIndex(-1);this.setMouseButtonPressed(false);if(this.openItem_)this.openItem_.setOpen(false)};goog.ui.Container.prototype.handleKeyEvent=function(e){if(this.isEnabled()&&this.isVisible()&&(0!=this.getChildCount()||this.keyEventTarget_)&&this.handleKeyEventInternal(e)){e.preventDefault();e.stopPropagation();return true}return false};goog.ui.Container.prototype.handleKeyEventInternal=function(e){var o=this.getHighlighted();if(o&&"function"==typeof o.handleKeyEvent&&o.handleKeyEvent(e))return true;if(this.openItem_&&this.openItem_!=o&&"function"==typeof this.openItem_.handleKeyEvent&&this.openItem_.handleKeyEvent(e))return true;if(e.shiftKey||e.ctrlKey||e.metaKey||e.altKey)return false;switch(e.keyCode){case goog.events.KeyCodes.ESC:if(this.isFocusable())this.getKeyEventTarget().blur();else return false;break;case goog.events.KeyCodes.HOME:this.highlightFirst();break;case goog.events.KeyCodes.END:this.highlightLast();break;case goog.events.KeyCodes.UP:if(this.orientation_==goog.ui.Container.Orientation.VERTICAL)this.highlightPrevious();else return false;break;case goog.events.KeyCodes.LEFT:if(this.orientation_==goog.ui.Container.Orientation.HORIZONTAL)if(this.isRightToLeft())this.highlightNext();else this.highlightPrevious();else return false;break;case goog.events.KeyCodes.DOWN:if(this.orientation_==goog.ui.Container.Orientation.VERTICAL)this.highlightNext();else return false;break;case goog.events.KeyCodes.RIGHT:if(this.orientation_==goog.ui.Container.Orientation.HORIZONTAL)if(this.isRightToLeft())this.highlightPrevious();else this.highlightNext();else return false;break;default:return false}return true};goog.ui.Container.prototype.registerChildId_=function(e){var o=e.getElement();var t=o.id||(o.id=e.getId());if(!this.childElementIdMap_)this.childElementIdMap_={};this.childElementIdMap_[t]=e};goog.ui.Container.prototype.addChild=function(e,o){goog.asserts.assertInstanceof(e,goog.ui.Control,"The child of a container must be a control");goog.ui.Container.superClass_.addChild.call(this,e,o)};goog.ui.Container.prototype.getChild;goog.ui.Container.prototype.getChildAt;goog.ui.Container.prototype.addChildAt=function(e,o,t){goog.asserts.assertInstanceof(e,goog.ui.Control);e.setDispatchTransitionEvents(goog.ui.Component.State.HOVER,true);e.setDispatchTransitionEvents(goog.ui.Component.State.OPENED,true);if(this.isFocusable()||!this.isFocusableChildrenAllowed())e.setSupportedState(goog.ui.Component.State.FOCUSED,false);e.setHandleMouseEvents(false);var i=e.getParent()==this?this.indexOfChild(e):-1;goog.ui.Container.superClass_.addChildAt.call(this,e,o,t);if(e.isInDocument()&&this.isInDocument())this.registerChildId_(e);this.updateHighlightedIndex_(i,o)};goog.ui.Container.prototype.updateHighlightedIndex_=function(e,o){if(-1==e)e=this.getChildCount();if(e==this.highlightedIndex_)this.highlightedIndex_=Math.min(this.getChildCount()-1,o);else if(e>this.highlightedIndex_&&o<=this.highlightedIndex_)this.highlightedIndex_++;else if(e<this.highlightedIndex_&&o>this.highlightedIndex_)this.highlightedIndex_--};goog.ui.Container.prototype.removeChild=function(e,o){e=goog.isString(e)?this.getChild(e):e;goog.asserts.assertInstanceof(e,goog.ui.Control);if(e){var t=this.indexOfChild(e);if(-1!=t)if(t==this.highlightedIndex_){e.setHighlighted(false);this.highlightedIndex_=-1}else if(t<this.highlightedIndex_)this.highlightedIndex_--;var i=e.getElement();if(i&&i.id&&this.childElementIdMap_)goog.object.remove(this.childElementIdMap_,i.id)}e=goog.ui.Container.superClass_.removeChild.call(this,e,o);e.setHandleMouseEvents(true);return e};goog.ui.Container.prototype.getOrientation=function(){return this.orientation_};goog.ui.Container.prototype.setOrientation=function(e){if(this.getElement())throw new Error(goog.ui.Component.Error.ALREADY_RENDERED);this.orientation_=e};goog.ui.Container.prototype.isVisible=function(){return this.visible_};goog.ui.Container.prototype.setVisible=function(e,o){if(o||this.visible_!=e&&this.dispatchEvent(e?goog.ui.Component.EventType.SHOW:goog.ui.Component.EventType.HIDE)){this.visible_=e;var t=this.getElement();if(t){goog.style.setElementShown(t,e);if(this.isFocusable())this.renderer_.enableTabIndex(this.getKeyEventTarget(),this.enabled_&&this.visible_);if(!o)this.dispatchEvent(this.visible_?goog.ui.Container.EventType.AFTER_SHOW:goog.ui.Container.EventType.AFTER_HIDE)}return true}return false};goog.ui.Container.prototype.isEnabled=function(){return this.enabled_};goog.ui.Container.prototype.setEnabled=function(e){if(this.enabled_!=e&&this.dispatchEvent(e?goog.ui.Component.EventType.ENABLE:goog.ui.Component.EventType.DISABLE)){if(e){this.enabled_=true;this.forEachChild((function(e){if(e.wasDisabled)delete e.wasDisabled;else e.setEnabled(true)}))}else{this.forEachChild((function(e){if(e.isEnabled())e.setEnabled(false);else e.wasDisabled=true}));this.enabled_=false;this.setMouseButtonPressed(false)}if(this.isFocusable())this.renderer_.enableTabIndex(this.getKeyEventTarget(),e&&this.visible_)}};goog.ui.Container.prototype.isFocusable=function(){return this.focusable_};goog.ui.Container.prototype.setFocusable=function(e){if(e!=this.focusable_&&this.isInDocument())this.enableFocusHandling_(e);this.focusable_=e;if(this.enabled_&&this.visible_)this.renderer_.enableTabIndex(this.getKeyEventTarget(),e)};goog.ui.Container.prototype.isFocusableChildrenAllowed=function(){return this.allowFocusableChildren_};goog.ui.Container.prototype.setFocusableChildrenAllowed=function(e){this.allowFocusableChildren_=e};goog.ui.Container.prototype.isOpenFollowsHighlight=function(){return this.openFollowsHighlight_};goog.ui.Container.prototype.setOpenFollowsHighlight=function(e){this.openFollowsHighlight_=e};goog.ui.Container.prototype.getHighlightedIndex=function(){return this.highlightedIndex_};goog.ui.Container.prototype.setHighlightedIndex=function(e){var o=this.getChildAt(e);if(o)o.setHighlighted(true);else if(this.highlightedIndex_>-1)this.getHighlighted().setHighlighted(false)};goog.ui.Container.prototype.setHighlighted=function(e){this.setHighlightedIndex(this.indexOfChild(e))};goog.ui.Container.prototype.getHighlighted=function(){return this.getChildAt(this.highlightedIndex_)};goog.ui.Container.prototype.highlightFirst=function(){this.highlightHelper((function(e,o){return(e+1)%o}),this.getChildCount()-1)};goog.ui.Container.prototype.highlightLast=function(){this.highlightHelper((function(e,o){e--;return e<0?o-1:e}),0)};goog.ui.Container.prototype.highlightNext=function(){this.highlightHelper((function(e,o){return(e+1)%o}),this.highlightedIndex_)};goog.ui.Container.prototype.highlightPrevious=function(){this.highlightHelper((function(e,o){e--;return e<0?o-1:e}),this.highlightedIndex_)};goog.ui.Container.prototype.highlightHelper=function(e,o){var t=o<0?this.indexOfChild(this.openItem_):o;var i=this.getChildCount();t=e.call(this,t,i);var r=0;while(r<=i){var n=this.getChildAt(t);if(n&&this.canHighlightItem(n)){this.setHighlightedIndexFromKeyEvent(t);return true}r++;t=e.call(this,t,i)}return false};goog.ui.Container.prototype.canHighlightItem=function(e){return e.isVisible()&&e.isEnabled()&&e.isSupportedState(goog.ui.Component.State.HOVER)};goog.ui.Container.prototype.setHighlightedIndexFromKeyEvent=function(e){this.setHighlightedIndex(e)};goog.ui.Container.prototype.getOpenItem=function(){return this.openItem_};goog.ui.Container.prototype.isMouseButtonPressed=function(){return this.mouseButtonPressed_};goog.ui.Container.prototype.setMouseButtonPressed=function(e){this.mouseButtonPressed_=e};goog.provide("goog.ui.ContainerRenderer");goog.require("goog.a11y.aria");goog.require("goog.array");goog.require("goog.asserts");goog.require("goog.dom.NodeType");goog.require("goog.dom.TagName");goog.require("goog.dom.classlist");goog.require("goog.string");goog.require("goog.style");goog.require("goog.ui.registry");goog.require("goog.userAgent");goog.forwardDeclare("goog.ui.Container");goog.forwardDeclare("goog.ui.Container.Orientation");goog.forwardDeclare("goog.ui.Control");goog.ui.ContainerRenderer=function(e){this.ariaRole_=e};goog.addSingletonGetter(goog.ui.ContainerRenderer);goog.ui.ContainerRenderer.getCustomRenderer=function(e,o){var t=new e;t.getCssClass=function(){return o};return t};goog.ui.ContainerRenderer.CSS_CLASS=goog.getCssName("goog-container");goog.ui.ContainerRenderer.prototype.getAriaRole=function(){return this.ariaRole_};goog.ui.ContainerRenderer.prototype.enableTabIndex=function(e,o){if(e)e.tabIndex=o?0:-1};goog.ui.ContainerRenderer.prototype.createDom=function(e){return e.getDomHelper().createDom(goog.dom.TagName.DIV,this.getClassNames(e).join(" "))};goog.ui.ContainerRenderer.prototype.getContentElement=function(e){return e};goog.ui.ContainerRenderer.prototype.canDecorate=function(e){return"DIV"==e.tagName};goog.ui.ContainerRenderer.prototype.decorate=function(e,o){if(o.id)e.setId(o.id);var t=this.getCssClass();var i=false;var r=goog.dom.classlist.get(o);if(r)goog.array.forEach(r,(function(o){if(o==t)i=true;else if(o)this.setStateFromClassName(e,o,t)}),this);if(!i)goog.dom.classlist.add(o,t);this.decorateChildren(e,this.getContentElement(o));return o};goog.ui.ContainerRenderer.prototype.setStateFromClassName=function(e,o,t){if(o==goog.getCssName(t,"disabled"))e.setEnabled(false);else if(o==goog.getCssName(t,"horizontal"))e.setOrientation(goog.ui.Container.Orientation.HORIZONTAL);else if(o==goog.getCssName(t,"vertical"))e.setOrientation(goog.ui.Container.Orientation.VERTICAL)};goog.ui.ContainerRenderer.prototype.decorateChildren=function(e,o,t){if(o){var i=t||o.firstChild,r;while(i&&i.parentNode==o){r=i.nextSibling;if(i.nodeType==goog.dom.NodeType.ELEMENT){var n=this.getDecoratorForChild(i);if(n){n.setElementInternal(i);if(!e.isEnabled())n.setEnabled(false);e.addChild(n);n.decorate(i)}}else if(!i.nodeValue||""==goog.string.trim(i.nodeValue))o.removeChild(i);i=r}}};goog.ui.ContainerRenderer.prototype.getDecoratorForChild=function(e){return goog.ui.registry.getDecorator(e)};goog.ui.ContainerRenderer.prototype.initializeDom=function(e){var o=e.getElement();goog.asserts.assert(o,"The container DOM element cannot be null.");goog.style.setUnselectable(o,true,goog.userAgent.GECKO);if(goog.userAgent.IE)o.hideFocus=true;var t=this.getAriaRole();if(t)goog.a11y.aria.setRole(o,t)};goog.ui.ContainerRenderer.prototype.getKeyEventTarget=function(e){return e.getElement()};goog.ui.ContainerRenderer.prototype.getCssClass=function(){return goog.ui.ContainerRenderer.CSS_CLASS};goog.ui.ContainerRenderer.prototype.getClassNames=function(e){var o=this.getCssClass();var t=e.getOrientation()==goog.ui.Container.Orientation.HORIZONTAL;var i=[o,t?goog.getCssName(o,"horizontal"):goog.getCssName(o,"vertical")];if(!e.isEnabled())i.push(goog.getCssName(o,"disabled"));return i};goog.ui.ContainerRenderer.prototype.getDefaultOrientation=function(){return goog.ui.Container.Orientation.VERTICAL};goog.provide("goog.ui.ControlContent");goog.ui.ControlContent;goog.provide("goog.ui.DatePicker");goog.provide("goog.ui.DatePicker.Events");goog.provide("goog.ui.DatePickerEvent");goog.require("goog.a11y.aria");goog.require("goog.asserts");goog.require("goog.date.Date");goog.require("goog.date.DateRange");goog.require("goog.date.Interval");goog.require("goog.dom");goog.require("goog.dom.NodeType");goog.require("goog.dom.TagName");goog.require("goog.dom.classlist");goog.require("goog.events.Event");goog.require("goog.events.EventType");goog.require("goog.events.KeyHandler");goog.require("goog.i18n.DateTimeFormat");goog.require("goog.i18n.DateTimePatterns");goog.require("goog.i18n.DateTimeSymbols");goog.require("goog.style");goog.require("goog.ui.Component");goog.require("goog.ui.DefaultDatePickerRenderer");goog.require("goog.ui.IdGenerator");goog.ui.DatePicker=function(e,o,t,i){goog.ui.Component.call(this,t);this.symbols_=o||goog.i18n.DateTimeSymbols;this.wdayNames_=this.symbols_.STANDALONESHORTWEEKDAYS;this.i18nDateFormatterDay_=new goog.i18n.DateTimeFormat("d",this.symbols_);this.i18nDateFormatterDay2_=new goog.i18n.DateTimeFormat("dd",this.symbols_);this.i18nDateFormatterWeek_=new goog.i18n.DateTimeFormat("w",this.symbols_);this.i18nDateFormatterDayAriaLabel_=new goog.i18n.DateTimeFormat("d MMM",this.symbols_);var r=goog.i18n.DateTimePatterns.YEAR_FULL||"y";this.i18nDateFormatterYear_=new goog.i18n.DateTimeFormat(r,this.symbols_);var n=goog.i18n.DateTimePatterns.YEAR_MONTH_FULL||"MMMM y";this.i18nDateFormatterMonthYear_=new goog.i18n.DateTimeFormat(n,this.symbols_);this.renderer_=i||new goog.ui.DefaultDatePickerRenderer(this.getBaseCssClass(),this.getDomHelper());this.date_=new goog.date.Date(e);this.date_.setFirstWeekCutOffDay(this.symbols_.FIRSTWEEKCUTOFFDAY);this.date_.setFirstDayOfWeek(this.symbols_.FIRSTDAYOFWEEK);this.activeMonth_=this.date_.clone();this.activeMonth_.setDate(1);this.wdayStyles_=["","","","","","",""];this.wdayStyles_[this.symbols_.WEEKENDRANGE[0]]=goog.getCssName(this.getBaseCssClass(),"wkend-start");this.wdayStyles_[this.symbols_.WEEKENDRANGE[1]]=goog.getCssName(this.getBaseCssClass(),"wkend-end");this.keyHandlers_={};this.grid_=[];this.elTable_;this.tableBody_;this.tableFoot_;this.elYear_;this.elMonth_;this.elToday_;this.elNone_;this.menu_;this.menuSelected_;this.selectedCell_;this.menuCallback_};goog.inherits(goog.ui.DatePicker,goog.ui.Component);goog.tagUnsealableClass(goog.ui.DatePicker);goog.ui.DatePicker.prototype.showFixedNumWeeks_=true;goog.ui.DatePicker.prototype.showOtherMonths_=true;goog.ui.DatePicker.prototype.userSelectableDateRange_=goog.date.DateRange.allTime();goog.ui.DatePicker.prototype.extraWeekAtEnd_=true;goog.ui.DatePicker.prototype.showWeekNum_=true;goog.ui.DatePicker.prototype.showWeekdays_=true;goog.ui.DatePicker.prototype.allowNone_=true;goog.ui.DatePicker.prototype.showToday_=true;goog.ui.DatePicker.prototype.simpleNavigation_=false;goog.ui.DatePicker.prototype.decoratorFunction_=null;goog.ui.DatePicker.prototype.longDateFormat_=false;goog.ui.DatePicker.prototype.elNavRow_=null;goog.ui.DatePicker.prototype.elMonthYear_=null;goog.ui.DatePicker.prototype.elFootRow_=null;goog.ui.DatePicker.prototype.cellIdGenerator_=goog.ui.IdGenerator.getInstance();goog.ui.DatePicker.BASE_CSS_CLASS_=goog.getCssName("goog-date-picker");goog.ui.DatePicker.YEAR_MENU_RANGE_=5;goog.ui.DatePicker.Events={CHANGE:"change",CHANGE_ACTIVE_MONTH:"changeActiveMonth",SELECT:"select"};goog.ui.DatePicker.prototype.isCreated=goog.ui.DatePicker.prototype.isInDocument;goog.ui.DatePicker.prototype.getFirstWeekday=function(){return this.activeMonth_.getFirstDayOfWeek()};goog.ui.DatePicker.prototype.getWeekdayClass=function(e){return this.wdayStyles_[e]};goog.ui.DatePicker.prototype.getShowFixedNumWeeks=function(){return this.showFixedNumWeeks_};goog.ui.DatePicker.prototype.getShowOtherMonths=function(){return this.showOtherMonths_};goog.ui.DatePicker.prototype.getExtraWeekAtEnd=function(){return this.extraWeekAtEnd_};goog.ui.DatePicker.prototype.getShowWeekNum=function(){return this.showWeekNum_};goog.ui.DatePicker.prototype.getShowWeekdayNames=function(){return this.showWeekdays_};goog.ui.DatePicker.prototype.getAllowNone=function(){return this.allowNone_};goog.ui.DatePicker.prototype.getShowToday=function(){return this.showToday_};goog.ui.DatePicker.prototype.getBaseCssClass=function(){return goog.ui.DatePicker.BASE_CSS_CLASS_};goog.ui.DatePicker.prototype.setFirstWeekday=function(e){this.activeMonth_.setFirstDayOfWeek(e);this.updateCalendarGrid_();this.redrawWeekdays_()};goog.ui.DatePicker.prototype.setWeekdayClass=function(e,o){this.wdayStyles_[e]=o;this.redrawCalendarGrid_()};goog.ui.DatePicker.prototype.setShowFixedNumWeeks=function(e){this.showFixedNumWeeks_=e;this.updateCalendarGrid_()};goog.ui.DatePicker.prototype.setShowOtherMonths=function(e){this.showOtherMonths_=e;this.redrawCalendarGrid_()};goog.ui.DatePicker.prototype.setUserSelectableDateRange=function(e){this.userSelectableDateRange_=e};goog.ui.DatePicker.prototype.getUserSelectableDateRange=function(){return this.userSelectableDateRange_};goog.ui.DatePicker.prototype.isUserSelectableDate_=function(e){return this.userSelectableDateRange_.contains(e)};goog.ui.DatePicker.prototype.setUseSimpleNavigationMenu=function(e){this.simpleNavigation_=e;this.updateNavigationRow_();this.updateCalendarGrid_()};goog.ui.DatePicker.prototype.setExtraWeekAtEnd=function(e){this.extraWeekAtEnd_=e;this.updateCalendarGrid_()};goog.ui.DatePicker.prototype.setShowWeekNum=function(e){this.showWeekNum_=e;this.updateNavigationRow_();this.updateFooterRow_();this.updateCalendarGrid_()};goog.ui.DatePicker.prototype.setShowWeekdayNames=function(e){this.showWeekdays_=e;this.redrawWeekdays_();this.redrawCalendarGrid_()};goog.ui.DatePicker.prototype.setUseNarrowWeekdayNames=function(e){this.wdayNames_=e?this.symbols_.STANDALONENARROWWEEKDAYS:this.symbols_.STANDALONESHORTWEEKDAYS;this.redrawWeekdays_()};goog.ui.DatePicker.prototype.setAllowNone=function(e){this.allowNone_=e;if(this.elNone_)this.updateTodayAndNone_()};goog.ui.DatePicker.prototype.setShowToday=function(e){this.showToday_=e;if(this.elToday_)this.updateTodayAndNone_()};goog.ui.DatePicker.prototype.updateTodayAndNone_=function(){goog.style.setElementShown(this.elToday_,this.showToday_);goog.style.setElementShown(this.elNone_,this.allowNone_);goog.style.setElementShown(this.tableFoot_,this.showToday_||this.allowNone_)};goog.ui.DatePicker.prototype.setDecorator=function(e){this.decoratorFunction_=e};goog.ui.DatePicker.prototype.setLongDateFormat=function(e){this.longDateFormat_=e;this.redrawCalendarGrid_()};goog.ui.DatePicker.prototype.previousMonth=function(){this.activeMonth_.add(new goog.date.Interval(goog.date.Interval.MONTHS,-1));this.updateCalendarGrid_();this.fireChangeActiveMonthEvent_()};goog.ui.DatePicker.prototype.nextMonth=function(){this.activeMonth_.add(new goog.date.Interval(goog.date.Interval.MONTHS,1));this.updateCalendarGrid_();this.fireChangeActiveMonthEvent_()};goog.ui.DatePicker.prototype.previousYear=function(){this.activeMonth_.add(new goog.date.Interval(goog.date.Interval.YEARS,-1));this.updateCalendarGrid_();this.fireChangeActiveMonthEvent_()};goog.ui.DatePicker.prototype.nextYear=function(){this.activeMonth_.add(new goog.date.Interval(goog.date.Interval.YEARS,1));this.updateCalendarGrid_();this.fireChangeActiveMonthEvent_()};goog.ui.DatePicker.prototype.selectToday=function(){this.setDate(new goog.date.Date)};goog.ui.DatePicker.prototype.selectNone=function(){if(this.allowNone_)this.setDate(null)};goog.ui.DatePicker.prototype.getActiveMonth=function(){return this.activeMonth_.clone()};goog.ui.DatePicker.prototype.getDate=function(){return this.date_&&this.date_.clone()};goog.ui.DatePicker.prototype.getDateAt=function(e,o){return this.grid_[e]?this.grid_[e][o]?this.grid_[e][o].clone():null:null};goog.ui.DatePicker.prototype.getDateElementAt=function(e,o){if(e<0||o<0)return null;var t=e+1;return this.elTable_[t]?this.elTable_[t][o+1]||null:null};goog.ui.DatePicker.prototype.setDate=function(e){this.setDate_(e,true)};goog.ui.DatePicker.prototype.setDate_=function(e,o){var t=e==this.date_||e&&this.date_&&e.getFullYear()==this.date_.getFullYear()&&e.getMonth()==this.date_.getMonth();var i=e==this.date_||t&&e.getDate()==this.date_.getDate();this.date_=e&&new goog.date.Date(e);if(e){this.activeMonth_.set(this.date_);this.activeMonth_.setFullYear(this.date_.getFullYear());this.activeMonth_.setDate(1)}this.updateCalendarGrid_();if(o){var r=new goog.ui.DatePickerEvent(goog.ui.DatePicker.Events.SELECT,this,this.date_);this.dispatchEvent(r)}if(!i){var n=new goog.ui.DatePickerEvent(goog.ui.DatePicker.Events.CHANGE,this,this.date_);this.dispatchEvent(n)}if(!t)this.fireChangeActiveMonthEvent_()};goog.ui.DatePicker.prototype.updateNavigationRow_=function(){if(!this.elNavRow_)return;var e=this.elNavRow_;while(e.firstChild)e.removeChild(e.firstChild);var o=this.symbols_.DATEFORMATS[goog.i18n.DateTimeFormat.Format.FULL_DATE].toLowerCase();this.renderer_.renderNavigationRow(e,this.simpleNavigation_,this.showWeekNum_,o);if(this.simpleNavigation_){this.addPreventDefaultClickHandler_(e,goog.getCssName(this.getBaseCssClass(),"previousMonth"),this.previousMonth);var t=goog.dom.getElementByClass(goog.getCssName(this.getBaseCssClass(),"previousMonth"),e);if(t){goog.a11y.aria.setState(t,goog.a11y.aria.State.HIDDEN,true);t.tabIndex=-1}this.addPreventDefaultClickHandler_(e,goog.getCssName(this.getBaseCssClass(),"nextMonth"),this.nextMonth);var i=goog.dom.getElementByClass(goog.getCssName(this.getBaseCssClass(),"nextMonth"),e);if(i){goog.a11y.aria.setState(i,goog.a11y.aria.State.HIDDEN,true);i.tabIndex=-1}this.elMonthYear_=goog.dom.getElementByClass(goog.getCssName(this.getBaseCssClass(),"monthyear"),e)}else{this.addPreventDefaultClickHandler_(e,goog.getCssName(this.getBaseCssClass(),"previousMonth"),this.previousMonth);this.addPreventDefaultClickHandler_(e,goog.getCssName(this.getBaseCssClass(),"nextMonth"),this.nextMonth);this.addPreventDefaultClickHandler_(e,goog.getCssName(this.getBaseCssClass(),"month"),this.showMonthMenu_);this.addPreventDefaultClickHandler_(e,goog.getCssName(this.getBaseCssClass(),"previousYear"),this.previousYear);this.addPreventDefaultClickHandler_(e,goog.getCssName(this.getBaseCssClass(),"nextYear"),this.nextYear);this.addPreventDefaultClickHandler_(e,goog.getCssName(this.getBaseCssClass(),"year"),this.showYearMenu_);this.elMonth_=goog.dom.getElementByClass(goog.getCssName(this.getBaseCssClass(),"month"),e);this.elYear_=goog.dom.getDomHelper().getElementByClass(goog.getCssName(this.getBaseCssClass(),"year"),e)}};goog.ui.DatePicker.prototype.addPreventDefaultClickHandler_=function(e,o,t){var i=goog.dom.getElementByClass(o,e);this.getHandler().listen(i,goog.events.EventType.CLICK,(function(e){e.preventDefault();t.call(this,e)}))};goog.ui.DatePicker.prototype.updateFooterRow_=function(){if(!this.elFootRow_)return;var e=this.elFootRow_;goog.dom.removeChildren(e);this.renderer_.renderFooterRow(e,this.showWeekNum_);this.addPreventDefaultClickHandler_(e,goog.getCssName(this.getBaseCssClass(),"today-btn"),this.selectToday);this.addPreventDefaultClickHandler_(e,goog.getCssName(this.getBaseCssClass(),"none-btn"),this.selectNone);this.elToday_=goog.dom.getElementByClass(goog.getCssName(this.getBaseCssClass(),"today-btn"),e);this.elNone_=goog.dom.getElementByClass(goog.getCssName(this.getBaseCssClass(),"none-btn"),e);this.updateTodayAndNone_()};goog.ui.DatePicker.prototype.decorateInternal=function(e){goog.ui.DatePicker.superClass_.decorateInternal.call(this,e);goog.asserts.assert(e);goog.dom.classlist.add(e,this.getBaseCssClass());var o=this.dom_.createDom(goog.dom.TagName.TABLE,{role:"presentation"});var t=this.dom_.createDom(goog.dom.TagName.THEAD);var i=this.dom_.createDom(goog.dom.TagName.TBODY,{role:"grid"});var r=this.dom_.createDom(goog.dom.TagName.TFOOT);i.tabIndex=0;this.tableBody_=i;this.tableFoot_=r;var n=this.dom_.createDom(goog.dom.TagName.TR,{role:"row"});n.className=goog.getCssName(this.getBaseCssClass(),"head");this.elNavRow_=n;this.updateNavigationRow_();t.appendChild(n);var l;this.elTable_=[];for(var s=0;s<7;s++){n=this.dom_.createElement(goog.dom.TagName.TR);this.elTable_[s]=[];for(var g=0;g<8;g++){l=this.dom_.createElement(0==g||0==s?"th":"td");if((0==g||0==s)&&g!=s){l.className=0==g?goog.getCssName(this.getBaseCssClass(),"week"):goog.getCssName(this.getBaseCssClass(),"wday");goog.a11y.aria.setRole(l,0==g?"rowheader":"columnheader")}else if(0!==s&&0!==g){goog.a11y.aria.setRole(l,"gridcell");l.setAttribute("tabindex","-1")}n.appendChild(l);this.elTable_[s][g]=l}i.appendChild(n)}n=this.dom_.createElement(goog.dom.TagName.TR);n.className=goog.getCssName(this.getBaseCssClass(),"foot");this.elFootRow_=n;this.updateFooterRow_();r.appendChild(n);o.cellSpacing="0";o.cellPadding="0";o.appendChild(t);o.appendChild(i);o.appendChild(r);e.appendChild(o);this.redrawWeekdays_();this.updateCalendarGrid_();e.tabIndex=0};goog.ui.DatePicker.prototype.createDom=function(){goog.ui.DatePicker.superClass_.createDom.call(this);this.decorateInternal(this.getElement())};goog.ui.DatePicker.prototype.enterDocument=function(){goog.ui.DatePicker.superClass_.enterDocument.call(this);var e=this.getHandler();e.listen(this.tableBody_,goog.events.EventType.CLICK,this.handleGridClick_);e.listen(this.getKeyHandlerForElement_(this.getElement()),goog.events.KeyHandler.EventType.KEY,this.handleGridKeyPress_)};goog.ui.DatePicker.prototype.exitDocument=function(){goog.ui.DatePicker.superClass_.exitDocument.call(this);this.destroyMenu_();for(var e in this.keyHandlers_)this.keyHandlers_[e].dispose();this.keyHandlers_={}};goog.ui.DatePicker.prototype.create=goog.ui.DatePicker.prototype.decorate;goog.ui.DatePicker.prototype.disposeInternal=function(){goog.ui.DatePicker.superClass_.disposeInternal.call(this);this.elTable_=null;this.tableBody_=null;this.tableFoot_=null;this.elNavRow_=null;this.elFootRow_=null;this.elMonth_=null;this.elMonthYear_=null;this.elYear_=null;this.elToday_=null;this.elNone_=null};goog.ui.DatePicker.prototype.handleGridClick_=function(e){if(e.target.tagName==goog.dom.TagName.TD){var o,t=-2,i=-2;for(o=e.target;o;o=o.previousSibling,t++);for(o=e.target.parentNode;o;o=o.previousSibling,i++);var r=this.grid_[i][t];if(this.isUserSelectableDate_(r))this.setDate(r.clone())}};goog.ui.DatePicker.prototype.handleGridKeyPress_=function(e){var o,t;switch(e.keyCode){case 33:e.preventDefault();o=-1;break;case 34:e.preventDefault();o=1;break;case 37:e.preventDefault();t=-1;break;case 39:e.preventDefault();t=1;break;case 38:e.preventDefault();t=-7;break;case 40:e.preventDefault();t=7;break;case 36:e.preventDefault();this.selectToday();case 46:e.preventDefault();this.selectNone();break;case 13:case 32:e.preventDefault();this.setDate_(this.date_,true);default:return}var i;if(this.date_){i=this.date_.clone();i.add(new goog.date.Interval(0,o,t))}else{i=this.activeMonth_.clone();i.setDate(1)}if(this.isUserSelectableDate_(i)){this.setDate_(i,false);this.selectedCell_.focus()}};goog.ui.DatePicker.prototype.showMonthMenu_=function(e){e.stopPropagation();var o=[];for(var t=0;t<12;t++)o.push(this.symbols_.STANDALONEMONTHS[t]);this.createMenu_(this.elMonth_,o,this.handleMonthMenuClick_,this.symbols_.STANDALONEMONTHS[this.activeMonth_.getMonth()])};goog.ui.DatePicker.prototype.showYearMenu_=function(e){e.stopPropagation();var o=[];var t=this.activeMonth_.getFullYear();var i=this.activeMonth_.clone();for(var r=-goog.ui.DatePicker.YEAR_MENU_RANGE_;r<=goog.ui.DatePicker.YEAR_MENU_RANGE_;r++){i.setFullYear(t+r);o.push(this.i18nDateFormatterYear_.format(i))}this.createMenu_(this.elYear_,o,this.handleYearMenuClick_,this.i18nDateFormatterYear_.format(this.activeMonth_))};goog.ui.DatePicker.prototype.handleMonthMenuClick_=function(e){var o=Number(e.getAttribute("itemIndex"));this.activeMonth_.setMonth(o);this.updateCalendarGrid_();if(this.elMonth_.focus)this.elMonth_.focus()};goog.ui.DatePicker.prototype.handleYearMenuClick_=function(e){if(e.firstChild.nodeType==goog.dom.NodeType.TEXT){var o=Number(e.getAttribute("itemIndex"));var t=this.activeMonth_.getFullYear();this.activeMonth_.setFullYear(t+o-goog.ui.DatePicker.YEAR_MENU_RANGE_);this.updateCalendarGrid_()}this.elYear_.focus()};goog.ui.DatePicker.prototype.createMenu_=function(e,o,t,i){this.destroyMenu_();var r=this.dom_.createElement(goog.dom.TagName.DIV);r.className=goog.getCssName(this.getBaseCssClass(),"menu");this.menuSelected_=null;var n=this.dom_.createElement(goog.dom.TagName.UL);for(var l=0;l<o.length;l++){var s=this.dom_.createDom(goog.dom.TagName.LI,null,o[l]);s.setAttribute("itemIndex",l);if(o[l]==i)this.menuSelected_=s;n.appendChild(s)}r.appendChild(n);e=e;r.style.left=e.offsetLeft+e.parentNode.offsetLeft+"px";r.style.top=e.offsetTop+"px";r.style.width=e.clientWidth+"px";this.elMonth_.parentNode.appendChild(r);this.menu_=r;if(!this.menuSelected_)this.menuSelected_=n.firstChild;this.menuSelected_.className=goog.getCssName(this.getBaseCssClass(),"menu-selected");this.menuCallback_=t;var g=this.getHandler();g.listen(this.menu_,goog.events.EventType.CLICK,this.handleMenuClick_);g.listen(this.getKeyHandlerForElement_(this.menu_),goog.events.KeyHandler.EventType.KEY,this.handleMenuKeyPress_);g.listen(this.dom_.getDocument(),goog.events.EventType.CLICK,this.destroyMenu_);r.tabIndex=0;r.focus()};goog.ui.DatePicker.prototype.handleMenuClick_=function(e){e.stopPropagation();this.destroyMenu_();if(this.menuCallback_)this.menuCallback_(e.target)};goog.ui.DatePicker.prototype.handleMenuKeyPress_=function(e){e.stopPropagation();var o;var t=this.menuSelected_;switch(e.keyCode){case 35:e.preventDefault();o=t.parentNode.lastChild;break;case 36:e.preventDefault();o=t.parentNode.firstChild;break;case 38:e.preventDefault();o=t.previousSibling;break;case 40:e.preventDefault();o=t.nextSibling;break;case 13:case 9:case 0:e.preventDefault();this.destroyMenu_();this.menuCallback_(t);break}if(o&&o!=t){t.className="";o.className=goog.getCssName(this.getBaseCssClass(),"menu-selected");this.menuSelected_=o}};goog.ui.DatePicker.prototype.destroyMenu_=function(){if(this.menu_){var e=this.getHandler();e.unlisten(this.menu_,goog.events.EventType.CLICK,this.handleMenuClick_);e.unlisten(this.getKeyHandlerForElement_(this.menu_),goog.events.KeyHandler.EventType.KEY,this.handleMenuKeyPress_);e.unlisten(this.dom_.getDocument(),goog.events.EventType.CLICK,this.destroyMenu_);goog.dom.removeNode(this.menu_);delete this.menu_}};goog.ui.DatePicker.prototype.updateCalendarGrid_=function(){if(!this.getElement())return;var e=this.activeMonth_.clone();e.setDate(1);if(this.elMonthYear_)goog.dom.setTextContent(this.elMonthYear_,this.i18nDateFormatterMonthYear_.format(e));if(this.elMonth_)goog.dom.setTextContent(this.elMonth_,this.symbols_.STANDALONEMONTHS[e.getMonth()]);if(this.elYear_)goog.dom.setTextContent(this.elYear_,this.i18nDateFormatterYear_.format(e));var o=e.getWeekday();var t=e.getNumberOfDaysInMonth();e.add(new goog.date.Interval(goog.date.Interval.MONTHS,-1));e.setDate(e.getNumberOfDaysInMonth()-(o-1));if(this.showFixedNumWeeks_&&!this.extraWeekAtEnd_&&t+o<33)e.add(new goog.date.Interval(goog.date.Interval.DAYS,-7));var i=new goog.date.Interval(goog.date.Interval.DAYS,1);this.grid_=[];for(var r=0;r<6;r++){this.grid_[r]=[];for(var n=0;n<7;n++){this.grid_[r][n]=e.clone();var l=e.getFullYear();e.add(i);if(0==e.getMonth()&&1==e.getDate())l++;e.setFullYear(l)}}this.redrawCalendarGrid_()};goog.ui.DatePicker.prototype.redrawCalendarGrid_=function(){if(!this.getElement())return;var e=this.activeMonth_.getMonth();var o=new goog.date.Date;var t=o.getFullYear();var i=o.getMonth();var r=o.getDate();for(var n=0;n<6;n++){if(this.showWeekNum_){goog.dom.setTextContent(this.elTable_[n+1][0],this.i18nDateFormatterWeek_.format(this.grid_[n][0]));goog.dom.classlist.set(this.elTable_[n+1][0],goog.getCssName(this.getBaseCssClass(),"week"))}else{goog.dom.setTextContent(this.elTable_[n+1][0],"");goog.dom.classlist.set(this.elTable_[n+1][0],"")}for(var l=0;l<7;l++){var s=this.grid_[n][l];var g=this.elTable_[n+1][l+1];if(!g.id)g.id=this.cellIdGenerator_.getNextUniqueId();goog.asserts.assert(g,"The table DOM element cannot be null.");goog.a11y.aria.setRole(g,"gridcell");goog.a11y.aria.setLabel(g,this.i18nDateFormatterDayAriaLabel_.format(s));var a=[goog.getCssName(this.getBaseCssClass(),"date")];if(!this.isUserSelectableDate_(s))a.push(goog.getCssName(this.getBaseCssClass(),"unavailable-date"));if(this.showOtherMonths_||s.getMonth()==e){if(s.getMonth()!=e)a.push(goog.getCssName(this.getBaseCssClass(),"other-month"));var c=(l+this.activeMonth_.getFirstDayOfWeek()+7)%7;if(this.wdayStyles_[c])a.push(this.wdayStyles_[c]);if(s.getDate()==r&&s.getMonth()==i&&s.getFullYear()==t)a.push(goog.getCssName(this.getBaseCssClass(),"today"));if(this.date_&&s.getDate()==this.date_.getDate()&&s.getMonth()==this.date_.getMonth()&&s.getFullYear()==this.date_.getFullYear()){a.push(goog.getCssName(this.getBaseCssClass(),"selected"));goog.asserts.assert(this.tableBody_,"The table body DOM element cannot be null");this.selectedCell_=g}if(this.decoratorFunction_){var u=this.decoratorFunction_(s);if(u)a.push(u)}var h=this.longDateFormat_?this.i18nDateFormatterDay2_.format(s):this.i18nDateFormatterDay_.format(s);goog.dom.setTextContent(g,h)}else goog.dom.setTextContent(g,"");goog.dom.classlist.set(g,a.join(" "))}if(n>=4){var d=this.elTable_[n+1][0].parentElement||this.elTable_[n+1][0].parentNode;goog.style.setElementShown(d,this.grid_[n][0].getMonth()==e||this.showFixedNumWeeks_)}}};goog.ui.DatePicker.prototype.fireChangeActiveMonthEvent_=function(){var e=new goog.ui.DatePickerEvent(goog.ui.DatePicker.Events.CHANGE_ACTIVE_MONTH,this,this.getActiveMonth());this.dispatchEvent(e)};goog.ui.DatePicker.prototype.redrawWeekdays_=function(){if(!this.getElement())return;if(this.showWeekdays_)for(var e=0;e<7;e++){var o=this.elTable_[0][e+1];var t=(e+this.activeMonth_.getFirstDayOfWeek()+7)%7;goog.dom.setTextContent(o,this.wdayNames_[(t+1)%7])}var i=this.elTable_[0][0].parentElement||this.elTable_[0][0].parentNode;goog.style.setElementShown(i,this.showWeekdays_)};goog.ui.DatePicker.prototype.getKeyHandlerForElement_=function(e){var o=goog.getUid(e);if(!(o in this.keyHandlers_))this.keyHandlers_[o]=new goog.events.KeyHandler(e);return this.keyHandlers_[o]};goog.ui.DatePickerEvent=function(e,o,t){goog.events.Event.call(this,e,o);this.date=t};goog.inherits(goog.ui.DatePickerEvent,goog.events.Event);goog.provide("goog.ui.DatePickerRenderer");goog.ui.DatePickerRenderer=function(){};goog.ui.DatePickerRenderer.prototype.renderNavigationRow=goog.abstractMethod;goog.ui.DatePickerRenderer.prototype.renderFooterRow=goog.abstractMethod;goog.provide("goog.ui.DefaultDatePickerRenderer");goog.require("goog.dom");goog.require("goog.dom.TagName");goog.require("goog.ui.DatePickerRenderer");goog.ui.DefaultDatePickerRenderer=function(e,o){this.baseCssClass_=e;this.dom_=o||goog.dom.getDomHelper()};goog.ui.DefaultDatePickerRenderer.prototype.getDomHelper=function(){return this.dom_};goog.ui.DefaultDatePickerRenderer.prototype.getBaseCssClass=function(){return this.baseCssClass_};goog.ui.DefaultDatePickerRenderer.prototype.renderNavigationRow=function(e,o,t,i){var r,n,l;if(o){r=this.getDomHelper().createElement(goog.dom.TagName.TD);r.colSpan=t?1:2;this.createButton_(r,"«",goog.getCssName(this.getBaseCssClass(),"previousMonth"));e.appendChild(r);r=this.getDomHelper().createElement(goog.dom.TagName.TD);r.colSpan=t?6:5;r.className=goog.getCssName(this.getBaseCssClass(),"monthyear");e.appendChild(r);r=this.getDomHelper().createElement(goog.dom.TagName.TD);this.createButton_(r,"»",goog.getCssName(this.getBaseCssClass(),"nextMonth"));e.appendChild(r)}else{n=this.getDomHelper().createElement(goog.dom.TagName.TD);n.colSpan=5;this.createButton_(n,"«",goog.getCssName(this.getBaseCssClass(),"previousMonth"));this.createButton_(n,"",goog.getCssName(this.getBaseCssClass(),"month"));this.createButton_(n,"»",goog.getCssName(this.getBaseCssClass(),"nextMonth"));l=this.getDomHelper().createElement(goog.dom.TagName.TD);l.colSpan=3;this.createButton_(l,"«",goog.getCssName(this.getBaseCssClass(),"previousYear"));this.createButton_(l,"",goog.getCssName(this.getBaseCssClass(),"year"));this.createButton_(l,"»",goog.getCssName(this.getBaseCssClass(),"nextYear"));if(i.indexOf("y")<i.indexOf("m")){e.appendChild(l);e.appendChild(n)}else{e.appendChild(n);e.appendChild(l)}}};goog.ui.DefaultDatePickerRenderer.prototype.renderFooterRow=function(e,o){var t=this.getDomHelper().createElement(goog.dom.TagName.TD);t.colSpan=o?2:3;t.className=goog.getCssName(this.getBaseCssClass(),"today-cont");var i=goog.getMsg("Today");this.createButton_(t,i,goog.getCssName(this.getBaseCssClass(),"today-btn"));e.appendChild(t);t=this.getDomHelper().createElement(goog.dom.TagName.TD);t.colSpan=o?4:3;e.appendChild(t);t=this.getDomHelper().createElement(goog.dom.TagName.TD);t.colSpan=2;t.className=goog.getCssName(this.getBaseCssClass(),"none-cont");var r=goog.getMsg("None");this.createButton_(t,r,goog.getCssName(this.getBaseCssClass(),"none-btn"));e.appendChild(t)};goog.ui.DefaultDatePickerRenderer.prototype.createButton_=function(e,o,t){var i=[goog.getCssName(this.getBaseCssClass(),"btn")];if(t)i.push(t);var r=this.getDomHelper().createElement(goog.dom.TagName.BUTTON);r.className=i.join(" ");r.appendChild(this.getDomHelper().createTextNode(o));e.appendChild(r);return r};goog.provide("goog.ui.MenuRenderer");goog.require("goog.a11y.aria");goog.require("goog.a11y.aria.Role");goog.require("goog.a11y.aria.State");goog.require("goog.asserts");goog.require("goog.dom");goog.require("goog.dom.TagName");goog.require("goog.ui.ContainerRenderer");goog.require("goog.ui.Separator");goog.forwardDeclare("goog.ui.Menu");goog.ui.MenuRenderer=function(e){goog.ui.ContainerRenderer.call(this,e||goog.a11y.aria.Role.MENU)};goog.inherits(goog.ui.MenuRenderer,goog.ui.ContainerRenderer);goog.addSingletonGetter(goog.ui.MenuRenderer);goog.ui.MenuRenderer.CSS_CLASS=goog.getCssName("goog-menu");goog.ui.MenuRenderer.prototype.canDecorate=function(e){return e.tagName==goog.dom.TagName.UL||goog.ui.MenuRenderer.superClass_.canDecorate.call(this,e)};goog.ui.MenuRenderer.prototype.getDecoratorForChild=function(e){return e.tagName==goog.dom.TagName.HR?new goog.ui.Separator:goog.ui.MenuRenderer.superClass_.getDecoratorForChild.call(this,e)};goog.ui.MenuRenderer.prototype.containsElement=function(e,o){return goog.dom.contains(e.getElement(),o)};goog.ui.MenuRenderer.prototype.getCssClass=function(){return goog.ui.MenuRenderer.CSS_CLASS};goog.ui.MenuRenderer.prototype.initializeDom=function(e){goog.ui.MenuRenderer.superClass_.initializeDom.call(this,e);var o=e.getElement();goog.asserts.assert(o,"The menu DOM element cannot be null.");goog.a11y.aria.setState(o,goog.a11y.aria.State.HASPOPUP,"true")};goog.provide("goog.ui.Menu");goog.provide("goog.ui.Menu.EventType");goog.require("goog.dom.TagName");goog.require("goog.math.Coordinate");goog.require("goog.string");goog.require("goog.style");goog.require("goog.ui.Component.EventType");goog.require("goog.ui.Component.State");goog.require("goog.ui.Container");goog.require("goog.ui.Container.Orientation");goog.require("goog.ui.MenuHeader");goog.require("goog.ui.MenuItem");goog.require("goog.ui.MenuRenderer");goog.require("goog.ui.MenuSeparator");goog.ui.Menu=function(e,o){goog.ui.Container.call(this,goog.ui.Container.Orientation.VERTICAL,o||goog.ui.MenuRenderer.getInstance(),e);this.setFocusable(false)};goog.inherits(goog.ui.Menu,goog.ui.Container);goog.tagUnsealableClass(goog.ui.Menu);goog.ui.Menu.EventType={BEFORE_SHOW:goog.ui.Component.EventType.BEFORE_SHOW,SHOW:goog.ui.Component.EventType.SHOW,BEFORE_HIDE:goog.ui.Component.EventType.HIDE,HIDE:goog.ui.Component.EventType.HIDE};goog.ui.Menu.CSS_CLASS=goog.ui.MenuRenderer.CSS_CLASS;goog.ui.Menu.prototype.openingCoords;goog.ui.Menu.prototype.allowAutoFocus_=true;goog.ui.Menu.prototype.allowHighlightDisabled_=false;goog.ui.Menu.prototype.getCssClass=function(){return this.getRenderer().getCssClass()};goog.ui.Menu.prototype.containsElement=function(e){if(this.getRenderer().containsElement(this,e))return true;for(var o=0,t=this.getChildCount();o<t;o++){var i=this.getChildAt(o);if("function"==typeof i.containsElement&&i.containsElement(e))return true}return false};goog.ui.Menu.prototype.addItem=function(e){this.addChild(e,true)};goog.ui.Menu.prototype.addItemAt=function(e,o){this.addChildAt(e,o,true)};goog.ui.Menu.prototype.removeItem=function(e){var o=this.removeChild(e,true);if(o)o.dispose()};goog.ui.Menu.prototype.removeItemAt=function(e){var o=this.removeChildAt(e,true);if(o)o.dispose()};goog.ui.Menu.prototype.getItemAt=function(e){return this.getChildAt(e)};goog.ui.Menu.prototype.getItemCount=function(){return this.getChildCount()};goog.ui.Menu.prototype.getItems=function(){var e=[];this.forEachChild((function(o){e.push(o)}));return e};goog.ui.Menu.prototype.setPosition=function(e,o){var t=this.isVisible();if(!t)goog.style.setElementShown(this.getElement(),true);goog.style.setPageOffset(this.getElement(),e,o);if(!t)goog.style.setElementShown(this.getElement(),false)};goog.ui.Menu.prototype.getPosition=function(){return this.isVisible()?goog.style.getPageOffset(this.getElement()):null};goog.ui.Menu.prototype.setAllowAutoFocus=function(e){this.allowAutoFocus_=e;if(e)this.setFocusable(true)};goog.ui.Menu.prototype.getAllowAutoFocus=function(){return this.allowAutoFocus_};goog.ui.Menu.prototype.setAllowHighlightDisabled=function(e){this.allowHighlightDisabled_=e};goog.ui.Menu.prototype.getAllowHighlightDisabled=function(){return this.allowHighlightDisabled_};goog.ui.Menu.prototype.setVisible=function(e,o,t){var i=goog.ui.Menu.superClass_.setVisible.call(this,e,o);if(i&&e&&this.isInDocument()&&this.allowAutoFocus_)this.getKeyEventTarget().focus();if(e&&t&&goog.isNumber(t.clientX))this.openingCoords=new goog.math.Coordinate(t.clientX,t.clientY);else this.openingCoords=null;return i};goog.ui.Menu.prototype.handleEnterItem=function(e){if(this.allowAutoFocus_)this.getKeyEventTarget().focus();return goog.ui.Menu.superClass_.handleEnterItem.call(this,e)};goog.ui.Menu.prototype.highlightNextPrefix=function(e){var o=new RegExp("^"+goog.string.regExpEscape(e),"i");return this.highlightHelper((function(e,t){var i=e<0?0:e;var r=false;do{++e;if(e==t){e=0;r=true}var n=this.getChildAt(e).getCaption();if(n&&n.match(o))return e}while(!r||e!=i);return this.getHighlightedIndex()}),this.getHighlightedIndex())};goog.ui.Menu.prototype.canHighlightItem=function(e){return(this.allowHighlightDisabled_||e.isEnabled())&&e.isVisible()&&e.isSupportedState(goog.ui.Component.State.HOVER)};goog.ui.Menu.prototype.decorateInternal=function(e){this.decorateContent(e);goog.ui.Menu.superClass_.decorateInternal.call(this,e)};goog.ui.Menu.prototype.handleKeyEventInternal=function(e){var o=goog.ui.Menu.base(this,"handleKeyEventInternal",e);if(!o)this.forEachChild((function(t){if(!o&&t.getMnemonic&&t.getMnemonic()==e.keyCode){if(this.isEnabled())this.setHighlighted(t);o=t.handleKeyEvent(e)}}),this);return o};goog.ui.Menu.prototype.setHighlightedIndex=function(e){goog.ui.Menu.base(this,"setHighlightedIndex",e);var o=this.getChildAt(e);if(o)goog.style.scrollIntoContainerView(o.getElement(),this.getElement())};goog.ui.Menu.prototype.decorateContent=function(e){var o=this.getRenderer();var t=this.getDomHelper().getElementsByTagNameAndClass(goog.dom.TagName.DIV,goog.getCssName(o.getCssClass(),"content"),e);var i=t.length;for(var r=0;r<i;r++)o.decorateChildren(this,t[r])};goog.provide("goog.ui.MenuHeader");goog.require("goog.ui.Component");goog.require("goog.ui.Control");goog.require("goog.ui.MenuHeaderRenderer");goog.require("goog.ui.registry");goog.ui.MenuHeader=function(e,o,t){goog.ui.Control.call(this,e,t||goog.ui.MenuHeaderRenderer.getInstance(),o);this.setSupportedState(goog.ui.Component.State.DISABLED,false);this.setSupportedState(goog.ui.Component.State.HOVER,false);this.setSupportedState(goog.ui.Component.State.ACTIVE,false);this.setSupportedState(goog.ui.Component.State.FOCUSED,false);this.setStateInternal(goog.ui.Component.State.DISABLED)};goog.inherits(goog.ui.MenuHeader,goog.ui.Control);goog.ui.registry.setDecoratorByClassName(goog.ui.MenuHeaderRenderer.CSS_CLASS,(function(){return new goog.ui.MenuHeader(null)}));goog.provide("goog.ui.MenuItem");goog.require("goog.a11y.aria.Role");goog.require("goog.array");goog.require("goog.dom");goog.require("goog.dom.classlist");goog.require("goog.math.Coordinate");goog.require("goog.string");goog.require("goog.ui.Component");goog.require("goog.ui.Control");goog.require("goog.ui.MenuItemRenderer");goog.require("goog.ui.registry");goog.forwardDeclare("goog.ui.Menu");goog.ui.MenuItem=function(e,o,t,i){goog.ui.Control.call(this,e,i||goog.ui.MenuItemRenderer.getInstance(),t);this.setValue(o)};goog.inherits(goog.ui.MenuItem,goog.ui.Control);goog.tagUnsealableClass(goog.ui.MenuItem);goog.ui.MenuItem.prototype.mnemonicKey_;goog.ui.MenuItem.MNEMONIC_WRAPPER_CLASS_=goog.getCssName("goog-menuitem-mnemonic-separator");goog.ui.MenuItem.ACCELERATOR_CLASS=goog.getCssName("goog-menuitem-accel");goog.ui.MenuItem.prototype.getValue=function(){var e=this.getModel();return null!=e?e:this.getCaption()};goog.ui.MenuItem.prototype.setValue=function(e){this.setModel(e)};goog.ui.MenuItem.prototype.setSupportedState=function(e,o){goog.ui.MenuItem.base(this,"setSupportedState",e,o);switch(e){case goog.ui.Component.State.SELECTED:this.setSelectableInternal_(o);break;case goog.ui.Component.State.CHECKED:this.setCheckableInternal_(o);break}};goog.ui.MenuItem.prototype.setSelectable=function(e){this.setSupportedState(goog.ui.Component.State.SELECTED,e)};goog.ui.MenuItem.prototype.setSelectableInternal_=function(e){if(this.isChecked()&&!e)this.setChecked(false);var o=this.getElement();if(o)this.getRenderer().setSelectable(this,o,e)};goog.ui.MenuItem.prototype.setCheckable=function(e){this.setSupportedState(goog.ui.Component.State.CHECKED,e)};goog.ui.MenuItem.prototype.setCheckableInternal_=function(e){var o=this.getElement();if(o)this.getRenderer().setCheckable(this,o,e)};goog.ui.MenuItem.prototype.getCaption=function(){var e=this.getContent();if(goog.isArray(e)){var o=goog.ui.MenuItem.ACCELERATOR_CLASS;var t=goog.ui.MenuItem.MNEMONIC_WRAPPER_CLASS_;var i=goog.array.map(e,(function(e){if(goog.dom.isElement(e)&&(goog.dom.classlist.contains(e,o)||goog.dom.classlist.contains(e,t)))return"";else return goog.dom.getRawTextContent(e)})).join("");return goog.string.collapseBreakingSpaces(i)}return goog.ui.MenuItem.superClass_.getCaption.call(this)};goog.ui.MenuItem.prototype.getAccelerator=function(){var e=this.getDomHelper();var o=this.getContent();if(goog.isArray(o)){var t=goog.array.find(o,(function(e){return goog.dom.classlist.contains(e,goog.ui.MenuItem.ACCELERATOR_CLASS)}));if(t)return e.getTextContent(t)}return null};goog.ui.MenuItem.prototype.handleMouseUp=function(e){var o=this.getParent();if(o){var t=o.openingCoords;o.openingCoords=null;if(t&&goog.isNumber(e.clientX)){var i=new goog.math.Coordinate(e.clientX,e.clientY);if(goog.math.Coordinate.equals(t,i))return}}goog.ui.MenuItem.base(this,"handleMouseUp",e)};goog.ui.MenuItem.prototype.handleKeyEventInternal=function(e){if(e.keyCode==this.getMnemonic()&&this.performActionInternal(e))return true;else return goog.ui.MenuItem.base(this,"handleKeyEventInternal",e)};goog.ui.MenuItem.prototype.setMnemonic=function(e){this.mnemonicKey_=e};goog.ui.MenuItem.prototype.getMnemonic=function(){return this.mnemonicKey_};goog.ui.registry.setDecoratorByClassName(goog.ui.MenuItemRenderer.CSS_CLASS,(function(){return new goog.ui.MenuItem(null)}));goog.ui.MenuItem.prototype.getPreferredAriaRole=function(){if(this.isSupportedState(goog.ui.Component.State.CHECKED))return goog.a11y.aria.Role.MENU_ITEM_CHECKBOX;if(this.isSupportedState(goog.ui.Component.State.SELECTED))return goog.a11y.aria.Role.MENU_ITEM_RADIO;return goog.ui.MenuItem.base(this,"getPreferredAriaRole")};goog.ui.MenuItem.prototype.getParent=function(){return goog.ui.Control.prototype.getParent.call(this)};goog.ui.MenuItem.prototype.getParentEventTarget=function(){return goog.ui.Control.prototype.getParentEventTarget.call(this)};goog.provide("goog.ui.Separator");goog.require("goog.a11y.aria");goog.require("goog.asserts");goog.require("goog.ui.Component");goog.require("goog.ui.Control");goog.require("goog.ui.MenuSeparatorRenderer");goog.require("goog.ui.registry");goog.ui.Separator=function(e,o){goog.ui.Control.call(this,null,e||goog.ui.MenuSeparatorRenderer.getInstance(),o);this.setSupportedState(goog.ui.Component.State.DISABLED,false);this.setSupportedState(goog.ui.Component.State.HOVER,false);this.setSupportedState(goog.ui.Component.State.ACTIVE,false);this.setSupportedState(goog.ui.Component.State.FOCUSED,false);this.setStateInternal(goog.ui.Component.State.DISABLED)};goog.inherits(goog.ui.Separator,goog.ui.Control);goog.ui.Separator.prototype.enterDocument=function(){goog.ui.Separator.superClass_.enterDocument.call(this);var e=this.getElement();goog.asserts.assert(e,"The DOM element for the separator cannot be null.");goog.a11y.aria.setRole(e,"separator")};goog.ui.registry.setDecoratorByClassName(goog.ui.MenuSeparatorRenderer.CSS_CLASS,(function(){return new goog.ui.Separator}));goog.provide("goog.ui.MenuSeparator");goog.require("goog.ui.MenuSeparatorRenderer");goog.require("goog.ui.Separator");goog.require("goog.ui.registry");goog.ui.MenuSeparator=function(e){goog.ui.Separator.call(this,goog.ui.MenuSeparatorRenderer.getInstance(),e)};goog.inherits(goog.ui.MenuSeparator,goog.ui.Separator);goog.ui.registry.setDecoratorByClassName(goog.ui.MenuSeparatorRenderer.CSS_CLASS,(function(){return new goog.ui.Separator}));goog.provide("goog.ui.PaletteRenderer");goog.require("goog.a11y.aria");goog.require("goog.a11y.aria.Role");goog.require("goog.a11y.aria.State");goog.require("goog.array");goog.require("goog.asserts");goog.require("goog.dom");goog.require("goog.dom.NodeIterator");goog.require("goog.dom.NodeType");goog.require("goog.dom.TagName");goog.require("goog.dom.classlist");goog.require("goog.iter");goog.require("goog.style");goog.require("goog.ui.ControlRenderer");goog.require("goog.userAgent");goog.forwardDeclare("goog.ui.Palette");goog.ui.PaletteRenderer=function(){goog.ui.ControlRenderer.call(this)};goog.inherits(goog.ui.PaletteRenderer,goog.ui.ControlRenderer);goog.addSingletonGetter(goog.ui.PaletteRenderer);goog.ui.PaletteRenderer.cellId_=0;goog.ui.PaletteRenderer.CSS_CLASS=goog.getCssName("goog-palette");goog.ui.PaletteRenderer.prototype.createDom=function(e){var o=this.getClassNames(e);var t=e.getDomHelper().createDom(goog.dom.TagName.DIV,o,this.createGrid(e.getContent(),e.getSize(),e.getDomHelper()));goog.a11y.aria.setRole(t,goog.a11y.aria.Role.GRID);return t};goog.ui.PaletteRenderer.prototype.createGrid=function(e,o,t){var i=[];for(var r=0,n=0;r<o.height;r++){var l=[];for(var s=0;s<o.width;s++){var g=e&&e[n++];l.push(this.createCell(g,t))}i.push(this.createRow(l,t))}return this.createTable(i,t)};goog.ui.PaletteRenderer.prototype.createTable=function(e,o){var t=o.createDom(goog.dom.TagName.TABLE,goog.getCssName(this.getCssClass(),"table"),o.createDom(goog.dom.TagName.TBODY,goog.getCssName(this.getCssClass(),"body"),e));t.cellSpacing="0";t.cellPadding="0";return t};goog.ui.PaletteRenderer.prototype.createRow=function(e,o){var t=o.createDom(goog.dom.TagName.TR,goog.getCssName(this.getCssClass(),"row"),e);goog.a11y.aria.setRole(t,goog.a11y.aria.Role.ROW);return t};goog.ui.PaletteRenderer.prototype.createCell=function(e,o){var t=o.createDom(goog.dom.TagName.TD,{class:goog.getCssName(this.getCssClass(),"cell"),id:goog.getCssName(this.getCssClass(),"cell-")+goog.ui.PaletteRenderer.cellId_++},e);goog.a11y.aria.setRole(t,goog.a11y.aria.Role.GRIDCELL);goog.a11y.aria.setState(t,goog.a11y.aria.State.SELECTED,false);if(!goog.dom.getTextContent(t)&&!goog.a11y.aria.getLabel(t)){var i=this.findAriaLabelForCell_(t);if(i)goog.a11y.aria.setLabel(t,i)}return t};goog.ui.PaletteRenderer.prototype.findAriaLabelForCell_=function(e){var o=new goog.dom.NodeIterator(e);var t="";var i;while(!t&&(i=goog.iter.nextOrValue(o,null)))if(i.nodeType==goog.dom.NodeType.ELEMENT)t=goog.a11y.aria.getLabel(i)||i.title;return t};goog.ui.PaletteRenderer.prototype.canDecorate=function(e){return false};goog.ui.PaletteRenderer.prototype.decorate=function(e,o){return null};goog.ui.PaletteRenderer.prototype.setContent=function(e,o){var t=o;if(e){var i=goog.dom.getElementsByTagNameAndClass(goog.dom.TagName.TBODY,goog.getCssName(this.getCssClass(),"body"),e)[0];if(i){var r=0;goog.array.forEach(i.rows,(function(e){goog.array.forEach(e.cells,(function(e){goog.dom.removeChildren(e);if(t){var o=t[r++];if(o)goog.dom.appendChild(e,o)}}))}));if(r<t.length){var n=[];var l=goog.dom.getDomHelper(e);var s=i.rows[0].cells.length;while(r<t.length){var g=t[r++];n.push(this.createCell(g,l));if(n.length==s){var a=this.createRow(n,l);goog.dom.appendChild(i,a);n.length=0}}if(n.length>0){while(n.length<s)n.push(this.createCell("",l));var a=this.createRow(n,l);goog.dom.appendChild(i,a)}}}goog.style.setUnselectable(e,true,goog.userAgent.GECKO)}};goog.ui.PaletteRenderer.prototype.getContainingItem=function(e,o){var t=e.getElement();while(o&&o.nodeType==goog.dom.NodeType.ELEMENT&&o!=t){if(o.tagName==goog.dom.TagName.TD&&goog.dom.classlist.contains(o,goog.getCssName(this.getCssClass(),"cell")))return o.firstChild;o=o.parentNode}return null};goog.ui.PaletteRenderer.prototype.highlightCell=function(e,o,t){if(o){var i=this.getCellForItem(o);goog.asserts.assert(i);goog.dom.classlist.enable(i,goog.getCssName(this.getCssClass(),"cell-hover"),t);if(t)goog.a11y.aria.setState(e.getElementStrict(),goog.a11y.aria.State.ACTIVEDESCENDANT,i.id);else if(i.id==goog.a11y.aria.getState(e.getElementStrict(),goog.a11y.aria.State.ACTIVEDESCENDANT))goog.a11y.aria.removeState(e.getElementStrict(),goog.a11y.aria.State.ACTIVEDESCENDANT)}};goog.ui.PaletteRenderer.prototype.getCellForItem=function(e){return e?e.parentNode:null};goog.ui.PaletteRenderer.prototype.selectCell=function(e,o,t){if(o){var i=o.parentNode;goog.dom.classlist.enable(i,goog.getCssName(this.getCssClass(),"cell-selected"),t);goog.a11y.aria.setState(i,goog.a11y.aria.State.SELECTED,t)}};goog.ui.PaletteRenderer.prototype.getCssClass=function(){return goog.ui.PaletteRenderer.CSS_CLASS};goog.provide("goog.ui.RangeModel");goog.require("goog.events.EventTarget");goog.require("goog.ui.Component");goog.ui.RangeModel=function(){goog.events.EventTarget.call(this)};goog.inherits(goog.ui.RangeModel,goog.events.EventTarget);goog.tagUnsealableClass(goog.ui.RangeModel);goog.ui.RangeModel.prototype.value_=0;goog.ui.RangeModel.prototype.minimum_=0;goog.ui.RangeModel.prototype.maximum_=100;goog.ui.RangeModel.prototype.extent_=0;goog.ui.RangeModel.prototype.step_=1;goog.ui.RangeModel.prototype.isChanging_=false;goog.ui.RangeModel.prototype.mute_=false;goog.ui.RangeModel.prototype.setMute=function(e){this.mute_=e};goog.ui.RangeModel.prototype.setValue=function(e){e=this.roundToStepWithMin(e);if(this.value_!=e){if(e+this.extent_>this.maximum_)this.value_=this.maximum_-this.extent_;else if(e<this.minimum_)this.value_=this.minimum_;else this.value_=e;if(!this.isChanging_&&!this.mute_)this.dispatchEvent(goog.ui.Component.EventType.CHANGE)}};goog.ui.RangeModel.prototype.getValue=function(){return this.roundToStepWithMin(this.value_)};goog.ui.RangeModel.prototype.setExtent=function(e){e=this.roundToStepWithMin(e);if(this.extent_!=e){if(e<0)this.extent_=0;else if(this.value_+e>this.maximum_)this.extent_=this.maximum_-this.value_;else this.extent_=e;if(!this.isChanging_&&!this.mute_)this.dispatchEvent(goog.ui.Component.EventType.CHANGE)}};goog.ui.RangeModel.prototype.getExtent=function(){return this.roundToStep(this.extent_)};goog.ui.RangeModel.prototype.setMinimum=function(e){if(this.minimum_!=e){var o=this.isChanging_;this.isChanging_=true;this.minimum_=e;if(e+this.extent_>this.maximum_)this.extent_=this.maximum_-this.minimum_;if(e>this.value_)this.setValue(e);if(e>this.maximum_){this.extent_=0;this.setMaximum(e);this.setValue(e)}this.isChanging_=o;if(!this.isChanging_&&!this.mute_)this.dispatchEvent(goog.ui.Component.EventType.CHANGE)}};goog.ui.RangeModel.prototype.getMinimum=function(){return this.roundToStepWithMin(this.minimum_)};goog.ui.RangeModel.prototype.setMaximum=function(e){e=this.roundToStepWithMin(e);if(this.maximum_!=e){var o=this.isChanging_;this.isChanging_=true;this.maximum_=e;if(e<this.value_+this.extent_)this.setValue(e-this.extent_);if(e<this.minimum_){this.extent_=0;this.setMinimum(e);this.setValue(this.maximum_)}if(e<this.minimum_+this.extent_)this.extent_=this.maximum_-this.minimum_;this.isChanging_=o;if(!this.isChanging_&&!this.mute_)this.dispatchEvent(goog.ui.Component.EventType.CHANGE)}};goog.ui.RangeModel.prototype.getMaximum=function(){return this.roundToStepWithMin(this.maximum_)};goog.ui.RangeModel.prototype.getStep=function(){return this.step_};goog.ui.RangeModel.prototype.setStep=function(e){if(this.step_!=e){this.step_=e;var o=this.isChanging_;this.isChanging_=true;this.setMaximum(this.getMaximum());this.setExtent(this.getExtent());this.setValue(this.getValue());this.isChanging_=o;if(!this.isChanging_&&!this.mute_)this.dispatchEvent(goog.ui.Component.EventType.CHANGE)}};goog.ui.RangeModel.prototype.roundToStepWithMin=function(e){if(null==this.step_)return e;return this.minimum_+Math.round((e-this.minimum_)/this.step_)*this.step_};goog.ui.RangeModel.prototype.roundToStep=function(e){if(null==this.step_)return e;return Math.round(e/this.step_)*this.step_};goog.provide("goog.ui.SelectionModel");goog.require("goog.array");goog.require("goog.events.EventTarget");goog.require("goog.events.EventType");goog.ui.SelectionModel=function(e){goog.events.EventTarget.call(this);this.items_=[];this.addItems(e)};goog.inherits(goog.ui.SelectionModel,goog.events.EventTarget);goog.tagUnsealableClass(goog.ui.SelectionModel);goog.ui.SelectionModel.prototype.selectedItem_=null;goog.ui.SelectionModel.prototype.selectionHandler_=null;goog.ui.SelectionModel.prototype.getSelectionHandler=function(){return this.selectionHandler_};goog.ui.SelectionModel.prototype.setSelectionHandler=function(e){this.selectionHandler_=e};goog.ui.SelectionModel.prototype.getItemCount=function(){return this.items_.length};goog.ui.SelectionModel.prototype.indexOfItem=function(e){return e?goog.array.indexOf(this.items_,e):-1};goog.ui.SelectionModel.prototype.getFirst=function(){return this.items_[0]};goog.ui.SelectionModel.prototype.getLast=function(){return this.items_[this.items_.length-1]};goog.ui.SelectionModel.prototype.getItemAt=function(e){return this.items_[e]||null};goog.ui.SelectionModel.prototype.addItems=function(e){if(e){goog.array.forEach(e,(function(e){this.selectItem_(e,false)}),this);goog.array.extend(this.items_,e)}};goog.ui.SelectionModel.prototype.addItem=function(e){this.addItemAt(e,this.getItemCount())};goog.ui.SelectionModel.prototype.addItemAt=function(e,o){if(e){this.selectItem_(e,false);goog.array.insertAt(this.items_,e,o)}};goog.ui.SelectionModel.prototype.removeItem=function(e){if(e&&goog.array.remove(this.items_,e))if(e==this.selectedItem_){this.selectedItem_=null;this.dispatchEvent(goog.events.EventType.SELECT)}};goog.ui.SelectionModel.prototype.removeItemAt=function(e){this.removeItem(this.getItemAt(e))};goog.ui.SelectionModel.prototype.getSelectedItem=function(){return this.selectedItem_};goog.ui.SelectionModel.prototype.getItems=function(){return goog.array.clone(this.items_)};goog.ui.SelectionModel.prototype.setSelectedItem=function(e){if(e!=this.selectedItem_){this.selectItem_(this.selectedItem_,false);this.selectedItem_=e;this.selectItem_(e,true)}this.dispatchEvent(goog.events.EventType.SELECT)};goog.ui.SelectionModel.prototype.getSelectedIndex=function(){return this.indexOfItem(this.selectedItem_)};goog.ui.SelectionModel.prototype.setSelectedIndex=function(e){this.setSelectedItem(this.getItemAt(e))};goog.ui.SelectionModel.prototype.clear=function(){goog.array.clear(this.items_);this.selectedItem_=null};goog.ui.SelectionModel.prototype.disposeInternal=function(){goog.ui.SelectionModel.superClass_.disposeInternal.call(this);delete this.items_;this.selectedItem_=null};goog.ui.SelectionModel.prototype.selectItem_=function(e,o){if(e)if("function"==typeof this.selectionHandler_)this.selectionHandler_(e,o);else if("function"==typeof e.setSelected)e.setSelected(o)};goog.provide("goog.ui.SliderBase");goog.provide("goog.ui.SliderBase.AnimationFactory");goog.provide("goog.ui.SliderBase.Orientation");goog.require("goog.Timer");goog.require("goog.a11y.aria");goog.require("goog.a11y.aria.Role");goog.require("goog.a11y.aria.State");goog.require("goog.array");goog.require("goog.asserts");goog.require("goog.dom");goog.require("goog.dom.TagName");goog.require("goog.dom.classlist");goog.require("goog.events");goog.require("goog.events.EventType");goog.require("goog.events.KeyCodes");goog.require("goog.events.KeyHandler");goog.require("goog.events.MouseWheelHandler");goog.require("goog.functions");goog.require("goog.fx.AnimationParallelQueue");goog.require("goog.fx.Dragger");goog.require("goog.fx.Transition");goog.require("goog.fx.dom.ResizeHeight");goog.require("goog.fx.dom.ResizeWidth");goog.require("goog.fx.dom.Slide");goog.require("goog.math");goog.require("goog.math.Coordinate");goog.require("goog.style");goog.require("goog.style.bidi");goog.require("goog.ui.Component");goog.require("goog.ui.RangeModel");goog.ui.SliderBase=function(e,o){goog.ui.Component.call(this,e);this.additionalAnimations_=null;this.rangeModel=new goog.ui.RangeModel;this.labelFn_=o||goog.functions.NULL;goog.events.listen(this.rangeModel,goog.ui.Component.EventType.CHANGE,this.handleRangeModelChange,false,this)};goog.inherits(goog.ui.SliderBase,goog.ui.Component);goog.tagUnsealableClass(goog.ui.SliderBase);goog.ui.SliderBase.EventType={DRAG_VALUE_START:goog.events.getUniqueId("dragvaluestart"),DRAG_VALUE_END:goog.events.getUniqueId("dragvalueend"),DRAG_EXTENT_START:goog.events.getUniqueId("dragextentstart"),DRAG_EXTENT_END:goog.events.getUniqueId("dragextentend"),DRAG_START:goog.events.getUniqueId("dragstart"),DRAG_END:goog.events.getUniqueId("dragend"),ANIMATION_END:goog.events.getUniqueId("animationend")};goog.ui.SliderBase.Orientation={VERTICAL:"vertical",HORIZONTAL:"horizontal"};goog.ui.SliderBase.prototype.orientation_=goog.ui.SliderBase.Orientation.HORIZONTAL;goog.ui.SliderBase.prototype.currentAnimation_;goog.ui.SliderBase.prototype.incTimer_;goog.ui.SliderBase.prototype.incrementing_;goog.ui.SliderBase.prototype.lastMousePosition_;goog.ui.SliderBase.MOUSE_DOWN_INCREMENT_INTERVAL_=200;goog.ui.SliderBase.ANIMATION_INTERVAL_=100;goog.ui.SliderBase.prototype.valueThumb;goog.ui.SliderBase.prototype.extentThumb;goog.ui.SliderBase.prototype.rangeHighlight;goog.ui.SliderBase.prototype.thumbToMove_;goog.ui.SliderBase.prototype.keyHandler_;goog.ui.SliderBase.prototype.mouseWheelHandler_;goog.ui.SliderBase.prototype.valueDragger_;goog.ui.SliderBase.prototype.extentDragger_;goog.ui.SliderBase.prototype.isAnimating_=false;goog.ui.SliderBase.prototype.moveToPointEnabled_=false;goog.ui.SliderBase.prototype.blockIncrement_=10;goog.ui.SliderBase.prototype.minExtent_=0;goog.ui.SliderBase.prototype.isHandleMouseWheel_=true;goog.ui.SliderBase.prototype.mouseDownTime_=0;goog.ui.SliderBase.prototype.MOUSE_DOWN_DELAY_=1e3;goog.ui.SliderBase.prototype.enabled_=true;goog.ui.SliderBase.prototype.flipForRtl_=false;goog.ui.SliderBase.prototype.enableFlipForRtl=function(e){this.flipForRtl_=e};goog.ui.SliderBase.prototype.getCssClass=goog.abstractMethod;goog.ui.SliderBase.prototype.createDom=function(){goog.ui.SliderBase.superClass_.createDom.call(this);var e=this.getDomHelper().createDom(goog.dom.TagName.DIV,this.getCssClass(this.orientation_));this.decorateInternal(e)};goog.ui.SliderBase.prototype.createThumbs=goog.abstractMethod;goog.ui.SliderBase.SLIDER_DRAGGING_CSS_CLASS_=goog.getCssName("goog-slider-dragging");goog.ui.SliderBase.THUMB_DRAGGING_CSS_CLASS_=goog.getCssName("goog-slider-thumb-dragging");goog.ui.SliderBase.DISABLED_CSS_CLASS_=goog.getCssName("goog-slider-disabled");goog.ui.SliderBase.prototype.decorateInternal=function(e){goog.ui.SliderBase.superClass_.decorateInternal.call(this,e);goog.asserts.assert(e);goog.dom.classlist.add(e,this.getCssClass(this.orientation_));this.createThumbs();this.setAriaRoles()};goog.ui.SliderBase.prototype.enterDocument=function(){goog.ui.SliderBase.superClass_.enterDocument.call(this);this.valueDragger_=new goog.fx.Dragger(this.valueThumb);this.extentDragger_=new goog.fx.Dragger(this.extentThumb);this.valueDragger_.enableRightPositioningForRtl(this.flipForRtl_);this.extentDragger_.enableRightPositioningForRtl(this.flipForRtl_);this.valueDragger_.defaultAction=this.extentDragger_.defaultAction=goog.nullFunction;this.keyHandler_=new goog.events.KeyHandler(this.getElement());this.enableEventHandlers_(true);this.getElement().tabIndex=0;this.updateUi_()};goog.ui.SliderBase.prototype.enableEventHandlers_=function(e){if(e){this.getHandler().listen(this.valueDragger_,goog.fx.Dragger.EventType.BEFOREDRAG,this.handleBeforeDrag_).listen(this.extentDragger_,goog.fx.Dragger.EventType.BEFOREDRAG,this.handleBeforeDrag_).listen(this.valueDragger_,[goog.fx.Dragger.EventType.START,goog.fx.Dragger.EventType.END],this.handleThumbDragStartEnd_).listen(this.extentDragger_,[goog.fx.Dragger.EventType.START,goog.fx.Dragger.EventType.END],this.handleThumbDragStartEnd_).listen(this.keyHandler_,goog.events.KeyHandler.EventType.KEY,this.handleKeyDown_).listen(this.getElement(),goog.events.EventType.CLICK,this.handleMouseDownAndClick_).listen(this.getElement(),goog.events.EventType.MOUSEDOWN,this.handleMouseDownAndClick_);if(this.isHandleMouseWheel())this.enableMouseWheelHandling_(true)}else{this.getHandler().unlisten(this.valueDragger_,goog.fx.Dragger.EventType.BEFOREDRAG,this.handleBeforeDrag_).unlisten(this.extentDragger_,goog.fx.Dragger.EventType.BEFOREDRAG,this.handleBeforeDrag_).unlisten(this.valueDragger_,[goog.fx.Dragger.EventType.START,goog.fx.Dragger.EventType.END],this.handleThumbDragStartEnd_).unlisten(this.extentDragger_,[goog.fx.Dragger.EventType.START,goog.fx.Dragger.EventType.END],this.handleThumbDragStartEnd_).unlisten(this.keyHandler_,goog.events.KeyHandler.EventType.KEY,this.handleKeyDown_).unlisten(this.getElement(),goog.events.EventType.CLICK,this.handleMouseDownAndClick_).unlisten(this.getElement(),goog.events.EventType.MOUSEDOWN,this.handleMouseDownAndClick_);if(this.isHandleMouseWheel())this.enableMouseWheelHandling_(false)}};goog.ui.SliderBase.prototype.exitDocument=function(){goog.ui.SliderBase.base(this,"exitDocument");goog.disposeAll(this.valueDragger_,this.extentDragger_,this.keyHandler_,this.mouseWheelHandler_)};goog.ui.SliderBase.prototype.handleBeforeDrag_=function(e){var o=e.dragger==this.valueDragger_?this.valueThumb:this.extentThumb;var t;if(this.orientation_==goog.ui.SliderBase.Orientation.VERTICAL){var i=this.getElement().clientHeight-o.offsetHeight;t=(i-e.top)/i*(this.getMaximum()-this.getMinimum())+this.getMinimum()}else{var r=this.getElement().clientWidth-o.offsetWidth;t=e.left/r*(this.getMaximum()-this.getMinimum())+this.getMinimum()}if(e.dragger==this.valueDragger_)t=Math.min(Math.max(t,this.getMinimum()),this.getValue()+this.getExtent());else t=Math.min(Math.max(t,this.getValue()),this.getMaximum());this.setThumbPosition_(o,t)};goog.ui.SliderBase.prototype.handleThumbDragStartEnd_=function(e){var o=e.type==goog.fx.Dragger.EventType.START;goog.dom.classlist.enable(goog.asserts.assertElement(this.getElement()),goog.ui.SliderBase.SLIDER_DRAGGING_CSS_CLASS_,o);goog.dom.classlist.enable(goog.asserts.assertElement(e.target.handle),goog.ui.SliderBase.THUMB_DRAGGING_CSS_CLASS_,o);var t=e.dragger==this.valueDragger_;if(o){this.dispatchEvent(goog.ui.SliderBase.EventType.DRAG_START);this.dispatchEvent(t?goog.ui.SliderBase.EventType.DRAG_VALUE_START:goog.ui.SliderBase.EventType.DRAG_EXTENT_START)}else{this.dispatchEvent(goog.ui.SliderBase.EventType.DRAG_END);this.dispatchEvent(t?goog.ui.SliderBase.EventType.DRAG_VALUE_END:goog.ui.SliderBase.EventType.DRAG_EXTENT_END)}};goog.ui.SliderBase.prototype.handleKeyDown_=function(e){var o=true;switch(e.keyCode){case goog.events.KeyCodes.HOME:this.animatedSetValue(this.getMinimum());break;case goog.events.KeyCodes.END:this.animatedSetValue(this.getMaximum());break;case goog.events.KeyCodes.PAGE_UP:this.moveThumbs(this.getBlockIncrement());break;case goog.events.KeyCodes.PAGE_DOWN:this.moveThumbs(-this.getBlockIncrement());break;case goog.events.KeyCodes.LEFT:var t=this.flipForRtl_&&this.isRightToLeft()?1:-1;this.moveThumbs(e.shiftKey?t*this.getBlockIncrement():t*this.getUnitIncrement());break;case goog.events.KeyCodes.DOWN:this.moveThumbs(e.shiftKey?-this.getBlockIncrement():-this.getUnitIncrement());break;case goog.events.KeyCodes.RIGHT:var t=this.flipForRtl_&&this.isRightToLeft()?-1:1;this.moveThumbs(e.shiftKey?t*this.getBlockIncrement():t*this.getUnitIncrement());break;case goog.events.KeyCodes.UP:this.moveThumbs(e.shiftKey?this.getBlockIncrement():this.getUnitIncrement());break;default:o=false}if(o)e.preventDefault()};goog.ui.SliderBase.prototype.handleMouseDownAndClick_=function(e){if(this.getElement().focus)this.getElement().focus();var o=e.target;if(!goog.dom.contains(this.valueThumb,o)&&!goog.dom.contains(this.extentThumb,o)){var t=e.type==goog.events.EventType.CLICK;if(t&&goog.now()<this.mouseDownTime_+this.MOUSE_DOWN_DELAY_)return;if(!t)this.mouseDownTime_=goog.now();if(this.moveToPointEnabled_)this.animatedSetValue(this.getValueFromMousePosition(e));else this.startBlockIncrementing_(e)}};goog.ui.SliderBase.prototype.handleMouseWheel_=function(e){var o=e.detail>0?-1:1;this.moveThumbs(o*this.getUnitIncrement());e.preventDefault()};goog.ui.SliderBase.prototype.startBlockIncrementing_=function(e){this.storeMousePos_(e);this.thumbToMove_=this.getClosestThumb_(this.getValueFromMousePosition(e));if(this.orientation_==goog.ui.SliderBase.Orientation.VERTICAL)this.incrementing_=this.lastMousePosition_<this.thumbToMove_.offsetTop;else this.incrementing_=this.lastMousePosition_>this.getOffsetStart_(this.thumbToMove_)+this.thumbToMove_.offsetWidth;var o=goog.dom.getOwnerDocument(this.getElement());this.getHandler().listen(o,goog.events.EventType.MOUSEUP,this.stopBlockIncrementing_,true).listen(this.getElement(),goog.events.EventType.MOUSEMOVE,this.storeMousePos_);if(!this.incTimer_){this.incTimer_=new goog.Timer(goog.ui.SliderBase.MOUSE_DOWN_INCREMENT_INTERVAL_);this.getHandler().listen(this.incTimer_,goog.Timer.TICK,this.handleTimerTick_)}this.handleTimerTick_();this.incTimer_.start()};goog.ui.SliderBase.prototype.handleTimerTick_=function(){var e;if(this.orientation_==goog.ui.SliderBase.Orientation.VERTICAL){var o=this.lastMousePosition_;var t=this.thumbToMove_.offsetTop;if(this.incrementing_){if(o<t)e=this.getThumbPosition_(this.thumbToMove_)+this.getBlockIncrement()}else{var i=this.thumbToMove_.offsetHeight;if(o>t+i)e=this.getThumbPosition_(this.thumbToMove_)-this.getBlockIncrement()}}else{var r=this.lastMousePosition_;var n=this.getOffsetStart_(this.thumbToMove_);if(this.incrementing_){var l=this.thumbToMove_.offsetWidth;if(r>n+l)e=this.getThumbPosition_(this.thumbToMove_)+this.getBlockIncrement()}else if(r<n)e=this.getThumbPosition_(this.thumbToMove_)-this.getBlockIncrement()}if(goog.isDef(e))this.setThumbPosition_(this.thumbToMove_,e)};goog.ui.SliderBase.prototype.stopBlockIncrementing_=function(){if(this.incTimer_)this.incTimer_.stop();var e=goog.dom.getOwnerDocument(this.getElement());this.getHandler().unlisten(e,goog.events.EventType.MOUSEUP,this.stopBlockIncrementing_,true).unlisten(this.getElement(),goog.events.EventType.MOUSEMOVE,this.storeMousePos_)};goog.ui.SliderBase.prototype.getRelativeMousePos_=function(e){var o=goog.style.getRelativePosition(e,this.getElement());if(this.orientation_==goog.ui.SliderBase.Orientation.VERTICAL)return o.y;else if(this.flipForRtl_&&this.isRightToLeft())return this.getElement().clientWidth-o.x;else return o.x};goog.ui.SliderBase.prototype.storeMousePos_=function(e){this.lastMousePosition_=this.getRelativeMousePos_(e)};goog.ui.SliderBase.prototype.getValueFromMousePosition=function(e){var o=this.getMinimum();var t=this.getMaximum();if(this.orientation_==goog.ui.SliderBase.Orientation.VERTICAL){var i=this.valueThumb.offsetHeight;var r=this.getElement().clientHeight-i;var n=this.getRelativeMousePos_(e)-i/2;return(t-o)*(r-n)/r+o}else{var l=this.valueThumb.offsetWidth;var s=this.getElement().clientWidth-l;var g=this.getRelativeMousePos_(e)-l/2;return(t-o)*g/s+o}};goog.ui.SliderBase.prototype.getThumbPosition_=function(e){if(e==this.valueThumb)return this.rangeModel.getValue();else if(e==this.extentThumb)return this.rangeModel.getValue()+this.rangeModel.getExtent();else throw new Error("Illegal thumb element. Neither minThumb nor maxThumb")};goog.ui.SliderBase.prototype.isDragging=function(){return this.valueDragger_.isDragging()||this.extentDragger_.isDragging()};goog.ui.SliderBase.prototype.moveThumbs=function(e){if(Math.abs(e)<this.getStep())e=goog.math.sign(e)*this.getStep();var o=this.getThumbPosition_(this.valueThumb)+e;var t=this.getThumbPosition_(this.extentThumb)+e;o=goog.math.clamp(o,this.getMinimum(),this.getMaximum()-this.minExtent_);t=goog.math.clamp(t,this.getMinimum()+this.minExtent_,this.getMaximum());this.setValueAndExtent(o,t-o)};goog.ui.SliderBase.prototype.setThumbPosition_=function(e,o){var t=this.rangeModel.roundToStepWithMin(o);var i=e==this.valueThumb?t:this.rangeModel.getValue();var r=e==this.extentThumb?t:this.rangeModel.getValue()+this.rangeModel.getExtent();if(i>=this.getMinimum()&&r>=i+this.minExtent_&&this.getMaximum()>=r)this.setValueAndExtent(i,r-i)};goog.ui.SliderBase.prototype.setValueAndExtent=function(e,o){if(this.getMinimum()<=e&&e<=this.getMaximum()-o&&this.minExtent_<=o&&o<=this.getMaximum()-e){if(e==this.getValue()&&o==this.getExtent())return;this.rangeModel.setMute(true);this.rangeModel.setExtent(0);this.rangeModel.setValue(e);this.rangeModel.setExtent(o);this.rangeModel.setMute(false);this.handleRangeModelChange(null)}};goog.ui.SliderBase.prototype.getMinimum=function(){return this.rangeModel.getMinimum()};goog.ui.SliderBase.prototype.setMinimum=function(e){this.rangeModel.setMinimum(e)};goog.ui.SliderBase.prototype.getMaximum=function(){return this.rangeModel.getMaximum()};goog.ui.SliderBase.prototype.setMaximum=function(e){this.rangeModel.setMaximum(e)};goog.ui.SliderBase.prototype.getValueThumb=function(){return this.valueThumb};goog.ui.SliderBase.prototype.getExtentThumb=function(){return this.extentThumb};goog.ui.SliderBase.prototype.getClosestThumb_=function(e){if(e<=this.rangeModel.getValue()+this.rangeModel.getExtent()/2)return this.valueThumb;else return this.extentThumb};goog.ui.SliderBase.prototype.handleRangeModelChange=function(e){this.updateUi_();this.updateAriaStates();this.dispatchEvent(goog.ui.Component.EventType.CHANGE)};goog.ui.SliderBase.prototype.updateUi_=function(){if(this.valueThumb&&!this.isAnimating_){var e=this.getThumbCoordinateForValue(this.getThumbPosition_(this.valueThumb));var o=this.getThumbCoordinateForValue(this.getThumbPosition_(this.extentThumb));if(this.orientation_==goog.ui.SliderBase.Orientation.VERTICAL){this.valueThumb.style.top=e.y+"px";this.extentThumb.style.top=o.y+"px";if(this.rangeHighlight){var t=this.calculateRangeHighlightPositioning_(o.y,e.y,this.valueThumb.offsetHeight);this.rangeHighlight.style.top=t.offset+"px";this.rangeHighlight.style.height=t.size+"px"}}else{var i=this.flipForRtl_&&this.isRightToLeft()?"right":"left";this.valueThumb.style[i]=e.x+"px";this.extentThumb.style[i]=o.x+"px";if(this.rangeHighlight){var t=this.calculateRangeHighlightPositioning_(e.x,o.x,this.valueThumb.offsetWidth);this.rangeHighlight.style[i]=t.offset+"px";this.rangeHighlight.style.width=t.size+"px"}}}};goog.ui.SliderBase.prototype.calculateRangeHighlightPositioning_=function(e,o,t){var i=Math.ceil(t/2);var r=o-e+t-2*i;return{offset:e+i,size:Math.max(r,0)}};goog.ui.SliderBase.prototype.getThumbCoordinateForValue=function(e){var o=new goog.math.Coordinate;if(this.valueThumb){var t=this.getMinimum();var i=this.getMaximum();var r=e==t&&t==i?0:(e-t)/(i-t);if(this.orientation_==goog.ui.SliderBase.Orientation.VERTICAL){var n=this.valueThumb.offsetHeight;var l=this.getElement().clientHeight-n;var s=Math.round(r*l);o.x=this.getOffsetStart_(this.valueThumb);o.y=l-s}else{var g=this.getElement().clientWidth-this.valueThumb.offsetWidth;var a=Math.round(r*g);o.x=a;o.y=this.valueThumb.offsetTop}}return o};goog.ui.SliderBase.prototype.animatedSetValue=function(e){e=goog.math.clamp(e,this.getMinimum(),this.getMaximum());if(this.isAnimating_){this.currentAnimation_.stop(true);this.currentAnimation_.dispose()}var o=new goog.fx.AnimationParallelQueue;var t;var i=this.getClosestThumb_(e);var r=this.getValue();var n=this.getExtent();var l=this.getThumbPosition_(i);var s=this.getThumbCoordinateForValue(l);var g=this.getStep();if(Math.abs(e-l)<g){var a=e>l?g:-g;e=l+a;e=goog.math.clamp(e,this.getMinimum(),this.getMaximum())}this.setThumbPosition_(i,e);var c=this.getThumbCoordinateForValue(this.getThumbPosition_(i));if(this.orientation_==goog.ui.SliderBase.Orientation.VERTICAL)t=[this.getOffsetStart_(i),c.y];else t=[c.x,i.offsetTop];var u=new goog.fx.dom.Slide(i,[s.x,s.y],t,goog.ui.SliderBase.ANIMATION_INTERVAL_);u.enableRightPositioningForRtl(this.flipForRtl_);o.add(u);if(this.rangeHighlight)this.addRangeHighlightAnimations_(i,r,n,c,o);if(this.additionalAnimations_){var h=this.additionalAnimations_.createAnimations(r,e,goog.ui.SliderBase.ANIMATION_INTERVAL_);goog.array.forEach(h,(function(e){o.add(e)}))}this.currentAnimation_=o;this.getHandler().listen(o,goog.fx.Transition.EventType.END,this.endAnimation_);this.isAnimating_=true;o.play(false)};goog.ui.SliderBase.prototype.isAnimating=function(){return this.isAnimating_};goog.ui.SliderBase.prototype.setAdditionalAnimations=function(e){this.additionalAnimations_=e};goog.ui.SliderBase.prototype.addRangeHighlightAnimations_=function(e,o,t,i,r){var n=this.getThumbCoordinateForValue(o);var l=this.getThumbCoordinateForValue(o+t);var s=n;var g=l;if(e==this.valueThumb)s=i;else g=i;if(this.orientation_==goog.ui.SliderBase.Orientation.VERTICAL){var a=this.calculateRangeHighlightPositioning_(l.y,n.y,this.valueThumb.offsetHeight);var c=this.calculateRangeHighlightPositioning_(g.y,s.y,this.valueThumb.offsetHeight);var u=new goog.fx.dom.Slide(this.rangeHighlight,[this.getOffsetStart_(this.rangeHighlight),a.offset],[this.getOffsetStart_(this.rangeHighlight),c.offset],goog.ui.SliderBase.ANIMATION_INTERVAL_);var h=new goog.fx.dom.ResizeHeight(this.rangeHighlight,a.size,c.size,goog.ui.SliderBase.ANIMATION_INTERVAL_);u.enableRightPositioningForRtl(this.flipForRtl_);h.enableRightPositioningForRtl(this.flipForRtl_);r.add(u);r.add(h)}else{var a=this.calculateRangeHighlightPositioning_(n.x,l.x,this.valueThumb.offsetWidth);var c=this.calculateRangeHighlightPositioning_(s.x,g.x,this.valueThumb.offsetWidth);var u=new goog.fx.dom.Slide(this.rangeHighlight,[a.offset,this.rangeHighlight.offsetTop],[c.offset,this.rangeHighlight.offsetTop],goog.ui.SliderBase.ANIMATION_INTERVAL_);var d=new goog.fx.dom.ResizeWidth(this.rangeHighlight,a.size,c.size,goog.ui.SliderBase.ANIMATION_INTERVAL_);u.enableRightPositioningForRtl(this.flipForRtl_);d.enableRightPositioningForRtl(this.flipForRtl_);r.add(u);r.add(d)}};goog.ui.SliderBase.prototype.endAnimation_=function(e){this.isAnimating_=false;this.dispatchEvent(goog.ui.SliderBase.EventType.ANIMATION_END)};goog.ui.SliderBase.prototype.setOrientation=function(e){if(this.orientation_!=e){var o=this.getCssClass(this.orientation_);var t=this.getCssClass(e);this.orientation_=e;if(this.getElement()){goog.dom.classlist.swap(goog.asserts.assert(this.getElement()),o,t);var i=this.flipForRtl_&&this.isRightToLeft()?"right":"left";this.valueThumb.style[i]=this.valueThumb.style.top="";this.extentThumb.style[i]=this.extentThumb.style.top="";if(this.rangeHighlight){this.rangeHighlight.style[i]=this.rangeHighlight.style.top="";this.rangeHighlight.style.width=this.rangeHighlight.style.height=""}this.updateUi_()}}};goog.ui.SliderBase.prototype.getOrientation=function(){return this.orientation_};goog.ui.SliderBase.prototype.disposeInternal=function(){goog.ui.SliderBase.superClass_.disposeInternal.call(this);if(this.incTimer_)this.incTimer_.dispose();delete this.incTimer_;if(this.currentAnimation_)this.currentAnimation_.dispose();delete this.currentAnimation_;delete this.valueThumb;delete this.extentThumb;if(this.rangeHighlight)delete this.rangeHighlight;this.rangeModel.dispose();delete this.rangeModel;if(this.keyHandler_){this.keyHandler_.dispose();delete this.keyHandler_}if(this.mouseWheelHandler_){this.mouseWheelHandler_.dispose();delete this.mouseWheelHandler_}if(this.valueDragger_){this.valueDragger_.dispose();delete this.valueDragger_}if(this.extentDragger_){this.extentDragger_.dispose();delete this.extentDragger_}};goog.ui.SliderBase.prototype.getBlockIncrement=function(){return this.blockIncrement_};goog.ui.SliderBase.prototype.setBlockIncrement=function(e){this.blockIncrement_=e};goog.ui.SliderBase.prototype.setMinExtent=function(e){this.minExtent_=e};goog.ui.SliderBase.prototype.unitIncrement_=1;goog.ui.SliderBase.prototype.getUnitIncrement=function(){return this.unitIncrement_};goog.ui.SliderBase.prototype.setUnitIncrement=function(e){this.unitIncrement_=e};goog.ui.SliderBase.prototype.getStep=function(){return this.rangeModel.getStep()};goog.ui.SliderBase.prototype.setStep=function(e){this.rangeModel.setStep(e)};goog.ui.SliderBase.prototype.getMoveToPointEnabled=function(){return this.moveToPointEnabled_};goog.ui.SliderBase.prototype.setMoveToPointEnabled=function(e){this.moveToPointEnabled_=e};goog.ui.SliderBase.prototype.getValue=function(){return this.rangeModel.getValue()};goog.ui.SliderBase.prototype.setValue=function(e){this.setThumbPosition_(this.valueThumb,e)};goog.ui.SliderBase.prototype.getExtent=function(){return this.rangeModel.getExtent()};goog.ui.SliderBase.prototype.setExtent=function(e){this.setThumbPosition_(this.extentThumb,this.rangeModel.getValue()+e)};goog.ui.SliderBase.prototype.setVisible=function(e){goog.style.setElementShown(this.getElement(),e);if(e)this.updateUi_()};goog.ui.SliderBase.prototype.setAriaRoles=function(){var e=this.getElement();goog.asserts.assert(e,"The DOM element for the slider base cannot be null.");goog.a11y.aria.setRole(e,goog.a11y.aria.Role.SLIDER);this.updateAriaStates()};goog.ui.SliderBase.prototype.updateAriaStates=function(){var e=this.getElement();if(e){goog.a11y.aria.setState(e,goog.a11y.aria.State.VALUEMIN,this.getMinimum());goog.a11y.aria.setState(e,goog.a11y.aria.State.VALUEMAX,this.getMaximum());goog.a11y.aria.setState(e,goog.a11y.aria.State.VALUENOW,this.getValue());goog.a11y.aria.setState(e,goog.a11y.aria.State.VALUETEXT,this.getTextValue()||"")}};goog.ui.SliderBase.prototype.setHandleMouseWheel=function(e){if(this.isInDocument()&&e!=this.isHandleMouseWheel())this.enableMouseWheelHandling_(e);this.isHandleMouseWheel_=e};goog.ui.SliderBase.prototype.isHandleMouseWheel=function(){return this.isHandleMouseWheel_};goog.ui.SliderBase.prototype.enableMouseWheelHandling_=function(e){if(e){if(!this.mouseWheelHandler_)this.mouseWheelHandler_=new goog.events.MouseWheelHandler(this.getElement());this.getHandler().listen(this.mouseWheelHandler_,goog.events.MouseWheelHandler.EventType.MOUSEWHEEL,this.handleMouseWheel_)}else this.getHandler().unlisten(this.mouseWheelHandler_,goog.events.MouseWheelHandler.EventType.MOUSEWHEEL,this.handleMouseWheel_)};goog.ui.SliderBase.prototype.setEnabled=function(e){if(this.enabled_==e)return;var o=e?goog.ui.Component.EventType.ENABLE:goog.ui.Component.EventType.DISABLE;if(this.dispatchEvent(o)){this.enabled_=e;this.enableEventHandlers_(e);if(!e)this.stopBlockIncrementing_();goog.dom.classlist.enable(goog.asserts.assert(this.getElement()),goog.ui.SliderBase.DISABLED_CSS_CLASS_,!e)}};goog.ui.SliderBase.prototype.isEnabled=function(){return this.enabled_};goog.ui.SliderBase.prototype.getOffsetStart_=function(e){return this.flipForRtl_?goog.style.bidi.getOffsetStart(e):e.offsetLeft};goog.ui.SliderBase.prototype.getTextValue=function(){return this.labelFn_(this.getValue())};goog.ui.SliderBase.AnimationFactory=function(){};goog.ui.SliderBase.AnimationFactory.prototype.createAnimations;goog.provide("goog.ui.Slider");goog.provide("goog.ui.Slider.Orientation");goog.require("goog.a11y.aria");goog.require("goog.a11y.aria.Role");goog.require("goog.dom");goog.require("goog.dom.TagName");goog.require("goog.ui.SliderBase");goog.ui.Slider=function(e,o){goog.ui.SliderBase.call(this,e,o);this.rangeModel.setExtent(0)};goog.inherits(goog.ui.Slider,goog.ui.SliderBase);goog.tagUnsealableClass(goog.ui.Slider);goog.ui.Slider.Orientation=goog.ui.SliderBase.Orientation;goog.ui.Slider.CSS_CLASS_PREFIX=goog.getCssName("goog-slider");goog.ui.Slider.THUMB_CSS_CLASS=goog.getCssName(goog.ui.Slider.CSS_CLASS_PREFIX,"thumb");goog.ui.Slider.prototype.getCssClass=function(e){return e==goog.ui.SliderBase.Orientation.VERTICAL?goog.getCssName(goog.ui.Slider.CSS_CLASS_PREFIX,"vertical"):goog.getCssName(goog.ui.Slider.CSS_CLASS_PREFIX,"horizontal")};goog.ui.Slider.prototype.getThumbCssClass=function(){return goog.ui.Slider.THUMB_CSS_CLASS};goog.ui.Slider.prototype.createThumbs=function(){var e=this.getElement();var o=goog.dom.getElementsByTagNameAndClass(null,this.getThumbCssClass(),e)[0];if(!o){o=this.createThumb_();e.appendChild(o)}this.valueThumb=this.extentThumb=o};goog.ui.Slider.prototype.createThumb_=function(){var e=this.getDomHelper().createDom(goog.dom.TagName.DIV,this.getThumbCssClass());goog.a11y.aria.setRole(e,goog.a11y.aria.Role.BUTTON);return e};goog.provide("goog.ui.tree.BaseNode");goog.provide("goog.ui.tree.BaseNode.EventType");goog.require("goog.Timer");goog.require("goog.a11y.aria");goog.require("goog.a11y.aria.State");goog.require("goog.asserts");goog.require("goog.dom.safe");goog.require("goog.events.Event");goog.require("goog.events.KeyCodes");goog.require("goog.html.SafeHtml");goog.require("goog.html.SafeStyle");goog.require("goog.string");goog.require("goog.string.StringBuffer");goog.require("goog.style");goog.require("goog.ui.Component");goog.forwardDeclare("goog.ui.tree.TreeControl");goog.ui.tree.BaseNode=function(e,o,t){goog.ui.Component.call(this,t);this.config_=o||goog.ui.tree.BaseNode.defaultConfig;this.html_=goog.html.SafeHtml.htmlEscapePreservingNewlines(e);this.iconClass_;this.expandedIconClass_;this.tree;this.previousSibling_;this.nextSibling_;this.firstChild_;this.lastChild_;this.selected_=false;this.expanded_=false;this.toolTip_=null;this.afterLabelHtml_=goog.html.SafeHtml.EMPTY;this.isUserCollapsible_=true;this.depth_=-1};goog.inherits(goog.ui.tree.BaseNode,goog.ui.Component);goog.ui.tree.BaseNode.EventType={BEFORE_EXPAND:"beforeexpand",EXPAND:"expand",BEFORE_COLLAPSE:"beforecollapse",COLLAPSE:"collapse"};goog.ui.tree.BaseNode.allNodes={};goog.ui.tree.BaseNode.prototype.disposeInternal=function(){goog.ui.tree.BaseNode.superClass_.disposeInternal.call(this);if(this.tree){this.tree.removeNode(this);this.tree=null}this.setElementInternal(null)};goog.ui.tree.BaseNode.prototype.initAccessibility=function(){var e=this.getElement();if(e){var o=this.getLabelElement();if(o&&!o.id)o.id=this.getId()+".label";goog.a11y.aria.setRole(e,"treeitem");goog.a11y.aria.setState(e,"selected",false);goog.a11y.aria.setState(e,"level",this.getDepth());if(o)goog.a11y.aria.setState(e,"labelledby",o.id);var t=this.getIconElement();if(t)goog.a11y.aria.setRole(t,"presentation");var i=this.getExpandIconElement();if(i)goog.a11y.aria.setRole(i,"presentation");var r=this.getChildrenElement();if(r){goog.a11y.aria.setRole(r,"group");if(r.hasChildNodes()){goog.a11y.aria.setState(e,goog.a11y.aria.State.EXPANDED,false);var n=this.getChildCount();for(var l=1;l<=n;l++){var s=this.getChildAt(l-1).getElement();goog.asserts.assert(s,"The child element cannot be null");goog.a11y.aria.setState(s,"setsize",n);goog.a11y.aria.setState(s,"posinset",l)}}}}};goog.ui.tree.BaseNode.prototype.createDom=function(){var e=this.getDomHelper().safeHtmlToNode(this.toSafeHtml());this.setElementInternal(e)};goog.ui.tree.BaseNode.prototype.enterDocument=function(){goog.ui.tree.BaseNode.superClass_.enterDocument.call(this);goog.ui.tree.BaseNode.allNodes[this.getId()]=this;this.initAccessibility()};goog.ui.tree.BaseNode.prototype.exitDocument=function(){goog.ui.tree.BaseNode.superClass_.exitDocument.call(this);delete goog.ui.tree.BaseNode.allNodes[this.getId()]};goog.ui.tree.BaseNode.prototype.addChildAt=function(e,o,t){goog.asserts.assert(!e.getParent());goog.asserts.assertInstanceof(e,goog.ui.tree.BaseNode);var i=this.getChildAt(o-1);var r=this.getChildAt(o);goog.ui.tree.BaseNode.superClass_.addChildAt.call(this,e,o);e.previousSibling_=i;e.nextSibling_=r;if(i)i.nextSibling_=e;else this.firstChild_=e;if(r)r.previousSibling_=e;else this.lastChild_=e;var n=this.getTree();if(n)e.setTreeInternal(n);e.setDepth_(this.getDepth()+1);var l=this.getElement();if(l){this.updateExpandIcon();goog.a11y.aria.setState(l,goog.a11y.aria.State.EXPANDED,this.getExpanded());if(this.getExpanded()){var s=this.getChildrenElement();if(!e.getElement())e.createDom();var g=e.getElement();var a=r&&r.getElement();s.insertBefore(g,a);if(this.isInDocument())e.enterDocument();if(!r)if(i)i.updateExpandIcon();else{goog.style.setElementShown(s,true);this.setExpanded(this.getExpanded())}}}};goog.ui.tree.BaseNode.prototype.add=function(e,o){goog.asserts.assert(!o||o.getParent()==this,"Can only add nodes before siblings");if(e.getParent())e.getParent().removeChild(e);this.addChildAt(e,o?this.indexOfChild(o):this.getChildCount());return e};goog.ui.tree.BaseNode.prototype.removeChild=function(e,o){var t=e;var i=this.getTree();var r=i?i.getSelectedItem():null;if(r==t||t.contains(r))if(i.hasFocus()){this.select();goog.Timer.callOnce(this.onTimeoutSelect_,10,this)}else this.select();goog.ui.tree.BaseNode.superClass_.removeChild.call(this,t);if(this.lastChild_==t)this.lastChild_=t.previousSibling_;if(this.firstChild_==t)this.firstChild_=t.nextSibling_;if(t.previousSibling_)t.previousSibling_.nextSibling_=t.nextSibling_;if(t.nextSibling_)t.nextSibling_.previousSibling_=t.previousSibling_;var n=t.isLastSibling();t.tree=null;t.depth_=-1;if(i){i.removeNode(t);if(this.isInDocument()){var l=this.getChildrenElement();if(t.isInDocument()){var s=t.getElement();l.removeChild(s);t.exitDocument()}if(n){var g=this.getLastChild();if(g)g.updateExpandIcon()}if(!this.hasChildren()){l.style.display="none";this.updateExpandIcon();this.updateIcon_();var a=this.getElement();if(a)goog.a11y.aria.removeState(a,goog.a11y.aria.State.EXPANDED)}}}return t};goog.ui.tree.BaseNode.prototype.remove=goog.ui.tree.BaseNode.prototype.removeChild;goog.ui.tree.BaseNode.prototype.onTimeoutSelect_=function(){this.select()};goog.ui.tree.BaseNode.prototype.getTree=goog.abstractMethod;goog.ui.tree.BaseNode.prototype.getDepth=function(){var e=this.depth_;if(e<0){e=this.computeDepth_();this.setDepth_(e)}return e};goog.ui.tree.BaseNode.prototype.computeDepth_=function(){var e=this.getParent();if(e)return e.getDepth()+1;else return 0};goog.ui.tree.BaseNode.prototype.setDepth_=function(e){if(e!=this.depth_){this.depth_=e;var o=this.getRowElement();if(o){var t=this.getPixelIndent_()+"px";if(this.isRightToLeft())o.style.paddingRight=t;else o.style.paddingLeft=t}this.forEachChild((function(o){o.setDepth_(e+1)}))}};goog.ui.tree.BaseNode.prototype.contains=function(e){var o=e;while(o){if(o==this)return true;o=o.getParent()}return false};goog.ui.tree.BaseNode.EMPTY_CHILDREN_=[];goog.ui.tree.BaseNode.prototype.getChildAt;goog.ui.tree.BaseNode.prototype.getChildren=function(){var e=[];this.forEachChild((function(o){e.push(o)}));return e};goog.ui.tree.BaseNode.prototype.getFirstChild=function(){return this.getChildAt(0)};goog.ui.tree.BaseNode.prototype.getLastChild=function(){return this.getChildAt(this.getChildCount()-1)};goog.ui.tree.BaseNode.prototype.getPreviousSibling=function(){return this.previousSibling_};goog.ui.tree.BaseNode.prototype.getNextSibling=function(){return this.nextSibling_};goog.ui.tree.BaseNode.prototype.isLastSibling=function(){return!this.nextSibling_};goog.ui.tree.BaseNode.prototype.isSelected=function(){return this.selected_};goog.ui.tree.BaseNode.prototype.select=function(){var e=this.getTree();if(e)e.setSelectedItem(this)};goog.ui.tree.BaseNode.prototype.deselect=goog.nullFunction;goog.ui.tree.BaseNode.prototype.setSelectedInternal=function(e){if(this.selected_==e)return;this.selected_=e;this.updateRow();var o=this.getElement();if(o){goog.a11y.aria.setState(o,"selected",e);if(e){var t=this.getTree().getElement();goog.asserts.assert(t,"The DOM element for the tree cannot be null");goog.a11y.aria.setState(t,"activedescendant",this.getId())}}};goog.ui.tree.BaseNode.prototype.getExpanded=function(){return this.expanded_};goog.ui.tree.BaseNode.prototype.setExpandedInternal=function(e){this.expanded_=e};goog.ui.tree.BaseNode.prototype.setExpanded=function(e){var o=e!=this.expanded_;if(o){var t=!this.dispatchEvent(e?goog.ui.tree.BaseNode.EventType.BEFORE_EXPAND:goog.ui.tree.BaseNode.EventType.BEFORE_COLLAPSE);if(t)return}var i;this.expanded_=e;var r=this.getTree();var n=this.getElement();if(this.hasChildren()){if(!e&&r&&this.contains(r.getSelectedItem()))this.select();if(n){i=this.getChildrenElement();if(i){goog.style.setElementShown(i,e);goog.a11y.aria.setState(n,goog.a11y.aria.State.EXPANDED,e);if(e&&this.isInDocument()&&!i.hasChildNodes()){var l=[];this.forEachChild((function(e){l.push(e.toSafeHtml())}));goog.dom.safe.setInnerHtml(i,goog.html.SafeHtml.concat(l));this.forEachChild((function(e){e.enterDocument()}))}}this.updateExpandIcon()}}else{i=this.getChildrenElement();if(i)goog.style.setElementShown(i,false)}if(n)this.updateIcon_();if(o)this.dispatchEvent(e?goog.ui.tree.BaseNode.EventType.EXPAND:goog.ui.tree.BaseNode.EventType.COLLAPSE)};goog.ui.tree.BaseNode.prototype.toggle=function(){this.setExpanded(!this.getExpanded())};goog.ui.tree.BaseNode.prototype.expand=function(){this.setExpanded(true)};goog.ui.tree.BaseNode.prototype.collapse=function(){this.setExpanded(false)};goog.ui.tree.BaseNode.prototype.collapseChildren=function(){this.forEachChild((function(e){e.collapseAll()}))};goog.ui.tree.BaseNode.prototype.collapseAll=function(){this.collapseChildren();this.collapse()};goog.ui.tree.BaseNode.prototype.expandChildren=function(){this.forEachChild((function(e){e.expandAll()}))};goog.ui.tree.BaseNode.prototype.expandAll=function(){this.expandChildren();this.expand()};goog.ui.tree.BaseNode.prototype.reveal=function(){var e=this.getParent();if(e){e.setExpanded(true);e.reveal()}};goog.ui.tree.BaseNode.prototype.setIsUserCollapsible=function(e){this.isUserCollapsible_=e;if(!this.isUserCollapsible_)this.expand();if(this.getElement())this.updateExpandIcon()};goog.ui.tree.BaseNode.prototype.isUserCollapsible=function(){return this.isUserCollapsible_};goog.ui.tree.BaseNode.prototype.toSafeHtml=function(){var e=this.getTree();var o=!e.getShowLines()||e==this.getParent()&&!e.getShowRootLines();var t=o?this.config_.cssChildrenNoLines:this.config_.cssChildren;var i=this.getExpanded()&&this.hasChildren();var r={class:t,style:this.getLineStyle()};var n=[];if(i)this.forEachChild((function(e){n.push(e.toSafeHtml())}));var l=goog.html.SafeHtml.create("div",r,n);return goog.html.SafeHtml.create("div",{class:this.config_.cssItem,id:this.getId()},[this.getRowSafeHtml(),l])};goog.ui.tree.BaseNode.prototype.getPixelIndent_=function(){return Math.max(0,(this.getDepth()-1)*this.config_.indentWidth)};goog.ui.tree.BaseNode.prototype.getRowSafeHtml=function(){var e={};e["padding-"+(this.isRightToLeft()?"right":"left")]=this.getPixelIndent_()+"px";var o={class:this.getRowClassName(),style:e};var t=[this.getExpandIconSafeHtml(),this.getIconSafeHtml(),this.getLabelSafeHtml()];return goog.html.SafeHtml.create("div",o,t)};goog.ui.tree.BaseNode.prototype.getRowClassName=function(){var e;if(this.isSelected())e=" "+this.config_.cssSelectedRow;else e="";return this.config_.cssTreeRow+e};goog.ui.tree.BaseNode.prototype.getLabelSafeHtml=function(){var e=goog.html.SafeHtml.create("span",{class:this.config_.cssItemLabel,title:this.getToolTip()||null},this.getSafeHtml());return goog.html.SafeHtml.concat(e,goog.html.SafeHtml.create("span",{},this.getAfterLabelSafeHtml()))};goog.ui.tree.BaseNode.prototype.getAfterLabelHtml=function(){return goog.html.SafeHtml.unwrap(this.getAfterLabelSafeHtml())};goog.ui.tree.BaseNode.prototype.getAfterLabelSafeHtml=function(){return this.afterLabelHtml_};goog.ui.tree.BaseNode.prototype.setAfterLabelSafeHtml=function(e){this.afterLabelHtml_=e;var o=this.getAfterLabelElement();if(o)goog.dom.safe.setInnerHtml(o,e)};goog.ui.tree.BaseNode.prototype.getIconSafeHtml=function(){return goog.html.SafeHtml.create("span",{style:{display:"inline-block"},class:this.getCalculatedIconClass()})};goog.ui.tree.BaseNode.prototype.getCalculatedIconClass=goog.abstractMethod;goog.ui.tree.BaseNode.prototype.getExpandIconSafeHtml=function(){return goog.html.SafeHtml.create("span",{type:"expand",style:{display:"inline-block"},class:this.getExpandIconClass()})};goog.ui.tree.BaseNode.prototype.getExpandIconClass=function(){var e=this.getTree();var o=!e.getShowLines()||e==this.getParent()&&!e.getShowRootLines();var t=this.config_;var i=new goog.string.StringBuffer;i.append(t.cssTreeIcon," ",t.cssExpandTreeIcon," ");if(this.hasChildren()){var r=0;if(e.getShowExpandIcons()&&this.isUserCollapsible_)if(this.getExpanded())r=2;else r=1;if(!o)if(this.isLastSibling())r+=4;else r+=8;switch(r){case 1:i.append(t.cssExpandTreeIconPlus);break;case 2:i.append(t.cssExpandTreeIconMinus);break;case 4:i.append(t.cssExpandTreeIconL);break;case 5:i.append(t.cssExpandTreeIconLPlus);break;case 6:i.append(t.cssExpandTreeIconLMinus);break;case 8:i.append(t.cssExpandTreeIconT);break;case 9:i.append(t.cssExpandTreeIconTPlus);break;case 10:i.append(t.cssExpandTreeIconTMinus);break;default:i.append(t.cssExpandTreeIconBlank)}}else if(o)i.append(t.cssExpandTreeIconBlank);else if(this.isLastSibling())i.append(t.cssExpandTreeIconL);else i.append(t.cssExpandTreeIconT);return i.toString()};goog.ui.tree.BaseNode.prototype.getLineStyle=function(){var e=this.getExpanded()&&this.hasChildren();return goog.html.SafeStyle.create({"background-position":this.getBackgroundPosition(),display:e?null:"none"})};goog.ui.tree.BaseNode.prototype.getBackgroundPosition=function(){return(this.isLastSibling()?"-100":(this.getDepth()-1)*this.config_.indentWidth)+"px 0"};goog.ui.tree.BaseNode.prototype.getElement=function(){var e=goog.ui.tree.BaseNode.superClass_.getElement.call(this);if(!e){e=this.getDomHelper().getElement(this.getId());this.setElementInternal(e)}return e};goog.ui.tree.BaseNode.prototype.getRowElement=function(){var e=this.getElement();return e?e.firstChild:null};goog.ui.tree.BaseNode.prototype.getExpandIconElement=function(){var e=this.getRowElement();return e?e.firstChild:null};goog.ui.tree.BaseNode.prototype.getIconElement=function(){var e=this.getRowElement();return e?e.childNodes[1]:null};goog.ui.tree.BaseNode.prototype.getLabelElement=function(){var e=this.getRowElement();return e&&e.lastChild?e.lastChild.previousSibling:null};goog.ui.tree.BaseNode.prototype.getAfterLabelElement=function(){var e=this.getRowElement();return e?e.lastChild:null};goog.ui.tree.BaseNode.prototype.getChildrenElement=function(){var e=this.getElement();return e?e.lastChild:null};goog.ui.tree.BaseNode.prototype.setIconClass=function(e){this.iconClass_=e;if(this.isInDocument())this.updateIcon_()};goog.ui.tree.BaseNode.prototype.getIconClass=function(){return this.iconClass_};goog.ui.tree.BaseNode.prototype.setExpandedIconClass=function(e){this.expandedIconClass_=e;if(this.isInDocument())this.updateIcon_()};goog.ui.tree.BaseNode.prototype.getExpandedIconClass=function(){return this.expandedIconClass_};goog.ui.tree.BaseNode.prototype.setText=function(e){this.setSafeHtml(goog.html.SafeHtml.htmlEscape(e))};goog.ui.tree.BaseNode.prototype.getText=function(){return goog.string.unescapeEntities(goog.html.SafeHtml.unwrap(this.html_))};goog.ui.tree.BaseNode.prototype.setSafeHtml=function(e){this.html_=e;var o=this.getLabelElement();if(o)goog.dom.safe.setInnerHtml(o,e);var t=this.getTree();if(t)t.setNode(this)};goog.ui.tree.BaseNode.prototype.getHtml=function(){return goog.html.SafeHtml.unwrap(this.getSafeHtml())};goog.ui.tree.BaseNode.prototype.getSafeHtml=function(){return this.html_};goog.ui.tree.BaseNode.prototype.setToolTip=function(e){this.toolTip_=e;var o=this.getLabelElement();if(o)o.title=e};goog.ui.tree.BaseNode.prototype.getToolTip=function(){return this.toolTip_};goog.ui.tree.BaseNode.prototype.updateRow=function(){var e=this.getRowElement();if(e)e.className=this.getRowClassName()};goog.ui.tree.BaseNode.prototype.updateExpandIcon=function(){var e=this.getExpandIconElement();if(e)e.className=this.getExpandIconClass();var o=this.getChildrenElement();if(o)o.style.backgroundPosition=this.getBackgroundPosition()};goog.ui.tree.BaseNode.prototype.updateIcon_=function(){this.getIconElement().className=this.getCalculatedIconClass()};goog.ui.tree.BaseNode.prototype.onMouseDown=function(e){var o=e.target;var t=o.getAttribute("type");if("expand"==t&&this.hasChildren()){if(this.isUserCollapsible_)this.toggle();return}this.select();this.updateRow()};goog.ui.tree.BaseNode.prototype.onClick_=goog.events.Event.preventDefault;goog.ui.tree.BaseNode.prototype.onDoubleClick_=function(e){var o=e.target;var t=o.getAttribute("type");if("expand"==t&&this.hasChildren())return;if(this.isUserCollapsible_)this.toggle()};goog.ui.tree.BaseNode.prototype.onKeyDown=function(e){var o=true;switch(e.keyCode){case goog.events.KeyCodes.RIGHT:if(e.altKey)break;if(this.hasChildren())if(!this.getExpanded())this.setExpanded(true);else this.getFirstChild().select();break;case goog.events.KeyCodes.LEFT:if(e.altKey)break;if(this.hasChildren()&&this.getExpanded()&&this.isUserCollapsible_)this.setExpanded(false);else{var t=this.getParent();var i=this.getTree();if(t&&(i.getShowRootNode()||t!=i))t.select()}break;case goog.events.KeyCodes.DOWN:var r=this.getNextShownNode();if(r)r.select();break;case goog.events.KeyCodes.UP:var n=this.getPreviousShownNode();if(n)n.select();break;default:o=false}if(o){e.preventDefault();var i=this.getTree();if(i)i.clearTypeAhead()}return o};goog.ui.tree.BaseNode.prototype.getLastShownDescendant=function(){if(!this.getExpanded()||!this.hasChildren())return this;return this.getLastChild().getLastShownDescendant()};goog.ui.tree.BaseNode.prototype.getNextShownNode=function(){if(this.hasChildren()&&this.getExpanded())return this.getFirstChild();else{var e=this;var o;while(e!=this.getTree()){o=e.getNextSibling();if(null!=o)return o;e=e.getParent()}return null}};goog.ui.tree.BaseNode.prototype.getPreviousShownNode=function(){var e=this.getPreviousSibling();if(null!=e)return e.getLastShownDescendant();var o=this.getParent();var t=this.getTree();if(!t.getShowRootNode()&&o==t)return null;if(this==t)return null;return o};goog.ui.tree.BaseNode.prototype.getClientData=goog.ui.tree.BaseNode.prototype.getModel;goog.ui.tree.BaseNode.prototype.setClientData=goog.ui.tree.BaseNode.prototype.setModel;goog.ui.tree.BaseNode.prototype.getConfig=function(){return this.config_};goog.ui.tree.BaseNode.prototype.setTreeInternal=function(e){if(this.tree!=e){this.tree=e;e.setNode(this);this.forEachChild((function(o){o.setTreeInternal(e)}))}};goog.ui.tree.BaseNode.defaultConfig={indentWidth:19,cssRoot:goog.getCssName("goog-tree-root")+" "+goog.getCssName("goog-tree-item"),cssHideRoot:goog.getCssName("goog-tree-hide-root"),cssItem:goog.getCssName("goog-tree-item"),cssChildren:goog.getCssName("goog-tree-children"),cssChildrenNoLines:goog.getCssName("goog-tree-children-nolines"),cssTreeRow:goog.getCssName("goog-tree-row"),cssItemLabel:goog.getCssName("goog-tree-item-label"),cssTreeIcon:goog.getCssName("goog-tree-icon"),cssExpandTreeIcon:goog.getCssName("goog-tree-expand-icon"),cssExpandTreeIconPlus:goog.getCssName("goog-tree-expand-icon-plus"),cssExpandTreeIconMinus:goog.getCssName("goog-tree-expand-icon-minus"),cssExpandTreeIconTPlus:goog.getCssName("goog-tree-expand-icon-tplus"),cssExpandTreeIconTMinus:goog.getCssName("goog-tree-expand-icon-tminus"),cssExpandTreeIconLPlus:goog.getCssName("goog-tree-expand-icon-lplus"),cssExpandTreeIconLMinus:goog.getCssName("goog-tree-expand-icon-lminus"),cssExpandTreeIconT:goog.getCssName("goog-tree-expand-icon-t"),cssExpandTreeIconL:goog.getCssName("goog-tree-expand-icon-l"),cssExpandTreeIconBlank:goog.getCssName("goog-tree-expand-icon-blank"),cssExpandedFolderIcon:goog.getCssName("goog-tree-expanded-folder-icon"),cssCollapsedFolderIcon:goog.getCssName("goog-tree-collapsed-folder-icon"),cssFileIcon:goog.getCssName("goog-tree-file-icon"),cssExpandedRootIcon:goog.getCssName("goog-tree-expanded-folder-icon"),cssCollapsedRootIcon:goog.getCssName("goog-tree-collapsed-folder-icon"),cssSelectedRow:goog.getCssName("selected")};goog.provide("goog.ui.tree.TreeControl");goog.require("goog.a11y.aria");goog.require("goog.asserts");goog.require("goog.dom.classlist");goog.require("goog.events.EventType");goog.require("goog.events.FocusHandler");goog.require("goog.events.KeyHandler");goog.require("goog.html.SafeHtml");goog.require("goog.log");goog.require("goog.ui.tree.BaseNode");goog.require("goog.ui.tree.TreeNode");goog.require("goog.ui.tree.TypeAhead");goog.require("goog.userAgent");goog.ui.tree.TreeControl=function(e,o,t){goog.ui.tree.BaseNode.call(this,e,o,t);this.setExpandedInternal(true);this.setSelectedInternal(true);this.selectedItem_=this;this.typeAhead_=new goog.ui.tree.TypeAhead;this.keyHandler_=null;this.focusHandler_=null;this.logger_=goog.log.getLogger("this");this.focused_=false;this.focusedNode_=null;this.showLines_=true;this.showExpandIcons_=true;this.showRootNode_=true;this.showRootLines_=true;if(goog.userAgent.IE)try{document.execCommand("BackgroundImageCache",false,true)}catch(e){goog.log.warning(this.logger_,"Failed to enable background image cache")}};goog.inherits(goog.ui.tree.TreeControl,goog.ui.tree.BaseNode);goog.ui.tree.TreeControl.prototype.getTree=function(){return this};goog.ui.tree.TreeControl.prototype.getDepth=function(){return 0};goog.ui.tree.TreeControl.prototype.reveal=function(){};goog.ui.tree.TreeControl.prototype.handleFocus_=function(e){this.focused_=true;goog.dom.classlist.add(goog.asserts.assert(this.getElement()),goog.getCssName("focused"));if(this.selectedItem_)this.selectedItem_.select()};goog.ui.tree.TreeControl.prototype.handleBlur_=function(e){this.focused_=false;goog.dom.classlist.remove(goog.asserts.assert(this.getElement()),goog.getCssName("focused"))};goog.ui.tree.TreeControl.prototype.hasFocus=function(){return this.focused_};goog.ui.tree.TreeControl.prototype.getExpanded=function(){return!this.showRootNode_||goog.ui.tree.TreeControl.superClass_.getExpanded.call(this)};goog.ui.tree.TreeControl.prototype.setExpanded=function(e){if(!this.showRootNode_)this.setExpandedInternal(e);else goog.ui.tree.TreeControl.superClass_.setExpanded.call(this,e)};goog.ui.tree.TreeControl.prototype.getExpandIconSafeHtml=function(){return goog.html.SafeHtml.EMPTY};goog.ui.tree.TreeControl.prototype.getIconElement=function(){var e=this.getRowElement();return e?e.firstChild:null};goog.ui.tree.TreeControl.prototype.getExpandIconElement=function(){return null};goog.ui.tree.TreeControl.prototype.updateExpandIcon=function(){};goog.ui.tree.TreeControl.prototype.getRowClassName=function(){return goog.ui.tree.TreeControl.superClass_.getRowClassName.call(this)+(this.showRootNode_?"":" "+this.getConfig().cssHideRoot)};goog.ui.tree.TreeControl.prototype.getCalculatedIconClass=function(){var e=this.getExpanded();var o=this.getExpandedIconClass();if(e&&o)return o;var t=this.getIconClass();if(!e&&t)return t;var i=this.getConfig();if(e&&i.cssExpandedRootIcon)return i.cssTreeIcon+" "+i.cssExpandedRootIcon;else if(!e&&i.cssCollapsedRootIcon)return i.cssTreeIcon+" "+i.cssCollapsedRootIcon;return""};goog.ui.tree.TreeControl.prototype.setSelectedItem=function(e){if(this.selectedItem_==e)return;var o=false;if(this.selectedItem_){o=this.selectedItem_==this.focusedNode_;this.selectedItem_.setSelectedInternal(false)}this.selectedItem_=e;if(e){e.setSelectedInternal(true);if(o)e.select()}this.dispatchEvent(goog.events.EventType.CHANGE)};goog.ui.tree.TreeControl.prototype.getSelectedItem=function(){return this.selectedItem_};goog.ui.tree.TreeControl.prototype.setShowLines=function(e){if(this.showLines_!=e){this.showLines_=e;if(this.isInDocument())this.updateLinesAndExpandIcons_()}};goog.ui.tree.TreeControl.prototype.getShowLines=function(){return this.showLines_};goog.ui.tree.TreeControl.prototype.updateLinesAndExpandIcons_=function(){var e=this;var o=e.getShowLines();var t=e.getShowRootLines();function i(r){var n=r.getChildrenElement();if(n){var l=!o||e==r.getParent()&&!t;var s=l?r.getConfig().cssChildrenNoLines:r.getConfig().cssChildren;n.className=s;var g=r.getExpandIconElement();if(g)g.className=r.getExpandIconClass()}r.forEachChild(i)}i(this)};goog.ui.tree.TreeControl.prototype.setShowRootLines=function(e){if(this.showRootLines_!=e){this.showRootLines_=e;if(this.isInDocument())this.updateLinesAndExpandIcons_()}};goog.ui.tree.TreeControl.prototype.getShowRootLines=function(){return this.showRootLines_};goog.ui.tree.TreeControl.prototype.setShowExpandIcons=function(e){if(this.showExpandIcons_!=e){this.showExpandIcons_=e;if(this.isInDocument())this.updateLinesAndExpandIcons_()}};goog.ui.tree.TreeControl.prototype.getShowExpandIcons=function(){return this.showExpandIcons_};goog.ui.tree.TreeControl.prototype.setShowRootNode=function(e){if(this.showRootNode_!=e){this.showRootNode_=e;if(this.isInDocument()){var o=this.getRowElement();if(o)o.className=this.getRowClassName()}if(!e&&this.getSelectedItem()==this&&this.getFirstChild())this.setSelectedItem(this.getFirstChild())}};goog.ui.tree.TreeControl.prototype.getShowRootNode=function(){return this.showRootNode_};goog.ui.tree.TreeControl.prototype.initAccessibility=function(){goog.ui.tree.TreeControl.superClass_.initAccessibility.call(this);var e=this.getElement();goog.asserts.assert(e,"The DOM element for the tree cannot be null.");goog.a11y.aria.setRole(e,"tree");goog.a11y.aria.setState(e,"labelledby",this.getLabelElement().id)};goog.ui.tree.TreeControl.prototype.enterDocument=function(){goog.ui.tree.TreeControl.superClass_.enterDocument.call(this);var e=this.getElement();e.className=this.getConfig().cssRoot;e.setAttribute("hideFocus","true");this.attachEvents_();this.initAccessibility()};goog.ui.tree.TreeControl.prototype.exitDocument=function(){goog.ui.tree.TreeControl.superClass_.exitDocument.call(this);this.detachEvents_()};goog.ui.tree.TreeControl.prototype.attachEvents_=function(){var e=this.getElement();e.tabIndex=0;var o=this.keyHandler_=new goog.events.KeyHandler(e);var t=this.focusHandler_=new goog.events.FocusHandler(e);this.getHandler().listen(t,goog.events.FocusHandler.EventType.FOCUSOUT,this.handleBlur_).listen(t,goog.events.FocusHandler.EventType.FOCUSIN,this.handleFocus_).listen(o,goog.events.KeyHandler.EventType.KEY,this.handleKeyEvent).listen(e,goog.events.EventType.MOUSEDOWN,this.handleMouseEvent_).listen(e,goog.events.EventType.CLICK,this.handleMouseEvent_).listen(e,goog.events.EventType.DBLCLICK,this.handleMouseEvent_)};goog.ui.tree.TreeControl.prototype.detachEvents_=function(){this.keyHandler_.dispose();this.keyHandler_=null;this.focusHandler_.dispose();this.focusHandler_=null};goog.ui.tree.TreeControl.prototype.handleMouseEvent_=function(e){goog.log.fine(this.logger_,"Received event "+e.type);var o=this.getNodeFromEvent_(e);if(o)switch(e.type){case goog.events.EventType.MOUSEDOWN:o.onMouseDown(e);break;case goog.events.EventType.CLICK:o.onClick_(e);break;case goog.events.EventType.DBLCLICK:o.onDoubleClick_(e);break}};goog.ui.tree.TreeControl.prototype.handleKeyEvent=function(e){var o=false;o=this.typeAhead_.handleNavigation(e)||this.selectedItem_&&this.selectedItem_.onKeyDown(e)||this.typeAhead_.handleTypeAheadChar(e);if(o)e.preventDefault();return o};goog.ui.tree.TreeControl.prototype.getNodeFromEvent_=function(e){var o=null;var t=e.target;while(null!=t){var i=t.id;o=goog.ui.tree.BaseNode.allNodes[i];if(o)return o;if(t==this.getElement())break;t=t.parentNode}return null};goog.ui.tree.TreeControl.prototype.createNode=function(e){return new goog.ui.tree.TreeNode(e||goog.html.SafeHtml.EMPTY,this.getConfig(),this.getDomHelper())};goog.ui.tree.TreeControl.prototype.setNode=function(e){this.typeAhead_.setNodeInMap(e)};goog.ui.tree.TreeControl.prototype.removeNode=function(e){this.typeAhead_.removeNodeFromMap(e)};goog.ui.tree.TreeControl.prototype.clearTypeAhead=function(){this.typeAhead_.clear()};goog.ui.tree.TreeControl.defaultConfig=goog.ui.tree.BaseNode.defaultConfig;goog.provide("goog.ui.tree.TreeNode");goog.require("goog.ui.tree.BaseNode");goog.forwardDeclare("goog.ui.tree.TreeControl");goog.ui.tree.TreeNode=function(e,o,t){goog.ui.tree.BaseNode.call(this,e,o,t)};goog.inherits(goog.ui.tree.TreeNode,goog.ui.tree.BaseNode);goog.ui.tree.TreeNode.prototype.getTree=function(){if(this.tree)return this.tree;var e=this.getParent();if(e){var o=e.getTree();if(o){this.setTreeInternal(o);return o}}return null};goog.ui.tree.TreeNode.prototype.getCalculatedIconClass=function(){var e=this.getExpanded();var o=this.getExpandedIconClass();if(e&&o)return o;var t=this.getIconClass();if(!e&&t)return t;var i=this.getConfig();if(this.hasChildren()){if(e&&i.cssExpandedFolderIcon)return i.cssTreeIcon+" "+i.cssExpandedFolderIcon;else if(!e&&i.cssCollapsedFolderIcon)return i.cssTreeIcon+" "+i.cssCollapsedFolderIcon}else if(i.cssFileIcon)return i.cssTreeIcon+" "+i.cssFileIcon;return""};goog.provide("goog.ui.tree.TypeAhead");goog.provide("goog.ui.tree.TypeAhead.Offset");goog.require("goog.array");goog.require("goog.events.KeyCodes");goog.require("goog.string");goog.require("goog.structs.Trie");goog.forwardDeclare("goog.ui.tree.BaseNode");goog.ui.tree.TypeAhead=function(){this.nodeMap_=new goog.structs.Trie;this.buffer_="";this.matchingLabels_=null;this.matchingNodes_=null;this.matchingLabelIndex_=0;this.matchingNodeIndex_=0};goog.ui.tree.TypeAhead.Offset={DOWN:1,UP:-1};goog.ui.tree.TypeAhead.prototype.handleNavigation=function(e){var o=false;switch(e.keyCode){case goog.events.KeyCodes.DOWN:case goog.events.KeyCodes.UP:if(e.ctrlKey){this.jumpTo_(e.keyCode==goog.events.KeyCodes.DOWN?goog.ui.tree.TypeAhead.Offset.DOWN:goog.ui.tree.TypeAhead.Offset.UP);o=true}break;case goog.events.KeyCodes.BACKSPACE:var t=this.buffer_.length-1;o=true;if(t>0){this.buffer_=this.buffer_.substring(0,t);this.jumpToLabel_(this.buffer_)}else if(0==t)this.buffer_="";else o=false;break;case goog.events.KeyCodes.ESC:this.buffer_="";o=true;break}return o};goog.ui.tree.TypeAhead.prototype.handleTypeAheadChar=function(e){var o=false;if(!e.ctrlKey&&!e.altKey){var t=String.fromCharCode(e.charCode||e.keyCode).toLowerCase();if(goog.string.isUnicodeChar(t)&&(" "!=t||this.buffer_)){this.buffer_+=t;o=this.jumpToLabel_(this.buffer_)}}return o};goog.ui.tree.TypeAhead.prototype.setNodeInMap=function(e){var o=e.getText();if(o&&!goog.string.isEmptyOrWhitespace(goog.string.makeSafe(o))){o=o.toLowerCase();var t=this.nodeMap_.get(o);if(t)t.push(e);else{var i=[e];this.nodeMap_.set(o,i)}}};goog.ui.tree.TypeAhead.prototype.removeNodeFromMap=function(e){var o=e.getText();if(o&&!goog.string.isEmptyOrWhitespace(goog.string.makeSafe(o))){o=o.toLowerCase();var t=this.nodeMap_.get(o);if(t){var i=e.getChildCount();for(var r=0;r<i;r++)this.removeNodeFromMap(e.getChildAt(r));goog.array.remove(t,e);if(!t.length)this.nodeMap_.remove(o)}}};goog.ui.tree.TypeAhead.prototype.jumpToLabel_=function(e){var o=false;var t=this.nodeMap_.getKeys(e);if(t&&t.length){this.matchingNodeIndex_=0;this.matchingLabelIndex_=0;var i=this.nodeMap_.get(t[0]);if(o=this.selectMatchingNode_(i))this.matchingLabels_=t}return o};goog.ui.tree.TypeAhead.prototype.jumpTo_=function(e){var o=false;var t=this.matchingLabels_;if(t){var i=null;var r=false;if(this.matchingNodes_){var n=this.matchingNodeIndex_+e;if(n>=0&&n<this.matchingNodes_.length){this.matchingNodeIndex_=n;i=this.matchingNodes_}else r=true}if(!i){var l=this.matchingLabelIndex_+e;if(l>=0&&l<t.length)this.matchingLabelIndex_=l;if(t.length>this.matchingLabelIndex_)i=this.nodeMap_.get(t[this.matchingLabelIndex_]);if(i&&i.length&&r)this.matchingNodeIndex_=e==goog.ui.tree.TypeAhead.Offset.UP?i.length-1:0}if(o=this.selectMatchingNode_(i))this.matchingLabels_=t}return o};goog.ui.tree.TypeAhead.prototype.selectMatchingNode_=function(e){var o;if(e){if(this.matchingNodeIndex_<e.length){o=e[this.matchingNodeIndex_];this.matchingNodes_=e}if(o){o.reveal();o.select()}}return!!o};goog.ui.tree.TypeAhead.prototype.clear=function(){this.buffer_=""};goog.provide("Blockly");goog.require("Blockly.BlockSvg.render");goog.require("Blockly.DropDownDiv");goog.require("Blockly.Events");goog.require("Blockly.FieldAngle");goog.require("Blockly.FieldCheckbox");goog.require("Blockly.FieldColour");goog.require("Blockly.FieldColourSlider");goog.require("Blockly.FieldDropdown");goog.require("Blockly.FieldIconMenu");goog.require("Blockly.FieldImage");goog.require("Blockly.FieldNote");goog.require("Blockly.FieldTextInput");goog.require("Blockly.FieldTextInputRemovable");goog.require("Blockly.FieldTextDropdown");goog.require("Blockly.FieldNumber");goog.require("Blockly.FieldNumberDropdown");goog.require("Blockly.FieldMatrix");goog.require("Blockly.FieldVariable");goog.require("Blockly.FieldVerticalSeparator");goog.require("Blockly.Generator");goog.require("Blockly.Msg");goog.require("Blockly.Procedures");goog.require("Blockly.ScratchMsgs");goog.require("Blockly.Toolbox");goog.require("Blockly.Touch");goog.require("Blockly.WidgetDiv");goog.require("Blockly.WorkspaceSvg");goog.require("Blockly.constants");goog.require("Blockly.inject");goog.require("Blockly.utils");goog.require("goog.color");Blockly.mainWorkspace=null;Blockly.selected=null;Blockly.draggingConnections_=[];Blockly.clipboardXml_=null;Blockly.clipboardSource_=null;Blockly.cache3dSupported_=null;Blockly.hueToRgb=function(e){return goog.color.hsvToHex(e,Blockly.HSV_SATURATION,255*Blockly.HSV_VALUE)};Blockly.svgSize=function(e){return{width:e.cachedWidth_,height:e.cachedHeight_}};Blockly.resizeSvgContents=function(e){e.resizeContents()};Blockly.svgResize=function(e){var o=e;while(o.options.parentWorkspace)o=o.options.parentWorkspace;var t=o.getParentSvg();var i=t.parentNode;if(!i)return;var r=i.offsetWidth;var n=i.offsetHeight;if(t.cachedWidth_!=r){t.setAttribute("width",r+"px");t.cachedWidth_=r}if(t.cachedHeight_!=n){t.setAttribute("height",n+"px");t.cachedHeight_=n}o.resize()};Blockly.onKeyDown_=function(e){if(Blockly.mainWorkspace.options.readOnly||Blockly.utils.isTargetInput(e)||Blockly.mainWorkspace.rendered&&!Blockly.mainWorkspace.isVisible())return;var o=false;if(27==e.keyCode){Blockly.hideChaff();Blockly.DropDownDiv.hide()}else if(8==e.keyCode||46==e.keyCode){e.preventDefault();if(Blockly.mainWorkspace.isDragging())return;if(Blockly.selected&&Blockly.selected.isDeletable())o=true}else if(e.altKey||e.ctrlKey||e.metaKey){if(Blockly.mainWorkspace.isDragging())return;if(Blockly.selected&&Blockly.selected.isDeletable()&&Blockly.selected.isMovable())if(67==e.keyCode){Blockly.hideChaff();Blockly.copy_(Blockly.selected)}else if(88==e.keyCode&&!Blockly.selected.workspace.isFlyout){Blockly.copy_(Blockly.selected);o=true}if(86==e.keyCode){if(Blockly.clipboardXml_){Blockly.Events.setGroup(true);var t=Blockly.clipboardSource_;if(t.isFlyout)t=t.targetWorkspace;t.paste(Blockly.clipboardXml_);Blockly.Events.setGroup(false)}}else if(90==e.keyCode){Blockly.hideChaff();Blockly.mainWorkspace.undo(e.shiftKey)}}if(o&&!Blockly.selected.workspace.isFlyout){Blockly.Events.setGroup(true);Blockly.hideChaff();Blockly.selected.dispose(true,true);Blockly.Events.setGroup(false)}};Blockly.copy_=function(e){if(e.isComment)var o=e.toXmlWithXY();else{var o=Blockly.Xml.blockToDom(e);var t=e.getRelativeToSurfaceXY();o.setAttribute("x",e.RTL?-t.x:t.x);o.setAttribute("y",t.y)}Blockly.clipboardXml_=o;Blockly.clipboardSource_=e.workspace};Blockly.duplicate_=function(e){var o=Blockly.clipboardXml_;var t=Blockly.clipboardSource_;Blockly.copy_(e);e.workspace.paste(Blockly.clipboardXml_);Blockly.clipboardXml_=o;Blockly.clipboardSource_=t};Blockly.onContextMenu_=function(e){if(!Blockly.utils.isTargetInput(e))e.preventDefault()};Blockly.hideChaff=function(e){Blockly.hideChaffInternal_(e);Blockly.WidgetDiv.hide(true)};Blockly.hideChaffOnResize=function(e){Blockly.hideChaffInternal_(e);Blockly.WidgetDiv.repositionForWindowResize()};Blockly.hideChaffInternal_=function(e){Blockly.Tooltip.hide();Blockly.DropDownDiv.hideWithoutAnimation();if(!e){var o=Blockly.getMainWorkspace();if(o.toolbox_&&o.toolbox_.flyout_&&o.toolbox_.flyout_.autoClose)o.toolbox_.clearSelection()}};Blockly.getMainWorkspace=function(){return Blockly.mainWorkspace};Blockly.alert=function(e,o){window.alert(e);if(o)o()};Blockly.confirm=function(e,o){o(window.confirm(e))};Blockly.prompt=function(e,o,t,i,r){t(window.prompt(e,o))};Blockly.statusButtonCallback=function(e){window.alert("status button was pressed for "+e)};Blockly.refreshStatusButtons=function(e){var o=e.getFlyout().buttons_;for(var t=0;t<o.length;t++)if(o[t]instanceof Blockly.FlyoutExtensionCategoryHeader)o[t].refreshStatus()};Blockly.jsonInitFactory_=function(e){return function(){this.jsonInit(e)}};Blockly.defineBlocksWithJsonArray=function(e){for(var o=0;o<e.length;o++){var t=e[o];if(!t)console.warn("Block definition #"+o+" in JSON array is "+t+". "+"Skipping.");else{var i=t.type;if(null==i||""===i)console.warn("Block definition #"+o+" in JSON array is missing a type attribute. Skipping.");else{if(Blockly.Blocks[i])console.warn("Block definition #"+o+" in JSON array"+' overwrites prior definition of "'+i+'".');Blockly.Blocks[i]={init:Blockly.jsonInitFactory_(t)}}}}};Blockly.bindEventWithChecks_=function(e,o,t,i,r,n){var l=false;var s=function(e){var o=!r;var n=Blockly.Touch.splitEventByTouches(e);for(var s=0,g;g=n[s];s++){if(o&&!Blockly.Touch.shouldHandleEvent(g))continue;Blockly.Touch.setClientFromTouch(g);if(t)i.call(t,g);else i(g);l=true}};e.addEventListener(o,s,false);var g=[[e,o,s]];if(o in Blockly.Touch.TOUCH_MAP){var a=function(e){s(e);var o=!n;if(l&&o)e.preventDefault()};for(var c=0,u;u=Blockly.Touch.TOUCH_MAP[o][c];c++){e.addEventListener(u,a,false);g.push([e,u,a])}}return g};Blockly.bindEvent_=function(e,o,t,i){var r=function(e){if(t)i.call(t,e);else i(e)};e.addEventListener(o,r,false);var n=[[e,o,r]];if(o in Blockly.Touch.TOUCH_MAP){var l=function(e){if(1==e.changedTouches.length){var o=e.changedTouches[0];e.clientX=o.clientX;e.clientY=o.clientY}r(e);e.preventDefault()};for(var s=0,g;g=Blockly.Touch.TOUCH_MAP[o][s];s++){e.addEventListener(g,l,false);n.push([e,g,l])}}return n};Blockly.unbindEvent_=function(e){while(e.length){var o=e.pop();var t=o[0];var i=o[1];var r=o[2];t.removeEventListener(i,r,false)}return r};Blockly.isNumber=function(e){return!!e.match(/^\s*-?\d+(\.\d+)?\s*$/)};if(!goog.global["console"])goog.global["console"]={log:function(){},warn:function(){}};if(!goog.global["Blockly"])goog.global["Blockly"]={};goog.global["Blockly"]["getMainWorkspace"]=Blockly.getMainWorkspace;goog.provide("Blockly.Block");goog.require("Blockly.Blocks");goog.require("Blockly.Colours");goog.require("Blockly.Comment");goog.require("Blockly.ScratchBlockComment");goog.require("Blockly.Connection");goog.require("Blockly.Events.BlockChange");goog.require("Blockly.Events.BlockCreate");goog.require("Blockly.Events.BlockDelete");goog.require("Blockly.Events.BlockMove");goog.require("Blockly.Extensions");goog.require("Blockly.FieldLabelSerializable");goog.require("Blockly.FieldVariableGetter");goog.require("Blockly.Input");goog.require("Blockly.Mutator");goog.require("Blockly.Warning");goog.require("Blockly.Workspace");goog.require("Blockly.Xml");goog.require("goog.array");goog.require("goog.asserts");goog.require("goog.math.Coordinate");goog.require("goog.string");Blockly.Block=function(e,o,t){var i=e&&e.getFlyout&&e.getFlyout()?e.getFlyout().getWorkspace():null;this.id=t&&!e.getBlockById(t)&&(!i||!i.getBlockById(t))?t:Blockly.utils.genUid();e.blockDB_[this.id]=this;this.outputConnection=null;this.nextConnection=null;this.previousConnection=null;this.inputList=[];this.inputsInline=true;this.disabled=false;this.tooltip="";this.contextMenu=true;this.parentBlock_=null;this.childBlocks_=[];this.deletable_=true;this.movable_=true;this.editable_=true;this.isShadow_=false;this.collapsed_=false;this.checkboxInFlyout_=false;this.comment=null;this.outputShape_=null;this.category_=null;this.xy_=new goog.math.Coordinate(0,0);this.workspace=e;this.isInFlyout=e.isFlyout;this.isInMutator=e.isMutator;this.RTL=e.RTL;this.isInsertionMarker_=false;if(o){this.type=o;var r=Blockly.Blocks[o];if(r){goog.asserts.assertObject(r,'Error: Unknown block type "%s".',o);goog.mixin(this,r)}else if(Blockly.Block.initWithDynamicJson){var n=Blockly.Block.initWithDynamicJson(o,this);goog.asserts.assert(n,'Error: Unknown block type "%s".',o)}else goog.asserts.assertObject(r,'Error: Unknown block type "%s".',o)}e.addTopBlock(this);if(goog.isFunction(this.init))this.init();this.inputsInlineDefault=this.inputsInline;if(Blockly.Events.isEnabled()){var l=Blockly.Events.getGroup();if(!l)Blockly.Events.setGroup(true);try{Blockly.Events.fire(new Blockly.Events.BlockCreate(this))}finally{if(!l)Blockly.Events.setGroup(false)}}if(goog.isFunction(this.onchange))this.setOnChange(this.onchange)};Blockly.Block.prototype.data=null;Blockly.Block.prototype.colour_="#FF0000";Blockly.Block.prototype.colourSecondary_="#FF0000";Blockly.Block.prototype.colourTertiary_="#FF0000";Blockly.Block.prototype.shadowColour_=null;Blockly.Block.prototype.dispose=function(e){if(!this.workspace)return;if(this.onchangeWrapper_)this.workspace.removeChangeListener(this.onchangeWrapper_);this.unplug(e);if(Blockly.Events.isEnabled())Blockly.Events.fire(new Blockly.Events.BlockDelete(this));Blockly.Events.disable();try{if(this.workspace){this.workspace.removeTopBlock(this);delete this.workspace.blockDB_[this.id];this.workspace=null}if(Blockly.selected==this)Blockly.selected=null;for(var o=this.childBlocks_.length-1;o>=0;o--)this.childBlocks_[o].dispose(false);for(var o=0,t;t=this.inputList[o];o++)t.dispose();this.inputList.length=0;var i=this.getConnections_(true);for(var o=0;o<i.length;o++){var r=i[o];if(r.isConnected())r.disconnect();i[o].dispose()}}finally{Blockly.Events.enable()}};Blockly.Block.prototype.initModel=function(){for(var e=0,o;o=this.inputList[e];e++)for(var t=0,i;i=o.fieldRow[t];t++)if(i.initModel)i.initModel()};Blockly.Block.prototype.unplug=function(e){if(this.outputConnection){if(this.outputConnection.isConnected())this.outputConnection.disconnect()}else{if(this.previousConnection){var o=null;if(this.previousConnection.isConnected()){o=this.previousConnection.targetConnection;this.previousConnection.disconnect()}}var t=this.getNextBlock();if(e&&t){var i=this.nextConnection.targetConnection;i.disconnect();if(o&&o.checkType_(i))o.connect(i)}}};Blockly.Block.prototype.getConnections_=function(){var e=[];if(this.outputConnection)e.push(this.outputConnection);if(this.previousConnection)e.push(this.previousConnection);if(this.nextConnection)e.push(this.nextConnection);for(var o=0,t;t=this.inputList[o];o++)if(t.connection)e.push(t.connection);return e};Blockly.Block.prototype.lastConnectionInStack=function(){var e=this.nextConnection;while(e){var o=e.targetBlock();if(!o)return e;e=o.nextConnection}return null};Blockly.Block.prototype.bumpNeighbours_=function(){console.warn("Not expected to reach this bumpNeighbours_ function. The "+"BlockSvg function for bumpNeighbours_ was expected to be called instead.")};Blockly.Block.prototype.getParent=function(){return this.parentBlock_};Blockly.Block.prototype.getInputWithBlock=function(e){for(var o=0,t;t=this.inputList[o];o++)if(t.connection&&t.connection.targetBlock()==e)return t;return null};Blockly.Block.prototype.getInputWithConnection=function(e){for(var o=0,t;t=this.inputList[o];o++)if(t.connection==e)return t;return null};Blockly.Block.prototype.getSurroundParent=function(){var e=this;do{var o=e;e=e.getParent();if(!e)return null}while(e.getNextBlock()==o);return e};Blockly.Block.prototype.getNextBlock=function(){return this.nextConnection&&this.nextConnection.targetBlock()};Blockly.Block.prototype.getPreviousBlock=function(){return this.previousConnection&&this.previousConnection.targetBlock()};Blockly.Block.prototype.getFirstStatementConnection=function(){for(var e=0,o;o=this.inputList[e];e++)if(o.connection&&o.connection.type==Blockly.NEXT_STATEMENT)return o.connection;return null};Blockly.Block.prototype.getRootBlock=function(){var e;var o=this;do{e=o;o=e.parentBlock_}while(o);return e};Blockly.Block.prototype.getChildren=function(e){if(!e)return this.childBlocks_;var o=[];for(var t=0,i;i=this.inputList[t];t++)if(i.connection){var r=i.connection.targetBlock();if(r)o.push(r)}var n=this.getNextBlock();if(n)o.push(n);return o};Blockly.Block.prototype.setParent=function(e){if(e==this.parentBlock_)return;if(this.parentBlock_){goog.array.remove(this.parentBlock_.childBlocks_,this);if(this.previousConnection&&this.previousConnection.isConnected())throw"Still connected to previous block.";if(this.outputConnection&&this.outputConnection.isConnected())throw"Still connected to parent block.";this.parentBlock_=null}else this.workspace.removeTopBlock(this);this.parentBlock_=e;if(e)e.childBlocks_.push(this);else this.workspace.addTopBlock(this)};Blockly.Block.prototype.getDescendants=function(e,o){var t=[this];var i=this.getChildren(e);for(var r,n=0;r=i[n];n++)if(!o||!r.isShadow_)t.push.apply(t,r.getDescendants(e,o));return t};Blockly.Block.prototype.isDeletable=function(){return this.deletable_&&!this.isShadow_&&!(this.workspace&&this.workspace.options.readOnly)};Blockly.Block.prototype.setDeletable=function(e){this.deletable_=e};Blockly.Block.prototype.isMovable=function(){return this.movable_&&!this.isShadow_&&!(this.workspace&&this.workspace.options.readOnly)};Blockly.Block.prototype.setMovable=function(e){this.movable_=e};Blockly.Block.prototype.isShadow=function(){return this.isShadow_};Blockly.Block.prototype.setShadow=function(e){this.isShadow_=e};Blockly.Block.prototype.isInsertionMarker=function(){return this.isInsertionMarker_};Blockly.Block.prototype.setInsertionMarker=function(e){if(this.isInsertionMarker_==e)return;this.isInsertionMarker_=e;if(this.isInsertionMarker_){this.setColour(Blockly.Colours.insertionMarker);this.setOpacity(Blockly.Colours.insertionMarkerOpacity);Blockly.utils.addClass(this.svgGroup_,"blocklyInsertionMarker")}};Blockly.Block.prototype.isEditable=function(){return this.editable_&&!(this.workspace&&this.workspace.options.readOnly)};Blockly.Block.prototype.setEditable=function(e){this.editable_=e;for(var o=0,t;t=this.inputList[o];o++)for(var i=0,r;r=t.fieldRow[i];i++)r.updateEditable()};Blockly.Block.prototype.setConnectionsHidden=function(e){if(!e&&this.isCollapsed()){if(this.outputConnection)this.outputConnection.setHidden(e);if(this.previousConnection)this.previousConnection.setHidden(e);if(this.nextConnection){this.nextConnection.setHidden(e);var o=this.nextConnection.targetBlock();if(o)o.setConnectionsHidden(e)}}else{var t=this.getConnections_(true);for(var i=0,r;r=t[i];i++){r.setHidden(e);if(r.isSuperior()){var o=r.targetBlock();if(o)o.setConnectionsHidden(e)}}}};Blockly.Block.prototype.getMatchingConnection=function(e,o){var t=this.getConnections_(true);var i=e.getConnections_(true);if(t.length!=i.length)throw"Connection lists did not match in length.";for(var r=0;r<i.length;r++)if(i[r]==o)return t[r];return null};Blockly.Block.prototype.setHelpUrl=function(e){this.helpUrl=e};Blockly.Block.prototype.setTooltip=function(e){this.tooltip=e};Blockly.Block.prototype.getColour=function(){return this.colour_};Blockly.Block.prototype.getColourSecondary=function(){return this.colourSecondary_};Blockly.Block.prototype.getColourTertiary=function(){return this.colourTertiary_};Blockly.Block.prototype.getShadowColour=function(){return this.shadowColour_};Blockly.Block.prototype.setShadowColour=function(e){this.shadowColour_=this.makeColour_(e);if(this.rendered)this.updateColour()};Blockly.Block.prototype.clearShadowColour=function(){this.shadowColour_=null;if(this.rendered)this.updateColour()};Blockly.Block.prototype.makeColour_=function(e){var o=Number(e);if(!isNaN(o))return Blockly.hueToRgb(o);else if(goog.isString(e)&&e.match(/^#[0-9a-fA-F]{6}$/))return e;else throw"Invalid colour: "+e};Blockly.Block.prototype.setColour=function(e,o,t){this.colour_=this.makeColour_(e);if(void 0!==o)this.colourSecondary_=this.makeColour_(o);else this.colourSecondary_=goog.color.rgbArrayToHex(goog.color.darken(goog.color.hexToRgb(this.colour_),.1));if(void 0!==t)this.colourTertiary_=this.makeColour_(t);else this.colourTertiary_=goog.color.rgbArrayToHex(goog.color.darken(goog.color.hexToRgb(this.colour_),.2));if(this.rendered)this.updateColour()};Blockly.Block.prototype.setOnChange=function(e){if(e&&!goog.isFunction(e))throw new Error("onchange must be a function.");if(this.onchangeWrapper_)this.workspace.removeChangeListener(this.onchangeWrapper_);this.onchange=e;if(this.onchange){this.onchangeWrapper_=e.bind(this);this.workspace.addChangeListener(this.onchangeWrapper_)}};Blockly.Block.prototype.getField=function(e){for(var o=0,t;t=this.inputList[o];o++)for(var i=0,r;r=t.fieldRow[i];i++)if(r.name===e)return r;return null};Blockly.Block.prototype.getVars=function(){var e=[];for(var o=0,t;t=this.inputList[o];o++)for(var i=0,r;r=t.fieldRow[i];i++)if(r.referencesVariables())e.push(r.getValue());return e};Blockly.Block.prototype.getVarModels=function(){var e=[];for(var o=0,t;t=this.inputList[o];o++)for(var i=0,r;r=t.fieldRow[i];i++)if(r.referencesVariables()){var n=this.workspace.getVariableById(r.getValue());if(n)e.push(n)}return e};Blockly.Block.prototype.updateVarName=function(e){for(var o=0,t;t=this.inputList[o];o++)for(var i=0,r;r=t.fieldRow[i];i++)if(r.referencesVariables()&&e.getId()==r.getValue())r.setText(e.name)};Blockly.Block.prototype.renameVarById=function(e,o){for(var t=0,i;i=this.inputList[t];t++)for(var r=0,n;n=i.fieldRow[r];r++)if(n.referencesVariables()&&e==n.getValue())n.setValue(o)};Blockly.Block.prototype.getFieldValue=function(e){var o=this.getField(e);if(o)return o.getValue();return null};Blockly.Block.prototype.setFieldValue=function(e,o){var t=this.getField(o);goog.asserts.assertObject(t,'Field "%s" not found.',o);t.setValue(e)};Blockly.Block.prototype.setPreviousStatement=function(e,o){if(e){if(void 0===o)o=null;if(!this.previousConnection){goog.asserts.assert(!this.outputConnection,"Remove output connection prior to adding previous connection.");this.previousConnection=this.makeConnection_(Blockly.PREVIOUS_STATEMENT)}this.previousConnection.setCheck(o)}else if(this.previousConnection){goog.asserts.assert(!this.previousConnection.isConnected(),"Must disconnect previous statement before removing connection.");this.previousConnection.dispose();this.previousConnection=null}};Blockly.Block.prototype.setNextStatement=function(e,o){if(e){if(void 0===o)o=null;if(!this.nextConnection)this.nextConnection=this.makeConnection_(Blockly.NEXT_STATEMENT);this.nextConnection.setCheck(o)}else if(this.nextConnection){goog.asserts.assert(!this.nextConnection.isConnected(),"Must disconnect next statement before removing connection.");this.nextConnection.dispose();this.nextConnection=null}};Blockly.Block.prototype.setOutput=function(e,o){if(e){if(void 0===o)o=null;if(!this.outputConnection){goog.asserts.assert(!this.previousConnection,"Remove previous connection prior to adding output connection.");this.outputConnection=this.makeConnection_(Blockly.OUTPUT_VALUE)}this.outputConnection.setCheck(o)}else if(this.outputConnection){goog.asserts.assert(!this.outputConnection.isConnected(),"Must disconnect output value before removing connection.");this.outputConnection.dispose();this.outputConnection=null}};Blockly.Block.prototype.setInputsInline=function(e){if(this.inputsInline!=e){Blockly.Events.fire(new Blockly.Events.BlockChange(this,"inline",null,this.inputsInline,e));this.inputsInline=e}};Blockly.Block.prototype.getInputsInline=function(){if(void 0!=this.inputsInline)return this.inputsInline;for(var e=1;e<this.inputList.length;e++)if(this.inputList[e-1].type==Blockly.DUMMY_INPUT&&this.inputList[e].type==Blockly.DUMMY_INPUT)return false;for(var e=1;e<this.inputList.length;e++)if(this.inputList[e-1].type==Blockly.INPUT_VALUE&&this.inputList[e].type==Blockly.DUMMY_INPUT)return true;return false};Blockly.Block.prototype.setDisabled=function(e){if(this.disabled!=e){Blockly.Events.fire(new Blockly.Events.BlockChange(this,"disabled",null,this.disabled,e));this.disabled=e}};Blockly.Block.prototype.getInheritedDisabled=function(){var e=this.getSurroundParent();while(e){if(e.disabled)return true;e=e.getSurroundParent()}return false};Blockly.Block.prototype.isCollapsed=function(){return this.collapsed_};Blockly.Block.prototype.setCollapsed=function(e){if(this.collapsed_!=e){Blockly.Events.fire(new Blockly.Events.BlockChange(this,"collapsed",null,this.collapsed_,e));this.collapsed_=e}};Blockly.Block.prototype.toString=function(e,o){var t=[];var i=o||"?";if(this.collapsed_)t.push(this.getInput("_TEMP_COLLAPSED_INPUT").fieldRow[0].text_);else for(var r=0,n;n=this.inputList[r];r++){for(var l=0,s;s=n.fieldRow[l];l++)if(s instanceof Blockly.FieldDropdown&&!s.getValue())t.push(i);else t.push(s.getText());if(n.connection){var g=n.connection.targetBlock();if(g)t.push(g.toString(void 0,o));else t.push(i)}}t=goog.string.trim(t.join(" "))||"???";if(e)t=goog.string.truncate(t,e);return t};Blockly.Block.prototype.appendValueInput=function(e){return this.appendInput_(Blockly.INPUT_VALUE,e)};Blockly.Block.prototype.appendStatementInput=function(e){return this.appendInput_(Blockly.NEXT_STATEMENT,e)};Blockly.Block.prototype.appendDummyInput=function(e){return this.appendInput_(Blockly.DUMMY_INPUT,e||"")};Blockly.Block.prototype.jsonInit=function(e){var o=e["type"]?'Block "'+e["type"]+'": ':"";goog.asserts.assert(void 0==e["output"]||void 0==e["previousStatement"],o+"Must not have both an output and a previousStatement.");if(void 0!==e["colour"])this.setColourFromJson_(e);var t=0;while(void 0!==e["message"+t]){this.interpolate_(e["message"+t],e["args"+t]||[],e["lastDummyAlign"+t]);t++}if(void 0!==e["inputsInline"])this.setInputsInline(e["inputsInline"]);if(void 0!==e["output"])this.setOutput(true,e["output"]);if(void 0!==e["previousStatement"])this.setPreviousStatement(true,e["previousStatement"]);if(void 0!==e["nextStatement"])this.setNextStatement(true,e["nextStatement"]);if(void 0!==e["tooltip"]){var i=e["tooltip"];var r=Blockly.utils.replaceMessageReferences(i);this.setTooltip(r)}if(void 0!==e["enableContextMenu"]){var i=e["enableContextMenu"];this.contextMenu=!!i}if(void 0!==e["helpUrl"]){var i=e["helpUrl"];var n=Blockly.utils.replaceMessageReferences(i);this.setHelpUrl(n)}if(goog.isString(e["extensions"])){console.warn("JSON attribute 'extensions' should be an array of "+"strings. Found raw string in JSON for '"+e["type"]+"' block.");e["extensions"]=[e["extensions"]]}if(void 0!==e["mutator"])Blockly.Extensions.apply(e["mutator"],this,true);if(Array.isArray(e["extensions"])){var l=e["extensions"];for(var t=0;t<l.length;++t){var s=l[t];Blockly.Extensions.apply(s,this,false)}}if(void 0!==e["outputShape"])this.setOutputShape(e["outputShape"]);if(void 0!==e["checkboxInFlyout"])this.setCheckboxInFlyout(e["checkboxInFlyout"]);if(void 0!==e["category"])this.setCategory(e["category"])};Blockly.Block.prototype.mixin=function(e,o){if(goog.isDef(o)&&!goog.isBoolean(o))throw new Error("opt_disableCheck must be a boolean if provided");if(!o){var t=[];for(var i in e)if(void 0!==this[i])t.push(i);if(t.length)throw new Error("Mixin will overwrite block members: "+JSON.stringify(t))}goog.mixin(this,e)};Blockly.Block.prototype.setColourFromRawValues_=function(e,o,t){e=goog.isString(e)?Blockly.utils.replaceMessageReferences(e):e;o=goog.isString(o)?Blockly.utils.replaceMessageReferences(o):o;t=goog.isString(t)?Blockly.utils.replaceMessageReferences(t):t;this.setColour(e,o,t)};Blockly.Block.prototype.setColourFromJson_=function(e){this.setColourFromRawValues_(e["colour"],e["colourSecondary"],e["colourTertiary"])};Blockly.Block.prototype.interpolate_=function(e,o,t){var i=Blockly.utils.tokenizeInterpolation(e);var r=[];var n=0;var l=[];for(var s=0;s<i.length;s++){var g=i[s];if("number"==typeof g){if(g<=0||g>o.length)throw new Error('Block "'+this.type+'": '+"Message index %"+g+" out of range.");if(r[g])throw new Error('Block "'+this.type+'": '+"Message index %"+g+" duplicated.");r[g]=true;n++;l.push(o[g-1])}else{g=g.trim();if(g)l.push(g)}}if(n!=o.length)throw new Error('Block "'+this.type+'": '+"Message does not reference all "+o.length+" arg(s).");if(l.length&&("string"==typeof l[l.length-1]||goog.string.startsWith(l[l.length-1]["type"],"field_"))){var a={type:"input_dummy"};if(t)a["align"]=t;l.push(a)}var c={LEFT:Blockly.ALIGN_LEFT,RIGHT:Blockly.ALIGN_RIGHT,CENTRE:Blockly.ALIGN_CENTRE};var u=[];for(var s=0;s<l.length;s++){var h=l[s];if("string"==typeof h)u.push([h,void 0]);else{var d=null;var p=null;do{var y=false;if("string"==typeof h)d=new Blockly.FieldLabel(h);else switch(h["type"]){case"input_value":p=this.appendValueInput(h["name"]);break;case"input_statement":p=this.appendStatementInput(h["name"]);break;case"input_dummy":p=this.appendDummyInput(h["name"]);break;default:d=Blockly.Field.fromJson(h);if(!d)if(h["alt"]){h=h["alt"];y=true}else console.warn("Blockly could not create a field of type "+h["type"]+". You may need to register your custom field.  See "+"github.com/google/blockly/issues/1584")}}while(y);if(d)u.push([d,h["name"]]);else if(p){if(h["check"])p.setCheck(h["check"]);if(h["align"])p.setAlign(c[h["align"]]);for(var f=0;f<u.length;f++)p.appendField(u[f][0],u[f][1]);u.length=0}}}};Blockly.Block.prototype.appendInput_=function(e,o){var t=null;if(e==Blockly.INPUT_VALUE||e==Blockly.NEXT_STATEMENT)t=this.makeConnection_(e);var i=new Blockly.Input(e,o,this,t);this.inputList.push(i);return i};Blockly.Block.prototype.moveInputBefore=function(e,o){if(e==o)return;var t=-1;var i=o?-1:this.inputList.length;for(var r=0,n;n=this.inputList[r];r++)if(n.name==e){t=r;if(-1!=i)break}else if(o&&n.name==o){i=r;if(-1!=t)break}goog.asserts.assert(-1!=t,'Named input "%s" not found.',e);goog.asserts.assert(-1!=i,'Reference input "%s" not found.',o);this.moveNumberedInputBefore(t,i)};Blockly.Block.prototype.moveNumberedInputBefore=function(e,o){goog.asserts.assert(e!=o,"Can't move input to itself.");goog.asserts.assert(e<this.inputList.length,"Input index "+e+" out of bounds.");goog.asserts.assert(o<=this.inputList.length,"Reference input "+o+" out of bounds.");var t=this.inputList[e];this.inputList.splice(e,1);if(e<o)o--;this.inputList.splice(o,0,t)};Blockly.Block.prototype.removeInput=function(e,o){for(var t=0,i;i=this.inputList[t];t++)if(i.name==e){if(i.connection&&i.connection.isConnected()){i.connection.setShadowDom(null);var r=i.connection.targetBlock();if(r.isShadow())r.dispose();else r.unplug()}i.dispose();this.inputList.splice(t,1);return}if(!o)goog.asserts.fail('Input "%s" not found.',e)};Blockly.Block.prototype.getInput=function(e){for(var o=0,t;t=this.inputList[o];o++)if(t.name==e)return t;return null};Blockly.Block.prototype.getInputTargetBlock=function(e){var o=this.getInput(e);return o&&o.connection&&o.connection.targetBlock()};Blockly.Block.prototype.getCommentText=function(){return this.comment||""};Blockly.Block.prototype.setCommentText=function(e){if(this.comment!=e){Blockly.Events.fire(new Blockly.Events.BlockChange(this,"comment",null,this.comment,e||""));this.comment=e}};Blockly.Block.prototype.setOutputShape=function(e){this.outputShape_=e};Blockly.Block.prototype.getOutputShape=function(){return this.outputShape_};Blockly.Block.prototype.setCategory=function(e){this.category_=e};Blockly.Block.prototype.getCategory=function(){return this.category_};Blockly.Block.prototype.setCheckboxInFlyout=function(e){this.checkboxInFlyout_=e};Blockly.Block.prototype.hasCheckboxInFlyout=function(){return this.checkboxInFlyout_};Blockly.Block.prototype.setWarningText=function(){};Blockly.Block.prototype.setMutator=function(){};Blockly.Block.prototype.getRelativeToSurfaceXY=function(){return this.xy_};Blockly.Block.prototype.moveBy=function(e,o){goog.asserts.assert(!this.parentBlock_,"Block has parent.");var t=new Blockly.Events.BlockMove(this);this.xy_.translate(e,o);t.recordNew();Blockly.Events.fire(t)};Blockly.Block.prototype.makeConnection_=function(e){return new Blockly.Connection(this,e)};Blockly.Block.prototype.allInputsFilled=function(e){if(void 0===e)e=true;if(!e&&this.isShadow())return false;for(var o=0,t;t=this.inputList[o];o++){if(!t.connection)continue;var i=t.connection.targetBlock();if(!i||!i.allInputsFilled(e))return false}var r=this.getNextBlock();if(r)return r.allInputsFilled(e);return true};Blockly.Block.prototype.toDevString=function(){var e=this.type?'"'+this.type+'" block':"Block";if(this.id)e+=' (id="'+this.id+'")';return e};goog.provide("Blockly.BlockSvg");goog.require("Blockly.Block");goog.require("Blockly.BlockAnimations");goog.require("Blockly.ContextMenu");goog.require("Blockly.Events.Ui");goog.require("Blockly.Events.BlockMove");goog.require("Blockly.Grid");goog.require("Blockly.RenderedConnection");goog.require("Blockly.scratchBlocksUtils");goog.require("Blockly.Tooltip");goog.require("Blockly.Touch");goog.require("Blockly.utils");goog.require("goog.Timer");goog.require("goog.asserts");goog.require("goog.dom");goog.require("goog.math.Coordinate");Blockly.BlockSvg=function(e,o,t){this.svgGroup_=Blockly.utils.createSvgElement("g",{},null);this.svgPath_=Blockly.utils.createSvgElement("path",{class:"blocklyPath blocklyBlockBackground"},this.svgGroup_);this.svgPath_.tooltip=this;this.rendered=false;this.useDragSurface_=Blockly.utils.is3dSupported()&&!!e.blockDragSurface_;Blockly.Tooltip.bindMouseEvents(this.svgPath_);Blockly.BlockSvg.superClass_.constructor.call(this,e,o,t);if(this.svgGroup_.dataset)this.svgGroup_.dataset.id=this.id};goog.inherits(Blockly.BlockSvg,Blockly.Block);Blockly.BlockSvg.prototype.height=0;Blockly.BlockSvg.prototype.width=0;Blockly.BlockSvg.prototype.insertionMarkerMinWidth_=0;Blockly.BlockSvg.prototype.opacity_=1;Blockly.BlockSvg.prototype.dragStartXY_=null;Blockly.BlockSvg.prototype.isGlowingBlock_=false;Blockly.BlockSvg.prototype.isGlowingStack_=false;Blockly.BlockSvg.INLINE=-1;Blockly.BlockSvg.prototype.initSvg=function(){goog.asserts.assert(this.workspace.rendered,"Workspace is headless.");if(!this.isInsertionMarker()){for(var e=0,o;o=this.inputList[e];e++){o.init();o.initOutlinePath(this.svgGroup_)}var t=this.getIcons();for(e=0;e<t.length;e++)t[e].createIcon()}this.updateColour();this.updateMovable();if(!this.workspace.options.readOnly&&!this.eventsInit_)Blockly.bindEventWithChecks_(this.getSvgRoot(),"mousedown",this,this.onMouseDown_);this.eventsInit_=true;if(!this.getSvgRoot().parentNode)this.workspace.getCanvas().appendChild(this.getSvgRoot())};Blockly.BlockSvg.prototype.select=function(){if(this.isShadow()&&this.getParent()){this.getParent().select();return}if(Blockly.selected==this)return;var e=null;if(Blockly.selected){e=Blockly.selected.id;Blockly.Events.disable();try{Blockly.selected.unselect()}finally{Blockly.Events.enable()}}var o=new Blockly.Events.Ui(null,"selected",e,this.id);o.workspaceId=this.workspace.id;Blockly.Events.fire(o);Blockly.selected=this;this.addSelect()};Blockly.BlockSvg.prototype.unselect=function(){if(Blockly.selected!=this)return;var e=new Blockly.Events.Ui(null,"selected",this.id,null);e.workspaceId=this.workspace.id;Blockly.Events.fire(e);Blockly.selected=null;this.removeSelect()};Blockly.BlockSvg.prototype.setGlowBlock=function(e){this.isGlowingBlock_=e;this.updateColour()};Blockly.BlockSvg.prototype.setGlowStack=function(e){this.isGlowingStack_=e;var o=this.getSvgRoot();if(this.isGlowingStack_&&!o.hasAttribute("filter")){var t=this.workspace.options.stackGlowFilterId||"blocklyStackGlowFilter";o.setAttribute("filter","url(#"+t+")")}else if(!this.isGlowingStack_&&o.hasAttribute("filter"))o.removeAttribute("filter")};Blockly.BlockSvg.prototype.mutator=null;Blockly.BlockSvg.prototype.comment=null;Blockly.BlockSvg.prototype.warning=null;Blockly.BlockSvg.prototype.getIcons=function(){var e=[];if(this.mutator)e.push(this.mutator);if(this.comment)e.push(this.comment);if(this.warning)e.push(this.warning);return e};Blockly.BlockSvg.prototype.setParent=function(e){var o=this.parentBlock_;if(e==o)return;Blockly.Field.startCache();Blockly.BlockSvg.superClass_.setParent.call(this,e);Blockly.Field.stopCache();var t=this.getSvgRoot();if(this.workspace.isClearing||!t)return;var i=this.getRelativeToSurfaceXY();if(e){e.getSvgRoot().appendChild(t);var r=this.getRelativeToSurfaceXY();this.moveConnections_(r.x-i.x,r.y-i.y);if(this.isShadow())this.setColour(this.getColour(),this.getColourSecondary(),e.getColourTertiary())}else if(o){this.workspace.getCanvas().appendChild(t);this.translate(i.x,i.y)}};Blockly.BlockSvg.prototype.getRelativeToSurfaceXY=function(){var e=0;var o=0;var t=this.useDragSurface_?this.workspace.blockDragSurface_.getGroup():null;var i=this.getSvgRoot();if(i)do{var r=Blockly.utils.getRelativeXY(i);e+=r.x;o+=r.y;if(this.useDragSurface_&&this.workspace.blockDragSurface_.getCurrentBlock()==i){var n=this.workspace.blockDragSurface_.getSurfaceTranslation();e+=n.x;o+=n.y}i=i.parentNode}while(i&&i!=this.workspace.getCanvas()&&i!=t);return new goog.math.Coordinate(e,o)};Blockly.BlockSvg.prototype.moveBy=function(e,o){goog.asserts.assert(!this.parentBlock_,"Block has parent.");var t=Blockly.Events.isEnabled();if(t)var i=new Blockly.Events.BlockMove(this);var r=this.getRelativeToSurfaceXY();this.translate(r.x+e,r.y+o);this.moveConnections_(e,o);if(t){i.recordNew();Blockly.Events.fire(i)}this.workspace.resizeContents()};Blockly.BlockSvg.prototype.translate=function(e,o){this.getSvgRoot().setAttribute("transform","translate("+e+","+o+")")};Blockly.BlockSvg.prototype.moveToDragSurface_=function(){if(!this.useDragSurface_)return;var e=this.getRelativeToSurfaceXY();this.clearTransformAttributes_();this.workspace.blockDragSurface_.translateSurface(e.x,e.y);this.workspace.blockDragSurface_.setBlocksAndShow(this.getSvgRoot())};Blockly.BlockSvg.prototype.moveOffDragSurface_=function(e){if(!this.useDragSurface_)return;this.translate(e.x,e.y);this.workspace.blockDragSurface_.clearAndHide(this.workspace.getCanvas())};Blockly.BlockSvg.prototype.moveDuringDrag=function(e){if(this.useDragSurface_)this.workspace.blockDragSurface_.translateSurface(e.x,e.y);else{this.svgGroup_.translate_="translate("+e.x+","+e.y+")";this.svgGroup_.setAttribute("transform",this.svgGroup_.translate_+this.svgGroup_.skew_)}};Blockly.BlockSvg.prototype.clearTransformAttributes_=function(){Blockly.utils.removeAttribute(this.getSvgRoot(),"transform")};Blockly.BlockSvg.prototype.snapToGrid=function(){if(!this.workspace)return;if(this.workspace.isDragging())return;if(this.getParent())return;if(this.isInFlyout)return;var e=this.workspace.getGrid();if(!e||!e.shouldSnap())return;var o=e.getSpacing();var t=o/2;var i=this.getRelativeToSurfaceXY();var r=Math.round((i.x-t)/o)*o+t-i.x;var n=Math.round((i.y-t)/o)*o+t-i.y;r=Math.round(r);n=Math.round(n);if(0!=r||0!=n)this.moveBy(r,n)};Blockly.BlockSvg.prototype.getBoundingRectangle=function(){var e=this.getRelativeToSurfaceXY(this);var o=this.getHeightWidth();var t;var i;if(this.RTL){t=new goog.math.Coordinate(e.x-o.width,e.y);i=new goog.math.Coordinate(e.x,e.y+o.height)}else{t=new goog.math.Coordinate(e.x,e.y);i=new goog.math.Coordinate(e.x+o.width,e.y+o.height)}return{topLeft:t,bottomRight:i}};Blockly.BlockSvg.prototype.setOpacity=function(e){this.opacity_=e;if(this.rendered)this.updateColour()};Blockly.BlockSvg.prototype.getOpacity=function(){return this.opacity_};Blockly.BlockSvg.prototype.setCollapsed=function(e){if(this.collapsed_==e)return;var o=[];for(var t=0,i;i=this.inputList[t];t++)o.push.apply(o,i.setVisible(!e));var r="_TEMP_COLLAPSED_INPUT";if(e){var n=this.getIcons();for(var t=0;t<n.length;t++)n[t].setVisible(false);var l=this.toString(Blockly.COLLAPSE_CHARS);this.appendDummyInput(r).appendField(l).init()}else{this.removeInput(r);this.setWarningText(null)}Blockly.BlockSvg.superClass_.setCollapsed.call(this,e);if(!o.length)o[0]=this;if(this.rendered)for(var t=0,s;s=o[t];t++)s.render()};Blockly.BlockSvg.prototype.tab=function(e,o){var t=this.createTabList_();var i=t.indexOf(e);if(-1==i)i=o?-1:t.length;var r=t[o?i+1:i-1];if(!r){var n=this.outputConnection&&this.outputConnection.targetBlock();if(n)n.tab(this,o);else{var l=o?this.getNextBlock():this.getPreviousBlock();if(l)l.tab(this,o)}}else if(r instanceof Blockly.Field)r.showEditor_();else r.tab(null,o)};Blockly.BlockSvg.prototype.createTabList_=function(){var e=[];for(var o=0,t;t=this.inputList[o];o++){for(var i=0,r;r=t.fieldRow[i];i++)if(r instanceof Blockly.FieldTextInput)e.push(r);if(t.connection){var n=t.connection.targetBlock();if(n)e.push(n)}}return e};Blockly.BlockSvg.prototype.onMouseDown_=function(e){var o=this.workspace&&this.workspace.getGesture(e);if(o)o.handleBlockStart(e,this)};Blockly.BlockSvg.prototype.showHelp_=function(){var e=goog.isFunction(this.helpUrl)?this.helpUrl():this.helpUrl;if(e)alert(e)};Blockly.BlockSvg.prototype.showContextMenu_=function(e){if(this.workspace.options.readOnly||!this.contextMenu)return;var o=this;var t=[];if(this.isDeletable()&&this.isMovable()&&!o.isInFlyout){t.push(Blockly.ContextMenu.blockDuplicateOption(o,e));if(this.isEditable()&&this.workspace.options.comments)t.push(Blockly.ContextMenu.blockCommentOption(o));t.push(Blockly.ContextMenu.blockDeleteOption(o))}else if(this.parentBlock_&&this.isShadow_){this.parentBlock_.showContextMenu_(e);return}if(this.customContextMenu)this.customContextMenu(t);Blockly.ContextMenu.show(e,t,this.RTL);Blockly.ContextMenu.currentBlock=this};Blockly.BlockSvg.prototype.moveConnections_=function(e,o){if(!this.rendered)return;var t=this.getConnections_(false);for(var i=0;i<t.length;i++)t[i].moveBy(e,o);var r=this.getIcons();for(i=0;i<r.length;i++)r[i].computeIconLocation();for(i=0;i<this.childBlocks_.length;i++)this.childBlocks_[i].moveConnections_(e,o)};Blockly.BlockSvg.prototype.setDragging=function(e){if(e){var o=this.getSvgRoot();o.translate_="";o.skew_="";Blockly.draggingConnections_=Blockly.draggingConnections_.concat(this.getConnections_(true));Blockly.utils.addClass(this.svgGroup_,"blocklyDragging")}else{Blockly.draggingConnections_=[];Blockly.utils.removeClass(this.svgGroup_,"blocklyDragging")}for(var t=0;t<this.childBlocks_.length;t++)this.childBlocks_[t].setDragging(e)};Blockly.BlockSvg.prototype.updateMovable=function(){if(this.isMovable())Blockly.utils.addClass(this.svgGroup_,"blocklyDraggable");else Blockly.utils.removeClass(this.svgGroup_,"blocklyDraggable")};Blockly.BlockSvg.prototype.setMovable=function(e){Blockly.BlockSvg.superClass_.setMovable.call(this,e);this.updateMovable()};Blockly.BlockSvg.prototype.setEditable=function(e){Blockly.BlockSvg.superClass_.setEditable.call(this,e);var o=this.getIcons();for(var t=0;t<o.length;t++)o[t].updateEditable()};Blockly.BlockSvg.prototype.setShadow=function(e){Blockly.BlockSvg.superClass_.setShadow.call(this,e);this.updateColour()};Blockly.BlockSvg.prototype.setInsertionMarker=function(e,o){Blockly.BlockSvg.superClass_.setInsertionMarker.call(this,e);this.insertionMarkerMinWidth_=o;this.updateColour()};Blockly.BlockSvg.prototype.getSvgRoot=function(){return this.svgGroup_};Blockly.BlockSvg.prototype.dispose=function(e,o){if(!this.workspace)return;Blockly.Tooltip.hide();Blockly.Field.startCache();var t=this.workspace;if(Blockly.selected==this){this.unselect();this.workspace.cancelCurrentGesture()}if(Blockly.ContextMenu.currentBlock==this)Blockly.ContextMenu.hide();if(o&&this.rendered){this.unplug(e);Blockly.BlockAnimations.disposeUiEffect(this)}this.rendered=false;Blockly.Events.disable();try{var i=this.getIcons();for(var r=0;r<i.length;r++)i[r].dispose()}finally{Blockly.Events.enable()}Blockly.BlockSvg.superClass_.dispose.call(this,e);goog.dom.removeNode(this.svgGroup_);t.resizeContents();this.svgGroup_=null;this.svgPath_=null;Blockly.Field.stopCache()};Blockly.BlockSvg.prototype.updateDisabled=function(){};Blockly.BlockSvg.prototype.getCommentText=function(){if(this.comment){var e=this.comment.getText();return e.replace(/\s+$/,"").replace(/ +\n/g,"\n")}return""};Blockly.BlockSvg.prototype.setCommentText=function(e,o,t,i,r){var n=false;if(goog.isString(e))if(!this.comment){this.comment=new Blockly.ScratchBlockComment(this,e,o,t,i,r);n=true}else this.comment.setText(e);else if(this.comment){this.comment.dispose();n=true}if(n&&this.rendered){this.render();if(goog.isString(e))this.comment.setVisible(true);this.bumpNeighbours_()}};Blockly.BlockSvg.prototype.setWarningText=function(e,o){if(!this.setWarningText.pid_)this.setWarningText.pid_=Object.create(null);var t=o||"";if(!t)for(var i in this.setWarningText.pid_){clearTimeout(this.setWarningText.pid_[i]);delete this.setWarningText.pid_[i]}else if(this.setWarningText.pid_[t]){clearTimeout(this.setWarningText.pid_[t]);delete this.setWarningText.pid_[t]}if(this.workspace.isDragging()){var r=this;this.setWarningText.pid_[t]=setTimeout((function(){if(r.workspace){delete r.setWarningText.pid_[t];r.setWarningText(e,t)}}),100);return}if(this.isInFlyout)e=null;var n=false;if(goog.isString(e)){if(!this.warning){this.warning=new Blockly.Warning(this);n=true}this.warning.setText(e,t)}else if(this.warning&&!t){this.warning.dispose();n=true}else if(this.warning){var l=this.warning.getText();this.warning.setText("",t);var s=this.warning.getText();if(!s)this.warning.dispose();n=l!=s}if(n&&this.rendered){this.render();this.bumpNeighbours_()}};Blockly.BlockSvg.prototype.setMutator=function(e){if(this.mutator&&this.mutator!==e)this.mutator.dispose();if(e){e.block_=this;this.mutator=e;e.createIcon()}};Blockly.BlockSvg.prototype.addSelect=function(){Blockly.utils.addClass(this.svgGroup_,"blocklySelected")};Blockly.BlockSvg.prototype.removeSelect=function(){Blockly.utils.removeClass(this.svgGroup_,"blocklySelected")};Blockly.BlockSvg.prototype.setMouseThroughStyle=function(e){if(e)Blockly.utils.addClass(this.svgGroup_,"blocklyDraggingMouseThrough");else Blockly.utils.removeClass(this.svgGroup_,"blocklyDraggingMouseThrough")};Blockly.BlockSvg.prototype.setDeleteStyle=function(e){if(e)Blockly.utils.addClass(this.svgGroup_,"blocklyDraggingDelete");else Blockly.utils.removeClass(this.svgGroup_,"blocklyDraggingDelete")};Blockly.BlockSvg.prototype.setColour=function(e,o,t){Blockly.BlockSvg.superClass_.setColour.call(this,e,o,t);if(this.rendered)this.updateColour()};Blockly.BlockSvg.prototype.bringToFront=function(){var e=this;do{var o=e.getSvgRoot();o.parentNode.appendChild(o);e=e.getParent()}while(e)};Blockly.BlockSvg.prototype.setPreviousStatement=function(e,o){Blockly.BlockSvg.superClass_.setPreviousStatement.call(this,e,o);if(this.rendered){this.render();this.bumpNeighbours_()}};Blockly.BlockSvg.prototype.setNextStatement=function(e,o){Blockly.BlockSvg.superClass_.setNextStatement.call(this,e,o);if(this.rendered){this.render();this.bumpNeighbours_()}};Blockly.BlockSvg.prototype.setOutput=function(e,o){Blockly.BlockSvg.superClass_.setOutput.call(this,e,o);if(this.rendered){this.render();this.bumpNeighbours_()}};Blockly.BlockSvg.prototype.setInputsInline=function(e){Blockly.BlockSvg.superClass_.setInputsInline.call(this,e);if(this.rendered){this.render();this.bumpNeighbours_()}};Blockly.BlockSvg.prototype.removeInput=function(e,o){Blockly.BlockSvg.superClass_.removeInput.call(this,e,o);if(this.rendered){this.render();this.bumpNeighbours_()}};Blockly.BlockSvg.prototype.moveNumberedInputBefore=function(e,o){Blockly.BlockSvg.superClass_.moveNumberedInputBefore.call(this,e,o);if(this.rendered){this.render();this.bumpNeighbours_()}};Blockly.BlockSvg.prototype.appendInput_=function(e,o){var t=Blockly.BlockSvg.superClass_.appendInput_.call(this,e,o);if(this.rendered){this.render();this.bumpNeighbours_()}return t};Blockly.BlockSvg.prototype.getConnections_=function(e){var o=[];if(e||this.rendered){if(this.outputConnection)o.push(this.outputConnection);if(this.previousConnection)o.push(this.previousConnection);if(this.nextConnection)o.push(this.nextConnection);if(e||!this.collapsed_)for(var t=0,i;i=this.inputList[t];t++)if(i.connection)o.push(i.connection)}return o};Blockly.BlockSvg.prototype.makeConnection_=function(e){return new Blockly.RenderedConnection(this,e)};Blockly.BlockSvg.prototype.bumpNeighbours_=function(){if(!this.workspace)return;if(this.workspace.isDragging())return;var e=this.getRootBlock();if(e.isInFlyout)return;var o=this.getConnections_(false);for(var t=0,i;i=o[t];t++){if(i.isConnected()&&i.isSuperior())i.targetBlock().bumpNeighbours_();var r=i.neighbours_(Blockly.SNAP_RADIUS);for(var n=0,l;l=r[n];n++)if(!i.isConnected()||!l.isConnected())if(l.getSourceBlock().getRootBlock()!=e)if(i.isSuperior())l.bumpAwayFrom_(i);else i.bumpAwayFrom_(l)}};Blockly.BlockSvg.prototype.scheduleSnapAndBump=function(){var e=this;var o=Blockly.Events.getGroup();setTimeout((function(){Blockly.Events.setGroup(o);e.snapToGrid();Blockly.Events.setGroup(false)}),Blockly.BUMP_DELAY/2);setTimeout((function(){Blockly.Events.setGroup(o);e.bumpNeighbours_();Blockly.Events.setGroup(false)}),Blockly.BUMP_DELAY)};goog.provide("Blockly.BlockSvg.render");goog.require("Blockly.BlockSvg");goog.require("Blockly.scratchBlocksUtils");goog.require("Blockly.utils");Blockly.BlockSvg.GRID_UNIT=4;Blockly.BlockSvg.SEP_SPACE_X=2*Blockly.BlockSvg.GRID_UNIT;Blockly.BlockSvg.SEP_SPACE_Y=2*Blockly.BlockSvg.GRID_UNIT;Blockly.BlockSvg.MIN_BLOCK_X=16*Blockly.BlockSvg.GRID_UNIT;Blockly.BlockSvg.MIN_BLOCK_X_OUTPUT=12*Blockly.BlockSvg.GRID_UNIT;Blockly.BlockSvg.MIN_BLOCK_X_SHADOW_OUTPUT=10*Blockly.BlockSvg.GRID_UNIT;Blockly.BlockSvg.MIN_BLOCK_Y=12*Blockly.BlockSvg.GRID_UNIT;Blockly.BlockSvg.EXTRA_STATEMENT_ROW_Y=8*Blockly.BlockSvg.GRID_UNIT;Blockly.BlockSvg.MIN_BLOCK_X_WITH_STATEMENT=40*Blockly.BlockSvg.GRID_UNIT;Blockly.BlockSvg.MIN_BLOCK_Y_SINGLE_FIELD_OUTPUT=8*Blockly.BlockSvg.GRID_UNIT;Blockly.BlockSvg.MIN_BLOCK_Y_REPORTER=10*Blockly.BlockSvg.GRID_UNIT;Blockly.BlockSvg.MIN_STATEMENT_INPUT_HEIGHT=6*Blockly.BlockSvg.GRID_UNIT;Blockly.BlockSvg.NOTCH_WIDTH=8*Blockly.BlockSvg.GRID_UNIT;Blockly.BlockSvg.NOTCH_HEIGHT=2*Blockly.BlockSvg.GRID_UNIT;Blockly.BlockSvg.CORNER_RADIUS=1*Blockly.BlockSvg.GRID_UNIT;Blockly.BlockSvg.STATEMENT_INPUT_EDGE_WIDTH=4*Blockly.BlockSvg.GRID_UNIT;Blockly.BlockSvg.STATEMENT_INPUT_INNER_SPACE=2*Blockly.BlockSvg.GRID_UNIT;Blockly.BlockSvg.START_HAT_HEIGHT=16;Blockly.BlockSvg.ICON_SEPARATOR_HEIGHT=10*Blockly.BlockSvg.GRID_UNIT;Blockly.BlockSvg.START_HAT_PATH="c 25,-22 71,-22 96,0";Blockly.BlockSvg.NOTCH_PATH_LEFT="c 2,0 3,1 4,2 "+"l 4,4 "+"c 1,1 2,2 4,2 "+"h 12 "+"c 2,0 3,-1 4,-2 "+"l 4,-4 "+"c 1,-1 2,-2 4,-2";Blockly.BlockSvg.NOTCH_PATH_RIGHT="c -2,0 -3,1 -4,2 "+"l -4,4 "+"c -1,1 -2,2 -4,2 "+"h -12 "+"c -2,0 -3,-1 -4,-2 "+"l -4,-4 "+"c -1,-1 -2,-2 -4,-2";Blockly.BlockSvg.NOTCH_START_PADDING=3*Blockly.BlockSvg.GRID_UNIT;Blockly.BlockSvg.TOP_LEFT_CORNER_START="m 0,"+Blockly.BlockSvg.CORNER_RADIUS;Blockly.BlockSvg.TOP_LEFT_CORNER="A "+Blockly.BlockSvg.CORNER_RADIUS+","+Blockly.BlockSvg.CORNER_RADIUS+" 0 0,1 "+Blockly.BlockSvg.CORNER_RADIUS+",0";Blockly.BlockSvg.TOP_RIGHT_CORNER="a "+Blockly.BlockSvg.CORNER_RADIUS+","+Blockly.BlockSvg.CORNER_RADIUS+" 0 0,1 "+Blockly.BlockSvg.CORNER_RADIUS+","+Blockly.BlockSvg.CORNER_RADIUS;Blockly.BlockSvg.BOTTOM_RIGHT_CORNER=" a "+Blockly.BlockSvg.CORNER_RADIUS+","+Blockly.BlockSvg.CORNER_RADIUS+" 0 0,1 -"+Blockly.BlockSvg.CORNER_RADIUS+","+Blockly.BlockSvg.CORNER_RADIUS;Blockly.BlockSvg.BOTTOM_LEFT_CORNER="a "+Blockly.BlockSvg.CORNER_RADIUS+","+Blockly.BlockSvg.CORNER_RADIUS+" 0 0,1 -"+Blockly.BlockSvg.CORNER_RADIUS+",-"+Blockly.BlockSvg.CORNER_RADIUS;Blockly.BlockSvg.INNER_TOP_LEFT_CORNER=" a "+Blockly.BlockSvg.CORNER_RADIUS+","+Blockly.BlockSvg.CORNER_RADIUS+" 0 0,0 -"+Blockly.BlockSvg.CORNER_RADIUS+","+Blockly.BlockSvg.CORNER_RADIUS;Blockly.BlockSvg.INNER_BOTTOM_LEFT_CORNER="a "+Blockly.BlockSvg.CORNER_RADIUS+","+Blockly.BlockSvg.CORNER_RADIUS+" 0 0,0 "+Blockly.BlockSvg.CORNER_RADIUS+","+Blockly.BlockSvg.CORNER_RADIUS;Blockly.BlockSvg.INPUT_SHAPE_HEXAGONAL="M "+4*Blockly.BlockSvg.GRID_UNIT+",0 "+" h "+4*Blockly.BlockSvg.GRID_UNIT+" l "+4*Blockly.BlockSvg.GRID_UNIT+","+4*Blockly.BlockSvg.GRID_UNIT+" l "+-4*Blockly.BlockSvg.GRID_UNIT+","+4*Blockly.BlockSvg.GRID_UNIT+" h "+-4*Blockly.BlockSvg.GRID_UNIT+" l "+-4*Blockly.BlockSvg.GRID_UNIT+","+-4*Blockly.BlockSvg.GRID_UNIT+" l "+4*Blockly.BlockSvg.GRID_UNIT+","+-4*Blockly.BlockSvg.GRID_UNIT+" z";Blockly.BlockSvg.INPUT_SHAPE_HEXAGONAL_WIDTH=12*Blockly.BlockSvg.GRID_UNIT;Blockly.BlockSvg.INPUT_SHAPE_SQUARE=Blockly.BlockSvg.TOP_LEFT_CORNER_START+Blockly.BlockSvg.TOP_LEFT_CORNER+" h "+(12*Blockly.BlockSvg.GRID_UNIT-2*Blockly.BlockSvg.CORNER_RADIUS)+Blockly.BlockSvg.TOP_RIGHT_CORNER+" v "+(8*Blockly.BlockSvg.GRID_UNIT-2*Blockly.BlockSvg.CORNER_RADIUS)+Blockly.BlockSvg.BOTTOM_RIGHT_CORNER+" h "+(-12*Blockly.BlockSvg.GRID_UNIT+2*Blockly.BlockSvg.CORNER_RADIUS)+Blockly.BlockSvg.BOTTOM_LEFT_CORNER+" z";Blockly.BlockSvg.INPUT_SHAPE_SQUARE_WIDTH=10*Blockly.BlockSvg.GRID_UNIT;Blockly.BlockSvg.INPUT_SHAPE_ROUND="M "+4*Blockly.BlockSvg.GRID_UNIT+",0"+" h "+4*Blockly.BlockSvg.GRID_UNIT+" a "+4*Blockly.BlockSvg.GRID_UNIT+" "+4*Blockly.BlockSvg.GRID_UNIT+" 0 0 1 0 "+8*Blockly.BlockSvg.GRID_UNIT+" h "+-4*Blockly.BlockSvg.GRID_UNIT+" a "+4*Blockly.BlockSvg.GRID_UNIT+" "+4*Blockly.BlockSvg.GRID_UNIT+" 0 0 1 0 -"+8*Blockly.BlockSvg.GRID_UNIT+" z";Blockly.BlockSvg.INPUT_SHAPE_ROUND_WIDTH=12*Blockly.BlockSvg.GRID_UNIT;Blockly.BlockSvg.INPUT_SHAPE_HEIGHT=8*Blockly.BlockSvg.GRID_UNIT;Blockly.BlockSvg.FIELD_HEIGHT=8*Blockly.BlockSvg.GRID_UNIT;Blockly.BlockSvg.FIELD_WIDTH=6*Blockly.BlockSvg.GRID_UNIT;Blockly.BlockSvg.EDITABLE_FIELD_PADDING=6;Blockly.BlockSvg.BOX_FIELD_PADDING=2*Blockly.BlockSvg.GRID_UNIT;Blockly.BlockSvg.DROPDOWN_ARROW_PADDING=2*Blockly.BlockSvg.GRID_UNIT;Blockly.BlockSvg.FIELD_WIDTH_MIN_EDIT=8*Blockly.BlockSvg.GRID_UNIT;Blockly.BlockSvg.FIELD_WIDTH_MAX_EDIT=1/0;Blockly.BlockSvg.FIELD_HEIGHT_MAX_EDIT=Blockly.BlockSvg.FIELD_HEIGHT;Blockly.BlockSvg.FIELD_TOP_PADDING=.5*Blockly.BlockSvg.GRID_UNIT;Blockly.BlockSvg.NUMBER_FIELD_CORNER_RADIUS=4*Blockly.BlockSvg.GRID_UNIT;Blockly.BlockSvg.TEXT_FIELD_CORNER_RADIUS=1*Blockly.BlockSvg.GRID_UNIT;Blockly.BlockSvg.FIELD_DEFAULT_CORNER_RADIUS=4*Blockly.BlockSvg.GRID_UNIT;Blockly.BlockSvg.MAX_DISPLAY_LENGTH=1/0;Blockly.BlockSvg.INPUT_AND_FIELD_MIN_X=12*Blockly.BlockSvg.GRID_UNIT;Blockly.BlockSvg.INLINE_PADDING_Y=1*Blockly.BlockSvg.GRID_UNIT;Blockly.BlockSvg.FIELD_TEXTINPUT_FONTSIZE_INITIAL=12;Blockly.BlockSvg.FIELD_TEXTINPUT_FONTSIZE_FINAL=12;Blockly.BlockSvg.FIELD_TEXTINPUT_EXPAND_PAST_TRUNCATION=false;Blockly.BlockSvg.FIELD_TEXTINPUT_ANIMATE_POSITIONING=false;Blockly.BlockSvg.SHAPE_IN_SHAPE_PADDING={1:{0:5*Blockly.BlockSvg.GRID_UNIT,1:2*Blockly.BlockSvg.GRID_UNIT,2:5*Blockly.BlockSvg.GRID_UNIT,3:5*Blockly.BlockSvg.GRID_UNIT},2:{0:3*Blockly.BlockSvg.GRID_UNIT,1:3*Blockly.BlockSvg.GRID_UNIT,2:1*Blockly.BlockSvg.GRID_UNIT,3:2*Blockly.BlockSvg.GRID_UNIT},3:{0:2*Blockly.BlockSvg.GRID_UNIT,1:2*Blockly.BlockSvg.GRID_UNIT,2:2*Blockly.BlockSvg.GRID_UNIT,3:2*Blockly.BlockSvg.GRID_UNIT}};Blockly.BlockSvg.DEFINE_HAT_CORNER_RADIUS=5*Blockly.BlockSvg.GRID_UNIT;Blockly.BlockSvg.TOP_LEFT_CORNER_DEFINE_HAT="a "+Blockly.BlockSvg.DEFINE_HAT_CORNER_RADIUS+","+Blockly.BlockSvg.DEFINE_HAT_CORNER_RADIUS+" 0 0,1 "+Blockly.BlockSvg.DEFINE_HAT_CORNER_RADIUS+",-"+Blockly.BlockSvg.DEFINE_HAT_CORNER_RADIUS;Blockly.BlockSvg.TOP_RIGHT_CORNER_DEFINE_HAT="a "+Blockly.BlockSvg.DEFINE_HAT_CORNER_RADIUS+","+Blockly.BlockSvg.DEFINE_HAT_CORNER_RADIUS+" 0 0,1 "+Blockly.BlockSvg.DEFINE_HAT_CORNER_RADIUS+","+Blockly.BlockSvg.DEFINE_HAT_CORNER_RADIUS;Blockly.BlockSvg.DEFINE_BLOCK_PADDING_RIGHT=2*Blockly.BlockSvg.GRID_UNIT;Blockly.BlockSvg.prototype.updateColour=function(){var e=this.getColourTertiary();var o=this.isShadow()&&!Blockly.scratchBlocksUtils.isShadowArgumentReporter(this);if(o&&this.parentBlock_){e=this.parentBlock_.getColourTertiary();if(this.inputList[0]&&this.inputList[0].fieldRow[0]&&(this.inputList[0].fieldRow[0]instanceof Blockly.FieldColour||this.inputList[0].fieldRow[0]instanceof Blockly.FieldColourSlider))e=Blockly.Colours.colourPickerStroke}this.svgPath_.setAttribute("stroke",e);if(this.isGlowingBlock_||o)if(this.getShadowColour())var t=this.getShadowColour();else var t=this.getColourSecondary();else var t=this.getColour();this.svgPath_.setAttribute("fill",t);this.svgPath_.setAttribute("fill-opacity",this.getOpacity());for(var i=0,r;r=this.inputList[i];i++)if(r.outlinePath)r.outlinePath.setAttribute("fill",this.getColourTertiary());var n=this.getIcons();for(var i=0;i<n.length;i++)n[i].updateColour();for(var l=0,r;r=this.inputList[l];l++)for(var s=0,g;g=r.fieldRow[s];s++)g.setText(null)};Blockly.BlockSvg.prototype.highlightForReplacement=function(e){if(e){var o=this.workspace.options.replacementGlowFilterId||"blocklyReplacementGlowFilter";this.svgPath_.setAttribute("filter","url(#"+o+")");Blockly.utils.addClass(this.svgGroup_,"blocklyReplaceable")}else{this.svgPath_.removeAttribute("filter");Blockly.utils.removeClass(this.svgGroup_,"blocklyReplaceable")}};Blockly.BlockSvg.prototype.highlightShapeForInput=function(e,o){var t=this.getInputWithConnection(e);if(!t)throw"No input found for the connection";if(!t.outlinePath)return;if(o){var i=this.workspace.options.replacementGlowFilterId||"blocklyReplacementGlowFilter";t.outlinePath.setAttribute("filter","url(#"+i+")");Blockly.utils.addClass(this.svgGroup_,"blocklyReplaceable")}else{t.outlinePath.removeAttribute("filter");Blockly.utils.removeClass(this.svgGroup_,"blocklyReplaceable")}};Blockly.BlockSvg.prototype.getHeightWidth=function(){var e=this.height;var o=this.width;var t=this.getNextBlock();if(t){var i=t.getHeightWidth();e+=i.height;e-=Blockly.BlockSvg.NOTCH_HEIGHT;o=Math.max(o,i.width)}return{height:e,width:o}};Blockly.BlockSvg.prototype.render=function(e){Blockly.Field.startCache();this.rendered=true;var o=Blockly.BlockSvg.SEP_SPACE_X;if(this.RTL)o=-o;var t=this.getIcons();var i=null;for(var r=0;r<t.length;r++)if(t[r]instanceof Blockly.ScratchBlockComment)i=t[r];else o=t[r].renderIcon(o);o+=this.RTL?Blockly.BlockSvg.SEP_SPACE_X:-Blockly.BlockSvg.SEP_SPACE_X;if(this.isScratchExtension&&this.outputConnection)o+=this.RTL?-Blockly.BlockSvg.GRID_UNIT:Blockly.BlockSvg.GRID_UNIT;var n=this.renderCompute_(o);this.renderDraw_(o,n);this.renderMoveConnections_();this.renderClassify_();if(i){var l=this.RTL?-n.rightEdge:n.rightEdge;var s=n[0].height/2;i.renderIcon(l,s)}if(false!==e){var g=this.getParent();if(g)g.render(true);else Blockly.resizeSvgContents(this.workspace)}Blockly.Field.stopCache()};Blockly.BlockSvg.prototype.renderFields_=function(e,o,t){if(this.RTL)o=-o;for(var i=0,r;r=e[i];i++){var n=r.getSvgRoot();if(!n)continue;if(this.previousConnection&&!(r instanceof Blockly.FieldLabel)&&!(r instanceof Blockly.FieldImage))o=this.RTL?Math.min(o,-Blockly.BlockSvg.INPUT_AND_FIELD_MIN_X):Math.max(o,Blockly.BlockSvg.INPUT_AND_FIELD_MIN_X);var l=-r.getSize().height/2;if(this.isScratchExtension&&r===this.inputList[0].fieldRow[0]&&r instanceof Blockly.FieldImage&&this.previousConnection)l+=Blockly.BlockSvg.GRID_UNIT;if(this.isScratchExtension&&!this.previousConnection&&this.nextConnection&&r instanceof Blockly.FieldVerticalSeparator)r.setLineHeight(Blockly.BlockSvg.ICON_SEPARATOR_HEIGHT-Blockly.BlockSvg.GRID_UNIT);var s,g;var a="";if(this.RTL){o-=r.renderSep+r.renderWidth;s=o;g=t+l;if(r.renderWidth)o-=Blockly.BlockSvg.SEP_SPACE_X}else{s=o+r.renderSep;g=t+l;if(r.renderWidth)o+=r.renderSep+r.renderWidth+Blockly.BlockSvg.SEP_SPACE_X}if(this.RTL&&r instanceof Blockly.FieldImage&&r.getFlipRTL()){a="scale(-1 1)";s+=r.renderWidth}n.setAttribute("transform","translate("+s+", "+g+") "+a);if(this.isInsertionMarker())n.setAttribute("display","none")}return this.RTL?-o:o};Blockly.BlockSvg.prototype.renderCompute_=function(e){var o=this.inputList;var t=[];t.rightEdge=0;t.bottomEdge=0;var i=0;var r=0;var n=false;var l=false;var s=false;var g=void 0;var a;for(var c=0,u;u=o[c];c++){if(!u.isVisible())continue;var h="procedures_definition"==this.type&&g&&g==Blockly.NEXT_STATEMENT;var d;if(!h&&(!g||g==Blockly.NEXT_STATEMENT||u.type==Blockly.NEXT_STATEMENT)){g=u.type;d=this.createRowForInput_(u);t.push(d)}else d=t[t.length-1];d.push(u);u.renderHeight=this.computeInputHeight_(u,d,a);u.renderWidth=this.computeInputWidth_(u);d.statementNotchAtBottom=true;if(u.connection&&u.connection.type===Blockly.NEXT_STATEMENT){var p=u.connection.targetBlock();if(p&&!p.lastConnectionInStack())d.statementNotchAtBottom=false}if(u.connection){var p=u.connection.targetBlock();var y=0;var f=0;if(p){var m=p.getHeightWidth();y=m.height;f=m.width}else y=Blockly.BlockSvg.INPUT_SHAPE_HEIGHT;if(u.connection.type===Blockly.INPUT_VALUE)y+=2*Blockly.BlockSvg.INLINE_PADDING_Y;if(u.connection.type===Blockly.NEXT_STATEMENT)if(d.statementNotchAtBottom)y-=Blockly.BlockSvg.NOTCH_HEIGHT;u.renderHeight=Math.max(u.renderHeight,y);u.renderWidth=Math.max(u.renderWidth,f)}d.height=Math.max(d.height,u.renderHeight);u.fieldWidth=0;if(1==t.length)u.fieldWidth+=this.RTL?-e:e;var _=false;for(var v=0,k;k=u.fieldRow[v];v++){if(0!=v)u.fieldWidth+=Blockly.BlockSvg.SEP_SPACE_X;var B=k.getSize();k.renderWidth=B.width;k.renderSep=_&&k.EDITABLE?Blockly.BlockSvg.SEP_SPACE_X:0;if(!h)u.fieldWidth+=k.renderWidth+k.renderSep;d.height=Math.max(d.height,B.height);_=k.EDITABLE}if(d.type!=Blockly.BlockSvg.INLINE)if(d.type==Blockly.NEXT_STATEMENT){l=true;r=Math.max(r,u.fieldWidth)}else{if(d.type==Blockly.INPUT_VALUE)n=true;else if(d.type==Blockly.DUMMY_INPUT)s=true;i=Math.max(i,u.fieldWidth)}a=d}this.computeOutputPadding_(t);t.statementEdge=Blockly.BlockSvg.STATEMENT_INPUT_EDGE_WIDTH+r;t.rightEdge=this.computeRightEdge_(t.rightEdge,l);for(var c=0;c<t.length;c++)t.bottomEdge+=t[c].height;t.hasValue=n;t.hasStatement=l;t.hasDummy=s;return t};Blockly.BlockSvg.prototype.computeInputWidth_=function(e){if(e.type==Blockly.INPUT_VALUE&&(!e.connection||!e.connection.isConnected()))switch(e.connection.getOutputShape()){case Blockly.OUTPUT_SHAPE_SQUARE:return Blockly.BlockSvg.INPUT_SHAPE_SQUARE_WIDTH;case Blockly.OUTPUT_SHAPE_ROUND:return Blockly.BlockSvg.INPUT_SHAPE_ROUND_WIDTH;case Blockly.OUTPUT_SHAPE_HEXAGONAL:return Blockly.BlockSvg.INPUT_SHAPE_HEXAGONAL_WIDTH;default:return 0}else return 0};Blockly.BlockSvg.prototype.computeInputHeight_=function(e,o,t){if(1===this.inputList.length&&this.outputConnection&&this.isShadow()&&!Blockly.scratchBlocksUtils.isShadowArgumentReporter(this))return Blockly.BlockSvg.MIN_BLOCK_Y_SINGLE_FIELD_OUTPUT;else if(this.outputConnection){if(this.isScratchExtension)return Blockly.BlockSvg.MIN_BLOCK_Y_REPORTER+2*Blockly.BlockSvg.GRID_UNIT;return Blockly.BlockSvg.MIN_BLOCK_Y_REPORTER}else if(o.type==Blockly.NEXT_STATEMENT)return Blockly.BlockSvg.MIN_STATEMENT_INPUT_HEIGHT;else if(t&&t.type==Blockly.NEXT_STATEMENT)return Blockly.BlockSvg.EXTRA_STATEMENT_ROW_Y;else{if(this.isScratchExtension&&this.previousConnection)return Blockly.BlockSvg.MIN_BLOCK_Y+2*Blockly.BlockSvg.GRID_UNIT;return Blockly.BlockSvg.MIN_BLOCK_Y}};Blockly.BlockSvg.prototype.createRowForInput_=function(e){var o=[];if(e.type!=Blockly.NEXT_STATEMENT)o.type=Blockly.BlockSvg.INLINE;else o.type=e.type;o.height=0;o.paddingStart=Blockly.BlockSvg.SEP_SPACE_X;o.paddingEnd=Blockly.BlockSvg.SEP_SPACE_X;return o};Blockly.BlockSvg.prototype.computeRightEdge_=function(e,o){var t=e;if(this.previousConnection||this.nextConnection)t=Math.max(t,Blockly.BlockSvg.MIN_BLOCK_X);else if(this.outputConnection)if(this.isShadow()&&!Blockly.scratchBlocksUtils.isShadowArgumentReporter(this))t=Math.max(t,Blockly.BlockSvg.MIN_BLOCK_X_SHADOW_OUTPUT);else t=Math.max(t,Blockly.BlockSvg.MIN_BLOCK_X_OUTPUT);if(o)t=Math.max(t,Blockly.BlockSvg.MIN_BLOCK_X_WITH_STATEMENT);if(this.insertionMarkerMinWidth_>0)t=Math.max(t,this.insertionMarkerMinWidth_);return t};Blockly.BlockSvg.prototype.computeOutputPadding_=function(e){if(!this.getOutputShape()||!this.outputConnection||this.isShadow()&&!Blockly.scratchBlocksUtils.isShadowArgumentReporter(this))return;if(e.length>1)return;var o=e[0];var t=this.getOutputShape();o.paddingStart=0;o.paddingEnd=0;var i=o[0];var r=i.fieldRow[0];var n;if(r)n=0;else{var l=i.connection;if(!l.targetConnection)n=l.getOutputShape();else n=l.targetConnection.getSourceBlock().getOutputShape();if(t==Blockly.OUTPUT_SHAPE_HEXAGONAL&&n!=Blockly.OUTPUT_SHAPE_HEXAGONAL){var s=i.renderHeight-Blockly.BlockSvg.MIN_BLOCK_Y_REPORTER;o.paddingStart+=s/2}}o.paddingStart+=Blockly.BlockSvg.SHAPE_IN_SHAPE_PADDING[t][n];var g=o[o.length-1];if(g.connection){var l=g.connection;if(!l.targetConnection)n=l.getOutputShape();else n=l.targetConnection.getSourceBlock().getOutputShape();if(t==Blockly.OUTPUT_SHAPE_HEXAGONAL&&n!=Blockly.OUTPUT_SHAPE_HEXAGONAL){var s=g.renderHeight-Blockly.BlockSvg.MIN_BLOCK_Y_REPORTER;o.paddingEnd+=s/2}}else n=0;o.paddingEnd+=Blockly.BlockSvg.SHAPE_IN_SHAPE_PADDING[t][n]};Blockly.BlockSvg.prototype.renderDraw_=function(e,o){this.startHat_=false;this.squareTopLeftCorner_=false;if(!this.outputConnection&&!this.previousConnection){this.squareTopLeftCorner_=true;this.startHat_=true;o.rightEdge=Math.max(o.rightEdge,100)}this.edgeShapeWidth_=0;this.edgeShape_=null;if(this.outputConnection){var t=this.getOutputShape();if(t===Blockly.OUTPUT_SHAPE_HEXAGONAL||t===Blockly.OUTPUT_SHAPE_ROUND){this.edgeShapeWidth_=o.bottomEdge/2;this.edgeShape_=t;this.squareTopLeftCorner_=true}}var i=[];this.renderDrawTop_(i,o.rightEdge);var r=this.renderDrawRight_(i,o,e);this.renderDrawBottom_(i,r);this.renderDrawLeft_(i);var n=i.join(" ");this.svgPath_.setAttribute("d",n);if(this.RTL)this.svgPath_.setAttribute("transform","scale(-1 1)")};Blockly.BlockSvg.prototype.renderClassify_=function(){var e=[];if(this.outputConnection){if(this.isShadow_)e.push("argument");else e.push("reporter");if(this.edgeShape_===Blockly.OUTPUT_SHAPE_HEXAGONAL)e.push("boolean");else if(this.edgeShape_===Blockly.OUTPUT_SHAPE_ROUND)e.push("round")}else{var o=this.inputList;var t=0;for(var i=0,r;r=o[i];i++)if(r.connection&&r.connection.type===Blockly.NEXT_STATEMENT)t++;if(t){e.push("c-block");e.push("c-"+t)}if(this.startHat_)e.push("hat");else if(!t)e.push("stack");if(!this.nextConnection)e.push("end")}this.svgGroup_.setAttribute("data-shapes",e.join(" "));if(this.getCategory())this.svgGroup_.setAttribute("data-category",this.getCategory())};Blockly.BlockSvg.prototype.renderDrawTop_=function(e,o){if(this.type==Blockly.PROCEDURES_DEFINITION_BLOCK_TYPE){e.push("m 0, 0");e.push(Blockly.BlockSvg.TOP_LEFT_CORNER_DEFINE_HAT)}else{if(this.squareTopLeftCorner_){e.push("m 0,0");if(this.startHat_)e.push(Blockly.BlockSvg.START_HAT_PATH);if(this.edgeShapeWidth_)e.push("m "+this.edgeShapeWidth_+",0")}else{e.push(Blockly.BlockSvg.TOP_LEFT_CORNER_START);e.push(Blockly.BlockSvg.TOP_LEFT_CORNER)}if(this.previousConnection){e.push("H",Blockly.BlockSvg.NOTCH_START_PADDING);e.push(Blockly.BlockSvg.NOTCH_PATH_LEFT);var t=this.RTL?-Blockly.BlockSvg.NOTCH_WIDTH:Blockly.BlockSvg.NOTCH_WIDTH;this.previousConnection.setOffsetInBlock(t,0)}}this.width=o};Blockly.BlockSvg.prototype.renderDrawRight_=function(e,o,t){var i=0;var r=0;var n,l;for(var s=0,g;g=o[s];s++){i=g.paddingStart;if(0==s)i+=this.RTL?-t:t;if(g.type==Blockly.BlockSvg.INLINE){for(var a=0,c;c=g[a];a++){var u=r+g.height/2;var h=Blockly.BlockSvg.getAlignedCursor_(i,c,o.rightEdge);i=this.renderFields_(c.fieldRow,h,u);if(c.type==Blockly.INPUT_VALUE){if(this.previousConnection)i=Math.max(i,Blockly.BlockSvg.INPUT_AND_FIELD_MIN_X);n=this.RTL?-i:i;var d=g.height/2;l=r+d;c.connection.setOffsetInBlock(n,l);this.renderInputShape_(c,i,r+d);i+=c.renderWidth+Blockly.BlockSvg.SEP_SPACE_X}}i-=Blockly.BlockSvg.SEP_SPACE_X;i+=g.paddingEnd;o.rightEdge=Math.max(i,o.rightEdge);i=Math.max(i,o.rightEdge);this.width=Math.max(this.width,i);if(!this.edgeShape_){e.push("H",i-Blockly.BlockSvg.CORNER_RADIUS-this.edgeShapeWidth_);e.push(Blockly.BlockSvg.TOP_RIGHT_CORNER)}else e.push("H",i-this.edgeShapeWidth_);if(!this.edgeShape_)e.push("v",g.height-2*Blockly.BlockSvg.CORNER_RADIUS)}else if(g.type==Blockly.NEXT_STATEMENT){var c=g[0];var h=i;var u=r;u+=Blockly.BlockSvg.MIN_STATEMENT_INPUT_HEIGHT;this.renderFields_(c.fieldRow,h,u);i=o.statementEdge+Blockly.BlockSvg.NOTCH_WIDTH;if(this.type==Blockly.PROCEDURES_DEFINITION_BLOCK_TYPE)this.renderDefineBlock_(e,o,c,g,r);else Blockly.BlockSvg.drawStatementInputFromTopRight_(e,i,o.rightEdge,g);n=this.RTL?-i:i;c.connection.setOffsetInBlock(n,r);if(c.connection.isConnected())this.width=Math.max(this.width,o.statementEdge+c.connection.targetBlock().getHeightWidth().width);if(this.type!=Blockly.PROCEDURES_DEFINITION_BLOCK_TYPE&&(s==o.length-1||o[s+1].type==Blockly.NEXT_STATEMENT)){e.push(Blockly.BlockSvg.TOP_RIGHT_CORNER);e.push("v",Blockly.BlockSvg.EXTRA_STATEMENT_ROW_Y-2*Blockly.BlockSvg.CORNER_RADIUS);r+=Blockly.BlockSvg.EXTRA_STATEMENT_ROW_Y}}r+=g.height}this.drawEdgeShapeRight_(e);if(!o.length){r=Blockly.BlockSvg.MIN_BLOCK_Y;e.push("V",r)}return r};Blockly.BlockSvg.prototype.renderInputShape_=function(e,o,t){var i=e.outlinePath;if(!i)return;if(e.connection.targetConnection)i.setAttribute("style","visibility: hidden");else{var r=0,n=0;var l=Blockly.BlockSvg.getInputShapeInfo_(e.connection.getOutputShape());if(this.RTL)r=-o-l.width;else r=o;n=t-Blockly.BlockSvg.INPUT_SHAPE_HEIGHT/2;i.setAttribute("d",l.path);i.setAttribute("transform","translate("+r+","+n+")");i.setAttribute("data-argument-type",l.argType);i.setAttribute("style","visibility: visible")}};Blockly.BlockSvg.prototype.renderDrawBottom_=function(e,o){this.height=o;if(!this.edgeShape_)e.push(Blockly.BlockSvg.BOTTOM_RIGHT_CORNER);if(this.nextConnection){var t=Blockly.BlockSvg.NOTCH_WIDTH+Blockly.BlockSvg.NOTCH_START_PADDING+Blockly.BlockSvg.CORNER_RADIUS;e.push("H",t," ");e.push(Blockly.BlockSvg.NOTCH_PATH_RIGHT);var i=this.RTL?-Blockly.BlockSvg.NOTCH_WIDTH:Blockly.BlockSvg.NOTCH_WIDTH;this.nextConnection.setOffsetInBlock(i,o);this.height+=Blockly.BlockSvg.NOTCH_HEIGHT}if(!this.edgeShape_){e.push("H",Blockly.BlockSvg.CORNER_RADIUS);e.push(Blockly.BlockSvg.BOTTOM_LEFT_CORNER)}else e.push("H",this.edgeShapeWidth_)};Blockly.BlockSvg.prototype.renderDrawLeft_=function(e){if(this.outputConnection)this.outputConnection.setOffsetInBlock(0,this.height/2);if(this.edgeShape_)if(this.edgeShape_===Blockly.OUTPUT_SHAPE_ROUND)e.push("a "+this.edgeShapeWidth_+" "+this.edgeShapeWidth_+" 0 0 1 0 -"+2*this.edgeShapeWidth_);else if(this.edgeShape_===Blockly.OUTPUT_SHAPE_HEXAGONAL)e.push("l "+-this.edgeShapeWidth_+" "+-this.edgeShapeWidth_+" l "+this.edgeShapeWidth_+" "+-this.edgeShapeWidth_);e.push("z")};Blockly.BlockSvg.prototype.drawEdgeShapeRight_=function(e){if(this.edgeShape_)if(this.edgeShape_===Blockly.OUTPUT_SHAPE_ROUND)e.push("a "+this.edgeShapeWidth_+" "+this.edgeShapeWidth_+" 0 0 1 0 "+2*this.edgeShapeWidth_);else if(this.edgeShape_===Blockly.OUTPUT_SHAPE_HEXAGONAL)e.push("l "+this.edgeShapeWidth_+" "+this.edgeShapeWidth_+" l "+-this.edgeShapeWidth_+" "+this.edgeShapeWidth_)};Blockly.BlockSvg.prototype.positionNewBlock=function(e,o,t){if(o.type==Blockly.NEXT_STATEMENT){var i=t.x_-o.x_;var r=t.y_-o.y_;e.moveBy(i,r)}};Blockly.BlockSvg.drawStatementInputFromTopRight_=function(e,o,t,i){Blockly.BlockSvg.drawStatementInputTop_(e,o);e.push("v",i.height-2*Blockly.BlockSvg.CORNER_RADIUS);Blockly.BlockSvg.drawStatementInputBottom_(e,t,i)};Blockly.BlockSvg.drawStatementInputTop_=function(e,o){e.push(Blockly.BlockSvg.BOTTOM_RIGHT_CORNER);e.push("H",o+Blockly.BlockSvg.STATEMENT_INPUT_INNER_SPACE+2*Blockly.BlockSvg.CORNER_RADIUS);e.push(Blockly.BlockSvg.NOTCH_PATH_RIGHT);e.push("h","-"+Blockly.BlockSvg.STATEMENT_INPUT_INNER_SPACE);e.push(Blockly.BlockSvg.INNER_TOP_LEFT_CORNER)};Blockly.BlockSvg.drawStatementInputBottom_=function(e,o,t){e.push(Blockly.BlockSvg.INNER_BOTTOM_LEFT_CORNER);if(t.statementNotchAtBottom){e.push("h ",Blockly.BlockSvg.STATEMENT_INPUT_INNER_SPACE);e.push(Blockly.BlockSvg.NOTCH_PATH_LEFT)}e.push("H",o-Blockly.BlockSvg.CORNER_RADIUS)};Blockly.BlockSvg.prototype.renderDefineBlock_=function(e,o,t,i,r){var n=2==i.length;var l=o.rightEdge;if(t.connection&&t.connection.targetBlock())l=o.statementEdge+t.connection.targetBlock().getHeightWidth().width+Blockly.BlockSvg.DEFINE_BLOCK_PADDING_RIGHT;else l=Math.max(Blockly.BlockSvg.MIN_BLOCK_X_WITH_STATEMENT,l)+Blockly.BlockSvg.DEFINE_BLOCK_PADDING_RIGHT;l-=Blockly.BlockSvg.DEFINE_HAT_CORNER_RADIUS;if(n){var s=i[1];var g=l+3*Blockly.BlockSvg.SEP_SPACE_X;l+=s.fieldRow[0].getSize().width;l+=2*Blockly.BlockSvg.SEP_SPACE_X;var a=r;a+=Blockly.BlockSvg.MIN_STATEMENT_INPUT_HEIGHT;this.renderFields_(s.fieldRow,g,a)}e.push("H",l);e.push(Blockly.BlockSvg.TOP_RIGHT_CORNER_DEFINE_HAT);i.height+=3*Blockly.BlockSvg.GRID_UNIT;e.push("v",i.height);i.height+=Blockly.BlockSvg.GRID_UNIT};Blockly.BlockSvg.getInputShapeInfo_=function(e){var o=null;var t=null;var i=0;switch(e){case Blockly.OUTPUT_SHAPE_HEXAGONAL:o=Blockly.BlockSvg.INPUT_SHAPE_HEXAGONAL;i=Blockly.BlockSvg.INPUT_SHAPE_HEXAGONAL_WIDTH;t="boolean";break;case Blockly.OUTPUT_SHAPE_ROUND:o=Blockly.BlockSvg.INPUT_SHAPE_ROUND;i=Blockly.BlockSvg.INPUT_SHAPE_ROUND_WIDTH;t="round";break;case Blockly.OUTPUT_SHAPE_SQUARE:default:o=Blockly.BlockSvg.INPUT_SHAPE_SQUARE;i=Blockly.BlockSvg.INPUT_SHAPE_SQUARE_WIDTH;t="square";break}return{path:o,argType:t,width:i}};Blockly.BlockSvg.getAlignedCursor_=function(e,o,t){if(o.align===Blockly.ALIGN_RIGHT)e+=t-o.fieldWidth-2*Blockly.BlockSvg.SEP_SPACE_X;else if(o.align===Blockly.ALIGN_CENTRE)e=Math.max(e,t/2-o.fieldWidth/2);return e};Blockly.BlockSvg.prototype.renderMoveConnections_=function(){var e=this.getRelativeToSurfaceXY();if(this.previousConnection)this.previousConnection.moveToOffset(e);if(this.outputConnection)this.outputConnection.moveToOffset(e);for(var o=0;o<this.inputList.length;o++){var t=this.inputList[o].connection;if(t){t.moveToOffset(e);if(t.isConnected())t.tighten_()}}if(this.nextConnection){this.nextConnection.moveToOffset(e);if(this.nextConnection.isConnected())this.nextConnection.tighten_()}};goog.provide("Blockly.BlockAnimations");Blockly.BlockAnimations.disposeUiEffect=function(e){var o=e.workspace;var t=e.getSvgRoot();o.getAudioManager().play("delete");var i=o.getSvgXY(t);var r=t.cloneNode(true);r.translateX_=i.x;r.translateY_=i.y;r.setAttribute("transform","translate("+i.x+","+i.y+")");o.getParentSvg().appendChild(r);r.bBox_=r.getBBox();Blockly.BlockAnimations.disposeUiStep_(r,o.RTL,new Date,o.scale)};Blockly.BlockAnimations.disposeUiStep_=function(e,o,t,i){var r=new Date-t;var n=r/150;if(n>1)goog.dom.removeNode(e);else{var l=e.translateX_+(o?-1:1)*e.bBox_.width*i/2*n;var s=e.translateY_+e.bBox_.height*i*n;var g=(1-n)*i;e.setAttribute("transform","translate("+l+","+s+")"+" scale("+g+")");setTimeout(Blockly.BlockAnimations.disposeUiStep_,10,e,o,t,i)}};Blockly.BlockAnimations.connectionUiEffect=function(e){e.workspace.getAudioManager().play("click")};Blockly.BlockAnimations.disconnectUiEffect=function(e){};Blockly.BlockAnimations.disconnectUiStop=function(){};goog.provide("Blockly.BlockDragSurfaceSvg");goog.require("Blockly.utils");goog.require("goog.asserts");goog.require("goog.math.Coordinate");Blockly.BlockDragSurfaceSvg=function(e){this.container_=e;this.createDom()};Blockly.BlockDragSurfaceSvg.prototype.SVG_=null;Blockly.BlockDragSurfaceSvg.prototype.dragGroup_=null;Blockly.BlockDragSurfaceSvg.prototype.container_=null;Blockly.BlockDragSurfaceSvg.prototype.scale_=1;Blockly.BlockDragSurfaceSvg.prototype.surfaceXY_=null;Blockly.BlockDragSurfaceSvg.prototype.dragShadowFilterId_="";Blockly.BlockDragSurfaceSvg.SHADOW_STD_DEVIATION=6;Blockly.BlockDragSurfaceSvg.prototype.createDom=function(){if(this.SVG_)return;this.SVG_=Blockly.utils.createSvgElement("svg",{xmlns:Blockly.SVG_NS,"xmlns:html":Blockly.HTML_NS,"xmlns:xlink":"http://www.w3.org/1999/xlink",version:"1.1",class:"blocklyBlockDragSurface"},this.container_);this.dragGroup_=Blockly.utils.createSvgElement("g",{},this.SVG_);var e=Blockly.utils.createSvgElement("defs",{},this.SVG_);this.dragShadowFilterId_=this.createDropShadowDom_(e);this.dragGroup_.setAttribute("filter","url(#"+this.dragShadowFilterId_+")")};Blockly.BlockDragSurfaceSvg.prototype.createDropShadowDom_=function(e){var o=String(Math.random()).substring(2);var t=Blockly.utils.createSvgElement("filter",{id:"blocklyDragShadowFilter"+o,height:"140%",width:"140%",y:"-20%",x:"-20%"},e);Blockly.utils.createSvgElement("feGaussianBlur",{in:"SourceAlpha",stdDeviation:Blockly.BlockDragSurfaceSvg.SHADOW_STD_DEVIATION},t);var i=Blockly.utils.createSvgElement("feComponentTransfer",{result:"offsetBlur"},t);Blockly.utils.createSvgElement("feFuncA",{type:"linear",slope:Blockly.Colours.dragShadowOpacity},i);Blockly.utils.createSvgElement("feComposite",{in:"SourceGraphic",in2:"offsetBlur",operator:"over"},t);return t.id};Blockly.BlockDragSurfaceSvg.prototype.setBlocksAndShow=function(e){goog.asserts.assert(0==this.dragGroup_.childNodes.length,"Already dragging a block.");this.dragGroup_.appendChild(e);this.SVG_.style.display="block";this.surfaceXY_=new goog.math.Coordinate(0,0);var o=document.getElementsByClassName("injectionDiv")[0];o.style.overflow="visible"};Blockly.BlockDragSurfaceSvg.prototype.translateAndScaleGroup=function(e,o,t){this.scale_=t;var i=e.toFixed(0);var r=o.toFixed(0);this.dragGroup_.setAttribute("transform","translate("+i+","+r+") scale("+t+")")};Blockly.BlockDragSurfaceSvg.prototype.translateSurfaceInternal_=function(){var e=this.surfaceXY_.x;var o=this.surfaceXY_.y;e=e.toFixed(0);o=o.toFixed(0);this.SVG_.style.display="block";Blockly.utils.setCssTransform(this.SVG_,"translate3d("+e+"px, "+o+"px, 0px)")};Blockly.BlockDragSurfaceSvg.prototype.translateSurface=function(e,o){this.surfaceXY_=new goog.math.Coordinate(e*this.scale_,o*this.scale_);this.translateSurfaceInternal_()};Blockly.BlockDragSurfaceSvg.prototype.getSurfaceTranslation=function(){var e=Blockly.utils.getRelativeXY(this.SVG_);return new goog.math.Coordinate(e.x/this.scale_,e.y/this.scale_)};Blockly.BlockDragSurfaceSvg.prototype.getGroup=function(){return this.dragGroup_};Blockly.BlockDragSurfaceSvg.prototype.getCurrentBlock=function(){return this.dragGroup_.firstChild};Blockly.BlockDragSurfaceSvg.prototype.clearAndHide=function(e){if(e)e.appendChild(this.getCurrentBlock());else this.dragGroup_.removeChild(this.getCurrentBlock());this.SVG_.style.display="none";goog.asserts.assert(0==this.dragGroup_.childNodes.length,"Drag group was not cleared.");this.surfaceXY_=null;var o=document.getElementsByClassName("injectionDiv")[0];o.style.overflow="hidden"};goog.provide("Blockly.BlockDragger");goog.require("Blockly.BlockAnimations");goog.require("Blockly.Events.BlockMove");goog.require("Blockly.Events.DragBlockOutside");goog.require("Blockly.Events.EndBlockDrag");goog.require("Blockly.InsertionMarkerManager");goog.require("goog.math.Coordinate");goog.require("goog.asserts");Blockly.BlockDragger=function(e,o){this.draggingBlock_=e;this.workspace_=o;this.draggedConnectionManager_=new Blockly.InsertionMarkerManager(this.draggingBlock_);this.deleteArea_=null;this.wouldDeleteBlock_=false;this.wasOutside_=false;this.startXY_=this.draggingBlock_.getRelativeToSurfaceXY();this.dragIconData_=Blockly.BlockDragger.initIconData_(e)};Blockly.BlockDragger.prototype.dispose=function(){this.draggingBlock_=null;this.workspace_=null;this.startWorkspace_=null;this.dragIconData_.length=0;if(this.draggedConnectionManager_){this.draggedConnectionManager_.dispose();this.draggedConnectionManager_=null}};Blockly.BlockDragger.initIconData_=function(e){var o=[];var t=e.getDescendants(false);for(var i=0,r;r=t[i];i++){var n=r.getIcons();for(var l=0;l<n.length;l++){var s={location:n[l].getIconLocation(),icon:n[l]};o.push(s)}}return o};Blockly.BlockDragger.prototype.startBlockDrag=function(e){if(!Blockly.Events.getGroup())Blockly.Events.setGroup(true);this.workspace_.setResizesEnabled(false);Blockly.BlockAnimations.disconnectUiStop();if(this.draggingBlock_.getParent()){this.draggingBlock_.unplug();var o=this.pixelsToWorkspaceUnits_(e);var t=goog.math.Coordinate.sum(this.startXY_,o);this.draggingBlock_.translate(t.x,t.y);Blockly.BlockAnimations.disconnectUiEffect(this.draggingBlock_)}this.draggingBlock_.setDragging(true);this.draggingBlock_.moveToDragSurface_();var i=this.workspace_.getToolbox();if(i){var r=this.draggingBlock_.isDeletable()?"blocklyToolboxDelete":"blocklyToolboxGrab";i.addStyle(r)}};Blockly.BlockDragger.prototype.dragBlock=function(e,o){var t=this.pixelsToWorkspaceUnits_(o);var i=goog.math.Coordinate.sum(this.startXY_,t);this.draggingBlock_.moveDuringDrag(i);this.dragIcons_(t);this.deleteArea_=this.workspace_.isDeleteArea(e);var r=!this.workspace_.isInsideBlocksArea(e);this.draggedConnectionManager_.update(t,this.deleteArea_,r);if(r!==this.wasOutside_){this.fireDragOutsideEvent_(r);this.wasOutside_=r}this.updateCursorDuringBlockDrag_(r);return r};Blockly.BlockDragger.prototype.endBlockDrag=function(e,o){this.dragBlock(e,o);this.dragIconData_=[];var t=this.wasOutside_;this.fireEndDragEvent_(t);this.draggingBlock_.setMouseThroughStyle(false);Blockly.BlockAnimations.disconnectUiStop();var i=this.pixelsToWorkspaceUnits_(o);var r=goog.math.Coordinate.sum(this.startXY_,i);this.draggingBlock_.moveOffDragSurface_(r);var n=this.wouldDeleteBlock_&&this.draggingBlock_.type==Blockly.PROCEDURES_DEFINITION_BLOCK_TYPE;var l=this.maybeDeleteBlock_();if(!l){this.draggingBlock_.moveConnections_(i.x,i.y);this.draggingBlock_.setDragging(false);this.draggedConnectionManager_.applyConnections();this.draggingBlock_.render();this.fireMoveEvent_();this.draggingBlock_.scheduleSnapAndBump()}this.workspace_.setResizesEnabled(true);var s=this.workspace_.getToolbox();if(s){var g=this.draggingBlock_.isDeletable()?"blocklyToolboxDelete":"blocklyToolboxGrab";s.removeStyle(g)}Blockly.Events.setGroup(false);if(t){var a=this.workspace_;setTimeout((function(){a.undo()}))}if(n){var a=this.workspace_;setTimeout((function(){var e=a.getAllBlocks();for(var o=0;o<e.length;o++){var t=e[o];if(t.type==Blockly.PROCEDURES_CALL_BLOCK_TYPE){var i=t.getProcCode();if(!Blockly.Procedures.getDefineBlock(i,a)){alert("To delete a block definition, first remove all uses of the block");a.undo();return}}}a.refreshToolboxSelection_()}))}};Blockly.BlockDragger.prototype.fireDragOutsideEvent_=function(e){var o=new Blockly.Events.DragBlockOutside(this.draggingBlock_);o.isOutside=e;Blockly.Events.fire(o)};Blockly.BlockDragger.prototype.fireEndDragEvent_=function(e){var o=new Blockly.Events.EndBlockDrag(this.draggingBlock_,e);Blockly.Events.fire(o)};Blockly.BlockDragger.prototype.fireMoveEvent_=function(){var e=new Blockly.Events.BlockMove(this.draggingBlock_);e.oldCoordinate=this.startXY_;e.recordNew();Blockly.Events.fire(e)};Blockly.BlockDragger.prototype.maybeDeleteBlock_=function(){var e=this.workspace_.trashcan;if(this.wouldDeleteBlock_){if(e)goog.Timer.callOnce(e.close,100,e);this.fireMoveEvent_();this.draggingBlock_.dispose(false,true)}else if(e)e.close();return this.wouldDeleteBlock_};Blockly.BlockDragger.prototype.updateCursorDuringBlockDrag_=function(e){this.wouldDeleteBlock_=this.draggedConnectionManager_.wouldDeleteBlock();var o=this.workspace_.trashcan;if(this.wouldDeleteBlock_){this.draggingBlock_.setDeleteStyle(true);if(this.deleteArea_==Blockly.DELETE_AREA_TRASH&&o)o.setOpen_(true)}else{this.draggingBlock_.setDeleteStyle(false);if(o)o.setOpen_(false)}if(e)this.draggingBlock_.setMouseThroughStyle(true);else this.draggingBlock_.setMouseThroughStyle(false)};Blockly.BlockDragger.prototype.pixelsToWorkspaceUnits_=function(e){var o=new goog.math.Coordinate(e.x/this.workspace_.scale,e.y/this.workspace_.scale);if(this.workspace_.isMutator){var t=this.workspace_.options.parentWorkspace.scale;o=o.scale(1/t)}return o};Blockly.BlockDragger.prototype.dragIcons_=function(e){for(var o=0;o<this.dragIconData_.length;o++){var t=this.dragIconData_[o];t.icon.setIconLocation(goog.math.Coordinate.sum(t.location,e))}};goog.provide("Blockly.Blocks");Blockly.Blocks=new Object(null);goog.provide("Blockly.BubbleDragger");goog.require("Blockly.Bubble");goog.require("Blockly.Events.CommentMove");goog.require("Blockly.WorkspaceCommentSvg");goog.require("goog.math.Coordinate");goog.require("goog.asserts");Blockly.BubbleDragger=function(e,o){this.draggingBubble_=e;this.workspace_=o;this.deleteArea_=null;this.wouldDeleteBubble_=false;this.startXY_=this.draggingBubble_.getRelativeToSurfaceXY();this.dragSurface_=Blockly.utils.is3dSupported()&&!!o.getBlockDragSurface()?o.getBlockDragSurface():null};Blockly.BubbleDragger.prototype.dispose=function(){this.draggingBubble_=null;this.workspace_=null;this.dragSurface_=null};Blockly.BubbleDragger.prototype.startBubbleDrag=function(){if(!Blockly.Events.getGroup())Blockly.Events.setGroup(true);this.workspace_.setResizesEnabled(false);this.draggingBubble_.setAutoLayout(false);if(this.dragSurface_)this.moveToDragSurface_();this.draggingBubble_.setDragging&&this.draggingBubble_.setDragging(true);var e=this.workspace_.getToolbox();if(e){var o=this.draggingBubble_.isDeletable()?"blocklyToolboxDelete":"blocklyToolboxGrab";e.addStyle(o)}};Blockly.BubbleDragger.prototype.dragBubble=function(e,o){var t=this.pixelsToWorkspaceUnits_(o);var i=goog.math.Coordinate.sum(this.startXY_,t);this.draggingBubble_.moveDuringDrag(this.dragSurface_,i);if(this.draggingBubble_.isDeletable()){this.deleteArea_=this.workspace_.isDeleteArea(e);this.updateCursorDuringBubbleDrag_()}};Blockly.BubbleDragger.prototype.maybeDeleteBubble_=function(){var e=this.workspace_.trashcan;if(this.wouldDeleteBubble_){if(e)setTimeout(e.close.bind(e),100);this.fireMoveEvent_();this.draggingBubble_.dispose(false,true)}else if(e)e.close();return this.wouldDeleteBubble_};Blockly.BubbleDragger.prototype.updateCursorDuringBubbleDrag_=function(){this.wouldDeleteBubble_=this.deleteArea_!=Blockly.DELETE_AREA_NONE;var e=this.workspace_.trashcan;if(this.wouldDeleteBubble_){this.draggingBubble_.setDeleteStyle(true);if(this.deleteArea_==Blockly.DELETE_AREA_TRASH&&e)e.setOpen_(true)}else{this.draggingBubble_.setDeleteStyle(false);if(e)e.setOpen_(false)}};Blockly.BubbleDragger.prototype.endBubbleDrag=function(e,o){this.dragBubble(e,o);var t=this.pixelsToWorkspaceUnits_(o);var i=goog.math.Coordinate.sum(this.startXY_,t);this.draggingBubble_.moveTo(i.x,i.y);var r=this.maybeDeleteBubble_();if(!r){if(this.dragSurface_)this.dragSurface_.clearAndHide(this.workspace_.getBubbleCanvas());this.draggingBubble_.setDragging&&this.draggingBubble_.setDragging(false);this.fireMoveEvent_()}this.workspace_.setResizesEnabled(true);if(this.workspace_.toolbox_){var n=this.draggingBubble_.isDeletable()?"blocklyToolboxDelete":"blocklyToolboxGrab";this.workspace_.toolbox_.removeStyle(n)}Blockly.Events.setGroup(false)};Blockly.BubbleDragger.prototype.fireMoveEvent_=function(){var e=null;if(this.draggingBubble_.isComment)e=new Blockly.Events.CommentMove(this.draggingBubble_);else if(this.draggingBubble_ instanceof Blockly.ScratchBubble)e=new Blockly.Events.CommentMove(this.draggingBubble_.comment);else return;e.setOldCoordinate(this.startXY_);e.recordNew();Blockly.Events.fire(e)};Blockly.BubbleDragger.prototype.pixelsToWorkspaceUnits_=function(e){var o=new goog.math.Coordinate(e.x/this.workspace_.scale,e.y/this.workspace_.scale);if(this.workspace_.isMutator){var t=this.workspace_.options.parentWorkspace.scale;o=o.scale(1/t)}return o};Blockly.BubbleDragger.prototype.moveToDragSurface_=function(){this.draggingBubble_.moveTo(0,0);this.dragSurface_.translateSurface(this.startXY_.x,this.startXY_.y);this.dragSurface_.setBlocksAndShow(this.draggingBubble_.getSvgRoot())};goog.provide("Blockly.Colours");Blockly.Colours={motion:{primary:"#4C97FF",secondary:"#4280D7",tertiary:"#3373CC"},looks:{primary:"#9966FF",secondary:"#855CD6",tertiary:"#774DCB"},sounds:{primary:"#CF63CF",secondary:"#C94FC9",tertiary:"#BD42BD"},control:{primary:"#FFAB19",secondary:"#EC9C13",tertiary:"#CF8B17"},event:{primary:"#FFBF00",secondary:"#E6AC00",tertiary:"#CC9900"},sensing:{primary:"#5CB1D6",secondary:"#47A8D1",tertiary:"#2E8EB8"},pen:{primary:"#0fBD8C",secondary:"#0DA57A",tertiary:"#0B8E69"},operators:{primary:"#59C059",secondary:"#46B946",tertiary:"#389438"},data:{primary:"#FF8C1A",secondary:"#FF8000",tertiary:"#DB6E00"},data_lists:{primary:"#FF661A",secondary:"#FF5500",tertiary:"#E64D00"},more:{primary:"#FF6680",secondary:"#FF4D6A",tertiary:"#FF3355"},text:"#575E75",workspace:"#F9F9F9",toolboxHover:"#4C97FF",toolboxSelected:"#e9eef2",toolboxText:"#575E75",toolbox:"#FFFFFF",flyout:"#F9F9F9",scrollbar:"#CECDCE",scrollbarHover:"#CECDCE",textField:"#FFFFFF",insertionMarker:"#000000",insertionMarkerOpacity:.2,dragShadowOpacity:.3,stackGlow:"#FFF200",stackGlowSize:4,stackGlowOpacity:1,replacementGlow:"#FFFFFF",replacementGlowSize:2,replacementGlowOpacity:1,colourPickerStroke:"#FFFFFF",fieldShadow:"rgba(0,0,0,0.1)",dropDownShadow:"rgba(0, 0, 0, .3)",numPadBackground:"#547AB2",numPadBorder:"#435F91",numPadActiveBackground:"#435F91",numPadText:"white",valueReportBackground:"#FFFFFF",valueReportBorder:"#AAAAAA"};Blockly.Colours.overrideColours=function(e){if(e)for(var o in e)if(e.hasOwnProperty(o)&&Blockly.Colours.hasOwnProperty(o)){var t=e[o];if(goog.isObject(t)){for(var i in t)if(t.hasOwnProperty(i)&&Blockly.Colours[o].hasOwnProperty(i))Blockly.Colours[o][i]=t[i]}else Blockly.Colours[o]=t}};goog.provide("Blockly.Connection");goog.require("Blockly.Events.BlockMove");goog.require("goog.asserts");goog.require("goog.dom");Blockly.Connection=function(e,o){this.sourceBlock_=e;this.type=o;if(e.workspace.connectionDBList){this.db_=e.workspace.connectionDBList[o];this.dbOpposite_=e.workspace.connectionDBList[Blockly.OPPOSITE_TYPE[o]];this.hidden_=!this.db_}};Blockly.Connection.CAN_CONNECT=0;Blockly.Connection.REASON_SELF_CONNECTION=1;Blockly.Connection.REASON_WRONG_TYPE=2;Blockly.Connection.REASON_TARGET_NULL=3;Blockly.Connection.REASON_CHECKS_FAILED=4;Blockly.Connection.REASON_DIFFERENT_WORKSPACES=5;Blockly.Connection.REASON_SHADOW_PARENT=6;Blockly.Connection.REASON_CUSTOM_PROCEDURE=7;Blockly.Connection.prototype.targetConnection=null;Blockly.Connection.prototype.check_=null;Blockly.Connection.prototype.shadowDom_=null;Blockly.Connection.prototype.x_=0;Blockly.Connection.prototype.y_=0;Blockly.Connection.prototype.inDB_=false;Blockly.Connection.prototype.db_=null;Blockly.Connection.prototype.dbOpposite_=null;Blockly.Connection.prototype.hidden_=null;Blockly.Connection.prototype.connect_=function(e){var o=this;var t=o.getSourceBlock();var i=e.getSourceBlock();var r=false;if(o==t.getFirstStatementConnection())r=true;if(e.isConnected()){if(r)var n=e.targetConnection;e.disconnect()}if(o.isConnected()){var l=o.targetBlock();var s=o.getShadowDom();o.setShadowDom(null);if(l.isShadow()){s=Blockly.Xml.blockToDom(l);l.dispose();l=null}else if(o.type==Blockly.NEXT_STATEMENT){if(!l.previousConnection)throw"Orphan block does not have a previous connection.";var g=i;while(g.nextConnection){var a=g.getNextBlock();if(a&&!a.isShadow())g=a;else{if(l.previousConnection.checkType_(g.nextConnection)){g.nextConnection.connect(l.previousConnection);l=null}break}}}if(l){o.disconnect();if(Blockly.Events.recordUndo){var c=Blockly.Events.getGroup();setTimeout((function(){if(l.workspace&&!l.getParent()){Blockly.Events.setGroup(c);if(l.outputConnection)l.outputConnection.bumpAwayFrom_(o);else if(l.previousConnection)l.previousConnection.bumpAwayFrom_(o);Blockly.Events.setGroup(false)}}),Blockly.BUMP_DELAY)}}o.setShadowDom(s)}if(r&&n)n.connect(t.previousConnection);var u;if(Blockly.Events.isEnabled())u=new Blockly.Events.BlockMove(i);Blockly.Connection.connectReciprocally_(o,e);i.setParent(t);if(u){u.recordNew();Blockly.Events.fire(u)}};Blockly.Connection.prototype.dispose=function(){if(this.isConnected())throw"Disconnect connection before disposing of it.";if(this.inDB_)this.db_.removeConnection_(this);this.db_=null;this.dbOpposite_=null};Blockly.Connection.prototype.isConnectedToNonInsertionMarker=function(){return this.targetConnection&&!this.targetBlock().isInsertionMarker()};Blockly.Connection.prototype.getSourceBlock=function(){return this.sourceBlock_};Blockly.Connection.prototype.isSuperior=function(){return this.type==Blockly.INPUT_VALUE||this.type==Blockly.NEXT_STATEMENT};Blockly.Connection.prototype.isConnected=function(){return!!this.targetConnection};Blockly.Connection.prototype.canConnectWithReason_=function(e){if(!e)return Blockly.Connection.REASON_TARGET_NULL;if(this.isSuperior()){var o=this.sourceBlock_;var t=e.getSourceBlock();var i=this}else{var t=this.sourceBlock_;var o=e.getSourceBlock();var i=e}if(o&&o==t)return Blockly.Connection.REASON_SELF_CONNECTION;else if(e.type!=Blockly.OPPOSITE_TYPE[this.type])return Blockly.Connection.REASON_WRONG_TYPE;else if(o&&t&&o.workspace!==t.workspace)return Blockly.Connection.REASON_DIFFERENT_WORKSPACES;else if(!this.checkType_(e))return Blockly.Connection.REASON_CHECKS_FAILED;else if(o.isShadow()&&!t.isShadow())return Blockly.Connection.REASON_SHADOW_PARENT;else if(o.type==Blockly.PROCEDURES_DEFINITION_BLOCK_TYPE&&t.type!=Blockly.PROCEDURES_PROTOTYPE_BLOCK_TYPE&&i==o.getInput("custom_block").connection||t.type==Blockly.PROCEDURES_PROTOTYPE_BLOCK_TYPE&&o.type!=Blockly.PROCEDURES_DEFINITION_BLOCK_TYPE)return Blockly.Connection.REASON_CUSTOM_PROCEDURE;return Blockly.Connection.CAN_CONNECT};Blockly.Connection.prototype.checkConnection_=function(e){switch(this.canConnectWithReason_(e)){case Blockly.Connection.CAN_CONNECT:break;case Blockly.Connection.REASON_SELF_CONNECTION:throw"Attempted to connect a block to itself.";case Blockly.Connection.REASON_DIFFERENT_WORKSPACES:throw"Blocks not on same workspace.";case Blockly.Connection.REASON_WRONG_TYPE:throw"Attempt to connect incompatible types.";case Blockly.Connection.REASON_TARGET_NULL:throw"Target connection is null.";case Blockly.Connection.REASON_CHECKS_FAILED:var o="Connection checks failed. ";o+=this+" expected "+this.check_+", found "+e.check_;throw o;case Blockly.Connection.REASON_SHADOW_PARENT:throw"Connecting non-shadow to shadow block.";case Blockly.Connection.REASON_CUSTOM_PROCEDURE:throw"Trying to replace a shadow on a custom procedure definition.";default:throw"Unknown connection failure: this should never happen!"}};Blockly.Connection.prototype.canConnectToPrevious_=function(e){if(this.targetConnection)return false;if(-1!=Blockly.draggingConnections_.indexOf(e))return false;var o=this.sourceBlock_.getFirstStatementConnection();var t=null!=o;var i=this==o;var r=this==this.sourceBlock_.nextConnection;if(t&&!i&&!r)return false;var n=null!=this.sourceBlock_.previousConnection;if(i&&n)return true;if(r||i&&!n){if(!e.targetConnection)return true;var l=e.targetBlock();if(!l.isInsertionMarker())return false;return!l.getPreviousBlock()}};Blockly.Connection.prototype.isConnectionAllowed=function(e){if(e.sourceBlock_.isInsertionMarker())return false;var o=this.canConnectWithReason_(e);if(o!=Blockly.Connection.CAN_CONNECT)return false;var t=this.sourceBlock_.getFirstStatementConnection();switch(e.type){case Blockly.PREVIOUS_STATEMENT:return this.canConnectToPrevious_(e);case Blockly.OUTPUT_VALUE:return false;case Blockly.INPUT_VALUE:if(e.targetConnection&&!e.targetBlock().isMovable()&&!e.targetBlock().isShadow())return false;break;case Blockly.NEXT_STATEMENT:if(t&&this==this.sourceBlock_.previousConnection&&e.isConnectedToNonInsertionMarker()&&!t.targetConnection)return false;if(e.isConnectedToNonInsertionMarker()&&!this.sourceBlock_.nextConnection&&!e.targetBlock().isShadow()&&e.targetBlock().nextConnection)return false;break;default:throw"Unknown connection type in isConnectionAllowed"}if(-1!=Blockly.draggingConnections_.indexOf(e))return false;return true};Blockly.Connection.prototype.connect=function(e){if(this.targetConnection==e)return;this.checkConnection_(e);if(this.isSuperior())this.connect_(e);else e.connect_(this)};Blockly.Connection.connectReciprocally_=function(e,o){goog.asserts.assert(e&&o,"Cannot connect null connections.");e.targetConnection=o;o.targetConnection=e};Blockly.Connection.singleConnection_=function(e,o){var t=false;for(var i=0;i<e.inputList.length;i++){var r=e.inputList[i].connection;if(r&&r.type==Blockly.INPUT_VALUE&&o.outputConnection.checkType_(r)){if(t)return null;t=r}}return t};Blockly.Connection.prototype.disconnect=function(){var e=this.targetConnection;goog.asserts.assert(e,"Source connection not connected.");goog.asserts.assert(e.targetConnection==this,"Target connection not connected to source connection.");var o,t,i;if(this.isSuperior()){o=this.sourceBlock_;t=e.getSourceBlock();i=this}else{o=e.getSourceBlock();t=this.sourceBlock_;i=e}this.disconnectInternal_(o,t);i.respawnShadow_()};Blockly.Connection.prototype.disconnectInternal_=function(e,o){var t;if(Blockly.Events.isEnabled())t=new Blockly.Events.BlockMove(o);var i=this.targetConnection;i.targetConnection=null;this.targetConnection=null;o.setParent(null);if(t){t.recordNew();Blockly.Events.fire(t)}};Blockly.Connection.prototype.respawnShadow_=function(){var e=this.getSourceBlock();var o=this.getShadowDom();if(e.workspace&&o&&Blockly.Events.recordUndo){var t=Blockly.Xml.domToBlock(o,e.workspace);if(t.outputConnection)this.connect(t.outputConnection);else if(t.previousConnection)this.connect(t.previousConnection);else throw"Child block does not have output or previous statement."}};Blockly.Connection.prototype.targetBlock=function(){if(this.isConnected())return this.targetConnection.getSourceBlock();return null};Blockly.Connection.prototype.checkType_=function(e){if(!this.check_||!e.check_)return true;for(var o=0;o<this.check_.length;o++)if(-1!=e.check_.indexOf(this.check_[o]))return true;return false};Blockly.Connection.prototype.onCheckChanged_=function(){if(this.isConnected()&&!this.checkType_(this.targetConnection)){var e=this.isSuperior()?this.targetBlock():this.sourceBlock_;e.unplug()}};Blockly.Connection.prototype.setCheck=function(e){if(e){if(!goog.isArray(e))e=[e];this.check_=e;this.onCheckChanged_()}else this.check_=null;return this};Blockly.Connection.prototype.getOutputShape=function(){if(!this.check_)return Blockly.OUTPUT_SHAPE_ROUND;if(-1!==this.check_.indexOf("Boolean"))return Blockly.OUTPUT_SHAPE_HEXAGONAL;if(-1!==this.check_.indexOf("Number"))return Blockly.OUTPUT_SHAPE_ROUND;if(-1!==this.check_.indexOf("String"))return Blockly.OUTPUT_SHAPE_SQUARE;return Blockly.OUTPUT_SHAPE_ROUND};Blockly.Connection.prototype.setShadowDom=function(e){this.shadowDom_=e};Blockly.Connection.prototype.getShadowDom=function(){return this.shadowDom_};Blockly.Connection.prototype.neighbours_=function(){return[]};Blockly.Connection.prototype.toString=function(){var e;var o=this.sourceBlock_;if(!o)return"Orphan Connection";else if(o.outputConnection==this)e="Output Connection of ";else if(o.previousConnection==this)e="Previous Connection of ";else if(o.nextConnection==this)e="Next Connection of ";else{var t=goog.array.find(o.inputList,(function(e){return e.connection==this}),this);if(t)e='Input "'+t.name+'" connection on ';else{console.warn("Connection not actually connected to sourceBlock_");return"Orphan Connection"}}return e+o.toDevString()};goog.provide("Blockly.ConnectionDB");goog.require("Blockly.Connection");Blockly.ConnectionDB=function(){this.connections_=[]};Blockly.ConnectionDB.prototype.addConnection=function(e){if(e.inDB_)throw Error("Connection already in database.");if(e.getSourceBlock().isInFlyout)return;var o=this.findPositionForConnection_(e);this.connections_.splice(o,0,e);e.inDB_=true};Blockly.ConnectionDB.prototype.findConnection=function(e){if(!this.connections_.length)return-1;var o=this.findPositionForConnection_(e);if(o>=this.connections_.length)return-1;var t=e.y_;var i=o;var r=o;while(i>=0&&this.connections_[i].y_==t){if(this.connections_[i]==e)return i;i--}while(r<this.connections_.length&&this.connections_[r].y_==t){if(this.connections_[r]==e)return r;r++}return-1};Blockly.ConnectionDB.prototype.findPositionForConnection_=function(e){if(!this.connections_.length)return 0;var o=0;var t=this.connections_.length;while(o<t){var i=Math.floor((o+t)/2);if(this.connections_[i].y_<e.y_)o=i+1;else if(this.connections_[i].y_>e.y_)t=i;else{o=i;break}}return o};Blockly.ConnectionDB.prototype.removeConnection_=function(e){if(!e.inDB_)throw Error("Connection not in database.");var o=this.findConnection(e);if(-1==o)throw Error("Unable to find connection in connectionDB.");e.inDB_=false;this.connections_.splice(o,1)};Blockly.ConnectionDB.prototype.getNeighbours=function(e,o){var t=this.connections_;var i=e.x_;var r=e.y_;var n=0;var l=t.length-2;var s=l;while(n<s){if(t[s].y_<r)n=s;else l=s;s=Math.floor((n+l)/2)}var g=[];function a(e){var n=i-t[e].x_;var l=r-t[e].y_;var s=Math.sqrt(n*n+l*l);if(s<=o)g.push(t[e]);return l<o}n=s;l=s;if(t.length){while(n>=0&&a(n))n--;do{l++}while(l<t.length&&a(l))}return g};Blockly.ConnectionDB.prototype.isInYRange_=function(e,o,t){return Math.abs(this.connections_[e].y_-o)<=t};Blockly.ConnectionDB.prototype.searchForClosest=function(e,o,t){if(!this.connections_.length)return{connection:null,radius:o};var i=e.y_;var r=e.x_;e.x_=r+t.x;e.y_=i+t.y;var n=this.findPositionForConnection_(e);var l=null;var s=o;var g;var a=n-1;while(a>=0&&this.isInYRange_(a,e.y_,o)){g=this.connections_[a];if(e.isConnectionAllowed(g,s)){l=g;s=g.distanceFrom(e)}a--}var c=n;while(c<this.connections_.length&&this.isInYRange_(c,e.y_,o)){g=this.connections_[c];if(e.isConnectionAllowed(g,s)){l=g;s=g.distanceFrom(e)}c++}e.x_=r;e.y_=i;return{connection:l,radius:s}};Blockly.ConnectionDB.init=function(e){var o=[];o[Blockly.INPUT_VALUE]=new Blockly.ConnectionDB;o[Blockly.OUTPUT_VALUE]=new Blockly.ConnectionDB;o[Blockly.NEXT_STATEMENT]=new Blockly.ConnectionDB;o[Blockly.PREVIOUS_STATEMENT]=new Blockly.ConnectionDB;e.connectionDBList=o};goog.provide("Blockly.constants");Blockly.DRAG_RADIUS=3;Blockly.FLYOUT_DRAG_RADIUS=10;Blockly.SNAP_RADIUS=48;Blockly.CONNECTING_SNAP_RADIUS=68;Blockly.CURRENT_CONNECTION_PREFERENCE=20;Blockly.BUMP_DELAY=0;Blockly.COLLAPSE_CHARS=30;Blockly.LONGPRESS=750;Blockly.LINE_SCROLL_MULTIPLIER=15;Blockly.SOUND_LIMIT=100;Blockly.DRAG_STACK=true;Blockly.HSV_SATURATION=.45;Blockly.HSV_VALUE=.65;Blockly.SPRITE={width:96,height:124,url:"sprites.png"};Blockly.SVG_NS="http://www.w3.org/2000/svg";Blockly.HTML_NS="http://www.w3.org/1999/xhtml";Blockly.INPUT_VALUE=1;Blockly.OUTPUT_VALUE=2;Blockly.NEXT_STATEMENT=3;Blockly.PREVIOUS_STATEMENT=4;Blockly.DUMMY_INPUT=5;Blockly.ALIGN_LEFT=-1;Blockly.ALIGN_CENTRE=0;Blockly.ALIGN_RIGHT=1;Blockly.DRAG_NONE=0;Blockly.DRAG_STICKY=1;Blockly.DRAG_BEGIN=1;Blockly.DRAG_FREE=2;Blockly.OPPOSITE_TYPE=[];Blockly.OPPOSITE_TYPE[Blockly.INPUT_VALUE]=Blockly.OUTPUT_VALUE;Blockly.OPPOSITE_TYPE[Blockly.OUTPUT_VALUE]=Blockly.INPUT_VALUE;Blockly.OPPOSITE_TYPE[Blockly.NEXT_STATEMENT]=Blockly.PREVIOUS_STATEMENT;Blockly.OPPOSITE_TYPE[Blockly.PREVIOUS_STATEMENT]=Blockly.NEXT_STATEMENT;Blockly.TOOLBOX_AT_TOP=0;Blockly.TOOLBOX_AT_BOTTOM=1;Blockly.TOOLBOX_AT_LEFT=2;Blockly.TOOLBOX_AT_RIGHT=3;Blockly.OUTPUT_SHAPE_HEXAGONAL=1;Blockly.OUTPUT_SHAPE_ROUND=2;Blockly.OUTPUT_SHAPE_SQUARE=3;Blockly.Categories={motion:"motion",looks:"looks",sound:"sounds",pen:"pen",data:"data",dataLists:"data-lists",event:"events",control:"control",sensing:"sensing",operators:"operators",more:"more"};Blockly.DELETE_AREA_NONE=null;Blockly.DELETE_AREA_TRASH=1;Blockly.DELETE_AREA_TOOLBOX=2;Blockly.VARIABLE_CATEGORY_NAME="VARIABLE";Blockly.PROCEDURE_CATEGORY_NAME="PROCEDURE";Blockly.RENAME_VARIABLE_ID="RENAME_VARIABLE_ID";Blockly.DELETE_VARIABLE_ID="DELETE_VARIABLE_ID";Blockly.NEW_BROADCAST_MESSAGE_ID="NEW_BROADCAST_MESSAGE_ID";Blockly.BROADCAST_MESSAGE_VARIABLE_TYPE="broadcast_msg";Blockly.LIST_VARIABLE_TYPE="list";Blockly.SCALAR_VARIABLE_TYPE="";Blockly.PROCEDURES_DEFINITION_BLOCK_TYPE="procedures_definition";Blockly.PROCEDURES_PROTOTYPE_BLOCK_TYPE="procedures_prototype";Blockly.PROCEDURES_CALL_BLOCK_TYPE="procedures_call";Blockly.StatusButtonState={READY:"ready",NOT_READY:"not ready"};goog.provide("Blockly.ContextMenu");goog.require("Blockly.Events.BlockCreate");goog.require("Blockly.scratchBlocksUtils");goog.require("Blockly.utils");goog.require("Blockly.utils.uiMenu");goog.require("goog.dom");goog.require("goog.events");goog.require("goog.style");goog.require("goog.ui.Menu");goog.require("goog.ui.MenuItem");goog.require("goog.userAgent");Blockly.ContextMenu.currentBlock=null;Blockly.ContextMenu.eventWrapper_=null;Blockly.ContextMenu.show=function(e,o,t){Blockly.WidgetDiv.show(Blockly.ContextMenu,t,null);if(!o.length){Blockly.ContextMenu.hide();return}var i=Blockly.ContextMenu.populate_(o,t);goog.events.listen(i,goog.ui.Component.EventType.ACTION,Blockly.ContextMenu.hide);Blockly.ContextMenu.position_(i,e,t);setTimeout((function(){i.getElement().focus()}),1);Blockly.ContextMenu.currentBlock=null};Blockly.ContextMenu.populate_=function(e,o){var t=new goog.ui.Menu;t.setRightToLeft(o);for(var i=0,r;r=e[i];i++){var n=new goog.ui.MenuItem(r.text);n.setRightToLeft(o);t.addChild(n,true);n.setEnabled(r.enabled);if(r.enabled){goog.events.listen(n,goog.ui.Component.EventType.ACTION,r.callback);n.handleContextMenu=function(){goog.events.dispatchEvent(this,goog.ui.Component.EventType.ACTION)}}}return t};Blockly.ContextMenu.position_=function(e,o,t){var i=Blockly.utils.getViewportBBox();var r={top:o.clientY+i.top,bottom:o.clientY+i.top,left:o.clientX+i.left,right:o.clientX+i.left};Blockly.ContextMenu.createWidget_(e);var n=Blockly.utils.uiMenu.getSize(e);if(t)Blockly.utils.uiMenu.adjustBBoxesForRTL(i,r,n);Blockly.WidgetDiv.positionWithAnchor(i,r,n,t);e.getElement().focus()};Blockly.ContextMenu.createWidget_=function(e){var o=Blockly.WidgetDiv.DIV;e.render(o);var t=e.getElement();Blockly.utils.addClass(t,"blocklyContextMenu");Blockly.bindEventWithChecks_(t,"contextmenu",null,Blockly.utils.noEvent);e.setAllowAutoFocus(true)};Blockly.ContextMenu.hide=function(){Blockly.WidgetDiv.hideIfOwner(Blockly.ContextMenu);Blockly.ContextMenu.currentBlock=null;if(Blockly.ContextMenu.eventWrapper_)Blockly.unbindEvent_(Blockly.ContextMenu.eventWrapper_)};Blockly.ContextMenu.callbackFactory=function(e,o){return function(){Blockly.Events.disable();try{var t=Blockly.Xml.domToBlock(o,e.workspace);var i=e.getRelativeToSurfaceXY();if(e.RTL)i.x-=Blockly.SNAP_RADIUS;else i.x+=Blockly.SNAP_RADIUS;i.y+=2*Blockly.SNAP_RADIUS;t.moveBy(i.x,i.y)}finally{Blockly.Events.enable()}if(Blockly.Events.isEnabled()&&!t.isShadow())Blockly.Events.fire(new Blockly.Events.BlockCreate(t));t.select()}};Blockly.ContextMenu.blockDeleteOption=function(e){var o=e.getDescendants(false,true).length;var t=e.getNextBlock();if(t)o-=t.getDescendants(false,true).length;var i={text:1==o?Blockly.Msg.DELETE_BLOCK:Blockly.Msg.DELETE_X_BLOCKS.replace("%1",String(o)),enabled:true,callback:function(){Blockly.Events.setGroup(true);e.dispose(true,true);Blockly.Events.setGroup(false)}};return i};Blockly.ContextMenu.blockHelpOption=function(e){var o=goog.isFunction(e.helpUrl)?e.helpUrl():e.helpUrl;var t={enabled:!!o,text:Blockly.Msg.HELP,callback:function(){e.showHelp_()}};return t};Blockly.ContextMenu.blockDuplicateOption=function(e,o){var t={text:Blockly.Msg.DUPLICATE,enabled:true,callback:Blockly.scratchBlocksUtils.duplicateAndDragCallback(e,o)};return t};Blockly.ContextMenu.blockCommentOption=function(e){var o={enabled:!goog.userAgent.IE};if(e.comment){o.text=Blockly.Msg.REMOVE_COMMENT;o.callback=function(){e.setCommentText(null)}}else{o.text=Blockly.Msg.ADD_COMMENT;o.callback=function(){e.setCommentText("");e.comment.focus()}}return o};Blockly.ContextMenu.wsUndoOption=function(e){return{text:Blockly.Msg.UNDO,enabled:e.hasUndoStack(),callback:e.undo.bind(e,false)}};Blockly.ContextMenu.wsRedoOption=function(e){return{text:Blockly.Msg.REDO,enabled:e.hasRedoStack(),callback:e.undo.bind(e,true)}};Blockly.ContextMenu.wsCleanupOption=function(e,o){return{text:Blockly.Msg.CLEAN_UP,enabled:o>1,callback:e.cleanUp.bind(e,true)}};Blockly.ContextMenu.toggleCollapseFn_=function(e,o){var t=10;var i=0;for(var r=0;r<e.length;r++){var n=e[r];while(n){setTimeout(n.setCollapsed.bind(n,o),i);n=n.getNextBlock();i+=t}}};Blockly.ContextMenu.wsCollapseOption=function(e,o){return{enabled:e,text:Blockly.Msg.COLLAPSE_ALL,callback:function(){Blockly.ContextMenu.toggleCollapseFn_(o,true)}}};Blockly.ContextMenu.wsExpandOption=function(e,o){return{enabled:e,text:Blockly.Msg.EXPAND_ALL,callback:function(){Blockly.ContextMenu.toggleCollapseFn_(o,false)}}};Blockly.ContextMenu.commentDeleteOption=function(e){var o={text:Blockly.Msg.DELETE,enabled:true,callback:function(){Blockly.Events.setGroup(true);e.dispose(true,true);Blockly.Events.setGroup(false)}};return o};Blockly.ContextMenu.commentDuplicateOption=function(e){var o={text:Blockly.Msg.DUPLICATE,enabled:true,callback:function(){Blockly.duplicate_(e)}};return o};Blockly.ContextMenu.workspaceCommentOption=function(e,o){var t=function(){var t=false;if(Blockly.Events.isEnabled()){Blockly.Events.disable();t=true}var i=new Blockly.WorkspaceCommentSvg(e,"",Blockly.WorkspaceCommentSvg.DEFAULT_SIZE,Blockly.WorkspaceCommentSvg.DEFAULT_SIZE,false);var r=e.getInjectionDiv();var n=r.getBoundingClientRect();var l=new goog.math.Coordinate(o.clientX-n.left,o.clientY-n.top);var s=e.getOriginOffsetInPixels();var g=goog.math.Coordinate.difference(l,s);var a=g.scale(1/e.scale);var c=a.x;var u=a.y;i.moveBy(c,u);if(e.rendered){i.initSvg();i.render(false);i.select()}if(t)Blockly.Events.enable();Blockly.WorkspaceComment.fireCreateEvent(i)};var i={enabled:true};i.text=Blockly.Msg.ADD_COMMENT;i.callback=function(){t()};return i};goog.provide("Blockly.Css");goog.require("Blockly.Colours");goog.require("goog.userAgent");Blockly.Css.Cursor={OPEN:"handopen",CLOSED:"handclosed",DELETE:"handdelete"};Blockly.Css.currentCursor_="";Blockly.Css.styleSheet_=null;Blockly.Css.mediaPath_="";Blockly.Css.inject=function(e,o){if(Blockly.Css.styleSheet_)return;var t=".blocklyDraggable {}\n";if(e){t+=Blockly.Css.CONTENT.join("\n");if(Blockly.FieldDate)t+=Blockly.FieldDate.CSS.join("\n")}Blockly.Css.mediaPath_=o.replace(/[\\\/]$/,"");t=t.replace(/<<<PATH>>>/g,Blockly.Css.mediaPath_);for(var i in Blockly.Colours)if(Blockly.Colours.hasOwnProperty(i))t=t.replace(new RegExp("\\$colour\\_"+i,"g"),Blockly.Colours[i]);var r=document.createElement("style");document.head.insertBefore(r,document.head.firstChild);var n=document.createTextNode(t);r.appendChild(n);Blockly.Css.styleSheet_=r.sheet};Blockly.Css.setCursor=function(e){console.warn("Deprecated call to Blockly.Css.setCursor."+"See https://github.com/google/blockly/issues/981 for context")};Blockly.Css.CONTENT=[".blocklySvg {","background-color: $colour_workspace;","outline: none;","overflow: hidden;","position: absolute;","display: block;","}",".blocklyRelativeWrapper {","position: relative;","width: 100%;","height: 100%;","}",".blocklyWidgetDiv {","display: none;","position: absolute;","z-index: 99999;","}",".injectionDiv {","height: 100%;","position: relative;","overflow: hidden;","touch-action: none","}",".blocklyNonSelectable {","user-select: none;","-moz-user-select: none;","-webkit-user-select: none;","-ms-user-select: none;","}",".blocklyWidgetDiv.fieldTextInput {","overflow: hidden;","border: 1px solid;","box-sizing: border-box;","transform-origin: 0 0;","-ms-transform-origin: 0 0;","-moz-transform-origin: 0 0;","-webkit-transform-origin: 0 0;","}",".blocklyWidgetDiv.fieldTextInput.removableTextInput {","overflow: visible;","}",".blocklyTextDropDownArrow {","position: absolute;","}",".blocklyTextRemoveIcon {","position: absolute;","width: 24px;","height: 24px;","top: -40px;","left: 50%;","margin-left: -12px;","cursor: pointer;","}",".blocklyNonSelectable {","user-select: none;","-moz-user-select: none;","-webkit-user-select: none;","-ms-user-select: none;","}",".blocklyWsDragSurface {","display: none;","position: absolute;","top: 0;","left: 0;","}",".blocklyWsDragSurface.blocklyOverflowVisible {","overflow: visible;","}",".blocklyBlockDragSurface {","display: none;","position: absolute;","top: 0;","left: 0;","right: 0;","bottom: 0;","overflow: visible !important;","z-index: 50;","}",".blocklyTooltipDiv {","background-color: #ffffc7;","border: 1px solid #ddc;","box-shadow: 4px 4px 20px 1px rgba(0,0,0,.15);","color: #000;","display: none;",'font-family: "Helvetica Neue", Helvetica, sans-serif;',"font-size: 9pt;","opacity: 0.9;","padding: 2px;","position: absolute;","z-index: 100000;","}",".blocklyDropDownDiv {","position: fixed;","left: 0;","top: 0;","z-index: 1000;","display: none;","border: 1px solid;","border-radius: 4px;","box-shadow: 0px 0px 8px 1px "+Blockly.Colours.dropDownShadow+";","padding: 4px;","-webkit-user-select: none;","min-height: 15px","}",".blocklyDropDownContent {","max-height: 300px;","overflow: auto;","}",".blocklyDropDownArrow {","position: absolute;","left: 0;","top: 0;","width: 16px;","height: 16px;","z-index: -1;","background-color: inherit;","border-color: inherit;","}",".blocklyDropDownButton {","display: inline-block;","float: left;","padding: 0;","margin: 4px;","border-radius: 4px;","outline: none;","border: 1px solid;","transition: box-shadow .1s;","cursor: pointer;","}",".blocklyDropDownButtonHover {","box-shadow: 0px 0px 0px 4px "+Blockly.Colours.fieldShadow+";","}",".blocklyDropDownButton:active {","box-shadow: 0px 0px 0px 6px "+Blockly.Colours.fieldShadow+";","}",".blocklyDropDownButton > img {","width: 80%;","height: 80%;","margin-top: 5%","}",".blocklyDropDownPlaceholder {","display: inline-block;","float: left;","padding: 0;","margin: 4px;","}",".blocklyNumPadButton {","display: inline-block;","float: left;","padding: 0;","width: 48px;","height: 48px;","margin: 4px;","border-radius: 4px;","background: $colour_numPadBackground;","color: $colour_numPadText;","outline: none;","border: 1px solid $colour_numPadBorder;","cursor: pointer;","font-weight: 600;",'font-family: "Helvetica Neue", Helvetica, sans-serif;',"font-size: 12pt;","-webkit-tap-highlight-color: rgba(0,0,0,0);","}",".blocklyNumPadButton > img {","margin-top: 10%;","width: 80%;","height: 80%;","}",".blocklyNumPadButton:active {","background: $colour_numPadActiveBackground;","-webkit-tap-highlight-color: rgba(0,0,0,0);","}",".arrowTop {","border-top: 1px solid;","border-left: 1px solid;","border-top-left-radius: 4px;","border-color: inherit;","}",".arrowBottom {","border-bottom: 1px solid;","border-right: 1px solid;","border-bottom-right-radius: 4px;","border-color: inherit;","}",".valueReportBox {","min-width: 50px;","max-width: 300px;","max-height: 200px;","overflow: auto;","word-wrap: break-word;","text-align: center;",'font-family: "Helvetica Neue", Helvetica, sans-serif;',"font-size: .8em;","}",".blocklyResizeSE {","cursor: se-resize;","fill: #aaa;","}",".blocklyResizeSW {","cursor: sw-resize;","fill: #aaa;","}",".blocklyResizeLine {","stroke: #888;","stroke-width: 1;","}",".blocklyHighlightedConnectionPath {","fill: none;","stroke: #fc3;","stroke-width: 4px;","}",".blocklyPath {","stroke-width: 1px;","}",".blocklySelected>.blocklyPath {","}",".blocklySelected>.blocklyPathLight {","display: none;","}",".blocklyDraggable {",'cursor: url("<<<PATH>>>/handopen.cur"), auto;',"cursor: grab;","cursor: -webkit-grab;","cursor: -moz-grab;","}",".blocklyDragging {",'cursor: url("<<<PATH>>>/handclosed.cur"), auto;',"cursor: grabbing;","cursor: -webkit-grabbing;","cursor: -moz-grabbing;","}",".blocklyDraggable:active {",'cursor: url("<<<PATH>>>/handclosed.cur"), auto;',"cursor: grabbing;","cursor: -webkit-grabbing;","cursor: -moz-grabbing;","}",".blocklyBlockDragSurface .blocklyDraggable {",'cursor: url("<<<PATH>>>/handclosed.cur"), auto;',"cursor: grabbing;","cursor: -webkit-grabbing;","cursor: -moz-grabbing;","}",".blocklyDragging.blocklyDraggingDelete {",'cursor: url("<<<PATH>>>/handdelete.cur"), auto;',"}",".blocklyDragging.blocklyDraggingMouseThrough {","pointer-events: none;","}",".blocklyToolboxDelete {",'cursor: url("<<<PATH>>>/handdelete.cur"), auto;',"}",".blocklyToolboxGrab {",'cursor: url("<<<PATH>>>/handclosed.cur"), auto;',"cursor: grabbing;","cursor: -webkit-grabbing;","}",".blocklyDragging>.blocklyPath,",".blocklyDragging>.blocklyPathLight {","fill-opacity: 1.0;","stroke-opacity: 1.0;","}",".blocklyDragging>.blocklyPath {","}",".blocklyDisabled>.blocklyPath {","fill-opacity: .5;","stroke-opacity: .5;","}",".blocklyInsertionMarker>.blocklyPath {","stroke: none;","}",".blocklyText {","fill: #fff;",'font-family: "Helvetica Neue", Helvetica, sans-serif;',"font-size: 12pt;","font-weight: 500;","}",".blocklyTextTruncated {","font-size: 11pt;","}",".blocklyNonEditableText>text {","pointer-events: none;","}",".blocklyNonEditableText>text,",".blocklyEditableText>text {","fill: $colour_text;","}",".blocklyEditableText>.blocklyEditableLabel {","fill: #fff;","}",".blocklyDropdownText {","fill: #fff !important;","}",".blocklyBubbleText {","fill: $colour_text;","}",".blocklyFlyout {","position: absolute;","z-index: 20;","}",".blocklyFlyoutButton {","fill: none;","pointer-events: all;","}",".blocklyFlyoutButtonBackground {","stroke: #c6c6c6;","}",".blocklyFlyoutButton .blocklyText {","fill: $colour_text;","}",".blocklyFlyoutButtonShadow {","fill: transparent;","}",".blocklyFlyoutButton:hover {","fill: white;","cursor: pointer;","}",".blocklyFlyoutLabel {","cursor: default;","}",".blocklyFlyoutLabelBackground {","opacity: 0;","}",".blocklyTouchTargetBackground {","fill: transparent;","cursor: pointer;","}",".blocklyFlyoutLabelText {",'font-family: "Helvetica Neue", Helvetica, sans-serif;',"font-size: 14pt;","fill: #575E75;","font-weight: bold;","}",".blocklySvg text, .blocklyBlockDragSurface text, .blocklyFlyout text, .blocklyToolboxDiv text {","user-select: none;","-moz-user-select: none;","-webkit-user-select: none;","cursor: inherit;","}",".blocklyHidden {","display: none;","}",".blocklyFieldDropdown:not(.blocklyHidden) {","display: block;","}",".blocklyIconGroup {","cursor: default;","}",".blocklyIconGroup:not(:hover),",".blocklyIconGroupReadonly {","opacity: .6;","}",".blocklyIconShape {","fill: #00f;","stroke: #fff;","stroke-width: 1px;","}",".blocklyIconSymbol {","fill: #fff;","}",".blocklyMinimalBody {","margin: 0;","padding: 0;","}",".blocklyCommentForeignObject {","position: relative;","z-index: 0;","}",".blocklyCommentRect {","fill: #E7DE8E;","stroke: #bcA903;","stroke-width: 1px","}",".blocklyCommentTarget {","fill: transparent;","stroke: #bcA903;","}",".blocklyCommentTargetFocused {","fill: none;","}",".blocklyCommentHandleTarget {","fill: none;","}",".blocklyCommentHandleTargetFocused {","fill: transparent;","}",".blocklyFocused>.blocklyCommentRect {","fill: #B9B272;","stroke: #B9B272;","}",".blocklySelected>.blocklyCommentTarget {","stroke: #fc3;","stroke-width: 3px;","}",".blocklyCommentTextarea {","background-color: #fef49c;","border: 0;","outline: 0;","margin: 0;","padding: 3px;","resize: none;","display: block;","overflow: hidden;","}",".blocklyCommentDeleteIcon {","cursor: pointer;","fill: #000;","display: none","}",".blocklySelected > .blocklyCommentDeleteIcon {","display: block","}",".blocklyDeleteIconShape {","fill: #000;","stroke: #000;","stroke-width: 1px;","}",".blocklyDeleteIconShape.blocklyDeleteIconHighlighted {","stroke: #fc3;","}",".scratchCommentForeignObject {","position: relative;","}",".scratchCommentBody {","background-color: #fef49c;","border-radius: 4px;","}",".scratchCommentRect {","fill: #fef49c;","}",".scratchCommentTarget {","fill: transparent;","}",".scratchWorkspaceCommentBorder {","stroke: #bcA903;","stroke-width: 1px;","}",".scratchCommentTargetFocused {","fill: none;","}",".scratchCommentTopBar {","fill: #000000;","fill-opacity: 0.1","}",".scratchCommentText {",'font-family: "Helvetica Neue", Helvetica, sans-serif;',"font-size: 12pt;","font-weight: 400;","}",".scratchCommentTextarea {","background-color: #fef49c;","border: 0;","outline: 0;","padding: 0;","resize: none;","overflow: hidden;","}",".scratchCommentTextarea::placeholder {","color: rgba(0,0,0,0.5);","font-style: italic;","}",".scratchCommentResizeSE {","cursor: se-resize;","fill: transparent;","}",".scratchCommentResizeSW {","cursor: sw-resize;","fill: transparent;","}",".blocklyHtmlInput {","border: none;",'font-family: "Helvetica Neue", Helvetica, sans-serif;',"font-size: 12pt;","height: 100%;","margin: 0;","outline: none;","box-sizing: border-box;","width: 100%;","text-align: center;","color: $colour_text;","font-weight: 500;","}",".blocklyMainBackground {","stroke-width: 1;","stroke: #c6c6c6;","}",".blocklyMutatorBackground {","fill: #fff;","stroke: #ddd;","stroke-width: 1;","}",".blocklyFlyoutBackground {","fill: $colour_flyout;","fill-opacity: .8;","}",".blocklyMainWorkspaceScrollbar {","z-index: 20;","}",".blocklyFlyoutScrollbar {","z-index: 30;","}",".blocklyScrollbarHorizontal, .blocklyScrollbarVertical {","position: absolute;","outline: none;","}",".blocklyScrollbarBackground {","opacity: 0;","}",".blocklyScrollbarHandle {","fill: $colour_scrollbar;","}",".blocklyScrollbarBackground:hover+.blocklyScrollbarHandle,",".blocklyScrollbarHandle:hover {","fill: $colour_scrollbarHover;","}",".blocklyZoom>image {","opacity: 1;","}",".blocklyFlyout .blocklyScrollbarHandle {","fill: #bbb;","}",".blocklyFlyout .blocklyScrollbarBackground:hover+.blocklyScrollbarHandle,",".blocklyFlyout .blocklyScrollbarHandle:hover {","fill: #aaa;","}",".blocklyInvalidInput {","background: #faa;","}",".blocklyAngleCircle {","stroke: "+Blockly.Colours.motion.tertiary+";","stroke-width: 1;","fill: "+Blockly.Colours.motion.secondary+";","}",".blocklyAngleCenterPoint {","stroke: #fff;","stroke-width: 1;","fill: #fff;","}",".blocklyAngleDragHandle {","stroke: #fff;","stroke-width: 5;","stroke-opacity: 0.25;","fill: #fff;","cursor: pointer;","}",".blocklyAngleDragArrow {","pointer-events: none","}",".blocklyAngleMarks {","stroke: #fff;","stroke-width: 1;","stroke-opacity: 0.5;","}",".blocklyAngleGauge {","fill: #fff;","fill-opacity: 0.20;","}",".blocklyAngleLine {","stroke: #fff;","stroke-width: 1;","stroke-linecap: round;","pointer-events: none;","}",".blocklyContextMenu {","border-radius: 4px;","max-height: 100%;","}",".blocklyDropdownMenu {","padding: 0 !important;","}",".blocklyDropDownNumPad {","background-color: $colour_numPadBackground;","}",".blocklyWidgetDiv .goog-option-selected .goog-menuitem-checkbox,",".blocklyWidgetDiv .goog-option-selected .goog-menuitem-icon {","background: url(<<<PATH>>>/sprites.png) no-repeat -48px -16px !important;","}",".blocklyToolboxDiv {","background-color: $colour_toolbox;","color: $colour_toolboxText;","overflow-x: visible;","overflow-y: auto;","position: absolute;",'font-family: "Helvetica Neue", Helvetica, sans-serif;',"z-index: 40;","-webkit-tap-highlight-color: transparent;","}",".blocklyTreeRoot {","padding: 4px 0;","}",".blocklyTreeRoot:focus {","outline: none;","}",".blocklyTreeRow {","height: 22px;","line-height: 22px;","margin-bottom: 3px;","padding-right: 8px;","white-space: nowrap;","}",".blocklyHorizontalTree {","float: left;","margin: 1px 5px 8px 0;","}",".blocklyHorizontalTreeRtl {","float: right;","margin: 1px 0 8px 5px;","}",'.blocklyToolboxDiv[dir="RTL"] .blocklyTreeRow {',"margin-left: 8px;","}",".blocklyTreeRow:not(.blocklyTreeSelected):hover {","background-color: #e4e4e4;","}",".blocklyTreeSeparator {","border-bottom: solid #e5e5e5 1px;","height: 0;","margin: 5px 0;","}",".blocklyTreeSeparatorHorizontal {","border-right: solid #e5e5e5 1px;","width: 0;","padding: 5px 0;","margin: 0 5px;","}",".blocklyTreeIcon {","background-image: url(<<<PATH>>>/sprites.png);","height: 16px;","vertical-align: middle;","width: 16px;","}",".blocklyTreeIconClosedLtr {","background-position: -32px -1px;","}",".blocklyTreeIconClosedRtl {","background-position: 0px -1px;","}",".blocklyTreeIconOpen {","background-position: -16px -1px;","}",".blocklyTreeSelected>.blocklyTreeIconClosedLtr {","background-position: -32px -17px;","}",".blocklyTreeSelected>.blocklyTreeIconClosedRtl {","background-position: 0px -17px;","}",".blocklyTreeSelected>.blocklyTreeIconOpen {","background-position: -16px -17px;","}",".blocklyTreeIconNone,",".blocklyTreeSelected>.blocklyTreeIconNone {","background-position: -48px -1px;","}",".blocklyTreeLabel {","cursor: default;",'font-family: "Helvetica Neue", Helvetica, sans-serif;',"font-size: 16px;","padding: 0 3px;","vertical-align: middle;","}",".blocklyToolboxDelete .blocklyTreeLabel {",'cursor: url("<<<PATH>>>/handdelete.cur"), auto;',"}",".blocklyTreeSelected .blocklyTreeLabel {","color: #fff;","}",".blocklyDropDownDiv .goog-slider-horizontal {","margin: 8px;","height: 22px;","width: 150px;","position: relative;","outline: none;","border-radius: 11px;","margin-bottom: 20px;","}",".blocklyDropDownDiv .goog-slider-horizontal .goog-slider-thumb {","width: 26px;","height: 26px;","top: -1px;","position: absolute;","background-color: white;","border-radius: 100%;","-webkit-box-shadow: 0 0 0 4px rgba(0, 0, 0, 0.15);","-moz-box-shadow: 0 0 0 4px rgba(0, 0, 0, 0.15);","box-shadow: 0 0 0 4px rgba(0, 0, 0, 0.15);","}",".scratchEyedropper {","background: none;","outline: none;","border: none;","width: 100%;","text-align: center;","border-top: 1px solid #ddd;","padding-top: 5px;","cursor: pointer;","}",".scratchColourPickerLabel {",'font-family: "Helvetica Neue", Helvetica, sans-serif;',"font-size: 0.65rem;","color: $colour_toolboxText;","margin: 8px;","}",".scratchColourPickerLabelText {","font-weight: bold;","}",".scratchColourPickerReadout {","margin-left: 10px;","}",".scratchMatrixButtonDiv {","width: 50%;","text-align: center;","float: left;","}",".scratchNotePickerKeyLabel {",'font-family: "Helvetica Neue", Helvetica, sans-serif;',"font-size: 0.75rem;","fill: $colour_text;","pointer-events: none;","}",".blocklyWidgetDiv .goog-menu {","background: #fff;","border-color: #ccc #666 #666 #ccc;","border-style: solid;","border-width: 1px;","cursor: default;",'font: normal 13px "Helvetica Neue", Helvetica, sans-serif;',"margin: 0;","outline: none;","padding: 4px 0;","position: absolute;","overflow-y: auto;","overflow-x: hidden;","z-index: 20000;","}",".blocklyDropDownDiv .goog-menu {","cursor: default;",'font: normal 13px "Helvetica Neue", Helvetica, sans-serif;',"outline: none;","z-index: 20000;","}",".blocklyWidgetDiv .goog-menuitem {","color: #000;",'font: normal 13px "Helvetica Neue", Helvetica, sans-serif;',"list-style: none;","margin: 0;","padding: 4px 7em 4px 28px;","white-space: nowrap;","}",".blocklyDropDownDiv .goog-menuitem {","color: #fff;",'font: normal 13px "Helvetica Neue", Helvetica, sans-serif;',"font-weight: bold;","list-style: none;","margin: 0;","min-height: 24px;","padding: 4px 7em 4px 28px;","white-space: nowrap;","}",".blocklyWidgetDiv .goog-menuitem.goog-menuitem-rtl, ",".blocklyDropDownDiv .goog-menuitem.goog-menuitem-rtl {","padding-left: 7em;","padding-right: 28px;","}",".blocklyWidgetDiv .goog-menu-nocheckbox .goog-menuitem,",".blocklyWidgetDiv .goog-menu-noicon .goog-menuitem, ",".blocklyDropDownDiv .goog-menu-nocheckbox .goog-menuitem,",".blocklyDropDownDiv .goog-menu-noicon .goog-menuitem { ","padding-left: 12px;","}",".blocklyWidgetDiv .goog-menu-noaccel .goog-menuitem, ",".blocklyDropDownDiv .goog-menu-noaccel .goog-menuitem {","padding-right: 20px;","}",".blocklyWidgetDiv .goog-menuitem-content ",".blocklyDropDownDiv .goog-menuitem-content {","color: #000;",'font: normal 13px "Helvetica Neue", Helvetica, sans-serif;',"}",".blocklyWidgetDiv .goog-menuitem-disabled .goog-menuitem-accel,",".blocklyWidgetDiv .goog-menuitem-disabled .goog-menuitem-content, ",".blocklyDropDownDiv .goog-menuitem-disabled .goog-menuitem-accel,",".blocklyDropDownDiv .goog-menuitem-disabled .goog-menuitem-content {","color: #ccc !important;","}",".blocklyWidgetDiv .goog-menuitem-disabled .goog-menuitem-icon, ",".blocklyDropDownDiv .goog-menuitem-disabled .goog-menuitem-icon {","opacity: 0.3;","-moz-opacity: 0.3;","filter: alpha(opacity=30);","}",".blocklyWidgetDiv .goog-menuitem-highlight,",".blocklyWidgetDiv .goog-menuitem-hover {","background-color: #d6e9f8;","border-color: #d6e9f8;","border-style: dotted;","border-width: 1px 0;","padding-bottom: 3px;","padding-top: 3px;","}",".blocklyDropDownDiv .goog-menuitem-highlight,",".blocklyDropDownDiv .goog-menuitem-hover {","background-color: rgba(0, 0, 0, 0.2);","}",".blocklyWidgetDiv .goog-menuitem-checkbox,",".blocklyWidgetDiv .goog-menuitem-icon, ",".blocklyDropDownDiv .goog-menuitem-checkbox,",".blocklyDropDownDiv .goog-menuitem-icon {","background-repeat: no-repeat;","height: 16px;","left: 6px;","position: absolute;","right: auto;","vertical-align: middle;","width: 16px;","}",".blocklyWidgetDiv .goog-option-selected .goog-menuitem-checkbox,",".blocklyWidgetDiv .goog-option-selected .goog-menuitem-icon,",".blocklyDropDownDiv .goog-option-selected .goog-menuitem-checkbox,",".blocklyDropDownDiv .goog-option-selected .goog-menuitem-icon {","background: url(<<<PATH>>>/sprites.png) no-repeat -48px -16px !important;","position: static;","float: left;","margin-left: -24px;","}",".blocklyWidgetDiv .goog-menuitem-rtl .goog-menuitem-checkbox,",".blocklyWidgetDiv .goog-menuitem-rtl .goog-menuitem-icon,",".blocklyDropDownDiv .goog-menuitem-rtl .goog-menuitem-checkbox,",".blocklyDropDownDiv .goog-menuitem-rtl .goog-menuitem-icon {","float: right;","margin-right: -24px;","}",".blocklyWidgetDiv .goog-menuitem-accel, ",".blocklyDropDownDiv .goog-menuitem-accel {","color: #999;","direction: ltr;","left: auto;","padding: 0 6px;","position: absolute;","right: 0;","text-align: right;","}",".blocklyWidgetDiv .goog-menuitem-rtl .goog-menuitem-accel, ",".blocklyDropDownDiv .goog-menuitem-rtl .goog-menuitem-accel {","left: 0;","right: auto;","text-align: left;","}",".blocklyWidgetDiv .goog-menuitem-mnemonic-hint, ",".blocklyDropDownDiv .goog-menuitem-mnemonic-hint {","text-decoration: underline;","}",".blocklyWidgetDiv .goog-menuitem-mnemonic-separator, ",".blocklyDropDownDiv .goog-menuitem-mnemonic-separator {","color: #999;","font-size: 12px;","padding-left: 4px;","}",".blocklyWidgetDiv .goog-menuseparator, ",".blocklyDropDownDiv .goog-menuseparator {","border-top: 1px solid #ccc;","margin: 4px 0;","padding: 0;","}",".blocklyFlyoutCheckbox {","fill: white;","stroke: #c8c8c8;","}",".checked > .blocklyFlyoutCheckbox {","fill: "+Blockly.Colours.motion.primary+";","stroke: "+Blockly.Colours.motion.tertiary+";","}",".blocklyFlyoutCheckboxPath {","fill: transparent;","stroke: white;","stroke-width: 3;","stroke-linecap: round;","stroke-linejoin: round;","}",".scratchCategoryMenu {","width: 60px;","background: $colour_toolbox;","color: $colour_toolboxText;","font-size: .7rem;","user-select: none;","-webkit-user-select: none;","-moz-user-select: none;","-ms-user-select: none;","}",".scratchCategoryMenuHorizontal {","width: 100%;","height: 50px;","background: $colour_toolbox;","color: $colour_toolboxText;","font-size: .7em;","user-select: none;","-webkit-user-select: none;","-moz-user-select: none;","-ms-user-select: none;","}",".scratchCategoryMenuHorizontal .scratchCategoryMenuRow {","float: left;","margin: 3px;","}",".scratchCategoryMenuRow {","}",".scratchCategoryMenuItem {","padding: 0.375rem 0px;","cursor: pointer;","text-align: center;","}",".scratchCategoryMenuHorizontal .scratchCategoryMenuItem {","padding: 6px 5px;","}",".scratchCategoryMenuItem.categorySelected {","background: $colour_toolboxSelected;","}",".scratchCategoryItemBubble {","width: 1.25rem;","height: 1.25rem;","border: 1px solid;","border-radius: 100%;","margin: 0 auto 0.125rem;","}",".scratchCategoryItemIcon {","width: 1.25rem;","height: 1.25rem;","margin: 0 auto 0.125rem;","background-size: 100%;","}",".scratchCategoryMenuItem:hover {","color: $colour_toolboxHover !important;","}",""];goog.provide("Blockly.DataCategory");goog.require("Blockly.Blocks");goog.require("Blockly.VariableModel");goog.require("Blockly.Variables");goog.require("Blockly.Workspace");Blockly.DataCategory=function(e){var o=e.getVariablesOfType("");o.sort(Blockly.VariableModel.compareByName);var t=[];Blockly.DataCategory.addCreateButton(t,e,"VARIABLE");for(var i=0;i<o.length;i++)Blockly.DataCategory.addDataVariable(t,o[i]);if(o.length>0){t[t.length-1].setAttribute("gap",24);var r=o[0];Blockly.DataCategory.addSetVariableTo(t,r);Blockly.DataCategory.addChangeVariableBy(t,r);Blockly.DataCategory.addShowVariable(t,r);Blockly.DataCategory.addHideVariable(t,r)}Blockly.DataCategory.addCreateButton(t,e,"LIST");o=e.getVariablesOfType(Blockly.LIST_VARIABLE_TYPE);o.sort(Blockly.VariableModel.compareByName);for(var i=0;i<o.length;i++)Blockly.DataCategory.addDataList(t,o[i]);if(o.length>0){t[t.length-1].setAttribute("gap",24);var r=o[0];Blockly.DataCategory.addAddToList(t,r);Blockly.DataCategory.addSep(t);Blockly.DataCategory.addDeleteOfList(t,r);Blockly.DataCategory.addDeleteAllOfList(t,r);Blockly.DataCategory.addInsertAtList(t,r);Blockly.DataCategory.addReplaceItemOfList(t,r);Blockly.DataCategory.addSep(t);Blockly.DataCategory.addItemOfList(t,r);Blockly.DataCategory.addItemNumberOfList(t,r);Blockly.DataCategory.addLengthOfList(t,r);Blockly.DataCategory.addListContainsItem(t,r);Blockly.DataCategory.addSep(t);Blockly.DataCategory.addShowList(t,r);Blockly.DataCategory.addHideList(t,r)}return t};Blockly.DataCategory.addDataVariable=function(e,o){Blockly.DataCategory.addBlock(e,o,"data_variable","VARIABLE");e[e.length-1].setAttribute("id",o.getId())};Blockly.DataCategory.addSetVariableTo=function(e,o){Blockly.DataCategory.addBlock(e,o,"data_setvariableto","VARIABLE",["VALUE","text",0])};Blockly.DataCategory.addChangeVariableBy=function(e,o){Blockly.DataCategory.addBlock(e,o,"data_changevariableby","VARIABLE",["VALUE","math_number",1])};Blockly.DataCategory.addShowVariable=function(e,o){Blockly.DataCategory.addBlock(e,o,"data_showvariable","VARIABLE")};Blockly.DataCategory.addHideVariable=function(e,o){Blockly.DataCategory.addBlock(e,o,"data_hidevariable","VARIABLE")};Blockly.DataCategory.addDataList=function(e,o){Blockly.DataCategory.addBlock(e,o,"data_listcontents","LIST");e[e.length-1].setAttribute("id",o.getId())};Blockly.DataCategory.addAddToList=function(e,o){Blockly.DataCategory.addBlock(e,o,"data_addtolist","LIST",["ITEM","text",Blockly.Msg.DEFAULT_LIST_ITEM])};Blockly.DataCategory.addDeleteOfList=function(e,o){Blockly.DataCategory.addBlock(e,o,"data_deleteoflist","LIST",["INDEX","math_integer",1])};Blockly.DataCategory.addDeleteAllOfList=function(e,o){Blockly.DataCategory.addBlock(e,o,"data_deletealloflist","LIST")};Blockly.DataCategory.addInsertAtList=function(e,o){Blockly.DataCategory.addBlock(e,o,"data_insertatlist","LIST",["INDEX","math_integer",1],["ITEM","text",Blockly.Msg.DEFAULT_LIST_ITEM])};Blockly.DataCategory.addReplaceItemOfList=function(e,o){Blockly.DataCategory.addBlock(e,o,"data_replaceitemoflist","LIST",["INDEX","math_integer",1],["ITEM","text",Blockly.Msg.DEFAULT_LIST_ITEM])};Blockly.DataCategory.addItemOfList=function(e,o){Blockly.DataCategory.addBlock(e,o,"data_itemoflist","LIST",["INDEX","math_integer",1])};Blockly.DataCategory.addItemNumberOfList=function(e,o){Blockly.DataCategory.addBlock(e,o,"data_itemnumoflist","LIST",["ITEM","text",Blockly.Msg.DEFAULT_LIST_ITEM])};Blockly.DataCategory.addLengthOfList=function(e,o){Blockly.DataCategory.addBlock(e,o,"data_lengthoflist","LIST")};Blockly.DataCategory.addListContainsItem=function(e,o){Blockly.DataCategory.addBlock(e,o,"data_listcontainsitem","LIST",["ITEM","text",Blockly.Msg.DEFAULT_LIST_ITEM])};Blockly.DataCategory.addShowList=function(e,o){Blockly.DataCategory.addBlock(e,o,"data_showlist","LIST")};Blockly.DataCategory.addHideList=function(e,o){Blockly.DataCategory.addBlock(e,o,"data_hidelist","LIST")};Blockly.DataCategory.addCreateButton=function(e,o,t){var i=goog.dom.createDom("button");var r=Blockly.Msg.NEW_VARIABLE;var n="CREATE_VARIABLE";var l=function(e){Blockly.Variables.createVariable(e.getTargetWorkspace(),null,"")};if("LIST"===t){r=Blockly.Msg.NEW_LIST;n="CREATE_LIST";l=function(e){Blockly.Variables.createVariable(e.getTargetWorkspace(),null,Blockly.LIST_VARIABLE_TYPE)}}i.setAttribute("text",r);i.setAttribute("callbackKey",n);o.registerButtonCallback(n,l);e.push(i)};Blockly.DataCategory.addBlock=function(e,o,t,i,r,n){if(Blockly.Blocks[t]){var l;var s;if(r)l=Blockly.DataCategory.createValue(r[0],r[1],r[2]);if(n)s=Blockly.DataCategory.createValue(n[0],n[1],n[2]);var g=8;var a="<xml>"+'<block type="'+t+'" gap="'+g+'">'+Blockly.Variables.generateVariableFieldXml_(o,i)+l+s+"</block>"+"</xml>";var c=Blockly.Xml.textToDom(a).firstChild;e.push(c)}};Blockly.DataCategory.createValue=function(e,o,t){var i;switch(e){case"ITEM":i="TEXT";break;case"INDEX":i="NUM";break;case"VALUE":if("math_number"===o)i="NUM";else i="TEXT";break}var r='<value name="'+e+'">'+'<shadow type="'+o+'">'+'<field name="'+i+'">'+t+"</field>"+"</shadow>"+"</value>";return r};Blockly.DataCategory.addSep=function(e){var o=36;var t="<xml>"+'<sep gap="'+o+'"/>'+"</xml>";var i=Blockly.Xml.textToDom(t).firstChild;e.push(i)};goog.provide("Blockly.DraggedConnectionManager");goog.require("Blockly.BlockAnimations");goog.require("Blockly.RenderedConnection");goog.require("goog.math.Coordinate");Blockly.DraggedConnectionManager=function(e){Blockly.selected=e;this.topBlock_=e;this.workspace_=e.workspace;this.availableConnections_=this.initAvailableConnections_();this.closestConnection_=null;this.localConnection_=null;this.radiusConnection_=0;this.wouldDeleteBlock_=false};Blockly.DraggedConnectionManager.prototype.dispose=function(){this.topBlock_=null;this.workspace_=null;this.availableConnections_.length=0;this.closestConnection_=null;this.localConnection_=null};Blockly.DraggedConnectionManager.prototype.wouldDeleteBlock=function(){return this.wouldDeleteBlock_};Blockly.DraggedConnectionManager.prototype.applyConnections=function(){if(this.closestConnection_){this.localConnection_.connect(this.closestConnection_);if(this.topBlock_.rendered){var e=this.localConnection_.isSuperior()?this.closestConnection_:this.localConnection_;Blockly.BlockAnimations.connectionUiEffect(e.getSourceBlock());var o=this.topBlock_.getRootBlock();o.bringToFront()}this.removeHighlighting_()}};Blockly.DraggedConnectionManager.prototype.update=function(e,o,t){var i;var r;if(!t){i=this.closestConnection_;r=this.updateClosest_(e);if(r&&i)i.unhighlight()}else if(this.closestConnection_){this.closestConnection_.unhighlight();this.closestConnection_=null}var n=!!this.closestConnection_&&o!=Blockly.DELETE_AREA_TOOLBOX;var l=!!o&&!this.topBlock_.getParent()&&this.topBlock_.isDeletable();this.wouldDeleteBlock_=l&&!n;if(!this.wouldDeleteBlock_&&r&&this.closestConnection_)this.addHighlighting_()};Blockly.DraggedConnectionManager.prototype.removeHighlighting_=function(){if(this.closestConnection_)this.closestConnection_.unhighlight()};Blockly.DraggedConnectionManager.prototype.addHighlighting_=function(){if(this.closestConnection_)this.closestConnection_.highlight()};Blockly.DraggedConnectionManager.prototype.initAvailableConnections_=function(){var e=this.topBlock_.getConnections_(false);var o=this.topBlock_.lastConnectionInStack();if(o&&o!=this.topBlock_.nextConnection)e.push(o);return e};Blockly.DraggedConnectionManager.prototype.updateClosest_=function(e){var o=this.closestConnection_;this.closestConnection_=null;this.localConnection_=null;this.radiusConnection_=Blockly.SNAP_RADIUS;for(var t=0;t<this.availableConnections_.length;t++){var i=this.availableConnections_[t];var r=i.closest(this.radiusConnection_,e);if(r.connection){this.closestConnection_=r.connection;this.localConnection_=i;this.radiusConnection_=r.radius}}return o!=this.closestConnection_};goog.provide("Blockly.DropDownDiv");goog.require("goog.dom");goog.require("goog.style");Blockly.DropDownDiv=function(){};Blockly.DropDownDiv.DIV_=null;Blockly.DropDownDiv.boundsElement_=null;Blockly.DropDownDiv.owner_=null;Blockly.DropDownDiv.ARROW_SIZE=16;Blockly.DropDownDiv.BORDER_SIZE=1;Blockly.DropDownDiv.ARROW_HORIZONTAL_PADDING=12;Blockly.DropDownDiv.PADDING_Y=20;Blockly.DropDownDiv.ANIMATION_TIME=.25;Blockly.DropDownDiv.animateOutTimer_=null;Blockly.DropDownDiv.onHide_=0;Blockly.DropDownDiv.createDom=function(){if(Blockly.DropDownDiv.DIV_)return;Blockly.DropDownDiv.DIV_=goog.dom.createDom("div","blocklyDropDownDiv");document.body.appendChild(Blockly.DropDownDiv.DIV_);Blockly.DropDownDiv.content_=goog.dom.createDom("div","blocklyDropDownContent");Blockly.DropDownDiv.DIV_.appendChild(Blockly.DropDownDiv.content_);Blockly.DropDownDiv.arrow_=goog.dom.createDom("div","blocklyDropDownArrow");Blockly.DropDownDiv.DIV_.appendChild(Blockly.DropDownDiv.arrow_);Blockly.DropDownDiv.DIV_.style.transition="transform "+Blockly.DropDownDiv.ANIMATION_TIME+"s, "+"opacity "+Blockly.DropDownDiv.ANIMATION_TIME+"s"};Blockly.DropDownDiv.setBoundsElement=function(e){Blockly.DropDownDiv.boundsElement_=e};Blockly.DropDownDiv.getContentDiv=function(){return Blockly.DropDownDiv.content_};Blockly.DropDownDiv.clearContent=function(){Blockly.DropDownDiv.content_.innerHTML="";Blockly.DropDownDiv.content_.style.width=""};Blockly.DropDownDiv.setColour=function(e,o){Blockly.DropDownDiv.DIV_.style.backgroundColor=e;Blockly.DropDownDiv.DIV_.style.borderColor=o};Blockly.DropDownDiv.setCategory=function(e){Blockly.DropDownDiv.DIV_.setAttribute("data-category",e)};Blockly.DropDownDiv.showPositionedByBlock=function(e,o,t,i){var r=o.workspace.scale;var n={width:o.width,height:o.height};n.width*=r;n.height*=r;var l=o.getSvgRoot().getBoundingClientRect();var s=l.left+n.width/2;var g=l.top+n.height;var a=s;var c=l.top;if(i)c+=i;Blockly.DropDownDiv.setBoundsElement(o.workspace.getParentSvg().parentNode);return Blockly.DropDownDiv.show(this,s,g,a,c,t)};Blockly.DropDownDiv.show=function(e,o,t,i,r,n){Blockly.DropDownDiv.owner_=e;Blockly.DropDownDiv.onHide_=n;var l=Blockly.DropDownDiv.DIV_;var s=Blockly.DropDownDiv.getPositionMetrics(o,t,i,r);Blockly.DropDownDiv.arrow_.style.transform="translate("+s.arrowX+"px,"+s.arrowY+"px) rotate(45deg)";Blockly.DropDownDiv.arrow_.setAttribute("class",s.arrowAtTop?"blocklyDropDownArrow arrowTop":"blocklyDropDownArrow arrowBottom");l.style.direction=e.sourceBlock_&&e.sourceBlock_.RTL?"rtl":"ltr";l.style.left=s.initialX+"px";l.style.top=s.initialY+"px";l.style.display="block";l.style.opacity=1;var g=s.finalX-s.initialX;var a=s.finalY-s.initialY;l.style.transform="translate("+g+"px,"+a+"px)";return s.arrowAtTop};Blockly.DropDownDiv.getPositionMetrics=function(e,o,t,i){var r=Blockly.DropDownDiv.DIV_;var n=Blockly.DropDownDiv.boundsElement_.getBoundingClientRect();var l=goog.style.getSize(Blockly.DropDownDiv.boundsElement_);var s=goog.style.getSize(r);var g,a,c;if(o+s.height>n.top+l.height)if(i-s.height<n.top){g=e;a=o+Blockly.DropDownDiv.PADDING_Y;c=false}else{g=t;a=i-s.height-Blockly.DropDownDiv.PADDING_Y;c=true}else{g=e;a=o+Blockly.DropDownDiv.PADDING_Y;c=false}var u=g-Blockly.DropDownDiv.ARROW_SIZE/2;u=Math.max(n.left,Math.min(u,n.left+l.width));var h=s.width/2;g-=h;g=Math.max(n.left,Math.min(g,n.left+l.width-s.width));u-=g;u=Math.max(Blockly.DropDownDiv.ARROW_HORIZONTAL_PADDING,Math.min(u,s.width-Blockly.DropDownDiv.ARROW_HORIZONTAL_PADDING-Blockly.DropDownDiv.ARROW_SIZE));var d=c?s.height-Blockly.DropDownDiv.BORDER_SIZE:0;d-=Blockly.DropDownDiv.ARROW_SIZE/2+Blockly.DropDownDiv.BORDER_SIZE;var p=g;var y;if(c)y=i-s.height;else y=o;return{initialX:p,initialY:y,finalX:g,finalY:a,arrowX:u,arrowY:d,arrowAtTop:!c}};Blockly.DropDownDiv.isVisible=function(){return!!Blockly.DropDownDiv.owner_};Blockly.DropDownDiv.hideIfOwner=function(e){if(Blockly.DropDownDiv.owner_===e){Blockly.DropDownDiv.hide();return true}return false};Blockly.DropDownDiv.hide=function(){var e=Blockly.DropDownDiv.DIV_;e.style.transform="translate(0px, 0px)";e.style.opacity=0;Blockly.DropDownDiv.animateOutTimer_=setTimeout((function(){Blockly.DropDownDiv.hideWithoutAnimation()}),1e3*Blockly.DropDownDiv.ANIMATION_TIME);if(Blockly.DropDownDiv.onHide_){Blockly.DropDownDiv.onHide_();Blockly.DropDownDiv.onHide_=null}};Blockly.DropDownDiv.hideWithoutAnimation=function(){if(!Blockly.DropDownDiv.isVisible())return;var e=Blockly.DropDownDiv.DIV_;Blockly.DropDownDiv.animateOutTimer_&&window.clearTimeout(Blockly.DropDownDiv.animateOutTimer_);e.style.transform="";e.style.top="";e.style.left="";e.style.display="none";Blockly.DropDownDiv.clearContent();Blockly.DropDownDiv.owner_=null;if(Blockly.DropDownDiv.onHide_){Blockly.DropDownDiv.onHide_();Blockly.DropDownDiv.onHide_=null}};goog.provide("Blockly.Extensions");goog.require("Blockly.Mutator");goog.require("Blockly.utils");goog.require("goog.string");Blockly.Extensions.ALL_={};Blockly.Extensions.register=function(e,o){if(!goog.isString(e)||goog.string.isEmptyOrWhitespace(e))throw new Error('Error: Invalid extension name "'+e+'"');if(Blockly.Extensions.ALL_[e])throw new Error('Error: Extension "'+e+'" is already registered.');if(!goog.isFunction(o))throw new Error('Error: Extension "'+e+'" must be a function');Blockly.Extensions.ALL_[e]=o};Blockly.Extensions.registerMixin=function(e,o){if(!goog.isObject(o))throw new Error('Error: Mixin "'+e+'" must be a object');Blockly.Extensions.register(e,(function(){this.mixin(o)}))};Blockly.Extensions.registerMutator=function(e,o,t,i){var r='Error when registering mutator "'+e+'": ';Blockly.Extensions.checkHasFunction_(r,o.domToMutation,"domToMutation");Blockly.Extensions.checkHasFunction_(r,o.mutationToDom,"mutationToDom");var n=Blockly.Extensions.checkMutatorDialog_(o,r);if(t&&!goog.isFunction(t))throw new Error('Extension "'+e+'" is not a function');Blockly.Extensions.register(e,(function(){if(n)this.setMutator(new Blockly.Mutator(i));this.mixin(o);if(t)t.apply(this)}))};Blockly.Extensions.apply=function(e,o,t){var i=Blockly.Extensions.ALL_[e];if(!goog.isFunction(i))throw new Error('Error: Extension "'+e+'" not found.');if(t)Blockly.Extensions.checkNoMutatorProperties_(e,o);else var r=Blockly.Extensions.getMutatorProperties_(o);i.apply(o);if(t){var n='Error after applying mutator "'+e+'": ';Blockly.Extensions.checkBlockHasMutatorProperties_(n,o)}else if(!Blockly.Extensions.mutatorPropertiesMatch_(r,o))throw new Error('Error when applying extension "'+e+'": '+"mutation properties changed when applying a non-mutator extension.")};Blockly.Extensions.checkHasFunction_=function(e,o,t){if(!o)throw new Error(e+'missing required property "'+t+'"');else if("function"!=typeof o)throw new Error(e+'" required property "'+t+'" must be a function')};Blockly.Extensions.checkNoMutatorProperties_=function(e,o){var t=Blockly.Extensions.getMutatorProperties_(o);if(t.length)throw new Error('Error: tried to apply mutation "'+e+'" to a block that already has mutator functions.'+"  Block id: "+o.id)};Blockly.Extensions.checkMutatorDialog_=function(e,o){var t=void 0!==e.compose;var i=void 0!==e.decompose;if(t&&i){if("function"!=typeof e.compose)throw new Error(o+"compose must be a function.");else if("function"!=typeof e.decompose)throw new Error(o+"decompose must be a function.");return true}else if(!t&&!i)return false;else throw new Error(o+'Must have both or neither of "compose" and "decompose"')};Blockly.Extensions.checkBlockHasMutatorProperties_=function(e,o){if("function"!==typeof o.domToMutation)throw new Error(e+'Applying a mutator didn\'t add "domToMutation"');if("function"!=typeof o.mutationToDom)throw new Error(e+'Applying a mutator didn\'t add "mutationToDom"');Blockly.Extensions.checkMutatorDialog_(o,e)};Blockly.Extensions.getMutatorProperties_=function(e){var o=[];if(void 0!==e.domToMutation)o.push(e.domToMutation);if(void 0!==e.mutationToDom)o.push(e.mutationToDom);if(void 0!==e.compose)o.push(e.compose);if(void 0!==e.decompose)o.push(e.decompose);return o};Blockly.Extensions.mutatorPropertiesMatch_=function(e,o){var t=Blockly.Extensions.getMutatorProperties_(o);if(t.length!=e.length)return false;for(var i=0;i<t.length;i++)if(e[i]!=t[i])return false;return true};Blockly.Extensions.buildTooltipForDropdown=function(e,o){var t=[];if(document)Blockly.utils.runAfterPageLoad((function(){for(var e in o)Blockly.utils.checkMessageReferences(o[e])}));var i=function(){if(this.type&&-1===t.indexOf(this.type)){Blockly.Extensions.checkDropdownOptionsInTable_(this,e,o);t.push(this.type)}this.setTooltip(function(){var i=this.getFieldValue(e);var r=o[i];if(null==r){if(-1===t.indexOf(this.type)){var n="No tooltip mapping for value "+i+" of field "+e;if(null!=this.type)n+=" of block type "+this.type;console.warn(n+".")}}else r=Blockly.utils.replaceMessageReferences(r);return r}.bind(this))};return i};Blockly.Extensions.checkDropdownOptionsInTable_=function(e,o,t){var i=e.getField(o);if(!i.isOptionListDynamic()){var r=i.getOptions();for(var n=0;n<r.length;++n){var l=r[n][1];if(null==t[l])console.warn("No tooltip mapping for value "+l+" of field "+o+" of block type "+e.type)}}};Blockly.Extensions.buildTooltipWithFieldValue=function(e,o){if(document)Blockly.utils.runAfterPageLoad((function(){Blockly.utils.checkMessageReferences(e)}));var t=function(){this.setTooltip(function(){return Blockly.utils.replaceMessageReferences(e).replace("%1",this.getFieldValue(o))}.bind(this))};return t};Blockly.Extensions.extensionParentTooltip_=function(){this.tooltipWhenNotConnected_=this.tooltip;this.setTooltip(function(){var e=this.getParent();return e&&e.getInputsInline()&&e.tooltip||this.tooltipWhenNotConnected_}.bind(this))};Blockly.Extensions.register("parent_tooltip_when_inline",Blockly.Extensions.extensionParentTooltip_);goog.provide("Blockly.Field");goog.require("Blockly.Events.BlockChange");goog.require("Blockly.Gesture");goog.require("goog.asserts");goog.require("goog.dom");goog.require("goog.math.Size");goog.require("goog.style");goog.require("goog.userAgent");Blockly.Field=function(e,o){this.size_=new goog.math.Size(Blockly.BlockSvg.FIELD_WIDTH,Blockly.BlockSvg.FIELD_HEIGHT);this.setValue(e);this.setValidator(o);this.maxDisplayLength=Blockly.BlockSvg.MAX_DISPLAY_LENGTH};Blockly.Field.TYPE_MAP_={};Blockly.Field.register=function(e,o){if(!goog.isString(e)||goog.string.isEmptyOrWhitespace(e))throw new Error('Invalid field type "'+e+'"');if(!goog.isObject(o)||!goog.isFunction(o.fromJson))throw new Error('Field "'+o+'" must have a fromJson function');Blockly.Field.TYPE_MAP_[e]=o};Blockly.Field.fromJson=function(e){var o=Blockly.Field.TYPE_MAP_[e["type"]];if(o)return o.fromJson(e);return null};Blockly.Field.cacheWidths_=null;Blockly.Field.cacheReference_=0;Blockly.Field.prototype.name=void 0;Blockly.Field.prototype.className_="blocklyText";Blockly.Field.prototype.text_="";Blockly.Field.prototype.sourceBlock_=null;Blockly.Field.prototype.visible_=true;Blockly.Field.prototype.argType_=null;Blockly.Field.prototype.validator_=null;Blockly.Field.prototype.useTouchInteraction_=false;Blockly.Field.NBSP=" ";Blockly.Field.IE_TEXT_OFFSET="0.3em";Blockly.Field.prototype.EDITABLE=true;Blockly.Field.prototype.SERIALIZABLE=true;Blockly.Field.prototype.setSourceBlock=function(e){goog.asserts.assert(!this.sourceBlock_,"Field already bound to a block.");this.sourceBlock_=e};Blockly.Field.prototype.init=function(){if(this.fieldGroup_)return;this.fieldGroup_=Blockly.utils.createSvgElement("g",{},null);if(!this.visible_)this.fieldGroup_.style.display="none";if(null!==this.getArgTypes())if(this.sourceBlock_.isShadow())this.sourceBlock_.svgGroup_.setAttribute("data-argument-type",this.getArgTypes());else this.fieldGroup_.setAttribute("data-argument-type",this.getArgTypes());var e=this.getSize();var o=this.sourceBlock_.RTL?-e.width/2:e.width/2;this.textElement_=Blockly.utils.createSvgElement("text",{class:this.className_,x:o,y:e.height/2+Blockly.BlockSvg.FIELD_TOP_PADDING,"dominant-baseline":"middle",dy:goog.userAgent.EDGE_OR_IE?Blockly.Field.IE_TEXT_OFFSET:"0","text-anchor":"middle"},this.fieldGroup_);this.updateEditable();this.sourceBlock_.getSvgRoot().appendChild(this.fieldGroup_);this.render_();this.size_.width=0;this.mouseDownWrapper_=Blockly.bindEventWithChecks_(this.getClickTarget_(),"mousedown",this,this.onMouseDown_)};Blockly.Field.prototype.initModel=function(){};Blockly.Field.prototype.dispose=function(){if(this.mouseDownWrapper_){Blockly.unbindEvent_(this.mouseDownWrapper_);this.mouseDownWrapper_=null}this.sourceBlock_=null;goog.dom.removeNode(this.fieldGroup_);this.fieldGroup_=null;this.textElement_=null;this.validator_=null};Blockly.Field.prototype.updateEditable=function(){var e=this.fieldGroup_;if(!this.EDITABLE||!e)return;if(this.sourceBlock_.isEditable()){Blockly.utils.addClass(e,"blocklyEditableText");Blockly.utils.removeClass(e,"blocklyNonEditableText");this.fieldGroup_.style.cursor=this.CURSOR}else{Blockly.utils.addClass(e,"blocklyNonEditableText");Blockly.utils.removeClass(e,"blocklyEditableText");this.fieldGroup_.style.cursor=""}};Blockly.Field.prototype.isCurrentlyEditable=function(){return this.EDITABLE&&!!this.sourceBlock_&&this.sourceBlock_.isEditable()};Blockly.Field.prototype.isVisible=function(){return this.visible_};Blockly.Field.prototype.setVisible=function(e){if(this.visible_==e)return;this.visible_=e;var o=this.getSvgRoot();if(o){o.style.display=e?"block":"none";this.render_()}};Blockly.Field.prototype.addArgType=function(e){if(null==this.argType_)this.argType_=[];this.argType_.push(e)};Blockly.Field.prototype.getArgTypes=function(){if(null===this.argType_||0===this.argType_.length)return null;else return this.argType_.join(" ")};Blockly.Field.prototype.setValidator=function(e){this.validator_=e};Blockly.Field.prototype.getValidator=function(){return this.validator_};Blockly.Field.prototype.classValidator=function(e){return e};Blockly.Field.prototype.callValidator=function(e){var o=this.classValidator(e);if(null===o)return null;else if(void 0!==o)e=o;var t=this.getValidator();if(t){var i=t.call(this,e);if(null===i)return null;else if(void 0!==i)e=i}return e};Blockly.Field.prototype.getSvgRoot=function(){return this.fieldGroup_};Blockly.Field.prototype.render_=function(){if(this.visible_&&this.textElement_){this.textElement_.textContent=this.getDisplayText_();this.updateWidth();var e=(this.size_.width-this.arrowWidth_)/2;if(this.sourceBlock_.RTL)e+=this.arrowWidth_;if(this.sourceBlock_.isShadow()&&!this.positionArrow){var o=Blockly.BlockSvg.FIELD_WIDTH/2;if(this.sourceBlock_.RTL){var t=this.size_.width-o;e=Math.min(t,e)}else e=Math.max(o,e)}this.textElement_.setAttribute("x",e)}if(this.box_){this.box_.setAttribute("width",this.size_.width);this.box_.setAttribute("height",this.size_.height)}};Blockly.Field.prototype.updateWidth=function(){var e=Blockly.Field.getCachedWidth(this.textElement_);if(this.EDITABLE)e+=Blockly.BlockSvg.EDITABLE_FIELD_PADDING;this.arrowWidth_=0;if(this.positionArrow){this.arrowWidth_=this.positionArrow(e);e+=this.arrowWidth_}if(this.box_)e+=2*Blockly.BlockSvg.BOX_FIELD_PADDING;this.size_.width=e};Blockly.Field.getCachedWidth=function(e){var o=e.textContent+"\n"+e.className.baseVal;var t;if(Blockly.Field.cacheWidths_){t=Blockly.Field.cacheWidths_[o];if(t)return t}try{if(goog.userAgent.IE||goog.userAgent.EDGE)t=e.getBBox().width;else t=e.getComputedTextLength()}catch(o){return 8*e.textContent.length}if(Blockly.Field.cacheWidths_)Blockly.Field.cacheWidths_[o]=t;return t};Blockly.Field.startCache=function(){Blockly.Field.cacheReference_++;if(!Blockly.Field.cacheWidths_)Blockly.Field.cacheWidths_={}};Blockly.Field.stopCache=function(){Blockly.Field.cacheReference_--;if(!Blockly.Field.cacheReference_)Blockly.Field.cacheWidths_=null};Blockly.Field.prototype.getSize=function(){if(!this.size_.width)this.render_();return this.size_};Blockly.Field.prototype.getScaledBBox_=function(){var e=this.getSize();var o=e.height*this.sourceBlock_.workspace.scale;var t=e.width*this.sourceBlock_.workspace.scale;var i=this.getAbsoluteXY_();return{top:i.y,bottom:i.y+o,left:i.x,right:i.x+t}};Blockly.Field.prototype.getDisplayText_=function(){var e=this.text_;if(!e)return Blockly.Field.NBSP;if(e.length>this.maxDisplayLength)e=e.substring(0,this.maxDisplayLength-2)+"…";e=e.replace(/\s/g,Blockly.Field.NBSP);if(this.sourceBlock_.RTL)if(this.sourceBlock_.editable_&&"math_number"===this.sourceBlock_.type)e="‪"+e+"‬";else e="‫"+e+"‬";return e};Blockly.Field.prototype.getText=function(){return this.text_};Blockly.Field.prototype.setText=function(e){if(null===e)return;e=String(e);if(e===this.text_)return;this.text_=e;this.forceRerender()};Blockly.Field.prototype.forceRerender=function(){this.size_.width=0;if(this.sourceBlock_&&this.sourceBlock_.rendered){this.sourceBlock_.render();this.sourceBlock_.bumpNeighbours_()}};Blockly.Field.prototype.updateTextNode_=function(){if(!this.textElement_)return;var e=this.text_;if(e.length>this.maxDisplayLength){e=e.substring(0,this.maxDisplayLength-2)+"…";this.textElement_.setAttribute("class",this.className_+" blocklyTextTruncated")}else this.textElement_.setAttribute("class",this.className_);goog.dom.removeChildren(this.textElement_);e=e.replace(/\s/g,Blockly.Field.NBSP);if(this.sourceBlock_.RTL&&e)if(this.sourceBlock_.editable_&&"math_number"===this.sourceBlock_.type)e="‪"+e+"‬";else e="‫"+e+"‬";if(!e)e=Blockly.Field.NBSP;var o=document.createTextNode(e);this.textElement_.appendChild(o);this.size_.width=0};Blockly.Field.prototype.getValue=function(){return this.getText()};Blockly.Field.prototype.setValue=function(e){if(null===e)return;var o=this.getValue();if(o==e)return;if(this.sourceBlock_&&Blockly.Events.isEnabled())Blockly.Events.fire(new Blockly.Events.BlockChange(this.sourceBlock_,"field",this.name,o,e));this.setText(e)};Blockly.Field.prototype.onMouseDown_=function(e){if(!this.sourceBlock_||!this.sourceBlock_.workspace)return;var o=this.sourceBlock_.workspace.getGesture(e);if(o)o.setStartField(this);this.useTouchInteraction_="mouse"!==Blockly.Touch.getTouchIdentifierFromEvent(event)};Blockly.Field.prototype.setTooltip=function(e){};Blockly.Field.prototype.getClickTarget_=function(){var e=0;for(var o=0,t;t=this.sourceBlock_.inputList[o];o++)e+=t.fieldRow.length;if(e<=1&&this.sourceBlock_.outputConnection)return this.sourceBlock_.getSvgRoot();else return this.getSvgRoot()};Blockly.Field.prototype.getAbsoluteXY_=function(){return goog.style.getPageOffset(this.getClickTarget_())};Blockly.Field.prototype.referencesVariables=function(){return false};goog.provide("Blockly.FieldTextInput");goog.require("Blockly.BlockSvg.render");goog.require("Blockly.Colours");goog.require("Blockly.Field");goog.require("Blockly.Msg");goog.require("Blockly.scratchBlocksUtils");goog.require("Blockly.utils");goog.require("goog.asserts");goog.require("goog.dom");goog.require("goog.dom.TagName");goog.require("goog.userAgent");Blockly.FieldTextInput=function(e,o,t){Blockly.FieldTextInput.superClass_.constructor.call(this,e,o);this.setRestrictor(t);this.addArgType("text")};goog.inherits(Blockly.FieldTextInput,Blockly.Field);Blockly.FieldTextInput.fromJson=function(e){var o=Blockly.utils.replaceMessageReferences(e["text"]);var t=new Blockly.FieldTextInput(o,e["class"]);if("boolean"===typeof e["spellcheck"])t.setSpellcheck(e["spellcheck"]);return t};Blockly.FieldTextInput.ANIMATION_TIME=.25;Blockly.FieldTextInput.TEXT_MEASURE_PADDING_MAGIC=45;Blockly.FieldTextInput.htmlInput_=null;Blockly.FieldTextInput.prototype.CURSOR="text";Blockly.FieldTextInput.prototype.spellcheck_=true;Blockly.FieldTextInput.prototype.init=function(){if(this.fieldGroup_)return;var e=!this.sourceBlock_.isShadow();if(e)this.className_+=" blocklyEditableLabel";Blockly.FieldTextInput.superClass_.init.call(this);if(e){this.box_=Blockly.utils.createSvgElement("rect",{x:0,y:0,width:this.size_.width,height:this.size_.height,fill:this.sourceBlock_.getColourTertiary(),rx:15});this.fieldGroup_.insertBefore(this.box_,this.textElement_)}};Blockly.FieldTextInput.prototype.dispose=function(){Blockly.WidgetDiv.hideIfOwner(this);Blockly.FieldTextInput.superClass_.dispose.call(this)};Blockly.FieldTextInput.prototype.setValue=function(e){if(null===e)return;if(this.sourceBlock_){var o=this.callValidator(e);if(null!==o)e=o}Blockly.Field.prototype.setValue.call(this,e)};Blockly.FieldTextInput.prototype.setText=function(e){if(null===e)return;e=String(e);if(e===this.text_)return;if(this.sourceBlock_&&Blockly.Events.isEnabled())Blockly.Events.fire(new Blockly.Events.BlockChange(this.sourceBlock_,"field",this.name,this.text_,e));Blockly.Field.prototype.setText.call(this,e)};Blockly.FieldTextInput.prototype.setSpellcheck=function(e){this.spellcheck_=e};Blockly.FieldTextInput.prototype.setRestrictor=function(e){this.restrictor_=e};Blockly.FieldTextInput.prototype.showEditor_=function(e,o,t,i){this.workspace_=this.sourceBlock_.workspace;var r=e||false;var n=o||false;Blockly.WidgetDiv.show(this,this.sourceBlock_.RTL,this.widgetDispose_(),this.widgetDisposeAnimationFinished_(),Blockly.FieldTextInput.ANIMATION_TIME);var l=Blockly.WidgetDiv.DIV;l.className+=" fieldTextInput";var s=goog.dom.createDom(goog.dom.TagName.INPUT,"blocklyHtmlInput");s.setAttribute("spellcheck",this.spellcheck_);if(n)s.setAttribute("readonly","true");Blockly.FieldTextInput.htmlInput_=s;l.appendChild(s);if(t){if(this.sourceBlock_.RTL)s.style.paddingLeft=this.arrowSize_+Blockly.BlockSvg.DROPDOWN_ARROW_PADDING+"px";else s.style.paddingRight=this.arrowSize_+Blockly.BlockSvg.DROPDOWN_ARROW_PADDING+"px";var g=goog.dom.createDom(goog.dom.TagName.IMG,"blocklyTextDropDownArrow");g.setAttribute("src",Blockly.mainWorkspace.options.pathToMedia+"dropdown-arrow-dark.svg");g.style.width=this.arrowSize_+"px";g.style.height=this.arrowSize_+"px";g.style.top=this.arrowY_+"px";g.style.cursor="pointer";var a="11px";if(this.sourceBlock_.RTL)g.style.left=a;else g.style.right=a;if(i)s.dropDownArrowMouseWrapper_=Blockly.bindEvent_(g,"mousedown",this,i);l.appendChild(g)}s.value=s.defaultValue=this.text_;s.oldValue_=null;this.validate_();this.resizeEditor_();if(!r){s.focus();s.select();s.setSelectionRange(0,99999)}this.bindEvents_(s,r||n);var c="box-shadow "+Blockly.FieldTextInput.ANIMATION_TIME+"s";if(Blockly.BlockSvg.FIELD_TEXTINPUT_ANIMATE_POSITIONING)l.style.transition+=",padding "+Blockly.FieldTextInput.ANIMATION_TIME+"s,"+"width "+Blockly.FieldTextInput.ANIMATION_TIME+"s,"+"height "+Blockly.FieldTextInput.ANIMATION_TIME+"s,"+"margin-left "+Blockly.FieldTextInput.ANIMATION_TIME+"s";l.style.transition=c;s.style.transition="font-size "+Blockly.FieldTextInput.ANIMATION_TIME+"s";s.style.fontSize=Blockly.BlockSvg.FIELD_TEXTINPUT_FONTSIZE_FINAL+"pt";l.style.boxShadow="0px 0px 0px 4px "+Blockly.Colours.fieldShadow};Blockly.FieldTextInput.prototype.bindEvents_=function(e,o){e.onKeyDownWrapper_=Blockly.bindEventWithChecks_(e,"keydown",this,this.onHtmlInputKeyDown_);e.onKeyUpWrapper_=Blockly.bindEventWithChecks_(e,"keyup",this,this.onHtmlInputChange_);e.onKeyPressWrapper_=Blockly.bindEventWithChecks_(e,"keypress",this,this.onHtmlInputChange_);e.onInputWrapper_=Blockly.bindEvent_(e,"input",this,this.onHtmlInputChange_);e.onWorkspaceChangeWrapper_=this.resizeEditor_.bind(this);this.workspace_.addChangeListener(e.onWorkspaceChangeWrapper_);if(o)e.onDocumentKeyDownWrapper_=Blockly.bindEventWithChecks_(document,"keydown",this,this.onDocumentKeyDown_)};Blockly.FieldTextInput.prototype.unbindEvents_=function(e){Blockly.unbindEvent_(e.onKeyDownWrapper_);Blockly.unbindEvent_(e.onKeyUpWrapper_);Blockly.unbindEvent_(e.onKeyPressWrapper_);Blockly.unbindEvent_(e.onInputWrapper_);this.workspace_.removeChangeListener(e.onWorkspaceChangeWrapper_);if(e.onDocumentKeyDownWrapper_)Blockly.unbindEvent_(e.onDocumentKeyDownWrapper_)};Blockly.FieldTextInput.prototype.onHtmlInputKeyDown_=function(e){var o=Blockly.FieldTextInput.htmlInput_;var t=9,i=13,r=27;if(e.keyCode==i){Blockly.WidgetDiv.hide();Blockly.DropDownDiv.hideWithoutAnimation()}else if(e.keyCode==r){o.value=o.defaultValue;Blockly.WidgetDiv.hide();Blockly.DropDownDiv.hideWithoutAnimation()}else if(e.keyCode==t){Blockly.WidgetDiv.hide();Blockly.DropDownDiv.hideWithoutAnimation();this.sourceBlock_.tab(this,!e.shiftKey);e.preventDefault()}};Blockly.FieldTextInput.prototype.onDocumentKeyDown_=function(e){var o=Blockly.FieldTextInput.htmlInput_;var t=e.target===o;var i="INPUT"===e.target.tagName||"TEXTAREA"===e.target.tagName;if(t||!i){o.removeAttribute("readonly");o.value="";o.focus();Blockly.unbindEvent_(o.onDocumentKeyDownWrapper_);o.onDocumentKeyDownWrapper_=null}};Blockly.FieldTextInput.GECKO_KEYCODE_WHITELIST=[97,99,118,120];Blockly.FieldTextInput.prototype.onHtmlInputChange_=function(e){if("keypress"===e.type&&this.restrictor_){var o;var t=false;if(goog.userAgent.GECKO){o=e.charCode;if(o<32||127==o)t=true;else if(e.metaKey||e.ctrlKey)t=Blockly.FieldTextInput.GECKO_KEYCODE_WHITELIST.indexOf(o)>-1}else o=e.keyCode;var i=String.fromCharCode(o);if(!t&&!this.restrictor_.test(i)&&e.preventDefault){e.preventDefault();return}}var r=Blockly.FieldTextInput.htmlInput_;var n=r.value;if(n!==r.oldValue_){r.oldValue_=n;this.setText(n);this.validate_()}else if(goog.userAgent.WEBKIT)this.sourceBlock_.render();this.resizeEditor_()};Blockly.FieldTextInput.prototype.validate_=function(){var e=true;goog.asserts.assertObject(Blockly.FieldTextInput.htmlInput_);var o=Blockly.FieldTextInput.htmlInput_;if(this.sourceBlock_)e=this.callValidator(o.value);if(null===e)Blockly.utils.addClass(o,"blocklyInvalidInput");else Blockly.utils.removeClass(o,"blocklyInvalidInput")};Blockly.FieldTextInput.prototype.resizeEditor_=function(){var e=this.sourceBlock_.workspace.scale;var o=Blockly.WidgetDiv.DIV;var t;if(this.sourceBlock_.isShadow())t=this.sourceBlock_.getHeightWidth().width*e;else t=this.size_.width*e;var i;if(Blockly.BlockSvg.FIELD_TEXTINPUT_EXPAND_PAST_TRUNCATION){var r=Blockly.scratchBlocksUtils.measureText(Blockly.FieldTextInput.htmlInput_.style.fontSize,Blockly.FieldTextInput.htmlInput_.style.fontFamily,Blockly.FieldTextInput.htmlInput_.style.fontWeight,Blockly.FieldTextInput.htmlInput_.value);r+=Blockly.FieldTextInput.TEXT_MEASURE_PADDING_MAGIC;r*=e;i=r}else i=t;i=Math.max(i,Blockly.BlockSvg.FIELD_WIDTH_MIN_EDIT*e);i=Math.min(i,Blockly.BlockSvg.FIELD_WIDTH_MAX_EDIT*e);o.style.width=i/e+1+"px";o.style.height=Blockly.BlockSvg.FIELD_HEIGHT_MAX_EDIT+1+"px";o.style.transform="scale("+e+")";o.style.marginLeft=-.5*(i-t)+"px";var n=this.getBorderRadius()+.5;o.style.borderRadius=n+"px";Blockly.FieldTextInput.htmlInput_.style.borderRadius=n+"px";var l=this.sourceBlock_.getColourTertiary();o.style.borderColor=l;var s=this.getAbsoluteXY_();s.x-=e/2;s.y-=e/2;if(this.sourceBlock_.RTL){s.x+=i;s.x-=o.offsetWidth*e;s.x+=1*e}s.y+=1*e;if(goog.userAgent.GECKO&&Blockly.WidgetDiv.DIV.style.top){s.x+=2*e;s.y+=1*e}if(goog.userAgent.WEBKIT)s.y-=1*e;o.style.left=s.x+"px";o.style.top=s.y+"px"};Blockly.FieldTextInput.prototype.getBorderRadius=function(){if(this.sourceBlock_.getOutputShape()==Blockly.OUTPUT_SHAPE_ROUND)return Blockly.BlockSvg.NUMBER_FIELD_CORNER_RADIUS;return Blockly.BlockSvg.TEXT_FIELD_CORNER_RADIUS};Blockly.FieldTextInput.prototype.widgetDispose_=function(){var e=this;return function(){var o=Blockly.WidgetDiv.DIV;var t=Blockly.FieldTextInput.htmlInput_;e.maybeSaveEdit_();e.unbindEvents_(t);if(t.dropDownArrowMouseWrapper_)Blockly.unbindEvent_(t.dropDownArrowMouseWrapper_);Blockly.Events.setGroup(false);t.style.fontSize=Blockly.BlockSvg.FIELD_TEXTINPUT_FONTSIZE_INITIAL+"pt";o.style.boxShadow="";if(e.sourceBlock_)if(e.sourceBlock_.isShadow()){var i=e.sourceBlock_.getHeightWidth();o.style.width=i.width+1+"px";o.style.height=i.height+1+"px"}else{o.style.width=e.size_.width+1+"px";o.style.height=Blockly.BlockSvg.FIELD_HEIGHT_MAX_EDIT+1+"px"}o.style.marginLeft=0}};Blockly.FieldTextInput.prototype.widgetDisposeAnimationFinished_=function(){return function(){var e=Blockly.WidgetDiv.DIV.style;e.width="auto";e.height="auto";e.fontSize="";Blockly.WidgetDiv.DIV.className="blocklyWidgetDiv";Blockly.WidgetDiv.DIV.removeAttribute("style");Blockly.FieldTextInput.htmlInput_.style.transition="";Blockly.FieldTextInput.htmlInput_=null}};Blockly.FieldTextInput.prototype.maybeSaveEdit_=function(){var e=Blockly.FieldTextInput.htmlInput_;var o=e.value;if(this.sourceBlock_){var t=this.callValidator(o);if(null===t)o=e.defaultValue;else{o=t;if(this.onFinishEditing_)this.onFinishEditing_(o)}}this.setText(o);this.sourceBlock_.rendered&&this.sourceBlock_.render()};Blockly.FieldTextInput.numberValidator=function(e){console.warn("Blockly.FieldTextInput.numberValidator is deprecated. "+"Use Blockly.FieldNumber instead.");if(null===e)return null;e=String(e);e=e.replace(/O/gi,"0");e=e.replace(/,/g,"");var o=parseFloat(e||0);return isNaN(o)?null:String(o)};Blockly.FieldTextInput.nonnegativeIntegerValidator=function(e){var o=Blockly.FieldTextInput.numberValidator(e);if(o)o=String(Math.max(0,Math.floor(o)));return o};Blockly.Field.register("field_input",Blockly.FieldTextInput);goog.provide("Blockly.FieldAngle");goog.require("Blockly.DropDownDiv");goog.require("Blockly.FieldTextInput");goog.require("goog.math");goog.require("goog.userAgent");Blockly.FieldAngle=function(e,o){this.symbol_=Blockly.utils.createSvgElement("tspan",{},null);this.symbol_.appendChild(document.createTextNode("°"));var t=new RegExp("[\\d]|[\\.]|[-]|[eE]");e=e&&!isNaN(e)?String(e):"0";Blockly.FieldAngle.superClass_.constructor.call(this,e,o,t);this.addArgType("angle")};goog.inherits(Blockly.FieldAngle,Blockly.FieldTextInput);Blockly.FieldAngle.fromJson=function(e){return new Blockly.FieldAngle(e["angle"])};Blockly.FieldAngle.ROUND=15;Blockly.FieldAngle.HALF=120/2;Blockly.FieldAngle.CLOCKWISE=true;Blockly.FieldAngle.OFFSET=90;Blockly.FieldAngle.WRAP=180;Blockly.FieldAngle.HANDLE_RADIUS=10;Blockly.FieldAngle.ARROW_WIDTH=Blockly.FieldAngle.HANDLE_RADIUS;Blockly.FieldAngle.HANDLE_GLOW_WIDTH=3;Blockly.FieldAngle.RADIUS=Blockly.FieldAngle.HALF-Blockly.FieldAngle.HANDLE_RADIUS-Blockly.FieldAngle.HANDLE_GLOW_WIDTH;Blockly.FieldAngle.CENTER_RADIUS=2;Blockly.FieldAngle.ARROW_SVG_PATH="icons/arrow.svg";Blockly.FieldAngle.prototype.dispose_=function(){var e=this;return function(){Blockly.FieldAngle.superClass_.dispose_.call(e)();e.gauge_=null;if(e.mouseDownWrapper_)Blockly.unbindEvent_(e.mouseDownWrapper_);if(e.mouseUpWrapper_)Blockly.unbindEvent_(e.mouseUpWrapper_);if(e.mouseMoveWrapper_)Blockly.unbindEvent_(e.mouseMoveWrapper_)}};Blockly.FieldAngle.prototype.showEditor_=function(){Blockly.FieldAngle.superClass_.showEditor_.call(this,this.useTouchInteraction_);Blockly.DropDownDiv.hideWithoutAnimation();Blockly.DropDownDiv.clearContent();var e=Blockly.DropDownDiv.getContentDiv();var o=Blockly.utils.createSvgElement("svg",{xmlns:"http://www.w3.org/2000/svg","xmlns:html":"http://www.w3.org/1999/xhtml","xmlns:xlink":"http://www.w3.org/1999/xlink",version:"1.1",height:2*Blockly.FieldAngle.HALF+"px",width:2*Blockly.FieldAngle.HALF+"px"},e);Blockly.utils.createSvgElement("circle",{cx:Blockly.FieldAngle.HALF,cy:Blockly.FieldAngle.HALF,r:Blockly.FieldAngle.RADIUS,class:"blocklyAngleCircle"},o);this.gauge_=Blockly.utils.createSvgElement("path",{class:"blocklyAngleGauge"},o);this.line_=Blockly.utils.createSvgElement("line",{x1:Blockly.FieldAngle.HALF,y1:Blockly.FieldAngle.HALF,class:"blocklyAngleLine"},o);var t=Math.PI*Blockly.FieldAngle.OFFSET/180;Blockly.utils.createSvgElement("line",{x1:Blockly.FieldAngle.HALF,y1:Blockly.FieldAngle.HALF,x2:Blockly.FieldAngle.HALF+Blockly.FieldAngle.RADIUS*Math.cos(t),y2:Blockly.FieldAngle.HALF-Blockly.FieldAngle.RADIUS*Math.sin(t),class:"blocklyAngleLine"},o);for(var i=0;i<360;i+=15)Blockly.utils.createSvgElement("line",{x1:Blockly.FieldAngle.HALF+Blockly.FieldAngle.RADIUS-13,y1:Blockly.FieldAngle.HALF,x2:Blockly.FieldAngle.HALF+Blockly.FieldAngle.RADIUS-7,y2:Blockly.FieldAngle.HALF,class:"blocklyAngleMarks",transform:"rotate("+i+","+Blockly.FieldAngle.HALF+","+Blockly.FieldAngle.HALF+")"},o);Blockly.utils.createSvgElement("circle",{cx:Blockly.FieldAngle.HALF,cy:Blockly.FieldAngle.HALF,r:Blockly.FieldAngle.CENTER_RADIUS,class:"blocklyAngleCenterPoint"},o);this.handle_=Blockly.utils.createSvgElement("g",{},o);Blockly.utils.createSvgElement("circle",{cx:0,cy:0,r:Blockly.FieldAngle.HANDLE_RADIUS,class:"blocklyAngleDragHandle"},this.handle_);this.arrowSvg_=Blockly.utils.createSvgElement("image",{width:Blockly.FieldAngle.ARROW_WIDTH,height:Blockly.FieldAngle.ARROW_WIDTH,x:-Blockly.FieldAngle.ARROW_WIDTH/2,y:-Blockly.FieldAngle.ARROW_WIDTH/2,class:"blocklyAngleDragArrow"},this.handle_);this.arrowSvg_.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",Blockly.mainWorkspace.options.pathToMedia+Blockly.FieldAngle.ARROW_SVG_PATH);Blockly.DropDownDiv.setColour(this.sourceBlock_.parentBlock_.getColour(),this.sourceBlock_.getColourTertiary());Blockly.DropDownDiv.setCategory(this.sourceBlock_.parentBlock_.getCategory());Blockly.DropDownDiv.showPositionedByBlock(this,this.sourceBlock_);this.mouseDownWrapper_=Blockly.bindEvent_(this.handle_,"mousedown",this,this.onMouseDown);this.updateGraph_()};Blockly.FieldAngle.prototype.onMouseDown=function(){this.mouseMoveWrapper_=Blockly.bindEvent_(document.body,"mousemove",this,this.onMouseMove);this.mouseUpWrapper_=Blockly.bindEvent_(document.body,"mouseup",this,this.onMouseUp)};Blockly.FieldAngle.prototype.onMouseUp=function(){Blockly.unbindEvent_(this.mouseMoveWrapper_);Blockly.unbindEvent_(this.mouseUpWrapper_)};Blockly.FieldAngle.prototype.onMouseMove=function(e){e.preventDefault();var o=this.gauge_.ownerSVGElement.getBoundingClientRect();var t=e.clientX-o.left-Blockly.FieldAngle.HALF;var i=e.clientY-o.top-Blockly.FieldAngle.HALF;var r=Math.atan(-i/t);if(isNaN(r))return;r=goog.math.toDegrees(r);if(t<0)r+=180;else if(i>0)r+=360;if(Blockly.FieldAngle.CLOCKWISE)r=Blockly.FieldAngle.OFFSET+360-r;else r-=Blockly.FieldAngle.OFFSET;if(Blockly.FieldAngle.ROUND)r=Math.round(r/Blockly.FieldAngle.ROUND)*Blockly.FieldAngle.ROUND;r=this.callValidator(r);Blockly.FieldTextInput.htmlInput_.value=r;this.setValue(r);this.validate_();this.resizeEditor_()};Blockly.FieldAngle.prototype.setText=function(e){Blockly.FieldAngle.superClass_.setText.call(this,e);if(!this.textElement_)return;this.updateGraph_();this.size_.width=0};Blockly.FieldAngle.prototype.updateGraph_=function(){if(!this.gauge_)return;var e=Number(this.getText())%360+Blockly.FieldAngle.OFFSET;var o=goog.math.toRadians(e);var t=["M ",Blockly.FieldAngle.HALF,",",Blockly.FieldAngle.HALF];var i=Blockly.FieldAngle.HALF;var r=Blockly.FieldAngle.HALF;if(!isNaN(o)){var n=goog.math.toRadians(Blockly.FieldAngle.OFFSET);var l=Math.cos(n)*Blockly.FieldAngle.RADIUS;var s=Math.sin(n)*-Blockly.FieldAngle.RADIUS;if(Blockly.FieldAngle.CLOCKWISE)o=2*n-o;i+=Math.cos(o)*Blockly.FieldAngle.RADIUS;r-=Math.sin(o)*Blockly.FieldAngle.RADIUS;var g=Math.abs(e-Blockly.FieldAngle.OFFSET)>180?1:0;var a=Number(Blockly.FieldAngle.CLOCKWISE);if(e<Blockly.FieldAngle.OFFSET)a=1-a;t.push(" l ",l,",",s," A ",Blockly.FieldAngle.RADIUS,",",Blockly.FieldAngle.RADIUS," 0 ",g," ",a," ",i,",",r," z");if(Blockly.FieldAngle.CLOCKWISE)var c=e+2*Blockly.FieldAngle.OFFSET;else var c=-e;this.arrowSvg_.setAttribute("transform","rotate("+c+")")}this.gauge_.setAttribute("d",t.join(""));this.line_.setAttribute("x2",i);this.line_.setAttribute("y2",r);this.handle_.setAttribute("transform","translate("+i+","+r+")")};Blockly.FieldAngle.prototype.classValidator=function(e){if(null===e)return null;var o=parseFloat(e||0);if(isNaN(o))return null;o%=360;if(o<0)o+=360;if(o>Blockly.FieldAngle.WRAP)o-=360;return String(o)};Blockly.Field.register("field_angle",Blockly.FieldAngle);goog.provide("Blockly.FieldCheckbox");goog.require("Blockly.Field");Blockly.FieldCheckbox=function(e,o){Blockly.FieldCheckbox.superClass_.constructor.call(this,"",o);this.setValue(e);this.addArgType("checkbox")};goog.inherits(Blockly.FieldCheckbox,Blockly.Field);Blockly.FieldCheckbox.fromJson=function(e){return new Blockly.FieldCheckbox(e["checked"]?"TRUE":"FALSE")};Blockly.FieldCheckbox.CHECK_CHAR="✓";Blockly.FieldCheckbox.prototype.CURSOR="default";Blockly.FieldCheckbox.prototype.init=function(){if(this.fieldGroup_)return;Blockly.FieldCheckbox.superClass_.init.call(this);this.checkElement_=Blockly.utils.createSvgElement("text",{class:"blocklyText blocklyCheckbox",x:-3,y:14},this.fieldGroup_);var e=document.createTextNode(Blockly.FieldCheckbox.CHECK_CHAR);this.checkElement_.appendChild(e);this.checkElement_.style.display=this.state_?"block":"none"};Blockly.FieldCheckbox.prototype.getValue=function(){return String(this.state_).toUpperCase()};Blockly.FieldCheckbox.prototype.setValue=function(e){var o="string"==typeof e?"TRUE"==e.toUpperCase():!!e;if(this.state_!==o){if(this.sourceBlock_&&Blockly.Events.isEnabled())Blockly.Events.fire(new Blockly.Events.BlockChange(this.sourceBlock_,"field",this.name,this.state_,o));this.state_=o;if(this.checkElement_)this.checkElement_.style.display=o?"block":"none"}};Blockly.FieldCheckbox.prototype.showEditor_=function(){var e=!this.state_;if(this.sourceBlock_)e=this.callValidator(e);if(null!==e)this.setValue(String(e).toUpperCase())};Blockly.Field.register("field_checkbox",Blockly.FieldCheckbox);goog.provide("Blockly.FieldColour");goog.require("Blockly.Field");goog.require("Blockly.utils");goog.require("goog.dom");goog.require("goog.events");goog.require("goog.style");goog.require("goog.ui.ColorPicker");Blockly.FieldColour=function(e,o){Blockly.FieldColour.superClass_.constructor.call(this,e,o);this.addArgType("colour")};goog.inherits(Blockly.FieldColour,Blockly.Field);Blockly.FieldColour.fromJson=function(e){return new Blockly.FieldColour(e["colour"])};Blockly.FieldColour.prototype.colours_=null;Blockly.FieldColour.prototype.columns_=0;Blockly.FieldColour.prototype.init=function(e){if(this.fieldGroup_)return;Blockly.FieldColour.superClass_.init.call(this,e);this.setValue(this.getValue())};Blockly.FieldColour.prototype.CURSOR="default";Blockly.FieldColour.prototype.dispose=function(){Blockly.WidgetDiv.hideIfOwner(this);Blockly.FieldColour.superClass_.dispose.call(this)};Blockly.FieldColour.prototype.getValue=function(){return this.colour_};Blockly.FieldColour.prototype.setValue=function(e){if(this.sourceBlock_&&Blockly.Events.isEnabled()&&this.colour_!=e)Blockly.Events.fire(new Blockly.Events.BlockChange(this.sourceBlock_,"field",this.name,this.colour_,e));this.colour_=e;if(this.sourceBlock_)this.sourceBlock_.setColour(e,e,e)};Blockly.FieldColour.prototype.getText=function(){var e=this.colour_;var o=e.match(/^#(.)\1(.)\2(.)\3$/);if(o)e="#"+o[1]+o[2]+o[3];return e};Blockly.FieldColour.prototype.getSize=function(){return new goog.math.Size(Blockly.BlockSvg.FIELD_WIDTH,Blockly.BlockSvg.FIELD_HEIGHT)};Blockly.FieldColour.COLOURS=goog.ui.ColorPicker.SIMPLE_GRID_COLORS;Blockly.FieldColour.COLUMNS=7;Blockly.FieldColour.prototype.setColours=function(e){this.colours_=e;return this};Blockly.FieldColour.prototype.setColumns=function(e){this.columns_=e;return this};Blockly.FieldColour.prototype.showEditor_=function(){Blockly.WidgetDiv.show(this,this.sourceBlock_.RTL,Blockly.FieldColour.widgetDispose_);var e=Blockly.utils.getViewportBBox();var o=this.getScaledBBox_();var t=this.createWidget_();var i=goog.style.getSize(t.getElement());Blockly.WidgetDiv.positionWithAnchor(e,o,i,this.sourceBlock_.RTL);var r=this;Blockly.FieldColour.changeEventKey_=goog.events.listen(t,goog.ui.ColorPicker.EventType.CHANGE,(function(e){var o=e.target.getSelectedColor()||"#000000";Blockly.WidgetDiv.hide();if(r.sourceBlock_)o=r.callValidator(o);if(null!==o)r.setValue(o)}))};Blockly.FieldColour.prototype.createWidget_=function(){var e=new goog.ui.ColorPicker;e.setSize(this.columns_||Blockly.FieldColour.COLUMNS);e.setColors(this.colours_||Blockly.FieldColour.COLOURS);var o=Blockly.WidgetDiv.DIV;e.render(o);e.setSelectedColor(this.getValue());return e};Blockly.FieldColour.widgetDispose_=function(){if(Blockly.FieldColour.changeEventKey_)goog.events.unlistenByKey(Blockly.FieldColour.changeEventKey_);Blockly.Events.setGroup(false)};Blockly.Field.register("field_colour",Blockly.FieldColour);goog.provide("Blockly.FieldColourSlider");goog.require("Blockly.Field");goog.require("Blockly.DropDownDiv");goog.require("goog.dom");goog.require("goog.events");goog.require("goog.style");goog.require("goog.color");goog.require("goog.ui.Slider");Blockly.FieldColourSlider=function(e,o){Blockly.FieldColourSlider.superClass_.constructor.call(this,e,o);this.addArgType("colour");this.sliderCallbacksEnabled_=false};goog.inherits(Blockly.FieldColourSlider,Blockly.Field);Blockly.FieldColourSlider.fromJson=function(e){return new Blockly.FieldColourSlider(e["colour"])};Blockly.FieldColourSlider.activateEyedropper_=null;Blockly.FieldColourSlider.EYEDROPPER_PATH="eyedropper.svg";Blockly.FieldColourSlider.prototype.init=function(e){if(this.fieldGroup_)return;Blockly.FieldColourSlider.superClass_.init.call(this,e);this.setValue(this.getValue())};Blockly.FieldColourSlider.prototype.getValue=function(){return this.colour_};Blockly.FieldColourSlider.prototype.setValue=function(e){if(this.sourceBlock_&&Blockly.Events.isEnabled()&&this.colour_!=e)Blockly.Events.fire(new Blockly.Events.BlockChange(this.sourceBlock_,"field",this.name,this.colour_,e));this.colour_=e;if(this.sourceBlock_)this.sourceBlock_.setColour(e,e,this.sourceBlock_.getColourTertiary());this.updateSliderHandles_();this.updateDom_()};Blockly.FieldColourSlider.prototype.createColourStops_=function(e){var o=[];for(var t=0;t<=360;t+=20)switch(e){case"hue":o.push(goog.color.hsvToHex(t,this.saturation_,this.brightness_));break;case"saturation":o.push(goog.color.hsvToHex(this.hue_,t/360,this.brightness_));break;case"brightness":o.push(goog.color.hsvToHex(this.hue_,this.saturation_,255*t/360));break;default:throw new Error("Unknown channel for colour sliders: "+e)}return o};Blockly.FieldColourSlider.prototype.setGradient_=function(e,o){var t=this.createColourStops_(o).join(",");goog.style.setStyle(e,"background","-moz-linear-gradient(left, "+t+")");goog.style.setStyle(e,"background","-webkit-linear-gradient(left, "+t+")");goog.style.setStyle(e,"background","-o-linear-gradient(left, "+t+")");goog.style.setStyle(e,"background","-ms-linear-gradient(left, "+t+")");goog.style.setStyle(e,"background","linear-gradient(left, "+t+")")};Blockly.FieldColourSlider.prototype.updateDom_=function(){if(this.hueSlider_){this.setGradient_(this.hueSlider_.getElement(),"hue");this.setGradient_(this.saturationSlider_.getElement(),"saturation");this.setGradient_(this.brightnessSlider_.getElement(),"brightness");this.hueReadout_.textContent=Math.floor(100*this.hue_/360).toFixed(0);this.saturationReadout_.textContent=Math.floor(100*this.saturation_).toFixed(0);this.brightnessReadout_.textContent=Math.floor(100*this.brightness_/255).toFixed(0)}};Blockly.FieldColourSlider.prototype.updateSliderHandles_=function(){if(this.hueSlider_){this.sliderCallbacksEnabled_=false;this.hueSlider_.setValue(this.hue_);this.saturationSlider_.setValue(this.saturation_);this.brightnessSlider_.setValue(this.brightness_);this.sliderCallbacksEnabled_=true}};Blockly.FieldColourSlider.prototype.getText=function(){var e=this.colour_;var o=e.match(/^#(.)\1(.)\2(.)\3$/);if(o)e="#"+o[1]+o[2]+o[3];return e};Blockly.FieldColourSlider.prototype.createLabelDom_=function(e){var o=document.createElement("div");o.setAttribute("class","scratchColourPickerLabel");var t=document.createElement("span");t.setAttribute("class","scratchColourPickerReadout");var i=document.createElement("span");i.setAttribute("class","scratchColourPickerLabelText");i.textContent=e;o.appendChild(i);o.appendChild(t);return[o,t]};Blockly.FieldColourSlider.prototype.sliderCallbackFactory_=function(e){var o=this;return function(t){if(!o.sliderCallbacksEnabled_)return;var i=t.target.getValue();var r=goog.color.hexToHsv(o.getValue());switch(e){case"hue":r[0]=o.hue_=i;break;case"saturation":r[1]=o.saturation_=i;break;case"brightness":r[2]=o.brightness_=i;break}var n=goog.color.hsvToHex(r[0],r[1],r[2]);if(o.sourceBlock_)n=o.callValidator(n);if(null!==n)o.setValue(n,true)}};Blockly.FieldColourSlider.prototype.activateEyedropperInternal_=function(){var e=this;Blockly.FieldColourSlider.activateEyedropper_((function(o){var t=goog.color.hexToHsv(o);e.hue_=t[0];e.saturation_=t[1];e.brightness_=t[2];e.setValue(o)}))};Blockly.FieldColourSlider.prototype.showEditor_=function(){Blockly.DropDownDiv.hideWithoutAnimation();Blockly.DropDownDiv.clearContent();var e=Blockly.DropDownDiv.getContentDiv();var o=goog.color.hexToHsv(this.getValue());this.hue_=o[0];this.saturation_=o[1];this.brightness_=o[2];var t=this.createLabelDom_(Blockly.Msg.COLOUR_HUE_LABEL);e.appendChild(t[0]);this.hueReadout_=t[1];this.hueSlider_=new goog.ui.Slider;this.hueSlider_.setUnitIncrement(5);this.hueSlider_.setMinimum(0);this.hueSlider_.setMaximum(360);this.hueSlider_.setMoveToPointEnabled(true);this.hueSlider_.render(e);var i=this.createLabelDom_(Blockly.Msg.COLOUR_SATURATION_LABEL);e.appendChild(i[0]);this.saturationReadout_=i[1];this.saturationSlider_=new goog.ui.Slider;this.saturationSlider_.setMoveToPointEnabled(true);this.saturationSlider_.setUnitIncrement(.01);this.saturationSlider_.setStep(.001);this.saturationSlider_.setMinimum(0);this.saturationSlider_.setMaximum(1);this.saturationSlider_.render(e);var r=this.createLabelDom_(Blockly.Msg.COLOUR_BRIGHTNESS_LABEL);e.appendChild(r[0]);this.brightnessReadout_=r[1];this.brightnessSlider_=new goog.ui.Slider;this.brightnessSlider_.setUnitIncrement(2);this.brightnessSlider_.setMinimum(0);this.brightnessSlider_.setMaximum(255);this.brightnessSlider_.setMoveToPointEnabled(true);this.brightnessSlider_.render(e);if(Blockly.FieldColourSlider.activateEyedropper_){var n=document.createElement("button");n.setAttribute("class","scratchEyedropper");var l=document.createElement("img");l.src=Blockly.mainWorkspace.options.pathToMedia+Blockly.FieldColourSlider.EYEDROPPER_PATH;n.appendChild(l);e.appendChild(n);Blockly.FieldColourSlider.eyedropperEventData_=Blockly.bindEventWithChecks_(n,"click",this,this.activateEyedropperInternal_)}Blockly.DropDownDiv.setColour("#ffffff","#dddddd");Blockly.DropDownDiv.setCategory(this.sourceBlock_.parentBlock_.getCategory());Blockly.DropDownDiv.showPositionedByBlock(this,this.sourceBlock_);this.setValue(this.getValue());this.sliderCallbacksEnabled_=true;Blockly.FieldColourSlider.hueChangeEventKey_=goog.events.listen(this.hueSlider_,goog.ui.Component.EventType.CHANGE,this.sliderCallbackFactory_("hue"));Blockly.FieldColourSlider.saturationChangeEventKey_=goog.events.listen(this.saturationSlider_,goog.ui.Component.EventType.CHANGE,this.sliderCallbackFactory_("saturation"));Blockly.FieldColourSlider.brightnessChangeEventKey_=goog.events.listen(this.brightnessSlider_,goog.ui.Component.EventType.CHANGE,this.sliderCallbackFactory_("brightness"))};Blockly.FieldColourSlider.prototype.dispose=function(){if(Blockly.FieldColourSlider.hueChangeEventKey_)goog.events.unlistenByKey(Blockly.FieldColourSlider.hueChangeEventKey_);if(Blockly.FieldColourSlider.saturationChangeEventKey_)goog.events.unlistenByKey(Blockly.FieldColourSlider.saturationChangeEventKey_);if(Blockly.FieldColourSlider.brightnessChangeEventKey_)goog.events.unlistenByKey(Blockly.FieldColourSlider.brightnessChangeEventKey_);if(Blockly.FieldColourSlider.eyedropperEventData_)Blockly.unbindEvent_(Blockly.FieldColourSlider.eyedropperEventData_);Blockly.Events.setGroup(false);Blockly.FieldColourSlider.superClass_.dispose.call(this)};Blockly.Field.register("field_colour_slider",Blockly.FieldColourSlider);goog.provide("Blockly.FieldDate");goog.require("Blockly.Field");goog.require("Blockly.utils");goog.require("goog.date");goog.require("goog.date.DateTime");goog.require("goog.dom");goog.require("goog.events");goog.require("goog.i18n.DateTimeSymbols");goog.require("goog.i18n.DateTimeSymbols_he");goog.require("goog.style");goog.require("goog.ui.DatePicker");Blockly.FieldDate=function(e,o){if(!e)e=(new goog.date.Date).toIsoString(true);Blockly.FieldDate.superClass_.constructor.call(this,e,o);this.setValue(e);this.addArgType("date")};goog.inherits(Blockly.FieldDate,Blockly.Field);Blockly.FieldDate.fromJson=function(e){return new Blockly.FieldDate(e["date"])};Blockly.FieldDate.prototype.CURSOR="text";Blockly.FieldDate.prototype.dispose=function(){Blockly.WidgetDiv.hideIfOwner(this);Blockly.FieldDate.superClass_.dispose.call(this)};Blockly.FieldDate.prototype.getValue=function(){return this.date_};Blockly.FieldDate.prototype.setValue=function(e){if(this.sourceBlock_){var o=this.callValidator(e);if(null!==o)e=o}this.date_=e;Blockly.Field.prototype.setText.call(this,e)};Blockly.FieldDate.prototype.showEditor_=function(){Blockly.WidgetDiv.show(this,this.sourceBlock_.RTL,Blockly.FieldDate.widgetDispose_);var e=Blockly.utils.getViewportBBox();var o=this.getScaledBBox_();var t=this.createWidget_();var i=goog.style.getSize(t.getElement());Blockly.WidgetDiv.positionWithAnchor(e,o,i,this.sourceBlock_.RTL);var r=this;Blockly.FieldDate.changeEventKey_=goog.events.listen(t,goog.ui.DatePicker.Events.CHANGE,(function(e){var o=e.date?e.date.toIsoString(true):"";Blockly.WidgetDiv.hide();if(r.sourceBlock_)o=r.callValidator(o);r.setValue(o)}))};Blockly.FieldDate.prototype.createWidget_=function(){Blockly.FieldDate.loadLanguage_();var e=new goog.ui.DatePicker;e.setAllowNone(false);e.setShowWeekNum(false);var o=Blockly.WidgetDiv.DIV;e.render(o);e.setDate(goog.date.DateTime.fromIsoString(this.getValue()));return e};Blockly.FieldDate.widgetDispose_=function(){if(Blockly.FieldDate.changeEventKey_)goog.events.unlistenByKey(Blockly.FieldDate.changeEventKey_);Blockly.Events.setGroup(false)};Blockly.FieldDate.loadLanguage_=function(){var e=/^DateTimeSymbols_(.+)$/;for(var o in goog.i18n){var t=o.match(e);if(t){var i=t[1].toLowerCase().replace("_",".");if(goog.getObjectByName(i,Blockly.Msg))goog.i18n.DateTimeSymbols=goog.i18n[o]}}};Blockly.FieldDate.CSS=[".blocklyWidgetDiv .goog-date-picker,",".blocklyWidgetDiv .goog-date-picker th,",".blocklyWidgetDiv .goog-date-picker td {","  font: 13px Arial, sans-serif;","}",".blocklyWidgetDiv .goog-date-picker {","  -moz-user-focus: normal;","  -moz-user-select: none;","  position: relative;","  border: 1px solid #000;","  float: left;","  padding: 2px;","  color: #000;","  background: #c3d9ff;","  cursor: default;","}",".blocklyWidgetDiv .goog-date-picker th {","  text-align: center;","}",".blocklyWidgetDiv .goog-date-picker td {","  text-align: center;","  vertical-align: middle;","  padding: 1px 3px;","}",".blocklyWidgetDiv .goog-date-picker-menu {","  position: absolute;","  background: threedface;","  border: 1px solid gray;","  -moz-user-focus: normal;","  z-index: 1;","  outline: none;","}",".blocklyWidgetDiv .goog-date-picker-menu ul {","  list-style: none;","  margin: 0px;","  padding: 0px;","}",".blocklyWidgetDiv .goog-date-picker-menu ul li {","  cursor: default;","}",".blocklyWidgetDiv .goog-date-picker-menu-selected {","  background: #ccf;","}",".blocklyWidgetDiv .goog-date-picker th {","  font-size: .9em;","}",".blocklyWidgetDiv .goog-date-picker td div {","  float: left;","}",".blocklyWidgetDiv .goog-date-picker button {","  padding: 0px;","  margin: 1px 0;","  border: 0;","  color: #20c;","  font-weight: bold;","  background: transparent;","}",".blocklyWidgetDiv .goog-date-picker-date {","  background: #fff;","}",".blocklyWidgetDiv .goog-date-picker-week,",".blocklyWidgetDiv .goog-date-picker-wday {","  padding: 1px 3px;","  border: 0;","  border-color: #a2bbdd;","  border-style: solid;","}",".blocklyWidgetDiv .goog-date-picker-week {","  border-right-width: 1px;","}",".blocklyWidgetDiv .goog-date-picker-wday {","  border-bottom-width: 1px;","}",".blocklyWidgetDiv .goog-date-picker-head td {","  text-align: center;","}",".blocklyWidgetDiv td.goog-date-picker-today-cont {","  text-align: center;","}",".blocklyWidgetDiv td.goog-date-picker-none-cont {","  text-align: center;","}",".blocklyWidgetDiv .goog-date-picker-month {","  min-width: 11ex;","  white-space: nowrap;","}",".blocklyWidgetDiv .goog-date-picker-year {","  min-width: 6ex;","  white-space: nowrap;","}",".blocklyWidgetDiv .goog-date-picker-monthyear {","  white-space: nowrap;","}",".blocklyWidgetDiv .goog-date-picker table {","  border-collapse: collapse;","}",".blocklyWidgetDiv .goog-date-picker-other-month {","  color: #888;","}",".blocklyWidgetDiv .goog-date-picker-wkend-start,",".blocklyWidgetDiv .goog-date-picker-wkend-end {","  background: #eee;","}",".blocklyWidgetDiv td.goog-date-picker-selected {","  background: #c3d9ff;","}",".blocklyWidgetDiv .goog-date-picker-today {","  background: #9ab;","  font-weight: bold !important;","  border-color: #246 #9bd #9bd #246;","  color: #fff;","}"];Blockly.Field.register("field_date",Blockly.FieldDate);goog.provide("Blockly.FieldDropdown");goog.require("Blockly.Field");goog.require("Blockly.DropDownDiv");goog.require("goog.dom");goog.require("goog.events");goog.require("goog.style");goog.require("goog.ui.Menu");goog.require("goog.ui.MenuItem");goog.require("goog.userAgent");Blockly.FieldDropdown=function(e,o){this.menuGenerator_=e;this.trimOptions_();var t=this.getOptions()[0];Blockly.FieldDropdown.superClass_.constructor.call(this,t[1],o);this.addArgType("dropdown")};goog.inherits(Blockly.FieldDropdown,Blockly.Field);Blockly.FieldDropdown.fromJson=function(e){return new Blockly.FieldDropdown(e["options"])};Blockly.FieldDropdown.CHECKMARK_OVERHANG=25;Blockly.FieldDropdown.prototype.CURSOR="default";Blockly.FieldDropdown.prototype.selectedItem=null;Blockly.FieldDropdown.prototype.value_="";Blockly.FieldDropdown.prototype.imageElement_=null;Blockly.FieldDropdown.prototype.imageJson_=null;Blockly.FieldDropdown.prototype.init=function(){if(this.fieldGroup_)return;this.arrowSize_=12;this.arrowX_=0;this.arrowY_=11;this.arrow_=Blockly.utils.createSvgElement("image",{height:this.arrowSize_+"px",width:this.arrowSize_+"px"});this.arrow_.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",Blockly.mainWorkspace.options.pathToMedia+"dropdown-arrow.svg");this.className_+=" blocklyDropdownText";Blockly.FieldDropdown.superClass_.init.call(this);if(!this.sourceBlock_.isShadow()){this.box_=Blockly.utils.createSvgElement("rect",{rx:Blockly.BlockSvg.CORNER_RADIUS,ry:Blockly.BlockSvg.CORNER_RADIUS,x:0,y:0,width:this.size_.width,height:this.size_.height,stroke:this.sourceBlock_.getColourTertiary(),fill:this.sourceBlock_.getColour(),class:"blocklyBlockBackground","fill-opacity":1},null);this.fieldGroup_.insertBefore(this.box_,this.textElement_)}var e=this.text_;this.text_=null;this.setText(e)};Blockly.FieldDropdown.prototype.showEditor_=function(){var e=this.getOptions();if(0==e.length)return;this.dropDownOpen_=true;Blockly.DropDownDiv.hideWithoutAnimation();Blockly.DropDownDiv.clearContent();var o=Blockly.DropDownDiv.getContentDiv();var t=this;function i(e){var o=this;var i=e.target;if(i)t.onItemSelected(o,i);Blockly.DropDownDiv.hide();Blockly.Events.setGroup(false)}var r=new goog.ui.Menu;r.setRightToLeft(this.sourceBlock_.RTL);for(var n=0;n<e.length;n++){var l=e[n][0];var s=e[n][1];if("object"==typeof l){var g=new Image(l["width"],l["height"]);g.src=l["src"];g.alt=l["alt"]||"";l=g}var a=new goog.ui.MenuItem(l);a.setRightToLeft(this.sourceBlock_.RTL);a.setValue(s);a.setCheckable(true);r.addChild(a,true);var c=s==this.value_;a.setChecked(c);if(c)this.selectedItem=a}goog.events.listen(r,goog.ui.Component.EventType.ACTION,i);r.render(o);var u=r.getElement();Blockly.utils.addClass(u,"blocklyDropdownMenu");var h=goog.style.getSize(u);h.height=u.scrollHeight;var d=this.sourceBlock_.isShadow()?this.sourceBlock_.parentBlock_.getColour():this.sourceBlock_.getColour();Blockly.DropDownDiv.setColour(d,this.sourceBlock_.getColourTertiary());var p=this.sourceBlock_.isShadow()?this.sourceBlock_.parentBlock_.getCategory():this.sourceBlock_.getCategory();Blockly.DropDownDiv.setCategory(p);var y=this.sourceBlock_.workspace.scale;var f={width:this.size_.width,height:this.size_.height};f.width*=y;f.height*=y;var m=this.fieldGroup_.getBoundingClientRect();var _=m.left+f.width/2;var v=m.top+f.height;var k=_;var B=m.top;Blockly.DropDownDiv.setBoundsElement(this.sourceBlock_.workspace.getParentSvg().parentNode);Blockly.DropDownDiv.show(this,_,v,k,B,this.onHide.bind(this));r.setAllowAutoFocus(true);u.focus();if(!this.disableColourChange_)if(this.sourceBlock_.isShadow())this.sourceBlock_.setShadowColour(this.sourceBlock_.getColourTertiary());else if(this.box_)this.box_.setAttribute("fill",this.sourceBlock_.getColourTertiary())};Blockly.FieldDropdown.prototype.onHide=function(){this.dropDownOpen_=false;if(!this.disableColourChange_&&this.sourceBlock_)if(this.sourceBlock_.isShadow())this.sourceBlock_.clearShadowColour();else if(this.box_)this.box_.setAttribute("fill",this.sourceBlock_.getColour())};Blockly.FieldDropdown.prototype.onItemSelected=function(e,o){var t=o.getValue();if(this.sourceBlock_)t=this.callValidator(t);if("function"==typeof t){t();return}if(null!==t)this.setValue(t)};Blockly.FieldDropdown.prototype.trimOptions_=function(){this.prefixField=null;this.suffixField=null;var e=this.menuGenerator_;if(!goog.isArray(e))return;var o=false;for(var t=0;t<e.length;t++){var i=e[t][0];if("string"==typeof i)e[t][0]=Blockly.utils.replaceMessageReferences(i);else{if(null!=i.alt)e[t][0].alt=Blockly.utils.replaceMessageReferences(i.alt);o=true}}if(o||e.length<2)return;var r=[];for(var t=0;t<e.length;t++)r.push(e[t][0]);var n=Blockly.utils.shortestStringLength(r);var l=Blockly.utils.commonWordPrefix(r,n);var s=Blockly.utils.commonWordSuffix(r,n);if(!l&&!s)return;if(n<=l+s)return;if(l)this.prefixField=r[0].substring(0,l-1);if(s)this.suffixField=r[0].substr(1-s);var g=[];for(var t=0;t<e.length;t++){var a=e[t][0];var c=e[t][1];a=a.substring(l,a.length-s);g[t]=[a,c]}this.menuGenerator_=g};Blockly.FieldDropdown.prototype.isOptionListDynamic=function(){return goog.isFunction(this.menuGenerator_)};Blockly.FieldDropdown.prototype.getOptions=function(){if(goog.isFunction(this.menuGenerator_))return this.menuGenerator_.call(this);return this.menuGenerator_};Blockly.FieldDropdown.prototype.getValue=function(){return this.value_};Blockly.FieldDropdown.prototype.setValue=function(e){if(null===e||e===this.value_)return;if(this.sourceBlock_&&Blockly.Events.isEnabled())Blockly.Events.fire(new Blockly.Events.BlockChange(this.sourceBlock_,"field",this.name,this.value_,e));if(this.selectedItem){this.selectedItem.setChecked(false);this.selectedItem=null}this.value_=e;var o=this.getOptions();for(var t=0;t<o.length;t++)if(o[t][1]==e){var i=o[t][0];if("object"==typeof i){this.imageJson_=i;this.text_=i.alt}else{this.imageJson_=null;this.text_=i}this.forceRerender();return}this.text_=e;this.forceRerender()};Blockly.FieldDropdown.prototype.setText=function(e){if(null===e||e===this.text_)return;this.text_=e;this.updateTextNode_();if(this.textElement_)this.textElement_.parentNode.appendChild(this.arrow_);if(this.sourceBlock_&&this.sourceBlock_.rendered){this.sourceBlock_.render();this.sourceBlock_.bumpNeighbours_()}};Blockly.FieldDropdown.prototype.positionArrow=function(e){if(!this.arrow_)return 0;var o=0;if(this.sourceBlock_.RTL){this.arrowX_=this.arrowSize_-Blockly.BlockSvg.DROPDOWN_ARROW_PADDING;o=this.arrowSize_+Blockly.BlockSvg.DROPDOWN_ARROW_PADDING}else{this.arrowX_=e+Blockly.BlockSvg.DROPDOWN_ARROW_PADDING/2;o=this.arrowSize_+Blockly.BlockSvg.DROPDOWN_ARROW_PADDING}if(this.box_)this.arrowX_+=Blockly.BlockSvg.BOX_FIELD_PADDING;this.arrow_.setAttribute("transform","translate("+this.arrowX_+","+this.arrowY_+")");return o};Blockly.FieldDropdown.prototype.dispose=function(){this.selectedItem=null;Blockly.WidgetDiv.hideIfOwner(this);Blockly.FieldDropdown.superClass_.dispose.call(this)};Blockly.Field.register("field_dropdown",Blockly.FieldDropdown);goog.provide("Blockly.FieldIconMenu");goog.require("Blockly.DropDownDiv");Blockly.FieldIconMenu=function(e){this.icons_=e;var o=e[0].value;Blockly.FieldIconMenu.superClass_.constructor.call(this,o);this.addArgType("iconmenu")};goog.inherits(Blockly.FieldIconMenu,Blockly.Field);Blockly.FieldIconMenu.fromJson=function(e){return new Blockly.FieldIconMenu(e["options"])};Blockly.FieldIconMenu.DROPDOWN_WIDTH=168;Blockly.FieldIconMenu.savedPrimary_=null;Blockly.FieldIconMenu.prototype.init=function(e){if(this.fieldGroup_)return;var o=12;this.arrowX_=18;this.arrowY_=10;if(e.RTL)this.arrowX_=-this.arrowX_-o;this.arrowIcon_=Blockly.utils.createSvgElement("image",{height:o+"px",width:o+"px",transform:"translate("+this.arrowX_+","+this.arrowY_+")"});this.arrowIcon_.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",Blockly.mainWorkspace.options.pathToMedia+"dropdown-arrow.svg");e.getSvgRoot().appendChild(this.arrowIcon_);Blockly.FieldIconMenu.superClass_.init.call(this,e)};Blockly.FieldIconMenu.prototype.CURSOR="default";Blockly.FieldIconMenu.prototype.setValue=function(e){if(null===e||e===this.value_)return;if(this.sourceBlock_&&Blockly.Events.isEnabled())Blockly.Events.fire(new Blockly.Events.Change(this.sourceBlock_,"field",this.name,this.value_,e));this.value_=e;this.setParentFieldImage(this.getSrcForValue(this.value_))};Blockly.FieldIconMenu.prototype.setParentFieldImage=function(e){if(this.sourceBlock_&&this.sourceBlock_.parentBlock_){var o=this.sourceBlock_.parentBlock_;for(var t=0,i;i=o.inputList[t];t++)for(var r=0,n;n=i.fieldRow[r];r++)if(n instanceof Blockly.FieldImage){n.setValue(e);return}}};Blockly.FieldIconMenu.prototype.getValue=function(){return this.value_};Blockly.FieldIconMenu.prototype.getSrcForValue=function(e){for(var o=0,t;t=this.icons_[o];o++)if(t.value===e)return t.src};Blockly.FieldIconMenu.prototype.showEditor_=function(){if(Blockly.DropDownDiv.hideIfOwner(this))return;Blockly.DropDownDiv.hideWithoutAnimation();Blockly.DropDownDiv.clearContent();var e=Blockly.DropDownDiv.getContentDiv();e.setAttribute("role","menu");e.setAttribute("aria-haspopup","true");for(var o=0,t;t=this.icons_[o];o++){if("placeholder"==t.type){var i=document.createElement("span");i.setAttribute("class","blocklyDropDownPlaceholder");i.style.width=t.width+"px";i.style.height=t.height+"px";e.appendChild(i);continue}var r=document.createElement("button");r.setAttribute("id",":"+o);r.setAttribute("role","menuitem");r.setAttribute("class","blocklyDropDownButton");r.title=t.alt;r.style.width=t.width+"px";r.style.height=t.height+"px";var n=this.sourceBlock_.getColour();if(t.value==this.getValue()){n=this.sourceBlock_.getColourTertiary();r.setAttribute("aria-selected","true")}r.style.backgroundColor=n;r.style.borderColor=this.sourceBlock_.getColourTertiary();Blockly.bindEvent_(r,"click",this,this.buttonClick_);Blockly.bindEvent_(r,"mouseup",this,this.buttonClick_);Blockly.bindEvent_(r,"mousedown",r,(function(e){this.setAttribute("class","blocklyDropDownButton blocklyDropDownButtonHover");e.preventDefault()}));Blockly.bindEvent_(r,"mouseover",r,(function(){this.setAttribute("class","blocklyDropDownButton blocklyDropDownButtonHover");e.setAttribute("aria-activedescendant",this.id)}));Blockly.bindEvent_(r,"mouseout",r,(function(){this.setAttribute("class","blocklyDropDownButton");e.removeAttribute("aria-activedescendant")}));var l=document.createElement("img");l.src=t.src;r.setAttribute("data-value",t.value);l.setAttribute("data-value",t.value);r.appendChild(l);e.appendChild(r)}e.style.width=Blockly.FieldIconMenu.DROPDOWN_WIDTH+"px";Blockly.DropDownDiv.setColour(this.sourceBlock_.getColour(),this.sourceBlock_.getColourTertiary());Blockly.DropDownDiv.setCategory(this.sourceBlock_.parentBlock_.getCategory());this.savedPrimary_=this.sourceBlock_.getColour();this.sourceBlock_.setColour(this.sourceBlock_.getColourSecondary(),this.sourceBlock_.getColourSecondary(),this.sourceBlock_.getColourTertiary());var s=this.sourceBlock_.workspace.scale;var g=-Blockly.BlockSvg.MIN_BLOCK_Y*s-Blockly.BlockSvg.FIELD_Y_OFFSET*s;var a=Blockly.DropDownDiv.showPositionedByBlock(this,this.sourceBlock_,this.onHide_.bind(this),g);if(!a){var c=this.arrowX_+Blockly.DropDownDiv.ARROW_SIZE/1.5+1;var u=this.arrowY_+Blockly.DropDownDiv.ARROW_SIZE/1.5;this.arrowIcon_.setAttribute("transform","translate("+c+","+u+") rotate(180)")}};Blockly.FieldIconMenu.prototype.buttonClick_=function(e){var o=e.target.getAttribute("data-value");this.setValue(o);Blockly.DropDownDiv.hide()};Blockly.FieldIconMenu.prototype.onHide_=function(){if(this.sourceBlock_)this.sourceBlock_.setColour(this.savedPrimary_,this.sourceBlock_.getColourSecondary(),this.sourceBlock_.getColourTertiary());Blockly.DropDownDiv.content_.removeAttribute("role");Blockly.DropDownDiv.content_.removeAttribute("aria-haspopup");Blockly.DropDownDiv.content_.removeAttribute("aria-activedescendant");this.arrowIcon_.setAttribute("transform","translate("+this.arrowX_+","+this.arrowY_+")")};Blockly.Field.register("field_iconmenu",Blockly.FieldIconMenu);goog.provide("Blockly.FieldImage");goog.require("Blockly.Field");goog.require("goog.dom");goog.require("goog.math.Size");goog.require("goog.userAgent");Blockly.FieldImage=function(e,o,t,i,r){this.sourceBlock_=null;this.height_=Number(t);this.width_=Number(o);this.size_=new goog.math.Size(this.width_,this.height_);this.text_=i||"";this.flipRTL_=r;this.setValue(e)};goog.inherits(Blockly.FieldImage,Blockly.Field);Blockly.FieldImage.fromJson=function(e){var o=Blockly.utils.replaceMessageReferences(e["src"]);var t=Number(Blockly.utils.replaceMessageReferences(e["width"]));var i=Number(Blockly.utils.replaceMessageReferences(e["height"]));var r=Blockly.utils.replaceMessageReferences(e["alt"]);var n=!!e["flip_rtl"]||!!e["flipRtl"];return new Blockly.FieldImage(o,t,i,r,n)};Blockly.FieldImage.prototype.EDITABLE=false;Blockly.FieldImage.prototype.init=function(){if(this.fieldGroup_)return;this.fieldGroup_=Blockly.utils.createSvgElement("g",{},null);if(!this.visible_)this.fieldGroup_.style.display="none";this.imageElement_=Blockly.utils.createSvgElement("image",{height:this.height_+"px",width:this.width_+"px"},this.fieldGroup_);this.setValue(this.src_);this.sourceBlock_.getSvgRoot().appendChild(this.fieldGroup_);this.setTooltip(this.sourceBlock_);Blockly.Tooltip.bindMouseEvents(this.imageElement_)};Blockly.FieldImage.prototype.dispose=function(){goog.dom.removeNode(this.fieldGroup_);this.fieldGroup_=null;this.imageElement_=null};Blockly.FieldImage.prototype.setTooltip=function(e){this.imageElement_.tooltip=e};Blockly.FieldImage.prototype.getValue=function(){return this.src_};Blockly.FieldImage.prototype.setValue=function(e){if(null===e)return;this.src_=e;if(this.imageElement_)this.imageElement_.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",e||"")};Blockly.FieldImage.prototype.getFlipRTL=function(){return this.flipRTL_};Blockly.FieldImage.prototype.setText=function(e){if(null===e)return;this.text_=e};Blockly.FieldImage.prototype.render_=function(){};Blockly.FieldImage.prototype.updateWidth=function(){};Blockly.Field.register("field_image",Blockly.FieldImage);goog.provide("Blockly.FieldLabel");goog.require("Blockly.Field");goog.require("Blockly.Tooltip");goog.require("goog.dom");goog.require("goog.math.Size");goog.require("goog.userAgent");Blockly.FieldLabel=function(e,o){this.size_=new goog.math.Size(0,0);this.class_=o;this.setValue(e)};goog.inherits(Blockly.FieldLabel,Blockly.Field);Blockly.FieldLabel.fromJson=function(e){var o=Blockly.utils.replaceMessageReferences(e["text"]);return new Blockly.FieldLabel(o,e["class"])};Blockly.FieldLabel.prototype.EDITABLE=false;Blockly.FieldLabel.prototype.SERIALIZABLE=false;Blockly.FieldLabel.prototype.init=function(){if(this.textElement_)return;this.textElement_=Blockly.utils.createSvgElement("text",{class:"blocklyText",y:Blockly.BlockSvg.FIELD_TOP_PADDING,"text-anchor":"middle","dominant-baseline":"middle",dy:goog.userAgent.EDGE_OR_IE?Blockly.Field.IE_TEXT_OFFSET:"0"},null);if(this.class_)Blockly.utils.addClass(this.textElement_,this.class_);if(!this.visible_)this.textElement_.style.display="none";this.sourceBlock_.getSvgRoot().appendChild(this.textElement_);this.textElement_.tooltip=this.sourceBlock_;Blockly.Tooltip.bindMouseEvents(this.textElement_);this.render_()};Blockly.FieldLabel.prototype.dispose=function(){goog.dom.removeNode(this.textElement_);this.textElement_=null};Blockly.FieldLabel.prototype.getSvgRoot=function(){return this.textElement_};Blockly.FieldLabel.prototype.setTooltip=function(e){this.textElement_.tooltip=e};Blockly.Field.register("field_label",Blockly.FieldLabel);goog.provide("Blockly.FieldLabelSerializable");goog.require("Blockly.FieldLabel");Blockly.FieldLabelSerializable=function(e,o){Blockly.FieldLabelSerializable.superClass_.constructor.call(this,e,o);this.arrowWidth_=0};goog.inherits(Blockly.FieldLabelSerializable,Blockly.FieldLabel);Blockly.FieldLabelSerializable.fromJson=function(e){var o=Blockly.utils.replaceMessageReferences(e["text"]);return new Blockly.FieldLabelSerializable(o,e["class"])};Blockly.FieldLabelSerializable.prototype.EDITABLE=false;Blockly.FieldLabelSerializable.prototype.SERIALIZABLE=true;Blockly.FieldLabelSerializable.prototype.updateWidth=function(){this.size_.width=Blockly.Field.getCachedWidth(this.textElement_)};Blockly.FieldLabelSerializable.prototype.render_=function(){if(this.visible_&&this.textElement_){goog.dom.removeChildren(this.textElement_);var e=document.createTextNode(this.getDisplayText_());this.textElement_.appendChild(e);this.updateWidth();var o=this.size_.width/2;var t=Blockly.BlockSvg.FIELD_WIDTH/2;if(this.sourceBlock_.RTL){var i=this.size_.width-t;o=Math.min(i,o)}else o=Math.max(t,o);this.textElement_.setAttribute("x",o)}};Blockly.Field.register("field_label_serializable",Blockly.FieldLabelSerializable);goog.provide("Blockly.FieldMatrix");goog.require("Blockly.DropDownDiv");Blockly.FieldMatrix=function(e){Blockly.FieldMatrix.superClass_.constructor.call(this,e);this.addArgType("matrix");this.ledThumbNodes_=[];this.ledButtons_=[];this.matrix_="";this.matrixStage_=null;this.arrow_=null;this.paintStyle_=null;this.mouseDownWrapper_=null;this.clearButtonWrapper_=null;this.fillButtonWrapper_=null;this.matrixTouchWrapper_=null;this.matrixMoveWrapper_=null;this.matrixReleaseWrapper_=null};goog.inherits(Blockly.FieldMatrix,Blockly.Field);Blockly.FieldMatrix.fromJson=function(e){return new Blockly.FieldMatrix(e["matrix"])};Blockly.FieldMatrix.THUMBNAIL_SIZE=26;Blockly.FieldMatrix.THUMBNAIL_NODE_SIZE=4;Blockly.FieldMatrix.THUMBNAIL_NODE_PAD=1;Blockly.FieldMatrix.ARROW_SIZE=12;Blockly.FieldMatrix.MATRIX_NODE_SIZE=18;Blockly.FieldMatrix.MATRIX_NODE_RADIUS=4;Blockly.FieldMatrix.MATRIX_NODE_PAD=5;Blockly.FieldMatrix.ZEROS="0000000000000000000000000";Blockly.FieldMatrix.ONES="1111111111111111111111111";Blockly.FieldMatrix.prototype.init=function(){if(this.fieldGroup_)return;this.fieldGroup_=Blockly.utils.createSvgElement("g",{},null);this.size_.width=Blockly.FieldMatrix.THUMBNAIL_SIZE+Blockly.FieldMatrix.ARROW_SIZE+1.5*Blockly.BlockSvg.DROPDOWN_ARROW_PADDING;this.sourceBlock_.getSvgRoot().appendChild(this.fieldGroup_);var e=Blockly.BlockSvg.DROPDOWN_ARROW_PADDING/2;var o=(this.size_.height-Blockly.FieldMatrix.THUMBNAIL_SIZE)/2;var t=Blockly.utils.createSvgElement("g",{transform:"translate("+e+", "+o+")","pointer-events":"bounding-box",cursor:"pointer"},this.fieldGroup_);this.ledThumbNodes_=[];var i=Blockly.FieldMatrix.THUMBNAIL_NODE_SIZE;var r=Blockly.FieldMatrix.THUMBNAIL_NODE_PAD;for(var n=0;n<5;n++){for(var l=0;l<5;l++){var s={x:(i+r)*l+r,y:(i+r)*n+r,width:i,height:i,rx:r,ry:r};this.ledThumbNodes_.push(Blockly.utils.createSvgElement("rect",s,t))}t.style.cursor="default";this.updateMatrix_()}if(!this.arrow_){var g=Blockly.FieldMatrix.THUMBNAIL_SIZE+1.5*Blockly.BlockSvg.DROPDOWN_ARROW_PADDING;var a=(this.size_.height-Blockly.FieldMatrix.ARROW_SIZE)/2;this.arrow_=Blockly.utils.createSvgElement("image",{height:Blockly.FieldMatrix.ARROW_SIZE+"px",width:Blockly.FieldMatrix.ARROW_SIZE+"px",transform:"translate("+g+", "+a+")"},this.fieldGroup_);this.arrow_.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",Blockly.mainWorkspace.options.pathToMedia+"dropdown-arrow.svg");this.arrow_.style.cursor="default"}this.mouseDownWrapper_=Blockly.bindEventWithChecks_(this.getClickTarget_(),"mousedown",this,this.onMouseDown_)};Blockly.FieldMatrix.prototype.setValue=function(e){if(!e||e===this.matrix_)return;if(this.sourceBlock_&&Blockly.Events.isEnabled())Blockly.Events.fire(new Blockly.Events.Change(this.sourceBlock_,"field",this.name,this.matrix_,e));e+=Blockly.FieldMatrix.ZEROS.substr(0,25-e.length);this.matrix_=e;this.updateMatrix_()};Blockly.FieldMatrix.prototype.getValue=function(){return String(this.matrix_)};Blockly.FieldMatrix.prototype.showEditor_=function(){Blockly.DropDownDiv.hideWithoutAnimation();Blockly.DropDownDiv.clearContent();var e=Blockly.DropDownDiv.getContentDiv();var o=5*Blockly.FieldMatrix.MATRIX_NODE_SIZE+6*Blockly.FieldMatrix.MATRIX_NODE_PAD;this.matrixStage_=Blockly.utils.createSvgElement("svg",{xmlns:"http://www.w3.org/2000/svg","xmlns:html":"http://www.w3.org/1999/xhtml","xmlns:xlink":"http://www.w3.org/1999/xlink",version:"1.1",height:o+"px",width:o+"px"},e);this.ledButtons_=[];for(var t=0;t<5;t++)for(var i=0;i<5;i++){var r=Blockly.FieldMatrix.MATRIX_NODE_SIZE*i+Blockly.FieldMatrix.MATRIX_NODE_PAD*(i+1);var n=Blockly.FieldMatrix.MATRIX_NODE_SIZE*t+Blockly.FieldMatrix.MATRIX_NODE_PAD*(t+1);var l={x:r+"px",y:n+"px",width:Blockly.FieldMatrix.MATRIX_NODE_SIZE,height:Blockly.FieldMatrix.MATRIX_NODE_SIZE,rx:Blockly.FieldMatrix.MATRIX_NODE_RADIUS,ry:Blockly.FieldMatrix.MATRIX_NODE_RADIUS};var s=Blockly.utils.createSvgElement("rect",l,this.matrixStage_);this.matrixStage_.appendChild(s);this.ledButtons_.push(s)}var g=document.createElement("div");var a=document.createElement("div");a.className="scratchMatrixButtonDiv";var c=this.createButton_(this.sourceBlock_.colourSecondary_);a.appendChild(c);var u=document.createElement("div");u.className="scratchMatrixButtonDiv";var h=this.createButton_("#FFFFFF");u.appendChild(h);g.appendChild(a);g.appendChild(u);e.appendChild(g);Blockly.DropDownDiv.setColour(this.sourceBlock_.getColour(),this.sourceBlock_.getColourTertiary());Blockly.DropDownDiv.setCategory(this.sourceBlock_.getCategory());Blockly.DropDownDiv.showPositionedByBlock(this,this.sourceBlock_);this.matrixTouchWrapper_=Blockly.bindEvent_(this.matrixStage_,"mousedown",this,this.onMouseDown);this.clearButtonWrapper_=Blockly.bindEvent_(c,"click",this,this.clearMatrix_);this.fillButtonWrapper_=Blockly.bindEvent_(h,"click",this,this.fillMatrix_);this.updateMatrix_()};Blockly.FieldMatrix.prototype.createButton_=function(e){var o=Blockly.utils.createSvgElement("svg",{xmlns:"http://www.w3.org/2000/svg","xmlns:html":"http://www.w3.org/1999/xhtml","xmlns:xlink":"http://www.w3.org/1999/xlink",version:"1.1",height:Blockly.FieldMatrix.MATRIX_NODE_SIZE+"px",width:Blockly.FieldMatrix.MATRIX_NODE_SIZE+"px"});var t=Blockly.FieldMatrix.MATRIX_NODE_SIZE/4;var i=Blockly.FieldMatrix.MATRIX_NODE_SIZE/16;for(var r=0;r<3;r++)for(var n=0;n<3;n++)Blockly.utils.createSvgElement("rect",{x:(t+i)*n+i,y:(t+i)*r+i,width:t,height:t,rx:i,ry:i,fill:e},o);return o};Blockly.FieldMatrix.prototype.updateMatrix_=function(){for(var e=0;e<this.matrix_.length;e++)if("0"===this.matrix_[e]){this.fillMatrixNode_(this.ledButtons_,e,this.sourceBlock_.colourSecondary_);this.fillMatrixNode_(this.ledThumbNodes_,e,this.sourceBlock_.colour_)}else{this.fillMatrixNode_(this.ledButtons_,e,"#FFFFFF");this.fillMatrixNode_(this.ledThumbNodes_,e,"#FFFFFF")}};Blockly.FieldMatrix.prototype.clearMatrix_=function(e){if(0!=e.button)return;this.setValue(Blockly.FieldMatrix.ZEROS)};Blockly.FieldMatrix.prototype.fillMatrix_=function(e){if(0!=e.button)return;this.setValue(Blockly.FieldMatrix.ONES)};Blockly.FieldMatrix.prototype.fillMatrixNode_=function(e,o,t){if(!e||!e[o]||!t)return;e[o].setAttribute("fill",t)};Blockly.FieldMatrix.prototype.setLEDNode_=function(e,o){if(e<0||e>24)return;var t=this.matrix_.substr(0,e)+o+this.matrix_.substr(e+1);this.setValue(t)};Blockly.FieldMatrix.prototype.fillLEDNode_=function(e){if(e<0||e>24)return;this.setLEDNode_(e,"1")};Blockly.FieldMatrix.prototype.clearLEDNode_=function(e){if(e<0||e>24)return;this.setLEDNode_(e,"0")};Blockly.FieldMatrix.prototype.toggleLEDNode_=function(e){if(e<0||e>24)return;if("0"===this.matrix_.charAt(e))this.setLEDNode_(e,"1");else this.setLEDNode_(e,"0")};Blockly.FieldMatrix.prototype.onMouseDown=function(e){this.matrixMoveWrapper_=Blockly.bindEvent_(document.body,"mousemove",this,this.onMouseMove);this.matrixReleaseWrapper_=Blockly.bindEvent_(document.body,"mouseup",this,this.onMouseUp);var o=this.checkForLED_(e);if(o>-1){if("0"===this.matrix_.charAt(o))this.paintStyle_="fill";else this.paintStyle_="clear";this.toggleLEDNode_(o);this.updateMatrix_()}else this.paintStyle_=null};Blockly.FieldMatrix.prototype.onMouseUp=function(){Blockly.unbindEvent_(this.matrixMoveWrapper_);Blockly.unbindEvent_(this.matrixReleaseWrapper_);this.paintStyle_=null};Blockly.FieldMatrix.prototype.onMouseMove=function(e){e.preventDefault();if(this.paintStyle_){var o=this.checkForLED_(e);if(o<0)return;if("clear"===this.paintStyle_)this.clearLEDNode_(o);else if("fill"===this.paintStyle_)this.fillLEDNode_(o)}};Blockly.FieldMatrix.prototype.checkForLED_=function(e){var o=this.matrixStage_.getBoundingClientRect();var t=Blockly.FieldMatrix.MATRIX_NODE_SIZE;var i=Blockly.FieldMatrix.MATRIX_NODE_PAD;var r=e.clientX-o.left;var n=e.clientY-o.top;var l=i/2;var s=o.width-i/2;if(r<l||r>s||n<l||n>s)return-1;var g=Math.trunc((r-i/2)/(t+i));var a=Math.trunc((n-i/2)/(t+i));return g+a*i};Blockly.FieldMatrix.prototype.dispose_=function(){var e=this;return function(){Blockly.FieldMatrix.superClass_.dispose_.call(e)();e.matrixStage_=null;if(e.mouseDownWrapper_)Blockly.unbindEvent_(e.mouseDownWrapper_);if(e.matrixTouchWrapper_)Blockly.unbindEvent_(e.matrixTouchWrapper_);if(e.matrixReleaseWrapper_)Blockly.unbindEvent_(e.matrixReleaseWrapper_);if(e.matrixMoveWrapper_)Blockly.unbindEvent_(e.matrixMoveWrapper_);if(e.clearButtonWrapper_)Blockly.unbindEvent_(e.clearButtonWrapper_);if(e.fillButtonWrapper_)Blockly.unbindEvent_(e.fillButtonWrapper_)}};Blockly.Field.register("field_matrix",Blockly.FieldMatrix);goog.provide("Blockly.FieldNote");goog.require("Blockly.DropDownDiv");goog.require("Blockly.FieldTextInput");goog.require("goog.math");goog.require("goog.userAgent");Blockly.FieldNote=function(e,o){e=e&&!isNaN(e)?String(e):"0";Blockly.FieldNote.superClass_.constructor.call(this,e,o);this.addArgType("note");this.fieldEditorWidth_=0;this.fieldEditorHeight_=0;this.pianoSVG_=null;this.keySVGs_=[];this.noteNameText_=null;this.lowCText_=null;this.highCText_=null;this.displayedOctave_=null;this.animationPos_=0;this.animationTarget_=0;this.mouseIsDown_=false;this.mouseDownWrappers_=[];this.mouseUpWrapper_=null;this.mouseEnterWrappers_=[];this.octaveDownMouseDownWrapper_=null;this.octaveUpMouseDownWrapper_=null};goog.inherits(Blockly.FieldNote,Blockly.FieldTextInput);Blockly.FieldNote.INSET=5;Blockly.FieldNote.TOP_MENU_HEIGHT=32-Blockly.FieldNote.INSET;Blockly.FieldNote.EDGE_PADDING=1;Blockly.FieldNote.SHADOW_HEIGHT=4;Blockly.FieldNote.SHADOW_COLOR="#000";Blockly.FieldNote.SHADOW_OPACITY=.2;Blockly.FieldNote.WHITE_KEY_COLOR="#FFFFFF";Blockly.FieldNote.BLACK_KEY_COLOR="#323133";Blockly.FieldNote.BLACK_KEY_STROKE="#555555";Blockly.FieldNote.KEY_SELECTED_COLOR="#b0d6ff";Blockly.FieldNote.NUM_WHITE_KEYS=8;Blockly.FieldNote.WHITE_KEY_HEIGHT=72;Blockly.FieldNote.WHITE_KEY_WIDTH=40;Blockly.FieldNote.BLACK_KEY_HEIGHT=40;Blockly.FieldNote.BLACK_KEY_WIDTH=32;Blockly.FieldNote.KEY_RADIUS=6;Blockly.FieldNote.KEY_LABEL_PADDING=8;Blockly.FieldNote.KEY_INFO=[{name:"C",pitch:0},{name:"C♯",pitch:1,isBlack:true},{name:"D",pitch:2},{name:"E♭",pitch:3,isBlack:true},{name:"E",pitch:4},{name:"F",pitch:5},{name:"F♯",pitch:6,isBlack:true},{name:"G",pitch:7},{name:"G♯",pitch:8,isBlack:true},{name:"A",pitch:9},{name:"B♭",pitch:10,isBlack:true},{name:"B",pitch:11},{name:"C",pitch:12}];Blockly.FieldNote.MAX_NOTE=130;Blockly.FieldNote.ANIMATION_FRACTION=.2;Blockly.FieldNote.ARROW_SVG_PATH="icons/arrow_button.svg";Blockly.FieldNote.OCTAVE_BUTTON_SIZE=32;Blockly.FieldNote.fromJson=function(e){return new Blockly.FieldNote(e["note"])};Blockly.FieldNote.prototype.dispose_=function(){var e=this;return function(){Blockly.FieldNote.superClass_.dispose_.call(e)();e.mouseDownWrappers_.forEach((function(e){Blockly.unbindEvent_(e)}));e.mouseEnterWrappers_.forEach((function(e){Blockly.unbindEvent_(e)}));if(e.mouseUpWrapper_)Blockly.unbindEvent_(e.mouseUpWrapper_);if(e.octaveDownMouseDownWrapper_)Blockly.unbindEvent_(e.octaveDownMouseDownWrapper_);if(e.octaveUpMouseDownWrapper_)Blockly.unbindEvent_(e.octaveUpMouseDownWrapper_);this.pianoSVG_=null;this.keySVGs_.length=0;this.noteNameText_=null;this.lowCText_=null;this.highCText_=null}};Blockly.FieldNote.prototype.showEditor_=function(){Blockly.FieldNote.superClass_.showEditor_.call(this,this.useTouchInteraction_);Blockly.DropDownDiv.hideWithoutAnimation();Blockly.DropDownDiv.clearContent();var e=Blockly.DropDownDiv.getContentDiv();this.fieldEditorWidth_=Blockly.FieldNote.NUM_WHITE_KEYS*Blockly.FieldNote.WHITE_KEY_WIDTH+Blockly.FieldNote.EDGE_PADDING;this.fieldEditorHeight_=Blockly.FieldNote.TOP_MENU_HEIGHT+Blockly.FieldNote.WHITE_KEY_HEIGHT+Blockly.FieldNote.EDGE_PADDING;var o=Blockly.utils.createSvgElement("svg",{xmlns:"http://www.w3.org/2000/svg","xmlns:html":"http://www.w3.org/1999/xhtml","xmlns:xlink":"http://www.w3.org/1999/xlink",version:"1.1",height:this.fieldEditorHeight_+"px",width:this.fieldEditorWidth_+"px"},e);this.pianoSVG_=Blockly.utils.createSvgElement("g",{},o);var t=Blockly.utils.createSvgElement("g",{},this.pianoSVG_);var i=Blockly.utils.createSvgElement("g",{},this.pianoSVG_);this.keySVGs_=[];this.addPianoOctave_(-this.fieldEditorWidth_+Blockly.FieldNote.EDGE_PADDING,t,i,null);this.addPianoOctave_(0,t,i,this.keySVGs_);this.addPianoOctave_(this.fieldEditorWidth_-Blockly.FieldNote.EDGE_PADDING,t,i,null);this.noteNameText_=Blockly.utils.createSvgElement("text",{x:this.fieldEditorWidth_/2,y:Blockly.FieldNote.TOP_MENU_HEIGHT/2,class:"blocklyText","text-anchor":"middle","dominant-baseline":"middle"},o);var r=Blockly.FieldNote.WHITE_KEY_WIDTH/2;this.lowCText_=this.addCKeyLabel_(r,o);var n=r+Blockly.FieldNote.WHITE_KEY_WIDTH*(Blockly.FieldNote.NUM_WHITE_KEYS-1);this.highCText_=this.addCKeyLabel_(n,o);Blockly.utils.createSvgElement("line",{stroke:this.sourceBlock_.getColourTertiary(),x1:0,y1:Blockly.FieldNote.TOP_MENU_HEIGHT,x2:this.fieldEditorWidth_,y2:Blockly.FieldNote.TOP_MENU_HEIGHT},o);Blockly.utils.createSvgElement("rect",{x:0,y:Blockly.FieldNote.TOP_MENU_HEIGHT,width:this.fieldEditorWidth_,height:Blockly.FieldNote.SHADOW_HEIGHT,fill:Blockly.FieldNote.SHADOW_COLOR,"fill-opacity":Blockly.FieldNote.SHADOW_OPACITY},o);this.octaveDownButton=this.addOctaveButton_(0,true,o);this.octaveUpButton=this.addOctaveButton_(this.fieldEditorWidth_+2*Blockly.FieldNote.INSET-Blockly.FieldNote.OCTAVE_BUTTON_SIZE,false,o);this.octaveDownMouseDownWrapper_=Blockly.bindEvent_(this.octaveDownButton,"mousedown",this,(function(){this.changeOctaveBy_(-1)}));this.octaveUpMouseDownWrapper_=Blockly.bindEvent_(this.octaveUpButton,"mousedown",this,(function(){this.changeOctaveBy_(1)}));Blockly.DropDownDiv.setColour(this.sourceBlock_.parentBlock_.getColour(),this.sourceBlock_.getColourTertiary());Blockly.DropDownDiv.setCategory(this.sourceBlock_.parentBlock_.getCategory());Blockly.DropDownDiv.showPositionedByBlock(this,this.sourceBlock_);this.updateSelection_()};Blockly.FieldNote.prototype.addPianoOctave_=function(e,o,t,i){var r,n,l,s,g,a;e+=Blockly.FieldNote.EDGE_PADDING/2;var c=Blockly.FieldNote.TOP_MENU_HEIGHT;for(var u=0;u<Blockly.FieldNote.KEY_INFO.length;u++){if(Blockly.FieldNote.KEY_INFO[u].isBlack){e-=Blockly.FieldNote.BLACK_KEY_WIDTH/2;r=Blockly.FieldNote.BLACK_KEY_WIDTH/2;n=Blockly.FieldNote.BLACK_KEY_WIDTH;l=Blockly.FieldNote.BLACK_KEY_HEIGHT;s=Blockly.FieldNote.BLACK_KEY_COLOR;g=Blockly.FieldNote.BLACK_KEY_STROKE;a=t}else{r=Blockly.FieldNote.WHITE_KEY_WIDTH;n=Blockly.FieldNote.WHITE_KEY_WIDTH;l=Blockly.FieldNote.WHITE_KEY_HEIGHT;s=Blockly.FieldNote.WHITE_KEY_COLOR;g=this.sourceBlock_.getColourTertiary();a=o}var h={d:this.getPianoKeyPath_(e,c,n,l),fill:s,stroke:g};e+=r;var d=Blockly.utils.createSvgElement("path",h,a);if(i){i[u]=d;d.setAttribute("data-pitch",Blockly.FieldNote.KEY_INFO[u].pitch);d.setAttribute("data-name",Blockly.FieldNote.KEY_INFO[u].name);d.setAttribute("data-isBlack",Blockly.FieldNote.KEY_INFO[u].isBlack);this.mouseDownWrappers_[u]=Blockly.bindEvent_(d,"mousedown",this,this.onMouseDownOnKey_);this.mouseEnterWrappers_[u]=Blockly.bindEvent_(d,"mouseenter",this,this.onMouseEnter_)}}};Blockly.FieldNote.prototype.getPianoKeyPath_=function(e,o,t,i){return"M"+e+" "+o+" "+"L"+e+" "+(o+i-Blockly.FieldNote.KEY_RADIUS)+" "+"Q"+e+" "+(o+i)+" "+(e+Blockly.FieldNote.KEY_RADIUS)+" "+(o+i)+" "+"L"+(e+t-Blockly.FieldNote.KEY_RADIUS)+" "+(o+i)+" "+"Q"+(e+t)+" "+(o+i)+" "+(e+t)+" "+(o+i-Blockly.FieldNote.KEY_RADIUS)+" "+"L"+(e+t)+" "+o+" "+"L"+e+" "+o};Blockly.FieldNote.prototype.addOctaveButton_=function(e,o,t){var i=Blockly.utils.createSvgElement("g",{},t);var r=Blockly.FieldNote.OCTAVE_BUTTON_SIZE;var n=Blockly.utils.createSvgElement("image",{width:r,height:r,x:e-Blockly.FieldNote.INSET,y:-1*Blockly.FieldNote.INSET},i);n.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",Blockly.mainWorkspace.options.pathToMedia+Blockly.FieldNote.ARROW_SVG_PATH);Blockly.utils.createSvgElement("line",{stroke:this.sourceBlock_.getColourTertiary(),x1:e-Blockly.FieldNote.INSET,y1:0,x2:e-Blockly.FieldNote.INSET,y2:Blockly.FieldNote.TOP_MENU_HEIGHT-Blockly.FieldNote.INSET},i);if(o){var l=-1*Blockly.FieldNote.OCTAVE_BUTTON_SIZE+2*Blockly.FieldNote.INSET;i.setAttribute("transform","scale(-1, 1) "+"translate("+l+", 0)")}return i};Blockly.FieldNote.prototype.addCKeyLabel_=function(e,o){return Blockly.utils.createSvgElement("text",{x:e,y:Blockly.FieldNote.TOP_MENU_HEIGHT+Blockly.FieldNote.WHITE_KEY_HEIGHT-Blockly.FieldNote.KEY_LABEL_PADDING,class:"scratchNotePickerKeyLabel","text-anchor":"middle"},o)};Blockly.FieldNote.prototype.setCKeyLabelsVisible_=function(e){if(e){this.fadeSvgToOpacity_(this.lowCText_,1);this.fadeSvgToOpacity_(this.highCText_,1)}else{this.fadeSvgToOpacity_(this.lowCText_,0);this.fadeSvgToOpacity_(this.highCText_,0)}};Blockly.FieldNote.prototype.fadeSvgToOpacity_=function(e,o){e.setAttribute("style","opacity: "+o+"; transition: opacity 0.1s;")};Blockly.FieldNote.prototype.onMouseDownOnKey_=function(e){this.mouseIsDown_=true;this.mouseUpWrapper_=Blockly.bindEvent_(document.body,"mouseup",this,this.onMouseUp_);this.selectNoteWithMouseEvent_(e)};Blockly.FieldNote.prototype.onMouseUp_=function(){this.mouseIsDown_=false;Blockly.unbindEvent_(this.mouseUpWrapper_)};Blockly.FieldNote.prototype.onMouseEnter_=function(e){if(this.mouseIsDown_)this.selectNoteWithMouseEvent_(e)};Blockly.FieldNote.prototype.selectNoteWithMouseEvent_=function(e){var o=Number(e.target.getAttribute("data-pitch"))+12*this.displayedOctave_;this.setNoteNum_(o);this.playNoteInternal_()};Blockly.FieldNote.prototype.playNoteInternal_=function(){if(Blockly.FieldNote.playNote_)Blockly.FieldNote.playNote_(this.getValue(),this.sourceBlock_.parentBlock_.getCategory())};Blockly.FieldNote.playNote_=function(){return};Blockly.FieldNote.prototype.changeOctaveBy_=function(e){this.displayedOctave_+=e;if(this.displayedOctave_<0){this.displayedOctave_=0;return}var o=Math.floor(Blockly.FieldNote.MAX_NOTE/12);if(this.displayedOctave_>o){this.displayedOctave_=o;return}var t=Number(this.getText())+12*e;this.setNoteNum_(t);this.animationTarget_=this.fieldEditorWidth_*e*-1;this.animationPos_=0;this.stepOctaveAnimation_();this.setCKeyLabelsVisible_(false)};Blockly.FieldNote.prototype.stepOctaveAnimation_=function(){var e=Math.abs(this.animationPos_-this.animationTarget_);if(e<1){this.pianoSVG_.setAttribute("transform","translate(0, 0)");this.setCKeyLabelsVisible_(true);this.playNoteInternal_();return}this.animationPos_+=(this.animationTarget_-this.animationPos_)*Blockly.FieldNote.ANIMATION_FRACTION;this.pianoSVG_.setAttribute("transform","translate("+this.animationPos_+",0)");requestAnimationFrame(this.stepOctaveAnimation_.bind(this))};Blockly.FieldNote.prototype.setNoteNum_=function(e){e=this.callValidator(e);this.setValue(e);Blockly.FieldTextInput.htmlInput_.value=e};Blockly.FieldNote.prototype.setText=function(e){Blockly.FieldNote.superClass_.setText.call(this,e);if(!this.textElement_)return;this.updateSelection_();this.size_.width=0};Blockly.FieldNote.prototype.noteNumToKeyIndex_=function(e){return Math.floor(e)-12*this.displayedOctave_};Blockly.FieldNote.prototype.updateSelection_=function(){var e=Number(this.getText());if(null==this.displayedOctave_||e>12*this.displayedOctave_+12||e<12*this.displayedOctave_)this.displayedOctave_=Math.floor(e/12);var o=this.noteNumToKeyIndex_(e);this.keySVGs_.forEach((function(e){var o=e.getAttribute("data-isBlack");if("true"===o)e.setAttribute("fill",Blockly.FieldNote.BLACK_KEY_COLOR);else e.setAttribute("fill",Blockly.FieldNote.WHITE_KEY_COLOR)}));if(this.keySVGs_[o]){this.keySVGs_[o].setAttribute("fill",Blockly.FieldNote.KEY_SELECTED_COLOR);var t=Blockly.FieldNote.KEY_INFO[o].name;this.noteNameText_.textContent=t+" ("+Math.floor(e)+")";var i=12*this.displayedOctave_;this.lowCText_.textContent="C("+i+")";this.highCText_.textContent="C("+(i+12)+")"}};Blockly.FieldNote.prototype.classValidator=function(e){if(null===e)return null;var o=parseFloat(e||0);if(isNaN(o))return null;if(o<0)o=0;if(o>Blockly.FieldNote.MAX_NOTE)o=Blockly.FieldNote.MAX_NOTE;return String(o)};Blockly.Field.register("field_note",Blockly.FieldNote);goog.provide("Blockly.FieldNumber");goog.require("Blockly.FieldTextInput");goog.require("Blockly.Touch");goog.require("goog.math");goog.require("goog.userAgent");Blockly.FieldNumber=function(e,o,t,i,r){var n=this.getNumRestrictor(o,t,i);e=e&&!isNaN(e)?String(e):"0";Blockly.FieldNumber.superClass_.constructor.call(this,e,r,n);this.addArgType("number")};goog.inherits(Blockly.FieldNumber,Blockly.FieldTextInput);Blockly.FieldNumber.fromJson=function(e){return new Blockly.FieldNumber(e["value"],e["min"],e["max"],e["precision"])};Blockly.FieldNumber.DROPDOWN_WIDTH=168;Blockly.FieldNumber.NUMPAD_BUTTONS=["7","8","9","4","5","6","1","2","3",".","0","-"," "];Blockly.FieldNumber.NUMPAD_DELETE_ICON="data:image/svg+xml;utf8,"+"<svg "+'xmlns="http://www.w3.org/2000/svg" viewBox="0 0 40 40">'+'<path d="M28.89,11.45H16.79a2.86,2.86,0,0,0-2,.84L9.09,1'+"8a2.85,2.85,0,0,0,0,4l5.69,5.69a2.86,2.86,0,0,0,2,.84h12"+".1a2.86,2.86,0,0,0,2.86-2.86V14.31A2.86,2.86,0,0,0,28.89"+",11.45ZM27.15,22.73a1,1,0,0,1,0,1.41,1,1,0,0,1-.71.3,1,1"+",0,0,1-.71-0.3L23,21.41l-2.73,2.73a1,1,0,0,1-1.41,0,1,1,"+"0,0,1,0-1.41L21.59,20l-2.73-2.73a1,1,0,0,1,0-1.41,1,1,0,"+'0,1,1.41,0L23,18.59l2.73-2.73a1,1,0,1,1,1.42,1.41L24.42,20Z" fill="'+Blockly.Colours.numPadText+'"/></svg>';Blockly.FieldNumber.activeField_=null;Blockly.FieldNumber.prototype.getNumRestrictor=function(e,o,t){this.setConstraints_(e,o,t);var i="[\\d]";if(this.decimalAllowed_)i+="|[\\.]";if(this.negativeAllowed_)i+="|[-]";if(this.exponentialAllowed_)i+="|[eE]";return new RegExp(i)};Blockly.FieldNumber.prototype.setConstraints_=function(e,o,t){this.decimalAllowed_="undefined"==typeof t||isNaN(t)||0==t||Math.floor(t)!=t;this.negativeAllowed_="undefined"==typeof e||isNaN(e)||e<0;this.exponentialAllowed_=this.decimalAllowed_};Blockly.FieldNumber.prototype.showEditor_=function(){Blockly.FieldNumber.activeField_=this;var e=this.useTouchInteraction_;Blockly.FieldNumber.superClass_.showEditor_.call(this,false,e);if(e)this.showNumPad_()};Blockly.FieldNumber.prototype.showNumPad_=function(){Blockly.DropDownDiv.hideWithoutAnimation();Blockly.DropDownDiv.clearContent();var e=Blockly.DropDownDiv.getContentDiv();e.setAttribute("role","menu");e.setAttribute("aria-haspopup","true");this.addButtons_(e);Blockly.DropDownDiv.setColour(this.sourceBlock_.parentBlock_.getColour(),this.sourceBlock_.getColourTertiary());e.style.width=Blockly.FieldNumber.DROPDOWN_WIDTH+"px";this.position_()};Blockly.FieldNumber.prototype.position_=function(){var e=this.sourceBlock_.workspace.scale;var o=this.sourceBlock_.getHeightWidth();o.width*=e;o.height*=e;var t=this.getAbsoluteXY_();var i=t.x+o.width/2;var r=t.y+o.height;var n=i;var l=t.y;Blockly.DropDownDiv.setBoundsElement(this.sourceBlock_.workspace.getParentSvg().parentNode);Blockly.DropDownDiv.show(this,i,r,n,l,this.onHide_.bind(this))};Blockly.FieldNumber.prototype.addButtons_=function(e){var o=this.sourceBlock_.parentBlock_.getColour();var t=this.sourceBlock_.parentBlock_.getColourTertiary();var i=Blockly.FieldNumber.NUMPAD_BUTTONS;for(var r=0,n;n=i[r];r++){var l=document.createElement("button");l.setAttribute("role","menuitem");l.setAttribute("class","blocklyNumPadButton");l.setAttribute("style","background:"+o+";"+"border: 1px solid "+t+";");l.title=n;l.innerHTML=n;Blockly.bindEvent_(l,"mousedown",l,Blockly.FieldNumber.numPadButtonTouch);if("."==n&&!this.decimalAllowed_)l.setAttribute("style","visibility: hidden");else if("-"==n&&!this.negativeAllowed_)continue;else if(" "==n&&!this.negativeAllowed_)continue;else if(" "==n&&this.negativeAllowed_)l.setAttribute("style","visibility: hidden");e.appendChild(l)}var s=document.createElement("button");s.setAttribute("role","menuitem");s.setAttribute("class","blocklyNumPadButton");s.setAttribute("style","background:"+o+";"+"border: 1px solid "+t+";");s.title="Delete";var g=document.createElement("img");g.src=Blockly.FieldNumber.NUMPAD_DELETE_ICON;s.appendChild(g);Blockly.bindEvent_(s,"mousedown",null,Blockly.FieldNumber.numPadEraseButtonTouch);e.appendChild(s)};Blockly.FieldNumber.numPadButtonTouch=function(e){var o=this.innerHTML;var t=Blockly.FieldTextInput.htmlInput_.value;var i=Blockly.FieldTextInput.htmlInput_.selectionStart;var r=Blockly.FieldTextInput.htmlInput_.selectionEnd;var n=t.slice(0,i)+o+t.slice(r);Blockly.FieldNumber.updateDisplay_(n,i+o.length);Blockly.Touch.clearTouchIdentifier();e.preventDefault()};Blockly.FieldNumber.numPadEraseButtonTouch=function(e){var o=Blockly.FieldTextInput.htmlInput_.value;var t=Blockly.FieldTextInput.htmlInput_.selectionStart;var i=Blockly.FieldTextInput.htmlInput_.selectionEnd;if(t==i)t=Math.max(0,t-1);var r=o.slice(0,t)+o.slice(i);Blockly.FieldNumber.updateDisplay_(r,t);Blockly.Touch.clearTouchIdentifier();e.preventDefault()};Blockly.FieldNumber.updateDisplay_=function(e,o){var t=Blockly.FieldTextInput.htmlInput_;t.value=e;Blockly.FieldNumber.superClass_.resizeEditor_.call(Blockly.FieldNumber.activeField_);t.setSelectionRange(o,o);t.scrollLeft=t.scrollWidth;Blockly.FieldNumber.activeField_.validate_()};Blockly.FieldNumber.prototype.onHide_=function(){Blockly.DropDownDiv.content_.removeAttribute("role");Blockly.DropDownDiv.content_.removeAttribute("aria-haspopup")};Blockly.Field.register("field_number",Blockly.FieldNumber);goog.provide("Blockly.FieldTextDropdown");goog.require("Blockly.DropDownDiv");goog.require("Blockly.FieldDropdown");goog.require("Blockly.FieldTextInput");goog.require("goog.userAgent");Blockly.FieldTextDropdown=function(e,o,t,i){this.menuGenerator_=o;Blockly.FieldDropdown.prototype.trimOptions_.call(this);Blockly.FieldTextDropdown.superClass_.constructor.call(this,e,t,i);this.addArgType("textdropdown")};goog.inherits(Blockly.FieldTextDropdown,Blockly.FieldTextInput);Blockly.FieldTextDropdown.fromJson=function(e){var o=new Blockly.FieldTextDropdown(e["text"],e["options"]);if("boolean"==typeof e["spellcheck"])o.setSpellcheck(e["spellcheck"]);return o};Blockly.FieldTextDropdown.prototype.init=function(){if(this.fieldGroup_)return;Blockly.FieldTextDropdown.superClass_.init.call(this);if(!this.arrow_){this.arrowSize_=12;this.arrowX_=0;this.arrowY_=11;this.arrow_=Blockly.utils.createSvgElement("image",{height:this.arrowSize_+"px",width:this.arrowSize_+"px"});this.arrow_.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",Blockly.mainWorkspace.options.pathToMedia+"dropdown-arrow-dark.svg");this.arrow_.style.cursor="pointer";this.fieldGroup_.appendChild(this.arrow_);this.mouseUpWrapper_=Blockly.bindEvent_(this.arrow_,"mouseup",this,this.showDropdown_)}this.disableColourChange_=true};Blockly.FieldTextDropdown.prototype.dispose=function(){if(this.mouseUpWrapper_){Blockly.unbindEvent_(this.mouseUpWrapper_);this.mouseUpWrapper_=null;Blockly.Touch.clearTouchIdentifier()}Blockly.FieldTextDropdown.superClass_.dispose.call(this)};Blockly.FieldTextDropdown.prototype.showEditor_=function(){if(!this.dropDownOpen_)Blockly.FieldTextDropdown.superClass_.showEditor_.call(this,null,null,true,(function(){Blockly.WidgetDiv.hide();this.showDropdown_();Blockly.Touch.clearTouchIdentifier()}))};Blockly.FieldTextDropdown.prototype.getOptions_=Blockly.FieldDropdown.prototype.getOptions_;Blockly.FieldTextDropdown.prototype.positionArrow=Blockly.FieldDropdown.prototype.positionArrow;Blockly.FieldTextDropdown.prototype.showDropdown_=Blockly.FieldDropdown.prototype.showEditor_;Blockly.FieldTextDropdown.prototype.onHide=Blockly.FieldDropdown.prototype.onHide;Blockly.Field.register("field_textdropdown",Blockly.FieldTextDropdown);goog.provide("Blockly.FieldNumberDropdown");goog.require("Blockly.FieldTextDropdown");goog.require("goog.userAgent");Blockly.FieldNumberDropdown=function(e,o,t,i,r,n){this.setConstraints_=Blockly.FieldNumber.prototype.setConstraints_;var l=Blockly.FieldNumber.prototype.getNumRestrictor.call(this,t,i,r);Blockly.FieldNumberDropdown.superClass_.constructor.call(this,e,o,n,l);this.addArgType("numberdropdown")};goog.inherits(Blockly.FieldNumberDropdown,Blockly.FieldTextDropdown);Blockly.FieldNumberDropdown.fromJson=function(e){return new Blockly.FieldNumberDropdown(e["value"],e["options"],e["min"],e["max"],e["precision"])};Blockly.Field.register("field_numberdropdown",Blockly.FieldNumberDropdown);goog.provide("Blockly.FieldTextInputRemovable");goog.require("Blockly.BlockSvg.render");goog.require("Blockly.Colours");goog.require("Blockly.FieldTextInput");goog.require("Blockly.Msg");goog.require("Blockly.utils");goog.require("goog.dom");goog.require("goog.dom.TagName");Blockly.FieldTextInputRemovable=function(e,o,t){Blockly.FieldTextInputRemovable.superClass_.constructor.call(this,e,o,t)};goog.inherits(Blockly.FieldTextInputRemovable,Blockly.FieldTextInput);Blockly.FieldTextInputRemovable.prototype.showEditor_=function(){Blockly.FieldTextInputRemovable.superClass_.showEditor_.call(this);var e=Blockly.WidgetDiv.DIV;e.className+=" removableTextInput";var o=goog.dom.createDom(goog.dom.TagName.IMG,"blocklyTextRemoveIcon");o.setAttribute("src",Blockly.mainWorkspace.options.pathToMedia+"icons/remove.svg");this.removeButtonMouseWrapper_=Blockly.bindEvent_(o,"mousedown",this,this.removeCallback_);e.appendChild(o)};Blockly.FieldTextInputRemovable.prototype.removeCallback_=function(){if(this.sourceBlock_&&this.sourceBlock_.removeFieldCallback)this.sourceBlock_.removeFieldCallback(this);else console.warn("Expected a source block with removeFieldCallback")};Blockly.FieldTextInputRemovable.fromJson=function(e){var o=Blockly.utils.replaceMessageReferences(e["text"]);var t=new Blockly.FieldTextInputRemovable(o,e["class"]);if("boolean"==typeof e["spellcheck"])t.setSpellcheck(e["spellcheck"]);return t};Blockly.Field.register("field_input_removable",Blockly.FieldTextInputRemovable);goog.provide("Blockly.FieldVariable");goog.require("Blockly.FieldDropdown");goog.require("Blockly.Msg");goog.require("Blockly.VariableModel");goog.require("Blockly.Variables");goog.require("goog.asserts");goog.require("goog.string");Blockly.FieldVariable=function(e,o,t){this.menuGenerator_=Blockly.FieldVariable.dropdownCreate;this.size_=new goog.math.Size(Blockly.BlockSvg.FIELD_WIDTH,Blockly.BlockSvg.FIELD_HEIGHT);this.setValidator(o);this.defaultVariableName=e||"";var i=t&&1==t.length;this.defaultType_=i?t[0]:"";this.variableTypes=t;this.addArgType("variable");this.value_=null};goog.inherits(Blockly.FieldVariable,Blockly.FieldDropdown);Blockly.FieldVariable.fromJson=function(e){var o=Blockly.utils.replaceMessageReferences(e["variable"]);var t=e["variableTypes"];return new Blockly.FieldVariable(o,null,t)};Blockly.FieldVariable.prototype.init=function(){if(this.fieldGroup_)return;Blockly.FieldVariable.superClass_.init.call(this);this.initModel()};Blockly.FieldVariable.prototype.initModel=function(){if(this.variable_)return;this.workspace_=this.sourceBlock_.workspace;var e=this.initFlyoutBroadcast_(this.workspace_);if(!e)var e=Blockly.Variables.getOrCreateVariablePackage(this.workspace_,null,this.defaultVariableName,this.defaultType_);Blockly.Events.disable();try{this.setValue(e.getId())}finally{Blockly.Events.enable()}};Blockly.FieldVariable.prototype.initFlyoutBroadcast_=function(e){var o=Blockly.BROADCAST_MESSAGE_VARIABLE_TYPE;var t=e.getVariablesOfType(o);if(e.isFlyout&&this.defaultType_==o&&0!=t.length){t.sort(Blockly.VariableModel.compareByName);return t[0]}};Blockly.FieldVariable.dispose=function(){Blockly.FieldVariable.superClass_.dispose.call(this);this.workspace_=null;this.variableMap_=null};Blockly.FieldVariable.prototype.setSourceBlock=function(e){goog.asserts.assert(!e.isShadow(),"Variable fields are not allowed to exist on shadow blocks.");Blockly.FieldVariable.superClass_.setSourceBlock.call(this,e)};Blockly.FieldVariable.prototype.getValue=function(){return this.variable_?this.variable_.getId():null};Blockly.FieldVariable.prototype.getText=function(){return this.variable_?this.variable_.name:""};Blockly.FieldVariable.prototype.getVariable=function(){return this.variable_};Blockly.FieldVariable.prototype.setValue=function(e){var o=this.sourceBlock_.workspace;var t=Blockly.Variables.getVariable(o,e);if(!t)throw new Error("Variable id doesn't point to a real variable!  ID was "+e);var i=t.type;if(!this.typeIsAllowed_(i))throw new Error("Variable type doesn't match this field!  Type was "+i);if(this.sourceBlock_&&Blockly.Events.isEnabled()){var r=this.variable_?this.variable_.getId():null;Blockly.Events.fire(new Blockly.Events.BlockChange(this.sourceBlock_,"field",this.name,r,e))}this.variable_=t;this.value_=e;this.setText(t.name)};Blockly.FieldVariable.prototype.typeIsAllowed_=function(e){var o=this.getVariableTypes_();if(!o)return true;for(var t=0;t<o.length;t++)if(e==o[t])return true;return false};Blockly.FieldVariable.prototype.getVariableTypes_=function(){var e=this.variableTypes;if(null===e)if(this.sourceBlock_){var o=this.sourceBlock_.workspace;return o.getVariableTypes()}e=e||[""];if(0==e.length){var t=this.getText();throw new Error("'variableTypes' of field variable "+t+" was an empty list")}return e};Blockly.FieldVariable.dropdownCreate=function(){if(!this.variable_)throw new Error("Tried to call dropdownCreate on a variable field with no"+" variable selected.");var e=[];var o=this.getText();var t=null;if(this.sourceBlock_)t=this.sourceBlock_.workspace;if(t){var i=this.getVariableTypes_();var e=[];for(var r=0;r<i.length;r++){var n=i[r];var l=t.getVariablesOfType(n);e=e.concat(l);var s=t.getPotentialVariableMap();if(s){var g=s.getVariablesOfType(n);e=e.concat(g)}}}e.sort(Blockly.VariableModel.compareByName);var a=[];for(var r=0;r<e.length;r++)a[r]=[e[r].name,e[r].getId()];if(this.defaultType_==Blockly.BROADCAST_MESSAGE_VARIABLE_TYPE)a.unshift([Blockly.Msg.NEW_BROADCAST_MESSAGE,Blockly.NEW_BROADCAST_MESSAGE_ID]);else{if(this.defaultType_==Blockly.LIST_VARIABLE_TYPE){var c=Blockly.Msg.RENAME_LIST;var u=Blockly.Msg.DELETE_LIST}else{var c=Blockly.Msg.RENAME_VARIABLE;var u=Blockly.Msg.DELETE_VARIABLE}a.push([c,Blockly.RENAME_VARIABLE_ID]);if(u)a.push([u.replace("%1",o),Blockly.DELETE_VARIABLE_ID])}return a};Blockly.FieldVariable.prototype.onItemSelected=function(e,o){var t=o.getValue();if(this.sourceBlock_&&this.sourceBlock_.workspace){var i=this.sourceBlock_.workspace;if(t==Blockly.RENAME_VARIABLE_ID){Blockly.Variables.renameVariable(i,this.variable_);return}else if(t==Blockly.DELETE_VARIABLE_ID){i.deleteVariableById(this.variable_.getId());return}else if(t==Blockly.NEW_BROADCAST_MESSAGE_ID){var r=this;var n=function(e){if(e)r.setValue(e)};Blockly.Variables.createVariable(i,n,Blockly.BROADCAST_MESSAGE_VARIABLE_TYPE);return}}this.setValue(t)};Blockly.FieldVariable.prototype.referencesVariables=function(){return true};Blockly.Field.register("field_variable",Blockly.FieldVariable);goog.provide("Blockly.FieldVariableGetter");goog.require("Blockly.Field");Blockly.FieldVariableGetter=function(e,o,t){this.size_=new goog.math.Size(Blockly.BlockSvg.FIELD_WIDTH,Blockly.BlockSvg.FIELD_HEIGHT);this.text_=e;this.maxDisplayLength=Blockly.BlockSvg.MAX_DISPLAY_LENGTH;this.name_=o;this.variableType_=t?t:""};goog.inherits(Blockly.FieldVariableGetter,Blockly.Field);Blockly.FieldVariableGetter.fromJson=function(e){var o=Blockly.utils.replaceMessageReferences(e["text"]);return new Blockly.FieldVariableGetter(o,e["name"],e["class"],e["variableType"])};Blockly.FieldVariableGetter.prototype.EDITABLE=false;Blockly.FieldVariableGetter.prototype.SERIALIZABLE=true;Blockly.FieldVariableGetter.prototype.init=function(){if(this.fieldGroup_)return;Blockly.FieldVariableGetter.superClass_.init.call(this);if(this.variable_)return;this.workspace_=this.sourceBlock_.workspace;var e=Blockly.Variables.getOrCreateVariablePackage(this.workspace_,null,this.text_,this.variableType_);this.setValue(e.getId())};Blockly.FieldVariableGetter.prototype.getValue=function(){return this.variable_?this.variable_.getId():""};Blockly.FieldVariableGetter.prototype.getText=function(){return this.variable_?this.variable_.name:""};Blockly.FieldVariableGetter.prototype.getVariable=function(){return this.variable_};Blockly.FieldVariableGetter.prototype.setValue=function(e){var o=this.sourceBlock_.workspace;var t=Blockly.Variables.getVariable(o,e);if(!t)throw new Error("Variable id doesn't point to a real variable!  ID was "+e);if(this.sourceBlock_&&Blockly.Events.isEnabled()){var i=this.variable_?this.variable_.getId():null;Blockly.Events.fire(new Blockly.Events.BlockChange(this.sourceBlock_,"field",this.name,i,t.getId()))}this.variable_=t;this.value_=e;this.setText(t.name)};Blockly.FieldVariableGetter.prototype.showEditor_=function(){};Blockly.FieldVariableGetter.prototype.updateEditable=function(){};Blockly.FieldVariableGetter.prototype.referencesVariables=function(){return true};Blockly.Field.register("field_variable_getter",Blockly.FieldVariableGetter);goog.provide("Blockly.FieldVerticalSeparator");goog.require("Blockly.Field");goog.require("goog.dom");goog.require("goog.math.Size");Blockly.FieldVerticalSeparator=function(){this.sourceBlock_=null;this.width_=1;this.height_=Blockly.BlockSvg.ICON_SEPARATOR_HEIGHT;this.size_=new goog.math.Size(this.width_,this.height_)};goog.inherits(Blockly.FieldVerticalSeparator,Blockly.Field);Blockly.FieldVerticalSeparator.fromJson=function(e){return new Blockly.FieldVerticalSeparator};Blockly.FieldVerticalSeparator.prototype.EDITABLE=false;Blockly.FieldVerticalSeparator.prototype.init=function(){if(this.fieldGroup_)return;this.fieldGroup_=Blockly.utils.createSvgElement("g",{},null);if(!this.visible_)this.fieldGroup_.style.display="none";this.lineElement_=Blockly.utils.createSvgElement("line",{stroke:this.sourceBlock_.getColourSecondary(),"stroke-linecap":"round",x1:0,y1:0,x2:0,y2:this.height_},this.fieldGroup_);this.sourceBlock_.getSvgRoot().appendChild(this.fieldGroup_)};Blockly.FieldVerticalSeparator.prototype.setLineHeight=function(e){this.lineElement_.setAttribute("y2",e)};Blockly.FieldVerticalSeparator.prototype.dispose=function(){goog.dom.removeNode(this.fieldGroup_);this.fieldGroup_=null;this.lineElement_=null};Blockly.FieldVerticalSeparator.prototype.getValue=function(){return null};Blockly.FieldVerticalSeparator.prototype.setValue=function(e){return};Blockly.FieldVerticalSeparator.prototype.setText=function(e){return};Blockly.FieldVerticalSeparator.prototype.render_=function(){};Blockly.FieldVerticalSeparator.prototype.updateWidth=function(){};Blockly.Field.register("field_vertical_separator",Blockly.FieldVerticalSeparator);goog.provide("Blockly.Flyout");goog.require("Blockly.Block");goog.require("Blockly.Comment");goog.require("Blockly.Events");goog.require("Blockly.Events.BlockCreate");goog.require("Blockly.Events.VarCreate");goog.require("Blockly.FlyoutButton");goog.require("Blockly.FlyoutExtensionCategoryHeader");goog.require("Blockly.Gesture");goog.require("Blockly.scratchBlocksUtils");goog.require("Blockly.Touch");goog.require("Blockly.WorkspaceSvg");goog.require("goog.dom");goog.require("goog.events");goog.require("goog.math.Rect");goog.require("goog.userAgent");Blockly.Flyout=function(e){e.getMetrics=this.getMetrics_.bind(this);e.setMetrics=this.setMetrics_.bind(this);this.workspace_=new Blockly.WorkspaceSvg(e);this.workspace_.isFlyout=true;var o=this.workspace_.newBlock;this.workspace_.newBlock=function(e,t){return o.call(this,e,t||e)};this.RTL=!!e.RTL;this.horizontalLayout_=e.horizontalLayout;this.toolboxPosition_=e.toolboxPosition;this.eventWrappers_=[];this.backgroundButtons_=[];this.buttons_=[];this.listeners_=[];this.permanentlyDisabled_=[];this.parentToolbox_=null;this.scrollTarget=null;this.recycleBlocks_=[]};Blockly.Flyout.prototype.autoClose=false;Blockly.Flyout.prototype.isVisible_=false;Blockly.Flyout.prototype.containerVisible_=true;Blockly.Flyout.prototype.CORNER_RADIUS=0;Blockly.Flyout.prototype.MARGIN=12;Blockly.Flyout.prototype.GAP_X=3*Blockly.Flyout.prototype.MARGIN;Blockly.Flyout.prototype.GAP_Y=Blockly.Flyout.prototype.MARGIN;Blockly.Flyout.prototype.SCROLLBAR_PADDING=2;Blockly.Flyout.prototype.width_=0;Blockly.Flyout.prototype.height_=0;Blockly.Flyout.prototype.contentWidth_=0;Blockly.Flyout.prototype.contentHeight_=0;Blockly.Flyout.prototype.verticalOffset_=0;Blockly.Flyout.prototype.dragAngleRange_=70;Blockly.Flyout.prototype.scrollAnimationFraction=.3;Blockly.Flyout.prototype.recyclingEnabled_=true;Blockly.Flyout.prototype.createDom=function(e){this.svgGroup_=Blockly.utils.createSvgElement(e,{class:"blocklyFlyout",style:"display: none"},null);this.svgBackground_=Blockly.utils.createSvgElement("path",{class:"blocklyFlyoutBackground"},this.svgGroup_);this.svgGroup_.appendChild(this.workspace_.createDom());return this.svgGroup_};Blockly.Flyout.prototype.init=function(e){this.targetWorkspace_=e;this.workspace_.targetWorkspace=e;this.scrollbar_=new Blockly.Scrollbar(this.workspace_,this.horizontalLayout_,false,"blocklyFlyoutScrollbar");this.position();Array.prototype.push.apply(this.eventWrappers_,Blockly.bindEventWithChecks_(this.svgGroup_,"wheel",this,this.wheel_));Array.prototype.push.apply(this.eventWrappers_,Blockly.bindEventWithChecks_(this.svgGroup_,"mousedown",this,this.onMouseDown_));this.workspace_.getGesture=this.targetWorkspace_.getGesture.bind(this.targetWorkspace_);this.workspace_.variableMap_=this.targetWorkspace_.getVariableMap();this.workspace_.createPotentialVariableMap()};Blockly.Flyout.prototype.dispose=function(){this.hide();Blockly.unbindEvent_(this.eventWrappers_);if(this.scrollbar_){this.scrollbar_.dispose();this.scrollbar_=null}if(this.workspace_){this.workspace_.targetWorkspace=null;this.workspace_.dispose();this.workspace_=null}if(this.svgGroup_){goog.dom.removeNode(this.svgGroup_);this.svgGroup_=null}this.parentToolbox_=null;this.svgBackground_=null;this.targetWorkspace_=null};Blockly.Flyout.prototype.setParentToolbox=function(e){this.parentToolbox_=e};Blockly.Flyout.prototype.getWidth=function(){return this.DEFAULT_WIDTH};Blockly.Flyout.prototype.getHeight=function(){return this.height_};Blockly.Flyout.prototype.getWorkspace=function(){return this.workspace_};Blockly.Flyout.prototype.isVisible=function(){return this.isVisible_};Blockly.Flyout.prototype.setVisible=function(e){var o=e!=this.isVisible();this.isVisible_=e;if(o)this.updateDisplay_()};Blockly.Flyout.prototype.setContainerVisible=function(e){var o=e!=this.containerVisible_;this.containerVisible_=e;if(o)this.updateDisplay_()};Blockly.Flyout.prototype.updateDisplay_=function(){var e=true;if(!this.containerVisible_)e=false;else e=this.isVisible();this.svgGroup_.style.display=e?"block":"none";this.scrollbar_.setContainerVisible(e)};Blockly.Flyout.prototype.hide=function(){if(!this.isVisible())return;this.setVisible(false);for(var e=0,o;o=this.listeners_[e];e++)Blockly.unbindEvent_(o);this.listeners_.length=0;if(this.reflowWrapper_){this.workspace_.removeChangeListener(this.reflowWrapper_);this.reflowWrapper_=null}};Blockly.Flyout.prototype.show=function(e){this.workspace_.setResizesEnabled(false);this.hide();this.clearOldBlocks_();this.setVisible(true);var o=[];var t=[];this.permanentlyDisabled_.length=0;for(var i=0,r;r=e[i];i++){if("string"===typeof r){var n=this.workspace_.targetWorkspace.getToolboxCategoryCallback(e[i]);var l=n(this.workspace_.targetWorkspace);e.splice.apply(e,[i,1].concat(l));r=e[i]}if(r.tagName){var s=r.tagName.toUpperCase();var g=this.horizontalLayout_?this.GAP_X:this.GAP_Y;if("BLOCK"==s){var a=r.getAttribute("id")||r.getAttribute("type");var c=this.recycleBlocks_.findIndex((function(e){return e.id===a}));var u;if(c>-1)u=this.recycleBlocks_.splice(c,1)[0];else u=Blockly.Xml.domToBlock(r,this.workspace_);if(u.disabled)this.permanentlyDisabled_.push(u);o.push({type:"block",block:u});var h=parseInt(r.getAttribute("gap"),10);t.push(isNaN(h)?g:h)}else if("SEP"==r.tagName.toUpperCase()){var d=parseInt(r.getAttribute("gap"),10);if(!isNaN(d)&&t.length>0)t[t.length-1]=d;else t.push(g)}else if("LABEL"==s&&"true"==r.getAttribute("showStatusButton")){var p=new Blockly.FlyoutExtensionCategoryHeader(this.workspace_,this.targetWorkspace_,r);o.push({type:"button",button:p});t.push(g)}else if("BUTTON"==s||"LABEL"==s){var y="LABEL"==s;var p=new Blockly.FlyoutButton(this.workspace_,this.targetWorkspace_,r,y);o.push({type:"button",button:p});t.push(g)}}}this.emptyRecycleBlocks_();this.layout_(o,t);var f=function(){var e=this.workspace_.getTopBlocks(false);for(var o=0,t;t=e[o];o++)t.removeSelect()};this.listeners_.push(Blockly.bindEvent_(this.svgBackground_,"mouseover",this,f));this.workspace_.setResizesEnabled(true);this.reflow();this.position();this.reflowWrapper_=this.reflow.bind(this);this.workspace_.addChangeListener(this.reflowWrapper_);this.recordCategoryScrollPositions_()};Blockly.Flyout.prototype.emptyRecycleBlocks_=function(){var e=this.recycleBlocks_;this.recycleBlocks_=[];for(var o=0;o<e.length;o++)e[o].dispose(false,false)};Blockly.Flyout.prototype.recordCategoryScrollPositions_=function(){this.categoryScrollPositions=[];for(var e=0;e<this.buttons_.length;e++)if(this.buttons_[e].getIsCategoryLabel()){var o=this.buttons_[e];this.categoryScrollPositions.push({categoryName:o.getText(),position:this.horizontalLayout_?o.getPosition().x:o.getPosition().y})}var t=this.categoryScrollPositions.length;if(t>0){for(var e=0;e<t-1;e++){var i=this.categoryScrollPositions[e].position;var r=this.categoryScrollPositions[e+1].position;var n=r-i;this.categoryScrollPositions[e].length=n}this.categoryScrollPositions[t-1].length=0;for(var e=0;e<t;e++){var l=this.parentToolbox_.getCategoryByIndex(e);if(l&&l.id_)this.categoryScrollPositions[e].categoryId=l.id_}}};Blockly.Flyout.prototype.selectCategoryByScrollPosition=function(e){if(this.scrollTarget)return;var o=Math.round(e/this.workspace_.scale);for(var t=this.categoryScrollPositions.length-1;t>=0;t--)if(o>=this.categoryScrollPositions[t].position){this.parentToolbox_.selectCategoryById(this.categoryScrollPositions[t].categoryId);return}};Blockly.Flyout.prototype.stepScrollAnimation=function(){if(!this.scrollTarget)return;var e=this.horizontalLayout_?-this.workspace_.scrollX:-this.workspace_.scrollY;var o=this.scrollTarget-e;if(Math.abs(o)<1){this.scrollbar_.set(this.scrollTarget);this.scrollTarget=null;return}this.scrollbar_.set(e+o*this.scrollAnimationFraction);requestAnimationFrame(this.stepScrollAnimation.bind(this))};Blockly.Flyout.prototype.getScrollPos=function(){var e=this.horizontalLayout_?-this.workspace_.scrollX:-this.workspace_.scrollY;return e/this.workspace_.scale};Blockly.Flyout.prototype.setScrollPos=function(e){this.scrollbar_.set(e*this.workspace_.scale)};Blockly.Flyout.prototype.setRecyclingEnabled=function(e){this.recyclingEnabled_=e};Blockly.Flyout.prototype.clearOldBlocks_=function(){var e=this.workspace_.getTopBlocks(false);for(var o=0,t;t=e[o];o++)if(t.workspace==this.workspace_)if(this.recyclingEnabled_&&Blockly.scratchBlocksUtils.blockIsRecyclable(t))this.recycleBlock_(t);else t.dispose(false,false);for(var i=0;i<this.backgroundButtons_.length;i++){var r=this.backgroundButtons_[i];if(r)goog.dom.removeNode(r)}this.backgroundButtons_.length=0;for(var o=0,n;n=this.buttons_[o];o++)n.dispose();this.buttons_.length=0;this.workspace_.getPotentialVariableMap().clear()};Blockly.Flyout.prototype.addBlockListeners_=function(e,o,t){this.listeners_.push(Blockly.bindEventWithChecks_(e,"mousedown",null,this.blockMouseDown_(o)));this.listeners_.push(Blockly.bindEventWithChecks_(t,"mousedown",null,this.blockMouseDown_(o)));this.listeners_.push(Blockly.bindEvent_(e,"mouseover",o,o.addSelect));this.listeners_.push(Blockly.bindEvent_(e,"mouseout",o,o.removeSelect));this.listeners_.push(Blockly.bindEvent_(t,"mouseover",o,o.addSelect));this.listeners_.push(Blockly.bindEvent_(t,"mouseout",o,o.removeSelect))};Blockly.Flyout.prototype.blockMouseDown_=function(e){var o=this;return function(t){var i=o.targetWorkspace_.getGesture(t);if(i){i.setStartBlock(e);i.handleFlyoutStart(t,o)}}};Blockly.Flyout.prototype.onMouseDown_=function(e){var o=this.targetWorkspace_.getGesture(e);if(o)o.handleFlyoutStart(e,this)};Blockly.Flyout.prototype.createBlock=function(e){var o=null;Blockly.Events.disable();var t=this.targetWorkspace_.getAllVariables();this.targetWorkspace_.setResizesEnabled(false);try{o=this.placeNewBlock_(e);Blockly.hideChaff()}finally{Blockly.Events.enable()}var i=Blockly.Variables.getAddedVariables(this.targetWorkspace_,t);if(Blockly.Events.isEnabled()){Blockly.Events.setGroup(true);Blockly.Events.fire(new Blockly.Events.Create(o));for(var r=0;r<i.length;r++){var n=i[r];Blockly.Events.fire(new Blockly.Events.VarCreate(n))}}if(this.autoClose)this.hide();return o};Blockly.Flyout.prototype.reflow=function(){if(this.reflowWrapper_)this.workspace_.removeChangeListener(this.reflowWrapper_);var e=this.workspace_.getTopBlocks(false);this.reflowInternal_(e);if(this.reflowWrapper_)this.workspace_.addChangeListener(this.reflowWrapper_)};Blockly.Flyout.prototype.isScrollable=function(){return this.scrollbar_?this.scrollbar_.isVisible():false};Blockly.Flyout.prototype.placeNewBlock_=function(e){var o=this.targetWorkspace_;var t=e.getSvgRoot();if(!t)throw"oldBlock is not rendered.";var i=Blockly.Xml.blockToDom(e);o.setResizesEnabled(false);var r=Blockly.Xml.domToBlock(i,o);var n=r.getSvgRoot();if(!n)throw"block is not rendered.";var l=o.getOriginOffsetInPixels();var s=this.workspace_.getOriginOffsetInPixels();var g=e.getRelativeToSurfaceXY();var a=g.scale(this.workspace_.scale);var c=goog.math.Coordinate.sum(s,a);var u=goog.math.Coordinate.difference(c,l);var h=u.scale(1/o.scale);r.moveBy(h.x,h.y);return r};Blockly.Flyout.prototype.recycleBlock_=function(e){var o=e.getRelativeToSurfaceXY();e.moveBy(-o.x,-o.y);this.recycleBlocks_.push(e)};goog.provide("Blockly.VerticalFlyout");goog.require("Blockly.Block");goog.require("Blockly.Comment");goog.require("Blockly.Events");goog.require("Blockly.Flyout");goog.require("Blockly.FlyoutButton");goog.require("Blockly.utils");goog.require("Blockly.WorkspaceSvg");goog.require("goog.dom");goog.require("goog.dom.animationFrame.polyfill");goog.require("goog.events");goog.require("goog.math.Rect");goog.require("goog.userAgent");Blockly.VerticalFlyout=function(e){e.getMetrics=this.getMetrics_.bind(this);e.setMetrics=this.setMetrics_.bind(this);Blockly.VerticalFlyout.superClass_.constructor.call(this,e);this.horizontalLayout_=false;this.checkboxes_=[]};goog.inherits(Blockly.VerticalFlyout,Blockly.Flyout);Blockly.VerticalFlyout.prototype.autoClose=false;Blockly.VerticalFlyout.prototype.DEFAULT_WIDTH=250;Blockly.VerticalFlyout.prototype.CHECKBOX_SIZE=25;Blockly.VerticalFlyout.prototype.CHECKBOX_TOUCH_PADDING=12;Blockly.VerticalFlyout.prototype.CHECKMARK_PATH="M"+Blockly.VerticalFlyout.prototype.CHECKBOX_SIZE/4+" "+Blockly.VerticalFlyout.prototype.CHECKBOX_SIZE/2+"L"+5*Blockly.VerticalFlyout.prototype.CHECKBOX_SIZE/12+" "+2*Blockly.VerticalFlyout.prototype.CHECKBOX_SIZE/3+"L"+3*Blockly.VerticalFlyout.prototype.CHECKBOX_SIZE/4+" "+Blockly.VerticalFlyout.prototype.CHECKBOX_SIZE/3;Blockly.VerticalFlyout.prototype.CHECKBOX_CORNER_RADIUS=5;Blockly.VerticalFlyout.prototype.CHECKBOX_MARGIN=Blockly.Flyout.prototype.MARGIN;Blockly.VerticalFlyout.prototype.CHECKBOX_SPACE_X=Blockly.VerticalFlyout.prototype.CHECKBOX_SIZE+2*Blockly.VerticalFlyout.prototype.CHECKBOX_MARGIN;Blockly.VerticalFlyout.prototype.init=function(e){Blockly.VerticalFlyout.superClass_.init.call(this,e);this.workspace_.scale=e.scale};Blockly.VerticalFlyout.prototype.createDom=function(e){Blockly.VerticalFlyout.superClass_.createDom.call(this,e);this.defs_=Blockly.utils.createSvgElement("defs",{},this.svgGroup_);var o=Blockly.utils.createSvgElement("clipPath",{id:"blocklyBlockMenuClipPath"},this.defs_);this.clipRect_=Blockly.utils.createSvgElement("rect",{id:"blocklyBlockMenuClipRect",height:"0",width:"0",y:"0",x:"0"},o);this.workspace_.svgGroup_.setAttribute("clip-path","url(#blocklyBlockMenuClipPath)");return this.svgGroup_};Blockly.VerticalFlyout.prototype.getContentBoundingBox_=function(){var e=this.workspace_.getBlocksBoundingBox();var o={xMin:e.x,yMin:e.y,xMax:e.x+e.width,yMax:e.y+e.height};for(var t=0;t<this.buttons_.length;t++){var i=this.buttons_[t];var r=i.getPosition();if(r.x<o.xMin)o.xMin=r.x;if(r.y<o.yMin)o.yMin=r.y;if(r.x+i.width>o.xMax)o.xMax=r.x+i.width;if(r.y+i.height>o.yMax)o.yMax=r.y+i.height}return{x:o.xMin,y:o.yMin,width:o.xMax-o.xMin,height:o.yMax-o.yMin}};Blockly.VerticalFlyout.prototype.getMetrics_=function(){if(!this.isVisible())return null;var e=this.getContentBoundingBox_();var o=this.SCROLLBAR_PADDING;var t=0;var i=this.height_-2*this.SCROLLBAR_PADDING;var r=this.getWidth()-this.SCROLLBAR_PADDING;var n=e.height*this.workspace_.scale;this.recordCategoryScrollPositions_();var l=this.MARGIN;if(this.categoryScrollPositions.length>0){var s=this.categoryScrollPositions[this.categoryScrollPositions.length-1];var g=s.position*this.workspace_.scale;var a=n-g;if(a<i)l=i-a}var c={viewHeight:i,viewWidth:r,contentHeight:n+l,contentWidth:e.width*this.workspace_.scale+2*this.MARGIN,viewTop:-this.workspace_.scrollY+e.y,viewLeft:-this.workspace_.scrollX,contentTop:e.y,contentLeft:e.x,absoluteTop:o,absoluteLeft:t};return c};Blockly.VerticalFlyout.prototype.setMetrics_=function(e){var o=this.getMetrics_();if(!o)return;if(goog.isNumber(e.y))this.workspace_.scrollY=-o.contentHeight*e.y;this.workspace_.translate(this.workspace_.scrollX+o.absoluteLeft,this.workspace_.scrollY+o.absoluteTop);this.clipRect_.setAttribute("height",Math.max(0,o.viewHeight)+"px");this.clipRect_.setAttribute("width",o.viewWidth+"px");if(this.categoryScrollPositions)this.selectCategoryByScrollPosition(-this.workspace_.scrollY)};Blockly.VerticalFlyout.prototype.position=function(){if(!this.isVisible())return;var e=this.targetWorkspace_.getMetrics();if(!e)return;this.width_=this.getWidth();if(this.parentToolbox_){var o=this.parentToolbox_.getWidth();var t=o-this.width_;var i=this.toolboxPosition_==Blockly.TOOLBOX_AT_RIGHT?e.viewWidth:t;var r=0}else{var i=this.toolboxPosition_==Blockly.TOOLBOX_AT_RIGHT?e.viewWidth-this.width_:0;var r=0}this.height_=Math.max(0,e.viewHeight-r);this.setBackgroundPath_(this.width_,this.height_);this.svgGroup_.setAttribute("width",this.width_);this.svgGroup_.setAttribute("height",this.height_);var n="translate("+i+"px,"+r+"px)";Blockly.utils.setCssTransform(this.svgGroup_,n);if(this.scrollbar_){this.scrollbar_.setOrigin(i,r);this.scrollbar_.resize()}this.svgGroup_.style.opacity=1};Blockly.VerticalFlyout.prototype.setBackgroundPath_=function(e,o){var t=this.toolboxPosition_==Blockly.TOOLBOX_AT_RIGHT;var i=["M "+0+",0"];i.push("h",e);i.push("a",this.CORNER_RADIUS,this.CORNER_RADIUS,0,0,t?0:1,t?-this.CORNER_RADIUS:this.CORNER_RADIUS,this.CORNER_RADIUS);i.push("v",Math.max(0,o-2*this.CORNER_RADIUS));i.push("a",this.CORNER_RADIUS,this.CORNER_RADIUS,0,0,t?0:1,t?this.CORNER_RADIUS:-this.CORNER_RADIUS,this.CORNER_RADIUS);i.push("h",-e);i.push("z");this.svgBackground_.setAttribute("d",i.join(" "))};Blockly.VerticalFlyout.prototype.scrollToStart=function(){this.scrollbar_.set(0)};Blockly.VerticalFlyout.prototype.scrollTo=function(e){this.scrollTarget=e*this.workspace_.scale;var o=this.workspace_.getMetrics();var t=o.contentHeight;var i=o.viewHeight;this.scrollTarget=Math.min(this.scrollTarget,t-i);this.stepScrollAnimation()};Blockly.VerticalFlyout.prototype.wheel_=function(e){this.scrollTarget=null;var o=e.deltaY;if(o){if(goog.userAgent.GECKO&&1===e.deltaMode)o*=10;var t=this.getMetrics_();var i=t.viewTop-t.contentTop+o;var r=t.contentHeight-t.viewHeight;i=Math.min(i,r);i=Math.max(i,0);this.scrollbar_.set(i);Blockly.WidgetDiv.hide(true);Blockly.DropDownDiv.hideWithoutAnimation()}e.preventDefault();e.stopPropagation()};Blockly.VerticalFlyout.prototype.clearOldBlocks_=function(){Blockly.VerticalFlyout.superClass_.clearOldBlocks_.call(this);for(var e=0,o;o=this.checkboxes_[e];e++){o.block.flyoutCheckbox=null;goog.dom.removeNode(o.svgRoot)}this.checkboxes_=[]};Blockly.VerticalFlyout.prototype.addBlockListeners_=function(e,o,t){Blockly.VerticalFlyout.superClass_.addBlockListeners_.call(this,e,o,t);if(o.flyoutCheckbox)this.listeners_.push(Blockly.bindEvent_(o.flyoutCheckbox.svgRoot,"mousedown",null,this.checkboxClicked_(o.flyoutCheckbox)))};Blockly.VerticalFlyout.prototype.layout_=function(e,o){var t=this.MARGIN;var i=this.getWidth()/this.workspace_.scale;var r=t;var n=t;for(var l=0,s;s=e[l];l++)if("block"==s.type){var g=s.block;var a=g.getDescendants(false);for(var c=0,u;u=a[c];c++)u.isInFlyout=true;var h=g.getSvgRoot();var d=g.getHeightWidth();var p=g.getRelativeToSurfaceXY().x;var y=i-this.MARGIN;var f=this.RTL?y-p:t;if(g.hasCheckboxInFlyout()){this.createCheckbox_(g,r,n,d);if(this.RTL)f-=this.CHECKBOX_SIZE+this.CHECKBOX_MARGIN;else f+=this.CHECKBOX_SIZE+this.CHECKBOX_MARGIN}g.moveBy(f,n+(g.startHat_?Blockly.BlockSvg.START_HAT_HEIGHT:0));var m=this.createRect_(g,this.RTL?f-d.width:f,n,d,l);this.addBlockListeners_(h,g,m);n+=d.height+o[l]+(g.startHat_?Blockly.BlockSvg.START_HAT_HEIGHT:0)}else if("button"==s.type){var _=s.button;var v=_.createDom();if(this.RTL)_.moveTo(i-this.MARGIN-_.width,n);else _.moveTo(r,n);_.show();this.listeners_.push(Blockly.bindEventWithChecks_(v,"mousedown",this,this.onMouseDown_));this.buttons_.push(_);n+=_.height+o[l]}};Blockly.VerticalFlyout.prototype.createRect_=function(e,o,t,i,r){var n=Blockly.utils.createSvgElement("rect",{"fill-opacity":0,x:o,y:t,height:i.height,width:i.width},null);n.tooltip=e;Blockly.Tooltip.bindMouseEvents(n);this.workspace_.getCanvas().insertBefore(n,e.getSvgRoot());e.flyoutRect_=n;this.backgroundButtons_[r]=n;return n};Blockly.VerticalFlyout.prototype.createCheckbox_=function(e,o,t,i){var r=Blockly.VerticalFlyout.getCheckboxState(e.id);var n=e.getSvgRoot();var l=this.CHECKBOX_SIZE+this.CHECKBOX_MARGIN;var s=this.RTL?this.getWidth()/this.workspace_.scale-l:o;var g=t+i.height/2-this.CHECKBOX_SIZE/2;var a=this.CHECKBOX_TOUCH_PADDING;var c=Blockly.utils.createSvgElement("g",{transform:"translate("+s+", "+g+")"},null);Blockly.utils.createSvgElement("rect",{class:"blocklyFlyoutCheckbox",height:this.CHECKBOX_SIZE,width:this.CHECKBOX_SIZE,rx:this.CHECKBOX_CORNER_RADIUS,ry:this.CHECKBOX_CORNER_RADIUS},c);Blockly.utils.createSvgElement("path",{class:"blocklyFlyoutCheckboxPath",d:this.CHECKMARK_PATH},c);Blockly.utils.createSvgElement("rect",{class:"blocklyTouchTargetBackground",x:-a+"px",y:-a+"px",height:this.CHECKBOX_SIZE+2*a,width:this.CHECKBOX_SIZE+2*a},c);var u={svgRoot:c,clicked:r,block:e};if(r)Blockly.utils.addClass(u.svgRoot,"checked");e.flyoutCheckbox=u;this.workspace_.getCanvas().insertBefore(c,n);this.checkboxes_.push(u)};Blockly.VerticalFlyout.prototype.checkboxClicked_=function(e){return function(o){this.setCheckboxState(e.block.id,!e.clicked);o.stopPropagation();o.preventDefault()}.bind(this)};Blockly.VerticalFlyout.prototype.setCheckboxState=function(e,o){for(var t=0;t<this.checkboxes_.length;t++){var i=this.checkboxes_[t];if(i.block.id===e){if(i.clicked===o)return;var r=i.clicked;i.clicked=o;if(i.clicked)Blockly.utils.addClass(i.svgRoot,"checked");else Blockly.utils.removeClass(i.svgRoot,"checked");Blockly.Events.fire(new Blockly.Events.Change(i.block,"checkbox",null,r,o));return}}};Blockly.VerticalFlyout.prototype.isDragTowardWorkspace=function(e){var o=e.x;var t=e.y;var i=Math.atan2(t,o)/Math.PI*180;var r=false;var n=this.dragAngleRange_;if(this.toolboxPosition_==Blockly.TOOLBOX_AT_LEFT){if(i<n&&i>-n)r=true}else if(i<-180+n||i>180-n)r=true;return r};Blockly.VerticalFlyout.prototype.getClientRect=function(){if(!this.svgGroup_)return null;var e=this.svgGroup_.getBoundingClientRect();var o=1e9;var t=e.left;var i=e.top;var r=e.width;var n=e.height;if(this.toolboxPosition_==Blockly.TOOLBOX_AT_LEFT)return new goog.math.Rect(t-o,i,o+r,n);else return new goog.math.Rect(t,i,o+r,n)};Blockly.VerticalFlyout.prototype.reflowInternal_=function(){return};Blockly.VerticalFlyout.getCheckboxState=function(){return false};goog.provide("Blockly.FlyoutButton");goog.require("goog.dom");goog.require("goog.math.Coordinate");Blockly.FlyoutButton=function(e,o,t,i){this.init(e,o,t,i);this.callback_=null;var r=t.getAttribute("callbackKey");if(this.isLabel_&&r)console.warn("Labels should not have callbacks. Label text: "+this.text_);else if(!this.isLabel_&&!(r&&o.getButtonCallback(r)))console.warn("Buttons should have callbacks. Button text: "+this.text_);else this.callback_=o.getButtonCallback(r)};Blockly.FlyoutButton.MARGIN=40;Blockly.FlyoutButton.prototype.width=0;Blockly.FlyoutButton.prototype.height=40;Blockly.FlyoutButton.prototype.onMouseUpWrapper_=null;Blockly.FlyoutButton.prototype.init=function(e,o,t,i){this.workspace_=e;this.targetWorkspace_=o;this.text_=t.getAttribute("text");this.position_=new goog.math.Coordinate(0,0);this.isLabel_=i;this.isCategoryLabel_="true"===t.getAttribute("category-label");this.cssClass_=t.getAttribute("web-class")||null};Blockly.FlyoutButton.prototype.createDom=function(){var e=this.isLabel_?"blocklyFlyoutLabel":"blocklyFlyoutButton";if(this.cssClass_)e+=" "+this.cssClass_;this.svgGroup_=Blockly.utils.createSvgElement("g",{class:e},this.workspace_.getCanvas());this.addTextSvg(this.isLabel_);this.mouseUpWrapper_=Blockly.bindEventWithChecks_(this.svgGroup_,"mouseup",this,this.onMouseUp_);return this.svgGroup_};Blockly.FlyoutButton.prototype.addTextSvg=function(e){if(!e)var o=Blockly.utils.createSvgElement("rect",{class:"blocklyFlyoutButtonShadow",rx:4,ry:4,x:1,y:1},this.svgGroup_);var t=Blockly.utils.createSvgElement("rect",{class:e?"blocklyFlyoutLabelBackground":"blocklyFlyoutButtonBackground",rx:4,ry:4},this.svgGroup_);var i=Blockly.utils.createSvgElement("text",{class:e?"blocklyFlyoutLabelText":"blocklyText",x:0,y:0,"text-anchor":"middle"},this.svgGroup_);i.textContent=Blockly.utils.replaceMessageReferences(this.text_);this.width=Blockly.Field.getCachedWidth(i);if(!e){this.width+=2*Blockly.FlyoutButton.MARGIN;o.setAttribute("width",this.width);o.setAttribute("height",this.height)}t.setAttribute("width",this.width);t.setAttribute("height",this.height);i.setAttribute("text-anchor","middle");i.setAttribute("dominant-baseline","central");i.setAttribute("dy",goog.userAgent.EDGE_OR_IE?Blockly.Field.IE_TEXT_OFFSET:"0");i.setAttribute("x",this.width/2);i.setAttribute("y",this.height/2)};Blockly.FlyoutButton.prototype.show=function(){this.updateTransform_();this.svgGroup_.setAttribute("display","block")};Blockly.FlyoutButton.prototype.updateTransform_=function(){this.svgGroup_.setAttribute("transform","translate("+this.position_.x+","+this.position_.y+")")};Blockly.FlyoutButton.prototype.moveTo=function(e,o){this.position_.x=e;this.position_.y=o;this.updateTransform_()};Blockly.FlyoutButton.prototype.getTargetWorkspace=function(){return this.targetWorkspace_};Blockly.FlyoutButton.prototype.getIsCategoryLabel=function(){return this.isCategoryLabel_};Blockly.FlyoutButton.prototype.getText=function(){return this.text_};Blockly.FlyoutButton.prototype.getPosition=function(){return this.position_};Blockly.FlyoutButton.prototype.dispose=function(){if(this.onMouseUpWrapper_)Blockly.unbindEvent_(this.onMouseUpWrapper_);if(this.svgGroup_){goog.dom.removeNode(this.svgGroup_);this.svgGroup_=null}this.workspace_=null;this.targetWorkspace_=null};Blockly.FlyoutButton.prototype.onMouseUp_=function(e){var o=this.targetWorkspace_.getGesture(e);if(o){if(o.isDragging())return;o.cancel()}if(this.callback_)this.callback_(this)};goog.provide("Blockly.FlyoutExtensionCategoryHeader");goog.require("Blockly.FlyoutButton");Blockly.FlyoutExtensionCategoryHeader=function(e,o,t){this.init(e,o,t,false);this.flyoutWidth_=this.targetWorkspace_.getFlyout().getWidth();this.extensionId=t.getAttribute("id");this.isCategoryLabel_=true};goog.inherits(Blockly.FlyoutExtensionCategoryHeader,Blockly.FlyoutButton);Blockly.FlyoutExtensionCategoryHeader.prototype.createDom=function(){var e="blocklyFlyoutLabel";this.svgGroup_=Blockly.utils.createSvgElement("g",{class:e},this.workspace_.getCanvas());this.addTextSvg(true);this.refreshStatus();var o=30;var t=20;var i=5;var r=16;var n=this.workspace_.RTL?t-this.flyoutWidth_+o:(this.flyoutWidth_-o-t)/this.workspace_.scale;if(this.imageSrc_){this.imageElement_=Blockly.utils.createSvgElement("image",{class:"blocklyFlyoutButton",height:o+"px",width:o+"px",x:n+"px",y:i+"px"},this.svgGroup_);this.imageElementBackground_=Blockly.utils.createSvgElement("rect",{class:"blocklyTouchTargetBackground",height:o+2*r+"px",width:o+2*r+"px",x:n-r+"px",y:i-r+"px"},this.svgGroup_);this.setImageSrc(this.imageSrc_)}this.callback_=Blockly.statusButtonCallback.bind(this,this.extensionId);this.mouseUpWrapper_=Blockly.bindEventWithChecks_(this.imageElementBackground_,"mouseup",this,this.onMouseUp_);return this.svgGroup_};Blockly.FlyoutExtensionCategoryHeader.prototype.refreshStatus=function(){var e=Blockly.FlyoutExtensionCategoryHeader.getExtensionState(this.extensionId);var o=Blockly.mainWorkspace.options.pathToMedia;if(e==Blockly.StatusButtonState.READY)this.setImageSrc(o+"status-ready.svg");if(e==Blockly.StatusButtonState.NOT_READY)this.setImageSrc(o+"status-not-ready.svg")};Blockly.FlyoutExtensionCategoryHeader.prototype.setImageSrc=function(e){if(null===e)return;this.imageSrc_=e;if(this.imageElement_)this.imageElement_.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",this.imageSrc_||"")};Blockly.FlyoutExtensionCategoryHeader.getExtensionState=function(){return Blockly.StatusButtonState.NOT_READY};goog.provide("Blockly.Generator");goog.require("Blockly.Block");goog.require("goog.asserts");Blockly.Generator=function(e){this.name_=e;this.FUNCTION_NAME_PLACEHOLDER_REGEXP_=new RegExp(this.FUNCTION_NAME_PLACEHOLDER_,"g")};Blockly.Generator.NAME_TYPE="generated_function";Blockly.Generator.prototype.INFINITE_LOOP_TRAP=null;Blockly.Generator.prototype.STATEMENT_PREFIX=null;Blockly.Generator.prototype.INDENT="  ";Blockly.Generator.prototype.COMMENT_WRAP=60;Blockly.Generator.prototype.ORDER_OVERRIDES=[];Blockly.Generator.prototype.workspaceToCode=function(e){if(!e){console.warn("No workspace specified in workspaceToCode call.  Guessing.");e=Blockly.getMainWorkspace()}var o=[];this.init(e);var t=e.getTopBlocks(true);for(var i=0,r;r=t[i];i++){var n=this.blockToCode(r);if(goog.isArray(n))n=n[0];if(n){if(r.outputConnection&&this.scrubNakedValue)n=this.scrubNakedValue(n);o.push(n)}}o=o.join("\n");o=this.finish(o);o=o.replace(/^\s+\n/,"");o=o.replace(/\n\s+$/,"\n");o=o.replace(/[ \t]+\n/g,"\n");return o};Blockly.Generator.prototype.prefixLines=function(e,o){return o+e.replace(/(?!\n$)\n/g,"\n"+o)};Blockly.Generator.prototype.allNestedComments=function(e){var o=[];var t=e.getDescendants(true);for(var i=0;i<t.length;i++){var r=t[i].getCommentText();if(r)o.push(r)}if(o.length)o.push("");return o.join("\n")};Blockly.Generator.prototype.blockToCode=function(e){if(!e)return"";if(e.disabled)return this.blockToCode(e.getNextBlock());var o=this[e.type];if(!o&&Blockly.Generator.getDynamicFunc)o=Blockly.Generator.getDynamicFunc(e.type);goog.asserts.assertFunction(o,'Language "%s" does not know how to generate code for block type "%s".',this.name_,e.type);var t=o.call(e,e);if(goog.isArray(t)){goog.asserts.assert(e.outputConnection,'Expecting string from statement block "%s".',e.type);return[this.scrub_(e,t[0]),t[1]]}else if(goog.isString(t)){var i=e.id.replace(/\$/g,"$$$$");if(this.STATEMENT_PREFIX)t=this.STATEMENT_PREFIX.replace(/%1/g,"'"+i+"'")+t;return this.scrub_(e,t)}else if(null===t)return"";else goog.asserts.fail("Invalid code generated: %s",t)};Blockly.Generator.prototype.valueToCode=function(e,o,t){if(isNaN(t))goog.asserts.fail('Expecting valid order from block "%s".',e.type);var i=e.getInputTargetBlock(o);if(!i)return"";var r=this.blockToCode(i);if(""===r)return"";goog.asserts.assertArray(r,'Expecting tuple from value block "%s".',i.type);var n=r[0];var l=r[1];if(isNaN(l))goog.asserts.fail('Expecting valid order from value block "%s".',i.type);if(!n)return"";var s=false;var g=Math.floor(t);var a=Math.floor(l);if(g<=a)if(g==a&&(0==g||99==g));else{s=true;for(var c=0;c<this.ORDER_OVERRIDES.length;c++)if(this.ORDER_OVERRIDES[c][0]==t&&this.ORDER_OVERRIDES[c][1]==l){s=false;break}}if(s)n="("+n+")";return n};Blockly.Generator.prototype.statementToCode=function(e,o){var t=e.getInputTargetBlock(o);var i=this.blockToCode(t);goog.asserts.assertString(i,'Expecting code from statement block "%s".',t&&t.type);if(i)i=this.prefixLines(i,this.INDENT);return i};Blockly.Generator.prototype.addLoopTrap=function(e,o){o=o.replace(/\$/g,"$$$$");if(this.INFINITE_LOOP_TRAP)e=this.INFINITE_LOOP_TRAP.replace(/%1/g,"'"+o+"'")+e;if(this.STATEMENT_PREFIX)e+=this.prefixLines(this.STATEMENT_PREFIX.replace(/%1/g,"'"+o+"'"),this.INDENT);return e};Blockly.Generator.prototype.RESERVED_WORDS_="";Blockly.Generator.prototype.addReservedWords=function(e){this.RESERVED_WORDS_+=e+","};Blockly.Generator.prototype.FUNCTION_NAME_PLACEHOLDER_="{leCUI8hutHZI4480Dc}";Blockly.Generator.prototype.provideFunction_=function(e,o){if(!this.definitions_[e]){var t=this.variableDB_.getDistinctName(e,Blockly.Procedures.NAME_TYPE);this.functionNames_[e]=t;var i=o.join("\n").replace(this.FUNCTION_NAME_PLACEHOLDER_REGEXP_,t);var r;while(r!=i){r=i;i=i.replace(/^(( {2})*) {2}/gm,"$1\0")}i=i.replace(/\0/g,this.INDENT);this.definitions_[e]=i}return this.functionNames_[e]};Blockly.Generator.prototype.init=function(e){};Blockly.Generator.prototype.scrub_=function(e,o){return o};Blockly.Generator.prototype.finish=function(e){return e};Blockly.Generator.prototype.scrubNakedValue=function(e){return e};goog.provide("Blockly.Gesture");goog.require("Blockly.BlockAnimations");goog.require("Blockly.BlockDragger");goog.require("Blockly.BubbleDragger");goog.require("Blockly.constants");goog.require("Blockly.Events.Ui");goog.require("Blockly.FlyoutDragger");goog.require("Blockly.scratchBlocksUtils");goog.require("Blockly.Tooltip");goog.require("Blockly.Touch");goog.require("Blockly.WorkspaceDragger");goog.require("goog.asserts");goog.require("goog.math.Coordinate");Blockly.Gesture=function(e,o){this.mouseDownXY_=null;this.currentDragDeltaXY_=null;this.startBubble_=null;this.startField_=null;this.startBlock_=null;this.targetBlock_=null;this.startWorkspace_=null;this.creatorWorkspace_=o;this.hasExceededDragRadius_=false;this.isDraggingWorkspace_=false;this.isDraggingBlock_=false;this.isDraggingBubble_=false;this.mostRecentEvent_=e;this.onMoveWrapper_=null;this.onUpWrapper_=null;this.bubbleDragger_=null;this.blockDragger_=null;this.workspaceDragger_=null;this.flyout_=null;this.calledUpdateIsDragging_=false;this.hasStarted_=false;this.isEnding_=false;this.shouldDuplicateOnDrag_=false};Blockly.Gesture.prototype.dispose=function(){Blockly.Touch.clearTouchIdentifier();Blockly.Tooltip.unblock();this.creatorWorkspace_.clearGesture();if(this.onMoveWrapper_)Blockly.unbindEvent_(this.onMoveWrapper_);if(this.onUpWrapper_)Blockly.unbindEvent_(this.onUpWrapper_);this.startField_=null;this.startBlock_=null;this.targetBlock_=null;this.startWorkspace_=null;this.flyout_=null;if(this.blockDragger_){this.blockDragger_.dispose();this.blockDragger_=null}if(this.workspaceDragger_){this.workspaceDragger_.dispose();this.workspaceDragger_=null}if(this.bubbleDragger_){this.bubbleDragger_.dispose();this.bubbleDragger_=null}};Blockly.Gesture.prototype.updateFromEvent_=function(e){var o=new goog.math.Coordinate(e.clientX,e.clientY);var t=this.updateDragDelta_(o);if(t){this.updateIsDragging_();Blockly.longStop_()}this.mostRecentEvent_=e};Blockly.Gesture.prototype.updateDragDelta_=function(e){this.currentDragDeltaXY_=goog.math.Coordinate.difference(e,this.mouseDownXY_);if(!this.hasExceededDragRadius_){var o=goog.math.Coordinate.magnitude(this.currentDragDeltaXY_);var t=this.flyout_?Blockly.FLYOUT_DRAG_RADIUS:Blockly.DRAG_RADIUS;this.hasExceededDragRadius_=o>t;return this.hasExceededDragRadius_}return false};Blockly.Gesture.prototype.updateIsDraggingFromFlyout_=function(){if(this.targetBlock_.disabled)return false;if(!this.flyout_.isScrollable()||this.flyout_.isDragTowardWorkspace(this.currentDragDeltaXY_)){this.startWorkspace_=this.flyout_.targetWorkspace_;this.startWorkspace_.updateScreenCalculationsIfScrolled();if(!Blockly.Events.getGroup())Blockly.Events.setGroup(true);this.startBlock_=null;this.targetBlock_=this.flyout_.createBlock(this.targetBlock_);this.targetBlock_.select();return true}return false};Blockly.Gesture.prototype.updateIsDraggingBubble_=function(){if(!this.startBubble_)return false;this.isDraggingBubble_=true;this.startDraggingBubble_();return true};Blockly.Gesture.prototype.updateIsDraggingBlock_=function(){if(!this.targetBlock_)return false;if(this.flyout_)this.isDraggingBlock_=this.updateIsDraggingFromFlyout_();else if(this.targetBlock_.isMovable()||this.shouldDuplicateOnDrag_)this.isDraggingBlock_=true;if(this.isDraggingBlock_){this.startDraggingBlock_();return true}return false};Blockly.Gesture.prototype.updateIsDraggingWorkspace_=function(){var e=this.flyout_?this.flyout_.isScrollable():this.startWorkspace_&&this.startWorkspace_.isDraggable();if(!e)return;if(this.flyout_)this.workspaceDragger_=new Blockly.FlyoutDragger(this.flyout_);else this.workspaceDragger_=new Blockly.WorkspaceDragger(this.startWorkspace_);this.isDraggingWorkspace_=true;this.workspaceDragger_.startDrag()};Blockly.Gesture.prototype.updateIsDragging_=function(){goog.asserts.assert(!this.calledUpdateIsDragging_,"updateIsDragging_ should only be called once per gesture.");this.calledUpdateIsDragging_=true;if(this.updateIsDraggingBubble_())return;if(this.updateIsDraggingBlock_())return;this.updateIsDraggingWorkspace_()};Blockly.Gesture.prototype.startDraggingBlock_=function(){if(this.shouldDuplicateOnDrag_)this.duplicateOnDrag_();this.blockDragger_=new Blockly.BlockDragger(this.targetBlock_,this.startWorkspace_);this.blockDragger_.startBlockDrag(this.currentDragDeltaXY_);this.blockDragger_.dragBlock(this.mostRecentEvent_,this.currentDragDeltaXY_)};Blockly.Gesture.prototype.startDraggingBubble_=function(){this.bubbleDragger_=new Blockly.BubbleDragger(this.startBubble_,this.startWorkspace_);this.bubbleDragger_.startBubbleDrag();this.bubbleDragger_.dragBubble(this.mostRecentEvent_,this.currentDragDeltaXY_)};Blockly.Gesture.prototype.doStart=function(e){if(Blockly.utils.isTargetInput(e)){this.cancel();return}this.hasStarted_=true;Blockly.BlockAnimations.disconnectUiStop();this.startWorkspace_.updateScreenCalculationsIfScrolled();if(this.startWorkspace_.isMutator)this.startWorkspace_.resize();this.startWorkspace_.markFocused();this.mostRecentEvent_=e;Blockly.hideChaff(!!this.flyout_);Blockly.Tooltip.block();if(this.targetBlock_)this.targetBlock_.select();if(Blockly.utils.isRightButton(e)){this.handleRightClick(e);return}if(goog.string.caseInsensitiveEquals(e.type,"touchstart"))Blockly.longStart_(e,this);this.mouseDownXY_=new goog.math.Coordinate(e.clientX,e.clientY);this.currentDragDeltaXY_=new goog.math.Coordinate(0,0);this.bindMouseEvents(e)};Blockly.Gesture.prototype.bindMouseEvents=function(e){this.onMoveWrapper_=Blockly.bindEventWithChecks_(document,"mousemove",null,this.handleMove.bind(this));this.onUpWrapper_=Blockly.bindEventWithChecks_(document,"mouseup",null,this.handleUp.bind(this));e.preventDefault();e.stopPropagation()};Blockly.Gesture.prototype.handleMove=function(e){var o=true;this.updateFromEvent_(e);if(this.isDraggingWorkspace_)this.workspaceDragger_.drag(this.currentDragDeltaXY_);else if(this.isDraggingBlock_){if(this.blockDragger_.dragBlock(this.mostRecentEvent_,this.currentDragDeltaXY_))o=false}else if(this.isDraggingBubble_)this.bubbleDragger_.dragBubble(this.mostRecentEvent_,this.currentDragDeltaXY_);if(o){e.preventDefault();e.stopPropagation()}};Blockly.Gesture.prototype.handleUp=function(e){this.updateFromEvent_(e);Blockly.longStop_();if(this.isEnding_)return;this.isEnding_=true;if(this.isDraggingBubble_)this.bubbleDragger_.endBubbleDrag(e,this.currentDragDeltaXY_);else if(this.isDraggingBlock_)this.blockDragger_.endBlockDrag(e,this.currentDragDeltaXY_);else if(this.isDraggingWorkspace_)this.workspaceDragger_.endDrag(this.currentDragDeltaXY_);else if(this.isBubbleClick_())this.doBubbleClick_();else if(this.isFieldClick_())this.doFieldClick_();else if(this.isBlockClick_())this.doBlockClick_();else if(this.isWorkspaceClick_())this.doWorkspaceClick_();e.preventDefault();e.stopPropagation();this.dispose()};Blockly.Gesture.prototype.cancel=function(){if(this.isEnding_){console.log("Trying to cancel a gesture recursively.");return}this.isEnding_=true;Blockly.longStop_();if(this.isDraggingBubble_)this.bubbleDragger_.endBubbleDrag(this.mostRecentEvent_,this.currentDragDeltaXY_);else if(this.isDraggingBlock_)this.blockDragger_.endBlockDrag(this.mostRecentEvent_,this.currentDragDeltaXY_);else if(this.isDraggingWorkspace_)this.workspaceDragger_.endDrag(this.currentDragDeltaXY_);this.dispose()};Blockly.Gesture.prototype.handleRightClick=function(e){if(this.targetBlock_){this.bringBlockToFront_();Blockly.hideChaff(this.flyout_);this.targetBlock_.showContextMenu_(e)}else if(this.startBubble_)this.startBubble_.showContextMenu_(e);else if(this.startWorkspace_&&!this.flyout_){Blockly.hideChaff();this.startWorkspace_.showContextMenu_(e)}e.preventDefault();e.stopPropagation();this.dispose()};Blockly.Gesture.prototype.handleWsStart=function(e,o){goog.asserts.assert(!this.hasStarted_,"Tried to call gesture.handleWsStart, but the gesture had already been "+"started.");this.setStartWorkspace_(o);this.mostRecentEvent_=e;this.doStart(e)};Blockly.Gesture.prototype.handleFlyoutStart=function(e,o){goog.asserts.assert(!this.hasStarted_,"Tried to call gesture.handleFlyoutStart, but the gesture had already "+"been started.");this.setStartFlyout_(o);this.handleWsStart(e,o.getWorkspace())};Blockly.Gesture.prototype.handleBlockStart=function(e,o){goog.asserts.assert(!this.hasStarted_,"Tried to call gesture.handleBlockStart, but the gesture had already "+"been started.");this.setStartBlock(o);this.mostRecentEvent_=e};Blockly.Gesture.prototype.handleBubbleStart=function(e,o){goog.asserts.assert(!this.hasStarted_,"Tried to call gesture.handleBubbleStart, but the gesture had already "+"been started.");this.setStartBubble(o);this.mostRecentEvent_=e};Blockly.Gesture.prototype.doBubbleClick_=function(){this.startBubble_.setFocus&&this.startBubble_.setFocus();this.startBubble_.select&&this.startBubble_.select()};Blockly.Gesture.prototype.doFieldClick_=function(){this.startField_.showEditor_();this.bringBlockToFront_()};Blockly.Gesture.prototype.doBlockClick_=function(){if(this.flyout_&&this.flyout_.autoClose){if(!this.targetBlock_.disabled){if(!Blockly.Events.getGroup())Blockly.Events.setGroup(true);var e=this.flyout_.createBlock(this.targetBlock_);e.scheduleSnapAndBump()}}else{var o=Blockly.WidgetDiv.isVisible()||Blockly.DropDownDiv.isVisible();if(!o){Blockly.Events.fire(new Blockly.Events.Ui(this.startBlock_,"click",void 0,void 0));var t=this.startBlock_.getRootBlock();Blockly.Events.fire(new Blockly.Events.Ui(t,"stackclick",void 0,void 0))}}this.bringBlockToFront_();Blockly.Events.setGroup(false)};Blockly.Gesture.prototype.doWorkspaceClick_=function(){if(Blockly.selected)Blockly.selected.unselect()};Blockly.Gesture.prototype.bringBlockToFront_=function(){if(this.targetBlock_&&!this.flyout_)this.targetBlock_.bringToFront()};Blockly.Gesture.prototype.setStartField=function(e){goog.asserts.assert(!this.hasStarted_,"Tried to call gesture.setStartField, but the gesture had already been "+"started.");if(!this.startField_)this.startField_=e};Blockly.Gesture.prototype.setStartBubble=function(e){if(!this.startBubble_)this.startBubble_=e};Blockly.Gesture.prototype.setStartBlock=function(e){if(!this.startBlock_&&!this.startBubble_){this.startBlock_=e;this.shouldDuplicateOnDrag_=Blockly.scratchBlocksUtils.isShadowArgumentReporter(e);if(e.isInFlyout&&e!=e.getRootBlock())this.setTargetBlock_(e.getRootBlock());else this.setTargetBlock_(e)}};Blockly.Gesture.prototype.setTargetBlock_=function(e){if(e.isShadow()&&!this.shouldDuplicateOnDrag_)this.setTargetBlock_(e.getParent());else this.targetBlock_=e};Blockly.Gesture.prototype.setStartWorkspace_=function(e){if(!this.startWorkspace_)this.startWorkspace_=e};Blockly.Gesture.prototype.setStartFlyout_=function(e){if(!this.flyout_)this.flyout_=e};Blockly.Gesture.prototype.isBubbleClick_=function(){var e=!!this.startBubble_;return e&&!this.hasExceededDragRadius_};Blockly.Gesture.prototype.isBlockClick_=function(){var e=!!this.startBlock_;return e&&!this.hasExceededDragRadius_&&!this.isFieldClick_()};Blockly.Gesture.prototype.isFieldClick_=function(){var e=this.startField_?this.startField_.isCurrentlyEditable():false;return e&&!this.hasExceededDragRadius_};Blockly.Gesture.prototype.isWorkspaceClick_=function(){var e=!this.startBlock_&&!this.startBubble_&&!this.startField_;return e&&!this.hasExceededDragRadius_};Blockly.Gesture.prototype.isDragging=function(){return this.isDraggingWorkspace_||this.isDraggingBlock_||this.isDraggingBubble_};Blockly.Gesture.prototype.hasStarted=function(){return this.hasStarted_};Blockly.Gesture.prototype.forceStartBlockDrag=function(e,o){this.handleBlockStart(e,o);this.handleWsStart(e,o.workspace);this.isDraggingBlock_=true;this.hasExceededDragRadius_=true;this.startDraggingBlock_()};Blockly.Gesture.prototype.duplicateOnDrag_=function(){var e=null;Blockly.Events.disable();try{this.startWorkspace_.setResizesEnabled(false);var o=Blockly.Xml.blockToDom(this.targetBlock_);e=Blockly.Xml.domToBlock(o,this.startWorkspace_);var t=this.targetBlock_.getRelativeToSurfaceXY();e.moveBy(t.x,t.y);e.setShadow(false)}finally{Blockly.Events.enable()}if(!e){console.error("Something went wrong while duplicating a block.");return}if(Blockly.Events.isEnabled())Blockly.Events.fire(new Blockly.Events.BlockCreate(e));e.select();this.targetBlock_=e};goog.provide("Blockly.Grid");goog.require("Blockly.utils");goog.require("goog.userAgent");Blockly.Grid=function(e,o){this.gridPattern_=e;this.spacing_=o["spacing"];this.length_=o["length"];this.line1_=e.firstChild;this.line2_=this.line1_&&this.line1_.nextSibling;this.snapToGrid_=o["snap"]};Blockly.Grid.prototype.scale_=1;Blockly.Grid.prototype.dispose=function(){this.gridPattern_=null};Blockly.Grid.prototype.shouldSnap=function(){return this.snapToGrid_};Blockly.Grid.prototype.getSpacing=function(){return this.spacing_};Blockly.Grid.prototype.getPatternId=function(){return this.gridPattern_.id};Blockly.Grid.prototype.update=function(e){this.scale_=e;var o=this.spacing_*e||100;this.gridPattern_.setAttribute("width",o);this.gridPattern_.setAttribute("height",o);var t=Math.floor(this.spacing_/2)+.5;var i=t-this.length_/2;var r=t+this.length_/2;t*=e;i*=e;r*=e;this.setLineAttributes_(this.line1_,e,i,r,t,t);this.setLineAttributes_(this.line2_,e,t,t,i,r)};Blockly.Grid.prototype.setLineAttributes_=function(e,o,t,i,r,n){if(e){e.setAttribute("stroke-width",o);e.setAttribute("x1",t);e.setAttribute("y1",r);e.setAttribute("x2",i);e.setAttribute("y2",n)}};Blockly.Grid.prototype.moveTo=function(e,o){this.gridPattern_.setAttribute("x",e);this.gridPattern_.setAttribute("y",o);if(goog.userAgent.IE||goog.userAgent.EDGE)this.update(this.scale_)};Blockly.Grid.createDom=function(e,o,t){var i=Blockly.utils.createSvgElement("pattern",{id:"blocklyGridPattern"+e,patternUnits:"userSpaceOnUse"},t);if(o["length"]>0&&o["spacing"]>0){Blockly.utils.createSvgElement("line",{stroke:o["colour"]},i);if(o["length"]>1)Blockly.utils.createSvgElement("line",{stroke:o["colour"]},i)}else Blockly.utils.createSvgElement("line",{},i);return i};goog.provide("Blockly.inject");goog.require("Blockly.BlockDragSurfaceSvg");goog.require("Blockly.Css");goog.require("Blockly.constants");goog.require("Blockly.DropDownDiv");goog.require("Blockly.Grid");goog.require("Blockly.Options");goog.require("Blockly.WorkspaceSvg");goog.require("Blockly.WorkspaceDragSurfaceSvg");goog.require("goog.dom");goog.require("goog.ui.Component");goog.require("goog.userAgent");Blockly.inject=function(e,o){if(goog.isString(e))e=document.getElementById(e)||document.querySelector(e);if(!goog.dom.contains(document,e))throw"Error: container is not in current document.";var t=new Blockly.Options(o||{});var i=goog.dom.createDom("div","injectionDiv");e.appendChild(i);Blockly.Field.startCache();var r=Blockly.createDom_(i,t);var n=new Blockly.BlockDragSurfaceSvg(i);var l=new Blockly.WorkspaceDragSurfaceSvg(i);var s=Blockly.createMainWorkspace_(r,t,n,l);Blockly.init_(s);Blockly.mainWorkspace=s;Blockly.svgResize(s);return s};Blockly.createDom_=function(e,o){e.setAttribute("dir","LTR");goog.ui.Component.setDefaultRightToLeft(o.RTL);Blockly.Css.inject(o.hasCss,o.pathToMedia);var t=Blockly.utils.createSvgElement("svg",{xmlns:"http://www.w3.org/2000/svg","xmlns:html":"http://www.w3.org/1999/xhtml","xmlns:xlink":"http://www.w3.org/1999/xlink",version:"1.1",class:"blocklySvg"},e);var i=Blockly.utils.createSvgElement("defs",{},t);var r=String(Math.random()).substring(2);var n=Blockly.utils.createSvgElement("filter",{id:"blocklyStackGlowFilter"+r,height:"160%",width:"180%",y:"-30%",x:"-40%"},i);o.stackGlowBlur=Blockly.utils.createSvgElement("feGaussianBlur",{in:"SourceGraphic",stdDeviation:Blockly.Colours.stackGlowSize},n);var l=Blockly.utils.createSvgElement("feComponentTransfer",{result:"outBlur"},n);Blockly.utils.createSvgElement("feFuncA",{type:"table",tableValues:"0"+goog.string.repeat(" 1",16)},l);Blockly.utils.createSvgElement("feFlood",{"flood-color":Blockly.Colours.stackGlow,"flood-opacity":Blockly.Colours.stackGlowOpacity,result:"outColor"},n);Blockly.utils.createSvgElement("feComposite",{in:"outColor",in2:"outBlur",operator:"in",result:"outGlow"},n);Blockly.utils.createSvgElement("feComposite",{in:"SourceGraphic",in2:"outGlow",operator:"over"},n);var s=Blockly.utils.createSvgElement("filter",{id:"blocklyReplacementGlowFilter"+r,height:"160%",width:"180%",y:"-30%",x:"-40%"},i);Blockly.utils.createSvgElement("feGaussianBlur",{in:"SourceGraphic",stdDeviation:Blockly.Colours.replacementGlowSize},s);var l=Blockly.utils.createSvgElement("feComponentTransfer",{result:"outBlur"},s);Blockly.utils.createSvgElement("feFuncA",{type:"table",tableValues:"0"+goog.string.repeat(" 1",16)},l);Blockly.utils.createSvgElement("feFlood",{"flood-color":Blockly.Colours.replacementGlow,"flood-opacity":Blockly.Colours.replacementGlowOpacity,result:"outColor"},s);Blockly.utils.createSvgElement("feComposite",{in:"outColor",in2:"outBlur",operator:"in",result:"outGlow"},s);Blockly.utils.createSvgElement("feComposite",{in:"SourceGraphic",in2:"outGlow",operator:"over"},s);var g=Blockly.utils.createSvgElement("pattern",{id:"blocklyDisabledPattern"+r,patternUnits:"userSpaceOnUse",width:10,height:10},i);Blockly.utils.createSvgElement("rect",{width:10,height:10,fill:"#aaa"},g);Blockly.utils.createSvgElement("path",{d:"M 0 0 L 10 10 M 10 0 L 0 10",stroke:"#cc0"},g);o.stackGlowFilterId=n.id;o.replacementGlowFilterId=s.id;o.disabledPatternId=g.id;o.gridPattern=Blockly.Grid.createDom(r,o.gridOptions,i);return t};Blockly.createMainWorkspace_=function(e,o,t,i){o.parentWorkspace=null;var r=new Blockly.WorkspaceSvg(o,t,i);r.scale=o.zoomOptions.startScale;e.appendChild(r.createDom("blocklyMainBackground"));if(!o.hasCategories&&o.languageTree){var n=r.addFlyout_("svg");Blockly.utils.insertAfter(n,e)}r.translate(0,0);Blockly.mainWorkspace=r;if(!o.readOnly&&!o.hasScrollbars){var l=function(){if(!r.isDragging()){var e=r.getMetrics();var t=e.viewLeft+e.absoluteLeft;var i=e.viewTop+e.absoluteTop;if(e.contentTop<i||e.contentTop+e.contentHeight>e.viewHeight+i||e.contentLeft<(o.RTL?e.viewLeft:t)||e.contentLeft+e.contentWidth>(o.RTL?e.viewWidth:e.viewWidth+t)){var n=25;var l=r.getTopBlocks(false);for(var s=0,g;g=l[s];s++){var a=g.getRelativeToSurfaceXY();var c=g.getHeightWidth();var u=i+n-c.height-a.y;if(u>0)g.moveBy(0,u);var h=i+e.viewHeight-n-a.y;if(h<0)g.moveBy(0,h);var d=n+t-a.x-(o.RTL?0:c.width);if(d>0)g.moveBy(d,0);var p=t+e.viewWidth-n-a.x+(o.RTL?c.width:0);if(p<0)g.moveBy(p,0)}}}};r.addChangeListener(l)}Blockly.svgResize(r);Blockly.WidgetDiv.createDom();Blockly.DropDownDiv.createDom();Blockly.Tooltip.createDom();return r};Blockly.init_=function(e){var o=e.options;var t=e.getParentSvg();Blockly.bindEventWithChecks_(t.parentNode,"contextmenu",null,(function(e){if(!Blockly.utils.isTargetInput(e))e.preventDefault()}));var i=Blockly.bindEventWithChecks_(window,"resize",null,(function(){Blockly.hideChaffOnResize(true);Blockly.svgResize(e)}));e.setResizeHandlerWrapper(i);Blockly.inject.bindDocumentEvents_();if(o.languageTree)if(e.toolbox_)e.toolbox_.init(e);else if(e.flyout_){e.flyout_.init(e);e.flyout_.show(o.languageTree.childNodes);e.flyout_.scrollToStart();if(o.horizontalLayout){e.scrollY=e.flyout_.height_;if(o.toolboxPosition==Blockly.TOOLBOX_AT_BOTTOM)e.scrollY*=-1}else{e.scrollX=e.flyout_.width_;if(o.toolboxPosition==Blockly.TOOLBOX_AT_RIGHT)e.scrollX*=-1}e.translate(e.scrollX,e.scrollY)}if(o.hasScrollbars){e.scrollbar=new Blockly.ScrollbarPair(e);e.scrollbar.resize()}if(o.hasSounds)Blockly.inject.loadSounds_(o.pathToMedia,e)};Blockly.inject.bindDocumentEvents_=function(){if(!Blockly.documentEventsBound_){Blockly.bindEventWithChecks_(document,"keydown",null,Blockly.onKeyDown_);Blockly.bindEvent_(document,"touchend",null,Blockly.longStop_);Blockly.bindEvent_(document,"touchcancel",null,Blockly.longStop_);if(goog.userAgent.IPAD)Blockly.bindEventWithChecks_(window,"orientationchange",document,(function(){Blockly.svgResize(Blockly.getMainWorkspace())}))}Blockly.documentEventsBound_=true};Blockly.inject.loadSounds_=function(e,o){var t=o.getAudioManager();t.load([e+"click.mp3",e+"click.wav",e+"click.ogg"],"click");t.load([e+"delete.mp3",e+"delete.ogg",e+"delete.wav"],"delete");var i=[];var r=function(){while(i.length)Blockly.unbindEvent_(i.pop());t.preload()};i.push(Blockly.bindEventWithChecks_(document,"mousemove",null,r,true));i.push(Blockly.bindEventWithChecks_(document,"touchstart",null,r,true))};Blockly.updateToolbox=function(e){console.warn("Deprecated call to Blockly.updateToolbox, "+"use workspace.updateToolbox instead.");Blockly.getMainWorkspace().updateToolbox(e)};goog.provide("Blockly.Input");goog.require("Blockly.Connection");goog.require("Blockly.FieldLabel");goog.require("goog.asserts");Blockly.Input=function(e,o,t,i){if(e!=Blockly.DUMMY_INPUT&&!o)throw"Value inputs and statement inputs must have non-empty name.";this.type=e;this.name=o;this.sourceBlock_=t;this.connection=i;this.fieldRow=[];this.outlinePath=null};Blockly.Input.prototype.align=Blockly.ALIGN_LEFT;Blockly.Input.prototype.visible_=true;Blockly.Input.prototype.appendField=function(e,o){this.insertFieldAt(this.fieldRow.length,e,o);return this};Blockly.Input.prototype.insertFieldAt=function(e,o,t){if(e<0||e>this.fieldRow.length)throw new Error("index "+e+" out of bounds.");if(!o&&!t)return this;if(goog.isString(o))o=new Blockly.FieldLabel(o);o.setSourceBlock(this.sourceBlock_);if(this.sourceBlock_.rendered)o.init();o.name=t;if(o.prefixField)e=this.insertFieldAt(e,o.prefixField);this.fieldRow.splice(e,0,o);++e;if(o.suffixField)e=this.insertFieldAt(e,o.suffixField);if(this.sourceBlock_.rendered){this.sourceBlock_.render();this.sourceBlock_.bumpNeighbours_()}return e};Blockly.Input.prototype.removeField=function(e){for(var o=0,t;t=this.fieldRow[o];o++)if(t.name===e){t.dispose();this.fieldRow.splice(o,1);if(this.sourceBlock_.rendered){this.sourceBlock_.render();this.sourceBlock_.bumpNeighbours_()}return}goog.asserts.fail('Field "%s" not found.',e)};Blockly.Input.prototype.isVisible=function(){return this.visible_};Blockly.Input.prototype.setVisible=function(e){var o=[];if(this.visible_==e)return o;this.visible_=e;var t=e?"block":"none";for(var i=0,r;r=this.fieldRow[i];i++)r.setVisible(e);if(this.connection){if(e)o=this.connection.unhideAll();else this.connection.hideAll();var n=this.connection.targetBlock();if(n){n.getSvgRoot().style.display=t;if(!e)n.rendered=false}}return o};Blockly.Input.prototype.setCheck=function(e){if(!this.connection)throw"This input does not have a connection.";this.connection.setCheck(e);return this};Blockly.Input.prototype.setAlign=function(e){this.align=e;if(this.sourceBlock_.rendered)this.sourceBlock_.render();return this};Blockly.Input.prototype.init=function(){if(!this.sourceBlock_.workspace.rendered)return;for(var e=0;e<this.fieldRow.length;e++)this.fieldRow[e].init(this.sourceBlock_)};Blockly.Input.prototype.dispose=function(){if(this.outlinePath)goog.dom.removeNode(this.outlinePath);for(var e=0,o;o=this.fieldRow[e];e++)o.dispose();if(this.connection)this.connection.dispose();this.sourceBlock_=null};Blockly.Input.prototype.initOutlinePath=function(e){if(!this.sourceBlock_.workspace.rendered)return;if(this.outlinePath)return;if(this.type==Blockly.INPUT_VALUE)this.outlinePath=Blockly.utils.createSvgElement("path",{class:"blocklyPath",style:"visibility: hidden",d:""},e)};goog.provide("Blockly.InsertionMarkerManager");goog.require("Blockly.BlockAnimations");goog.require("Blockly.Events.BlockMove");goog.require("Blockly.RenderedConnection");goog.require("goog.math.Coordinate");Blockly.InsertionMarkerManager=function(e){Blockly.selected=e;this.topBlock_=e;this.workspace_=e.workspace;this.lastOnStack_=null;this.lastMarker_=null;this.firstMarker_=this.createMarkerBlock_(this.topBlock_);this.closestConnection_=null;this.localConnection_=null;this.wouldDeleteBlock_=false;this.markerConnection_=null;this.highlightingBlock_=false;this.highlightedBlock_=null;this.availableConnections_=this.initAvailableConnections_()};Blockly.InsertionMarkerManager.prototype.dispose=function(){this.topBlock_=null;this.workspace_=null;this.availableConnections_.length=0;this.closestConnection_=null;this.localConnection_=null;Blockly.Events.disable();try{if(this.firstMarker_){this.firstMarker_.dispose();this.firstMarker_=null}if(this.lastMarker_){this.lastMarker_.dispose();this.lastMarker_=null}}finally{Blockly.Events.enable()}this.highlightedBlock_=null};Blockly.InsertionMarkerManager.prototype.wouldDeleteBlock=function(){return this.wouldDeleteBlock_};Blockly.InsertionMarkerManager.prototype.applyConnections=function(){if(this.closestConnection_){Blockly.Events.disable();this.hidePreview_();Blockly.Events.enable();this.localConnection_.connect(this.closestConnection_);if(this.topBlock_.rendered){var e=this.localConnection_.isSuperior()?this.closestConnection_:this.localConnection_;Blockly.BlockAnimations.connectionUiEffect(e.getSourceBlock());var o=this.topBlock_.getRootBlock();o.bringToFront()}}};Blockly.InsertionMarkerManager.prototype.update=function(e,o){var t=this.getCandidate_(e);this.wouldDeleteBlock_=this.shouldDelete_(t,o);var i=this.wouldDeleteBlock_||this.shouldUpdatePreviews_(t,e);if(i){Blockly.Events.disable();this.maybeHidePreview_(t);this.maybeShowPreview_(t);Blockly.Events.enable()}};Blockly.InsertionMarkerManager.prototype.createMarkerBlock_=function(e){var o=e.type;Blockly.Events.disable();try{var t=this.workspace_.newBlock(o);t.setInsertionMarker(true,e.width);if(e.mutationToDom){var i=e.mutationToDom();if(i)t.domToMutation(i)}t.initSvg()}finally{Blockly.Events.enable()}return t};Blockly.InsertionMarkerManager.prototype.initAvailableConnections_=function(){var e=this.topBlock_.getConnections_(false);var o=this.topBlock_.lastConnectionInStack();if(o&&o!=this.topBlock_.nextConnection){e.push(o);this.lastOnStack_=o;this.lastMarker_=this.createMarkerBlock_(o.sourceBlock_)}return e};Blockly.InsertionMarkerManager.prototype.shouldUpdatePreviews_=function(e,o){var t=e.local;var i=e.closest;var r=e.radius;if(t&&i){if(t.type==Blockly.OUTPUT_VALUE)return true;if(this.localConnection_&&this.closestConnection_){if(this.closestConnection_==i)return false;var n=this.localConnection_.x_+o.x-this.closestConnection_.x_;var l=this.localConnection_.y_+o.y-this.closestConnection_.y_;var s=Math.sqrt(n*n+l*l);return!(i&&r>s-Blockly.CURRENT_CONNECTION_PREFERENCE)}else if(!this.localConnection_&&!this.closestConnection_)return true;else console.error("Only one of localConnection_ and closestConnection_ was set.")}else return!!(this.localConnection_&&this.closestConnection_);console.error("Returning true from shouldUpdatePreviews, but it's not clear why.");return true};Blockly.InsertionMarkerManager.prototype.getCandidate_=function(e){var o=this.getStartRadius_();var t=null;var i=null;for(var r=0;r<this.availableConnections_.length;r++){var n=this.availableConnections_[r];var l=n.closest(o,e);if(l.connection){t=l.connection;i=n;o=l.radius}}return{closest:t,local:i,radius:o}};Blockly.InsertionMarkerManager.prototype.getStartRadius_=function(){if(this.closestConnection_&&this.localConnection_)return Blockly.CONNECTING_SNAP_RADIUS;return Blockly.SNAP_RADIUS};Blockly.InsertionMarkerManager.prototype.shouldReplace_=function(){var e=this.closestConnection_;var o=this.localConnection_;if(o.type==Blockly.OUTPUT_VALUE)return true;if(o==o.sourceBlock_.getFirstStatementConnection())return false;var t=!this.topBlock_.nextConnection;var i=t&&o.type==Blockly.PREVIOUS_STATEMENT&&e.isConnected();if(i)return true;return false};Blockly.InsertionMarkerManager.prototype.shouldDelete_=function(e,o){var t=e&&!!e.closest&&o!=Blockly.DELETE_AREA_TOOLBOX;var i=!!o&&!this.topBlock_.getParent()&&this.topBlock_.isDeletable();return i&&!t};Blockly.InsertionMarkerManager.prototype.maybeShowPreview_=function(e){if(this.wouldDeleteBlock_)return;var o=e.closest;var t=e.local;if(!o)return;if(o==this.closestConnection_||o.sourceBlock_.isInsertionMarker())return;this.closestConnection_=o;this.localConnection_=t;this.showPreview_()};Blockly.InsertionMarkerManager.prototype.showPreview_=function(){if(this.shouldReplace_())this.highlightBlock_();else this.connectMarker_()};Blockly.InsertionMarkerManager.prototype.maybeHidePreview_=function(e){if(!e.closest)this.hidePreview_();var o=this.closestConnection_&&this.localConnection_;var t=this.closestConnection_!=e.closest;var i=this.localConnection_!=e.local;if(o&&(t||i||this.wouldDeleteBlock_))this.hidePreview_();this.markerConnection_=null;this.closestConnection_=null;this.localConnection_=null};Blockly.InsertionMarkerManager.prototype.hidePreview_=function(){if(this.highlightingBlock_)this.unhighlightBlock_();else if(this.markerConnection_)this.disconnectMarker_()};Blockly.InsertionMarkerManager.prototype.highlightBlock_=function(){var e=this.closestConnection_;var o=this.localConnection_;if(e.targetBlock()){this.highlightedBlock_=e.targetBlock();e.targetBlock().highlightForReplacement(true)}else if(o.type==Blockly.OUTPUT_VALUE){this.highlightedBlock_=e.sourceBlock_;e.sourceBlock_.highlightShapeForInput(e,true)}this.highlightingBlock_=true};Blockly.InsertionMarkerManager.prototype.unhighlightBlock_=function(){var e=this.closestConnection_;if(e.type==Blockly.INPUT_VALUE&&!e.isConnected())this.highlightedBlock_.highlightShapeForInput(e,false);else this.highlightedBlock_.highlightForReplacement(false);this.highlightedBlock_=null;this.highlightingBlock_=false};Blockly.InsertionMarkerManager.prototype.disconnectMarker_=function(){if(!this.markerConnection_){console.log("No insertion marker connection to disconnect");return}var e=this.markerConnection_;var o=e.sourceBlock_;var t=o.nextConnection;var i=o.previousConnection;if(e==t&&!(i&&i.targetConnection))e.targetBlock().unplug(false);else if(e.type==Blockly.NEXT_STATEMENT&&e!=t){var r=e.targetConnection;r.sourceBlock_.unplug(false);var n=i?i.targetConnection:null;o.unplug(true);if(n)n.connect(r)}else o.unplug(true);if(e.targetConnection)throw"markerConnection_ still connected at the end of disconnectInsertionMarker";this.markerConnection_=null;o.getSvgRoot().setAttribute("visibility","hidden")};Blockly.InsertionMarkerManager.prototype.connectMarker_=function(){var e=this.localConnection_;var o=this.closestConnection_;var t=this.lastOnStack_&&e==this.lastOnStack_;var i=t?this.lastMarker_:this.firstMarker_;var r=i.getMatchingConnection(e.sourceBlock_,e);goog.asserts.assert(r!=this.markerConnection_,"Made it to connectMarker_ even though the marker isn't changing");i.render();i.rendered=true;i.getSvgRoot().setAttribute("visibility","visible");i.positionNewBlock(i,r,o);r.connect(o);this.markerConnection_=r};goog.provide("Blockly.Names");Blockly.Names=function(e,o){this.variablePrefix_=o||"";this.reservedDict_=Object.create(null);if(e){var t=e.split(",");for(var i=0;i<t.length;i++)this.reservedDict_[t[i]]=true}this.reset()};Blockly.Names.DEVELOPER_VARIABLE_TYPE="DEVELOPER_VARIABLE";Blockly.Names.prototype.reset=function(){this.db_=Object.create(null);this.dbReverse_=Object.create(null);this.variableMap_=null};Blockly.Names.prototype.setVariableMap=function(e){this.variableMap_=e};Blockly.Names.prototype.getNameForUserVariable_=function(e){if(!this.variableMap_){console.log("Deprecated call to Blockly.Names.prototype.getName without "+"defining a variable map. To fix, add the folowing code in your "+"generator's init() function:\n"+"Blockly.YourGeneratorName.variableDB_.setVariableMap("+"workspace.getVariableMap());");return null}var o=this.variableMap_.getVariableById(e);if(o)return o.name;else return null};Blockly.Names.prototype.getName=function(e,o){if(o==Blockly.Variables.NAME_TYPE){var t=this.getNameForUserVariable_(e);if(t)e=t}var i=e.toLowerCase()+"_"+o;var r=o==Blockly.Variables.NAME_TYPE||o==Blockly.Names.DEVELOPER_VARIABLE_TYPE;var n=r?this.variablePrefix_:"";if(i in this.db_)return n+this.db_[i];var l=this.getDistinctName(e,o);this.db_[i]=l.substr(n.length);return l};Blockly.Names.prototype.getDistinctName=function(e,o){var t=this.safeName_(e);var i="";while(this.dbReverse_[t+i]||t+i in this.reservedDict_)i=i?i+1:2;t+=i;this.dbReverse_[t]=true;var r=o==Blockly.Variables.NAME_TYPE||o==Blockly.Names.DEVELOPER_VARIABLE_TYPE;var n=r?this.variablePrefix_:"";return n+t};Blockly.Names.prototype.safeName_=function(e){if(!e)e="unnamed";else{e=encodeURI(e.replace(/ /g,"_")).replace(/[^\w]/g,"_");if(-1!="0123456789".indexOf(e[0]))e="my_"+e}return e};Blockly.Names.equals=function(e,o){return e.toLowerCase()==o.toLowerCase()};goog.provide("Blockly.Options");goog.require("Blockly.Colours");Blockly.Options=function(e){var o=!!e["readOnly"];if(o){var t=null;var i=false;var r=false;var n=false;var l=false;var s=false;var g=false}else{if(!e["toolbox"]&&Blockly.Blocks.defaultToolbox){var a=new DOMParser;var c=a.parseFromString(Blockly.Blocks.defaultToolbox,"text/xml");e["toolbox"]=c.documentElement}var t=Blockly.Options.parseToolboxTree(e["toolbox"]);var i=Boolean(t&&t.getElementsByTagName("category").length);var r=e["trashcan"];if(void 0===r)r=false;var n=e["collapse"];if(void 0===n)n=i;var l=e["comments"];if(void 0===l)l=i;var s=e["disable"];if(void 0===s)s=i;var g=e["sounds"];if(void 0===g)g=true}var u=!!e["rtl"];var h=e["horizontalLayout"];if(void 0===h)h=false;var d=e["toolboxPosition"];if("end"===d)d=false;else d=true;if(h)var p=d?Blockly.TOOLBOX_AT_TOP:Blockly.TOOLBOX_AT_BOTTOM;else var p=d==u?Blockly.TOOLBOX_AT_RIGHT:Blockly.TOOLBOX_AT_LEFT;var y=e["scrollbars"];if(void 0===y)y=i;var f=e["css"];if(void 0===f)f=true;var m="https://blockly-demo.appspot.com/static/media/";if(e["media"])m=e["media"];else if(e["path"])m=e["path"]+"media/";if(void 0===e["oneBasedIndex"])var _=true;else var _=!!e["oneBasedIndex"];Blockly.Colours.overrideColours(e["colours"]);this.RTL=u;this.oneBasedIndex=_;this.collapse=n;this.comments=l;this.disable=s;this.readOnly=o;this.pathToMedia=m;this.hasCategories=i;this.hasScrollbars=y;this.hasTrashcan=r;this.hasSounds=g;this.hasCss=f;this.horizontalLayout=h;this.languageTree=t;this.gridOptions=Blockly.Options.parseGridOptions_(e);this.zoomOptions=Blockly.Options.parseZoomOptions_(e);this.toolboxPosition=p};Blockly.Options.prototype.parentWorkspace=null;Blockly.Options.prototype.setMetrics=null;Blockly.Options.prototype.getMetrics=null;Blockly.Options.parseZoomOptions_=function(e){var o=e["zoom"]||{};var t={};if(void 0===o["controls"])t.controls=false;else t.controls=!!o["controls"];if(void 0===o["wheel"])t.wheel=false;else t.wheel=!!o["wheel"];if(void 0===o["startScale"])t.startScale=1;else t.startScale=parseFloat(o["startScale"]);if(void 0===o["maxScale"])t.maxScale=3;else t.maxScale=parseFloat(o["maxScale"]);if(void 0===o["minScale"])t.minScale=.3;else t.minScale=parseFloat(o["minScale"]);if(void 0===o["scaleSpeed"])t.scaleSpeed=1.2;else t.scaleSpeed=parseFloat(o["scaleSpeed"]);return t};Blockly.Options.parseGridOptions_=function(e){var o=e["grid"]||{};var t={};t.spacing=parseFloat(o["spacing"])||0;t.colour=o["colour"]||"#888";t.length=parseFloat(o["length"])||1;t.snap=t.spacing>0&&!!o["snap"];return t};Blockly.Options.parseToolboxTree=function(e){if(e){if("string"!=typeof e)if("undefined"==typeof XSLTProcessor&&e.outerHTML)e=e.outerHTML;else if(!(e instanceof Element))e=null;if("string"==typeof e)e=Blockly.Xml.textToDom(e)}else e=null;return e};goog.provide("Blockly.Procedures");goog.require("Blockly.Blocks");goog.require("Blockly.constants");goog.require("Blockly.Events.BlockChange");goog.require("Blockly.Field");goog.require("Blockly.Names");goog.require("Blockly.Workspace");Blockly.Procedures.NAME_TYPE=Blockly.PROCEDURE_CATEGORY_NAME;Blockly.Procedures.allProcedures=function(e){var o=e.getAllBlocks();var t=[];var i=[];for(var r=0;r<o.length;r++)if(o[r].getProcedureDef){var n=o[r].getProcedureDef();if(n)if(n[2])t.push(n);else i.push(n)}i.sort(Blockly.Procedures.procTupleComparator_);t.sort(Blockly.Procedures.procTupleComparator_);return[i,t]};Blockly.Procedures.allProcedureMutations=function(e){var o=e.getAllBlocks();var t=[];for(var i=0;i<o.length;i++)if(o[i].type==Blockly.PROCEDURES_PROTOTYPE_BLOCK_TYPE){var r=o[i].mutationToDom(true);if(r)t.push(r)}return t};Blockly.Procedures.sortProcedureMutations_=function(e){var o=e.slice();o.sort((function(e,o){var t=e.getAttribute("proccode");var i=o.getAttribute("proccode");return Blockly.scratchBlocksUtils.compareStrings(t,i)}));return o};Blockly.Procedures.procTupleComparator_=function(e,o){return Blockly.scratchBlocksUtils.compareStrings(e[0],o[0])};Blockly.Procedures.findLegalName=function(e,o){if(o.isInFlyout)return e;while(!Blockly.Procedures.isLegalName_(e,o.workspace,o)){var t=e.match(/^(.*?)(\d+)$/);if(!t)e+="2";else e=t[1]+(parseInt(t[2],10)+1)}return e};Blockly.Procedures.isLegalName_=function(e,o,t){return!Blockly.Procedures.isNameUsed(e,o,t)};Blockly.Procedures.isNameUsed=function(e,o,t){var i=o.getAllBlocks();for(var r=0;r<i.length;r++){if(i[r]==t)continue;if(i[r].getProcedureDef){var n=i[r].getProcedureDef();if(Blockly.Names.equals(n[0],e))return false}}return true};Blockly.Procedures.rename=function(e){e=e.replace(/^[\s\xa0]+|[\s\xa0]+$/g,"");var o=Blockly.Procedures.findLegalName(e,this.sourceBlock_);var t=this.text_;if(t!=e&&t!=o){var i=this.sourceBlock_.workspace.getAllBlocks();for(var r=0;r<i.length;r++)if(i[r].renameProcedure)i[r].renameProcedure(t,o)}return o};Blockly.Procedures.flyoutCategory=function(e){var o=[];Blockly.Procedures.addCreateButton_(e,o);var t=Blockly.Procedures.allProcedureMutations(e);t=Blockly.Procedures.sortProcedureMutations_(t);for(var i=0;i<t.length;i++){var r=t[i];var n=goog.dom.createDom("block");n.setAttribute("type","procedures_call");n.setAttribute("gap",16);n.appendChild(r);o.push(n)}return o};Blockly.Procedures.addCreateButton_=function(e,o){var t=goog.dom.createDom("button");var i=Blockly.Msg.NEW_PROCEDURE;var r="CREATE_PROCEDURE";var n=function(){Blockly.Procedures.createProcedureDefCallback_(e)};t.setAttribute("text",i);t.setAttribute("callbackKey",r);e.registerButtonCallback(r,n);o.push(t)};Blockly.Procedures.getCallers=function(e,o,t,i){var r=[];var n=o.getTopBlocks();for(var l=0;l<n.length;l++){var s=n[l];if(s.id==t.id&&!i)continue;r.push.apply(r,s.getDescendants(false))}var g=[];for(var l=0;l<r.length;l++){var s=r[l];if(s.type==Blockly.PROCEDURES_CALL_BLOCK_TYPE){var a=s.getProcCode();if(a&&a==e)g.push(s)}}return g};Blockly.Procedures.mutateCallersAndPrototype=function(e,o,t){var i=Blockly.Procedures.getDefineBlock(e,o);var r=Blockly.Procedures.getPrototypeBlock(e,o);if(i&&r){var n=Blockly.Procedures.getCallers(e,i.workspace,i,true);n.push(r);Blockly.Events.setGroup(true);for(var l=0,s;s=n[l];l++){var g=s.mutationToDom();var a=g&&Blockly.Xml.domToText(g);s.domToMutation(t);var c=s.mutationToDom();var u=c&&Blockly.Xml.domToText(c);if(a!=u)Blockly.Events.fire(new Blockly.Events.BlockChange(s,"mutation",null,a,u))}Blockly.Events.setGroup(false)}else alert("No define block on workspace")};Blockly.Procedures.getDefineBlock=function(e,o){var t=o.getTopBlocks(false);for(var i=0;i<t.length;i++)if(t[i].type==Blockly.PROCEDURES_DEFINITION_BLOCK_TYPE){var r=t[i].getInput("custom_block").connection.targetBlock();if(r.getProcCode&&r.getProcCode()==e)return t[i]}return null};Blockly.Procedures.getPrototypeBlock=function(e,o){var t=Blockly.Procedures.getDefineBlock(e,o);if(t)return t.getInput("custom_block").connection.targetBlock();return null};Blockly.Procedures.newProcedureMutation=function(){var e="<xml>"+"<mutation"+' proccode="'+Blockly.Msg["PROCEDURE_DEFAULT_NAME"]+'"'+' argumentids="[]"'+' argumentnames="[]"'+' argumentdefaults="[]"'+' warp="false">'+"</mutation>"+"</xml>";return Blockly.Xml.textToDom(e).firstChild};Blockly.Procedures.createProcedureDefCallback_=function(e){Blockly.Procedures.externalProcedureDefCallback(Blockly.Procedures.newProcedureMutation(),Blockly.Procedures.createProcedureCallbackFactory_(e))};Blockly.Procedures.createProcedureCallbackFactory_=function(e){return function(o){if(o){var t="<xml>"+'<block type="procedures_definition">'+'<statement name="custom_block">'+'<shadow type="procedures_prototype">'+Blockly.Xml.domToText(o)+"</shadow>"+"</statement>"+"</block>"+"</xml>";var i=Blockly.Xml.textToDom(t).firstChild;Blockly.Events.setGroup(true);var r=Blockly.Xml.domToBlock(i,e);var n=e.scale;var l=-e.scrollX;if(e.RTL)l+=e.getMetrics().contentWidth-30;else l+=30;r.moveBy(l/n,(-e.scrollY+30)/n);r.scheduleSnapAndBump();Blockly.Events.setGroup(false);e.refreshToolboxSelection_()}}};Blockly.Procedures.editProcedureCallback_=function(e){if(e.type==Blockly.PROCEDURES_DEFINITION_BLOCK_TYPE){var o=e.getInput("custom_block");if(!o){alert("Bad input");return}var t=o.connection;if(!t){alert("Bad connection");return}var i=t.targetBlock();if(!i||!i.type==Blockly.PROCEDURES_PROTOTYPE_BLOCK_TYPE){alert("Bad inner block");return}e=i}else if(e.type==Blockly.PROCEDURES_CALL_BLOCK_TYPE){var r=e.workspace.isFlyout?e.workspace.targetWorkspace:e.workspace;e=Blockly.Procedures.getPrototypeBlock(e.getProcCode(),r)}Blockly.Procedures.externalProcedureDefCallback(e.mutationToDom(),Blockly.Procedures.editProcedureCallbackFactory_(e))};Blockly.Procedures.editProcedureCallbackFactory_=function(e){return function(o){if(o){Blockly.Procedures.mutateCallersAndPrototype(e.getProcCode(),e.workspace,o);var t=e.workspace.isFlyout?e.workspace.targetWorkspace:e.workspace;t.refreshToolboxSelection_()}}};Blockly.Procedures.externalProcedureDefCallback=function(){alert("External procedure editor must be override Blockly.Procedures.externalProcedureDefCallback")};Blockly.Procedures.makeEditOption=function(e){var o={enabled:true,text:Blockly.Msg.EDIT_PROCEDURE,callback:function(){Blockly.Procedures.editProcedureCallback_(e)}};return o};Blockly.Procedures.showProcedureDefCallback_=function(e){alert('TODO(#1136): implement showing procedure definition (procCode was "'+e.procCode_+'")')};Blockly.Procedures.makeShowDefinitionOption=function(e){var o={enabled:true,text:Blockly.Msg.SHOW_PROCEDURE_DEFINITION,callback:function(){Blockly.Procedures.showProcedureDefCallback_(e)}};return o};Blockly.Procedures.deleteProcedureDefCallback=function(e,o){var t=Blockly.Procedures.getCallers(e,o.workspace,o,false);if(t.length>0)return false;var i=o.workspace;Blockly.Events.setGroup(true);o.dispose();Blockly.Events.setGroup(false);i.refreshToolboxSelection_();return true};goog.provide("Blockly.RenderedConnection");goog.require("Blockly.Connection");Blockly.RenderedConnection=function(e,o){Blockly.RenderedConnection.superClass_.constructor.call(this,e,o);this.offsetInBlock_=new goog.math.Coordinate(0,0)};goog.inherits(Blockly.RenderedConnection,Blockly.Connection);Blockly.RenderedConnection.prototype.distanceFrom=function(e){var o=this.x_-e.x_;var t=this.y_-e.y_;return Math.sqrt(o*o+t*t)};Blockly.RenderedConnection.prototype.bumpAwayFrom_=function(e){if(this.sourceBlock_.workspace.isDragging())return;var o=this.sourceBlock_.getRootBlock();if(o.isInFlyout)return;var t=false;if(!o.isMovable()){o=e.getSourceBlock().getRootBlock();if(!o.isMovable())return;e=this;t=true}var i=Blockly.selected==o;i||o.addSelect();var r=e.x_+Blockly.SNAP_RADIUS-this.x_;var n=e.y_+Blockly.SNAP_RADIUS-this.y_;if(t)n=-n;if(o.RTL)r=-r;o.moveBy(r,n);i||o.removeSelect()};Blockly.RenderedConnection.prototype.moveTo=function(e,o){if(this.inDB_)this.db_.removeConnection_(this);this.x_=e;this.y_=o;if(!this.hidden_)this.db_.addConnection(this)};Blockly.RenderedConnection.prototype.moveBy=function(e,o){this.moveTo(this.x_+e,this.y_+o)};Blockly.RenderedConnection.prototype.moveToOffset=function(e){this.moveTo(e.x+this.offsetInBlock_.x,e.y+this.offsetInBlock_.y)};Blockly.RenderedConnection.prototype.setOffsetInBlock=function(e,o){this.offsetInBlock_.x=e;this.offsetInBlock_.y=o};Blockly.RenderedConnection.prototype.tighten_=function(){var e=this.targetConnection.x_-this.x_;var o=this.targetConnection.y_-this.y_;if(0!=e||0!=o){var t=this.targetBlock();var i=t.getSvgRoot();if(!i)throw"block is not rendered.";var r=Blockly.utils.getRelativeXY(i);t.getSvgRoot().setAttribute("transform","translate("+(r.x-e)+","+(r.y-o)+")");t.moveConnections_(-e,-o)}};Blockly.RenderedConnection.prototype.closest=function(e,o){return this.dbOpposite_.searchForClosest(this,e,o)};Blockly.RenderedConnection.prototype.highlight=function(){var e;e="m -20,0 h 5 "+Blockly.BlockSvg.NOTCH_PATH_LEFT+" h 5";var o=this.sourceBlock_.getRelativeToSurfaceXY();var t=this.x_-o.x;var i=this.y_-o.y;Blockly.Connection.highlightedPath_=Blockly.utils.createSvgElement("path",{class:"blocklyHighlightedConnectionPath",d:e,transform:"translate("+t+","+i+")"+(this.sourceBlock_.RTL?" scale(-1 1)":"")},this.sourceBlock_.getSvgRoot())};Blockly.RenderedConnection.prototype.unhideAll=function(){this.setHidden(false);var e=[];if(this.type!=Blockly.INPUT_VALUE&&this.type!=Blockly.NEXT_STATEMENT)return e;var o=this.targetBlock();if(o){var t;if(o.isCollapsed()){t=[];o.outputConnection&&t.push(o.outputConnection);o.nextConnection&&t.push(o.nextConnection);o.previousConnection&&t.push(o.previousConnection)}else t=o.getConnections_(true);for(var i=0;i<t.length;i++)e.push.apply(e,t[i].unhideAll());if(!e.length)e[0]=o}return e};Blockly.RenderedConnection.prototype.unhighlight=function(){goog.dom.removeNode(Blockly.Connection.highlightedPath_);delete Blockly.Connection.highlightedPath_};Blockly.RenderedConnection.prototype.setHidden=function(e){this.hidden_=e;if(e&&this.inDB_)this.db_.removeConnection_(this);else if(!e&&!this.inDB_)this.db_.addConnection(this)};Blockly.RenderedConnection.prototype.hideAll=function(){this.setHidden(true);if(this.targetConnection){var e=this.targetBlock().getDescendants(false);for(var o=0;o<e.length;o++){var t=e[o];var i=t.getConnections_(true);for(var r=0;r<i.length;r++)i[r].setHidden(true);var n=t.getIcons();for(var r=0;r<n.length;r++)n[r].setVisible(false)}}};Blockly.RenderedConnection.prototype.isConnectionAllowed=function(e,o){if(this.distanceFrom(e)>o)return false;return Blockly.RenderedConnection.superClass_.isConnectionAllowed.call(this,e)};Blockly.RenderedConnection.prototype.disconnectInternal_=function(e,o){Blockly.RenderedConnection.superClass_.disconnectInternal_.call(this,e,o);if(e.rendered)e.render();if(o.rendered){o.updateDisabled();o.render()}};Blockly.RenderedConnection.prototype.respawnShadow_=function(){var e=this.getSourceBlock();var o=this.getShadowDom();if(e.workspace&&o&&Blockly.Events.recordUndo){Blockly.RenderedConnection.superClass_.respawnShadow_.call(this);var t=this.targetBlock();if(!t)throw"Couldn't respawn the shadow block that should exist here.";t.initSvg();t.render(false);if(e.rendered)e.render()}};Blockly.RenderedConnection.prototype.neighbours_=function(e){return this.dbOpposite_.getNeighbours(this,e)};Blockly.RenderedConnection.prototype.connect_=function(e){Blockly.RenderedConnection.superClass_.connect_.call(this,e);var o=this;var t=o.getSourceBlock();var i=e.getSourceBlock();if(t.rendered)t.updateDisabled();if(i.rendered)i.updateDisabled();if(t.rendered&&i.rendered)if(o.type==Blockly.NEXT_STATEMENT||o.type==Blockly.PREVIOUS_STATEMENT)i.render();else t.render()};Blockly.RenderedConnection.prototype.onCheckChanged_=function(){if(this.isConnected()&&!this.checkType_(this.targetConnection)){var e=this.isSuperior()?this.targetBlock():this.sourceBlock_;e.unplug();this.sourceBlock_.bumpNeighbours_()}};goog.provide("Blockly.scratchBlocksUtils");Blockly.scratchBlocksUtils.measureText=function(e,o,t,i){var r=document.createElement("canvas");var n=r.getContext("2d");n.font=t+" "+e+" "+o;return n.measureText(i).width};Blockly.scratchBlocksUtils.encodeEntities=function(e){return e.replace(/[\u00A0-\u9999<>&]/gim,(function(e){return"&#"+e.charCodeAt(0)+";"}))};Blockly.scratchBlocksUtils.changeObscuredShadowIds=function(e){var o=e.getDescendants(false);for(var t=o.length-1;t>=0;t--){var i=o[t];for(var r=0;r<i.inputList.length;r++){var n=i.inputList[r].connection;if(n){var l=n.getShadowDom();if(l){l.setAttribute("id",Blockly.utils.genUid());n.setShadowDom(l)}}}}};Blockly.scratchBlocksUtils.isShadowArgumentReporter=function(e){return e.isShadow()&&("argument_reporter_boolean"==e.type||"argument_reporter_string_number"==e.type)};Blockly.scratchBlocksUtils.compareStrings=function(e,o){return e.localeCompare(o,[],{sensitivity:"base",numeric:true})};Blockly.scratchBlocksUtils.blockIsRecyclable=function(e){if(e.mutationToDom&&e.domToMutation)return false;for(var o=0;o<e.inputList.length;o++){var t=e.inputList[o];for(var i=0;i<t.fieldRow.length;i++){var r=t.fieldRow[i];if(r instanceof Blockly.FieldVariable||r instanceof Blockly.FieldVariableGetter)return false;if(r instanceof Blockly.FieldDropdown||r instanceof Blockly.FieldNumberDropdown||r instanceof Blockly.FieldTextDropdown)if(r.isOptionListDynamic())return false}if(t.connection){var n=t.connection.targetBlock();if(n&&!Blockly.scratchBlocksUtils.blockIsRecyclable(n))return false}}return true};Blockly.scratchBlocksUtils.duplicateAndDragCallback=function(e,o){var t="mouse"===Blockly.Touch.getTouchIdentifierFromEvent(o);return function(i){setTimeout((function(){var r=e.workspace;var n=e.getSvgRoot();if(!n)throw new Error("oldBlock is not rendered.");var l=Blockly.Xml.blockToDom(e);r.setResizesEnabled(false);Blockly.Events.disable();try{var s=Blockly.Xml.domToBlock(l,r);Blockly.scratchBlocksUtils.changeObscuredShadowIds(s);var g=s.getSvgRoot();if(!g)throw new Error("newBlock is not rendered.");var a=e.getRelativeToSurfaceXY();s.moveBy(a.x,a.y);if(!t){var c=r.RTL?-100:100;var u=100;s.moveBy(c,u)}}finally{Blockly.Events.enable()}if(Blockly.Events.isEnabled())Blockly.Events.fire(new Blockly.Events.BlockCreate(s));if(t){var h={clientX:o.clientX,clientY:o.clientY,type:"mousedown",preventDefault:function(){i.preventDefault()},stopPropagation:function(){i.stopPropagation()},target:i.target};r.startDragWithFakeEvent(h,s)}}),0)}};goog.provide("Blockly.Bubble");goog.require("Blockly.Touch");goog.require("Blockly.Workspace");goog.require("goog.dom");goog.require("goog.math.Coordinate");goog.require("goog.userAgent");Blockly.Bubble=function(e,o,t,i,r,n){this.workspace_=e;this.content_=o;this.shape_=t;var l=Blockly.Bubble.ARROW_ANGLE;if(this.workspace_.RTL)l=-l;this.arrow_radians_=Blockly.utils.toRadians(l);var s=e.getBubbleCanvas();s.appendChild(this.createDom_(o,!!(r&&n)));this.setAnchorLocation(i);if(!r||!n){var g=this.content_.getBBox();r=g.width+2*Blockly.Bubble.BORDER_WIDTH;n=g.height+2*Blockly.Bubble.BORDER_WIDTH}this.setBubbleSize(r,n);this.positionBubble_();this.renderArrow_();this.rendered_=true;if(!e.options.readOnly){Blockly.bindEventWithChecks_(this.bubbleBack_,"mousedown",this,this.bubbleMouseDown_);if(this.resizeGroup_)Blockly.bindEventWithChecks_(this.resizeGroup_,"mousedown",this,this.resizeMouseDown_)}};Blockly.Bubble.BORDER_WIDTH=6;Blockly.Bubble.ARROW_THICKNESS=5;Blockly.Bubble.ARROW_ANGLE=20;Blockly.Bubble.ARROW_BEND=4;Blockly.Bubble.ANCHOR_RADIUS=8;Blockly.Bubble.onMouseUpWrapper_=null;Blockly.Bubble.onMouseMoveWrapper_=null;Blockly.Bubble.prototype.resizeCallback_=null;Blockly.Bubble.unbindDragEvents_=function(){if(Blockly.Bubble.onMouseUpWrapper_){Blockly.unbindEvent_(Blockly.Bubble.onMouseUpWrapper_);Blockly.Bubble.onMouseUpWrapper_=null}if(Blockly.Bubble.onMouseMoveWrapper_){Blockly.unbindEvent_(Blockly.Bubble.onMouseMoveWrapper_);Blockly.Bubble.onMouseMoveWrapper_=null}};Blockly.Bubble.bubbleMouseUp_=function(){Blockly.Touch.clearTouchIdentifier();Blockly.Bubble.unbindDragEvents_()};Blockly.Bubble.prototype.rendered_=false;Blockly.Bubble.prototype.anchorXY_=null;Blockly.Bubble.prototype.relativeLeft_=0;Blockly.Bubble.prototype.relativeTop_=0;Blockly.Bubble.prototype.width_=0;Blockly.Bubble.prototype.height_=0;Blockly.Bubble.prototype.autoLayout_=true;Blockly.Bubble.prototype.createDom_=function(e,o){this.bubbleGroup_=Blockly.utils.createSvgElement("g",{},null);var t={filter:"url(#"+this.workspace_.options.embossFilterId+")"};if(-1!=goog.userAgent.getUserAgentString().indexOf("JavaFX"))t={};var i=Blockly.utils.createSvgElement("g",t,this.bubbleGroup_);this.bubbleArrow_=Blockly.utils.createSvgElement("path",{},i);this.bubbleBack_=Blockly.utils.createSvgElement("rect",{class:"blocklyDraggable",x:0,y:0,rx:Blockly.Bubble.BORDER_WIDTH,ry:Blockly.Bubble.BORDER_WIDTH},i);if(o){this.resizeGroup_=Blockly.utils.createSvgElement("g",{class:this.workspace_.RTL?"blocklyResizeSW":"blocklyResizeSE"},this.bubbleGroup_);var r=2*Blockly.Bubble.BORDER_WIDTH;Blockly.utils.createSvgElement("polygon",{points:"0,x x,x x,0".replace(/x/g,r.toString())},this.resizeGroup_);Blockly.utils.createSvgElement("line",{class:"blocklyResizeLine",x1:r/3,y1:r-1,x2:r-1,y2:r/3},this.resizeGroup_);Blockly.utils.createSvgElement("line",{class:"blocklyResizeLine",x1:2*r/3,y1:r-1,x2:r-1,y2:2*r/3},this.resizeGroup_)}else this.resizeGroup_=null;this.bubbleGroup_.appendChild(e);return this.bubbleGroup_};Blockly.Bubble.prototype.getSvgRoot=function(){return this.bubbleGroup_};Blockly.Bubble.prototype.setSvgId=function(e){if(this.bubbleGroup_.dataset)this.bubbleGroup_.dataset.blockId=e};Blockly.Bubble.prototype.bubbleMouseDown_=function(e){var o=this.workspace_.getGesture(e);if(o)o.handleBubbleStart(e,this)};Blockly.Bubble.prototype.showContextMenu_=function(e){};Blockly.Bubble.prototype.isDeletable=function(){return false};Blockly.Bubble.prototype.resizeMouseDown_=function(e){this.promote_();Blockly.Bubble.unbindDragEvents_();if(Blockly.utils.isRightButton(e)){e.stopPropagation();return}this.workspace_.startDrag(e,new goog.math.Coordinate(this.workspace_.RTL?-this.width_:this.width_,this.height_));Blockly.Bubble.onMouseUpWrapper_=Blockly.bindEventWithChecks_(document,"mouseup",this,Blockly.Bubble.bubbleMouseUp_);Blockly.Bubble.onMouseMoveWrapper_=Blockly.bindEventWithChecks_(document,"mousemove",this,this.resizeMouseMove_);Blockly.hideChaff();e.stopPropagation()};Blockly.Bubble.prototype.resizeMouseMove_=function(e){this.autoLayout_=false;var o=this.workspace_.moveDrag(e);this.setBubbleSize(this.workspace_.RTL?-o.x:o.x,o.y);if(this.workspace_.RTL)this.positionBubble_()};Blockly.Bubble.prototype.registerResizeEvent=function(e){this.resizeCallback_=e};Blockly.Bubble.prototype.promote_=function(){var e=this.bubbleGroup_.parentNode;if(e.lastChild!==this.bubbleGroup_){e.appendChild(this.bubbleGroup_);return true}return false};Blockly.Bubble.prototype.setAnchorLocation=function(e){this.anchorXY_=e;if(this.rendered_)this.positionBubble_()};Blockly.Bubble.prototype.layoutBubble_=function(){var e=-this.width_/4;var o=-this.height_-Blockly.BlockSvg.MIN_BLOCK_Y;var t=this.workspace_.getMetrics();t.viewWidth/=this.workspace_.scale;t.viewLeft/=this.workspace_.scale;var i=this.anchorXY_.x;if(this.workspace_.RTL){if(i-t.viewLeft-e-this.width_<Blockly.Scrollbar.scrollbarThickness)e=i-t.viewLeft-this.width_-Blockly.Scrollbar.scrollbarThickness;else if(i-t.viewLeft-e>t.viewWidth)e=i-t.viewLeft-t.viewWidth}else if(i+e<t.viewLeft)e=t.viewLeft-i;else if(t.viewLeft+t.viewWidth<i+e+this.width_+Blockly.BlockSvg.SEP_SPACE_X+Blockly.Scrollbar.scrollbarThickness)e=t.viewLeft+t.viewWidth-i-this.width_-Blockly.Scrollbar.scrollbarThickness;if(this.anchorXY_.y+o<t.viewTop){var r=this.shape_.getBBox();o=r.height}this.relativeLeft_=e;this.relativeTop_=o};Blockly.Bubble.prototype.positionBubble_=function(){var e=this.anchorXY_.x;if(this.workspace_.RTL)e-=this.relativeLeft_;else e+=this.relativeLeft_;var o=this.relativeTop_+this.anchorXY_.y;this.moveTo(e,o)};Blockly.Bubble.prototype.moveTo=function(e,o){this.bubbleGroup_.setAttribute("transform","translate("+e+","+o+")")};Blockly.Bubble.prototype.getBubbleSize=function(){return{width:this.width_,height:this.height_}};Blockly.Bubble.prototype.setBubbleSize=function(e,o){var t=2*Blockly.Bubble.BORDER_WIDTH;e=Math.max(e,t+45);o=Math.max(o,t+20);this.width_=e;this.height_=o;this.bubbleBack_.setAttribute("width",e);this.bubbleBack_.setAttribute("height",o);if(this.resizeGroup_)if(this.workspace_.RTL){var i=2*Blockly.Bubble.BORDER_WIDTH;this.resizeGroup_.setAttribute("transform","translate("+i+","+(o-t)+") scale(-1 1)")}else this.resizeGroup_.setAttribute("transform","translate("+(e-t)+","+(o-t)+")");if(this.rendered_){if(this.autoLayout_)this.layoutBubble_();this.positionBubble_();this.renderArrow_()}if(this.resizeCallback_)this.resizeCallback_()};Blockly.Bubble.prototype.renderArrow_=function(){var e=[];var o=this.width_/2;var t=this.height_/2;var i=-this.relativeLeft_;var r=-this.relativeTop_;if(o==i&&t==r)e.push("M "+o+","+t);else{var n=r-t;var l=i-o;if(this.workspace_.RTL)l*=-1;var s=Math.sqrt(n*n+l*l);var g=Math.acos(l/s);if(n<0)g=2*Math.PI-g;var a=g+Math.PI/2;if(a>2*Math.PI)a-=2*Math.PI;var c=Math.sin(a);var u=Math.cos(a);var h=this.getBubbleSize();var d=(h.width+h.height)/Blockly.Bubble.ARROW_THICKNESS;d=Math.min(d,h.width,h.height)/4;var p=1-Blockly.Bubble.ANCHOR_RADIUS/s;i=o+p*l;r=t+p*n;var y=o+d*u;var f=t+d*c;var m=o-d*u;var _=t-d*c;var v=g+this.arrow_radians_;if(v>2*Math.PI)v-=2*Math.PI;var k=Math.sin(v)*s/Blockly.Bubble.ARROW_BEND;var B=Math.cos(v)*s/Blockly.Bubble.ARROW_BEND;e.push("M"+y+","+f);e.push("C"+(y+B)+","+(f+k)+" "+i+","+r+" "+i+","+r);e.push("C"+i+","+r+" "+(m+B)+","+(_+k)+" "+m+","+_)}e.push("z");this.bubbleArrow_.setAttribute("d",e.join(" "))};Blockly.Bubble.prototype.setColour=function(e){this.bubbleBack_.setAttribute("fill",e);this.bubbleArrow_.setAttribute("fill",e)};Blockly.Bubble.prototype.dispose=function(){Blockly.Bubble.unbindDragEvents_();goog.dom.removeNode(this.bubbleGroup_);this.bubbleGroup_=null;this.bubbleArrow_=null;this.bubbleBack_=null;this.resizeGroup_=null;this.workspace_=null;this.content_=null;this.shape_=null};Blockly.Bubble.prototype.moveDuringDrag=function(e,o){if(e)e.translateSurface(o.x,o.y);else this.moveTo(o.x,o.y);if(this.workspace_.RTL)this.relativeLeft_=this.anchorXY_.x-o.x-this.width_;else this.relativeLeft_=o.x-this.anchorXY_.x;this.relativeTop_=o.y-this.anchorXY_.y;this.renderArrow_()};Blockly.Bubble.prototype.getRelativeToSurfaceXY=function(){return new goog.math.Coordinate(this.workspace_.RTL?this.anchorXY_.x-this.relativeLeft_:this.anchorXY_.x+this.relativeLeft_,this.anchorXY_.y+this.relativeTop_)};Blockly.Bubble.prototype.setAutoLayout=function(e){this.autoLayout_=e};goog.provide("Blockly.ScratchBubble");goog.require("Blockly.Touch");goog.require("Blockly.Workspace");goog.require("goog.dom");goog.require("goog.math");goog.require("goog.math.Coordinate");goog.require("goog.userAgent");Blockly.ScratchBubble=function(e,o,t,i,r,n,l,s,g){this.comment=e;this.workspace_=o;this.content_=t;this.x=l;this.y=s;this.isMinimized_=g||false;var a=o.getBubbleCanvas();a.appendChild(this.createDom_(t,!!(r&&n),this.isMinimized_));this.setAnchorLocation(i);if(!r||!n){var c=this.content_.getBBox();r=c.width+2*Blockly.ScratchBubble.BORDER_WIDTH;n=c.height+2*Blockly.ScratchBubble.BORDER_WIDTH}this.setBubbleSize(r,n);this.positionBubble_();this.renderArrow_();this.rendered_=true;if(!o.options.readOnly){Blockly.bindEventWithChecks_(this.minimizeArrow_,"mousedown",this,this.minimizeArrowMouseDown_,true);Blockly.bindEventWithChecks_(this.minimizeArrow_,"mouseout",this,this.minimizeArrowMouseOut_,true);Blockly.bindEventWithChecks_(this.minimizeArrow_,"mouseup",this,this.minimizeArrowMouseUp_,true);Blockly.bindEventWithChecks_(this.deleteIcon_,"mousedown",this,this.deleteMouseDown_,true);Blockly.bindEventWithChecks_(this.deleteIcon_,"mouseout",this,this.deleteMouseOut_,true);Blockly.bindEventWithChecks_(this.deleteIcon_,"mouseup",this,this.deleteMouseUp_,true);Blockly.bindEventWithChecks_(this.commentTopBar_,"mousedown",this,this.bubbleMouseDown_);Blockly.bindEventWithChecks_(this.bubbleBack_,"mousedown",this,this.bubbleMouseDown_);if(this.resizeGroup_){Blockly.bindEventWithChecks_(this.resizeGroup_,"mousedown",this,this.resizeMouseDown_);Blockly.bindEventWithChecks_(this.resizeGroup_,"mouseup",this,this.resizeMouseUp_)}}this.setAutoLayout(false);this.moveTo(this.x,this.y)};goog.inherits(Blockly.ScratchBubble,Blockly.Bubble);Blockly.ScratchBubble.BORDER_WIDTH=1;Blockly.ScratchBubble.LINE_THICKNESS=1;Blockly.ScratchBubble.TOP_BAR_HEIGHT=32;Blockly.ScratchBubble.MINIMIZE_ICON_SIZE=32;Blockly.ScratchBubble.DELETE_ICON_SIZE=32;Blockly.ScratchBubble.TOP_BAR_ICON_INSET=0;Blockly.ScratchBubble.RESIZE_SIZE=16;Blockly.ScratchBubble.RESIZE_CORNER_PAD=4;Blockly.ScratchBubble.RESIZE_OUTER_PAD=8;Blockly.ScratchBubble.prototype.createDom_=function(e,o,t){this.bubbleGroup_=Blockly.utils.createSvgElement("g",{},null);this.bubbleArrow_=Blockly.utils.createSvgElement("line",{"stroke-linecap":"round"},this.bubbleGroup_);this.bubbleBack_=Blockly.utils.createSvgElement("rect",{class:"blocklyDraggable scratchCommentRect",x:0,y:0,rx:4*Blockly.ScratchBubble.BORDER_WIDTH,ry:4*Blockly.ScratchBubble.BORDER_WIDTH},this.bubbleGroup_);this.labelText_=e.labelText;this.createCommentTopBar_();this.commentEditor_=e.commentEditor;this.bubbleGroup_.appendChild(this.commentEditor_);if(o)this.createResizeHandle_();else this.resizeGroup_=null;if(t){this.minimizeArrow_.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",Blockly.mainWorkspace.options.pathToMedia+"comment-arrow-up.svg");this.commentEditor_.setAttribute("display","none");this.resizeGroup_.setAttribute("display","none")}else{this.minimizeArrow_.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",Blockly.mainWorkspace.options.pathToMedia+"comment-arrow-down.svg");this.topBarLabel_.setAttribute("display","none")}return this.bubbleGroup_};Blockly.ScratchBubble.prototype.createCommentTopBar_=function(){this.commentTopBar_=Blockly.utils.createSvgElement("rect",{class:"blocklyDraggable scratchCommentTopBar",rx:Blockly.ScratchBubble.BORDER_WIDTH,ry:Blockly.ScratchBubble.BORDER_WIDTH,height:Blockly.ScratchBubble.TOP_BAR_HEIGHT},this.bubbleGroup_);this.createTopBarIcons_();this.createTopBarLabel_()};Blockly.ScratchBubble.prototype.createTopBarIcons_=function(){var e=Blockly.ScratchBubble.TOP_BAR_HEIGHT/2+Blockly.ScratchBubble.BORDER_WIDTH;var o=Blockly.ScratchBubble.TOP_BAR_ICON_INSET;this.minimizeArrow_=Blockly.utils.createSvgElement("image",{x:o,y:e-Blockly.ScratchBubble.MINIMIZE_ICON_SIZE/2,width:Blockly.ScratchBubble.MINIMIZE_ICON_SIZE,height:Blockly.ScratchBubble.MINIMIZE_ICON_SIZE},this.bubbleGroup_);this.deleteIcon_=Blockly.utils.createSvgElement("image",{x:o,y:e-Blockly.ScratchBubble.DELETE_ICON_SIZE/2,width:Blockly.ScratchBubble.DELETE_ICON_SIZE,height:Blockly.ScratchBubble.DELETE_ICON_SIZE},this.bubbleGroup_);this.deleteIcon_.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",Blockly.mainWorkspace.options.pathToMedia+"delete-x.svg")};Blockly.ScratchBubble.prototype.createTopBarLabel_=function(){this.topBarLabel_=Blockly.utils.createSvgElement("text",{class:"scratchCommentText",x:this.width_/2,y:Blockly.ScratchBubble.TOP_BAR_HEIGHT/2+Blockly.ScratchBubble.BORDER_WIDTH,"text-anchor":"middle","dominant-baseline":"middle"},this.bubbleGroup_);var e=document.createTextNode(this.labelText_);this.topBarLabel_.appendChild(e)};Blockly.ScratchBubble.prototype.createResizeHandle_=function(){this.resizeGroup_=Blockly.utils.createSvgElement("g",{class:this.workspace_.RTL?"scratchCommentResizeSW":"scratchCommentResizeSE"},this.bubbleGroup_);var e=Blockly.ScratchBubble.RESIZE_SIZE;var o=Blockly.ScratchBubble.RESIZE_OUTER_PAD;var t=Blockly.ScratchBubble.RESIZE_CORNER_PAD;Blockly.utils.createSvgElement("polygon",{points:[-o,e+t,e+t,e+t,e+t,-o].join(" ")},this.resizeGroup_);Blockly.utils.createSvgElement("line",{class:"blocklyResizeLine",x1:e/3,y1:e-1,x2:e-1,y2:e/3},this.resizeGroup_);Blockly.utils.createSvgElement("line",{class:"blocklyResizeLine",x1:2*e/3,y1:e-1,x2:e-1,y2:2*e/3},this.resizeGroup_)};Blockly.ScratchBubble.prototype.showContextMenu_=function(e){if(this.workspace_.options.readOnly)return;if(this.contextMenuCallback_)this.contextMenuCallback_(e)};Blockly.ScratchBubble.prototype.minimizeArrowMouseDown_=function(e){this.shouldToggleMinimize_=true;e.stopPropagation()};Blockly.ScratchBubble.prototype.minimizeArrowMouseOut_=function(e){this.shouldToggleMinimize_=false};Blockly.ScratchBubble.prototype.minimizeArrowMouseUp_=function(e){if(this.shouldToggleMinimize_){this.shouldToggleMinimize_=false;if(this.minimizeToggleCallback_)this.minimizeToggleCallback_.call(this)}e.stopPropagation()};Blockly.ScratchBubble.prototype.deleteMouseDown_=function(e){this.shouldDelete_=true;e.stopPropagation()};Blockly.ScratchBubble.prototype.deleteMouseOut_=function(e){this.shouldDelete_=false};Blockly.ScratchBubble.prototype.deleteMouseUp_=function(e){if(this.shouldDelete_){this.shouldDelete_=false;if(this.deleteCallback_)this.deleteCallback_.call(this)}e.stopPropagation()};Blockly.ScratchBubble.prototype.resizeMouseDown_=function(e){this.resizeStartSize_={width:this.width_,height:this.height_};this.workspace_.setResizesEnabled(false);Blockly.ScratchBubble.superClass_.resizeMouseDown_.call(this,e)};Blockly.ScratchBubble.prototype.resizeMouseUp_=function(e){var o=this.resizeStartSize_;this.resizeStartSize_=null;if(this.width_==o.width&&this.height_==o.height)return;Blockly.Events.fire(new Blockly.Events.CommentChange(this.comment,{width:o.width,height:o.height},{width:this.width_,height:this.height_}));this.workspace_.setResizesEnabled(true)};Blockly.ScratchBubble.prototype.setMinimized=function(e,o){if(e==this.isMinimized_)return;if(e){this.isMinimized_=true;this.minimizeArrow_.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",Blockly.mainWorkspace.options.pathToMedia+"comment-arrow-up.svg");this.commentEditor_.setAttribute("display","none");if(this.resizeGroup_)this.resizeGroup_.setAttribute("display","none");if(o&&this.labelText_!=o)this.topBarLabel_.textContent=o;Blockly.utils.removeAttribute(this.topBarLabel_,"display")}else{this.isMinimized_=false;this.minimizeArrow_.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",Blockly.mainWorkspace.options.pathToMedia+"comment-arrow-down.svg");this.topBarLabel_.setAttribute("display","none");Blockly.utils.removeAttribute(this.commentEditor_,"display");if(this.resizeGroup_)Blockly.utils.removeAttribute(this.resizeGroup_,"display")}};Blockly.ScratchBubble.prototype.registerMinimizeToggleEvent=function(e){this.minimizeToggleCallback_=e};Blockly.ScratchBubble.prototype.registerDeleteEvent=function(e){this.deleteCallback_=e};Blockly.ScratchBubble.prototype.registerContextMenuCallback=function(e){this.contextMenuCallback_=e};Blockly.ScratchBubble.prototype.setAnchorLocation=function(e){this.anchorXY_=e;if(this.rendered_)this.positionBubble_()};Blockly.ScratchBubble.prototype.moveTo=function(e,o){Blockly.ScratchBubble.superClass_.moveTo.call(this,e,o);this.updatePosition_(e,o)};Blockly.ScratchBubble.prototype.setBubbleSize=function(e,o){var t=2*Blockly.ScratchBubble.BORDER_WIDTH;e=Math.max(e,t+50);o=Math.max(o,Blockly.ScratchBubble.TOP_BAR_HEIGHT);this.width_=e;this.height_=o;this.bubbleBack_.setAttribute("width",e);this.bubbleBack_.setAttribute("height",o);this.commentTopBar_.setAttribute("width",e);this.commentTopBar_.setAttribute("height",Blockly.ScratchBubble.TOP_BAR_HEIGHT);if(this.workspace_.RTL)this.minimizeArrow_.setAttribute("x",e-Blockly.ScratchBubble.MINIMIZE_ICON_SIZE-Blockly.ScratchBubble.TOP_BAR_ICON_INSET);else this.deleteIcon_.setAttribute("x",e-Blockly.ScratchBubble.DELETE_ICON_SIZE-Blockly.ScratchBubble.TOP_BAR_ICON_INSET);if(this.resizeGroup_){var i=Blockly.ScratchBubble.RESIZE_SIZE;if(this.workspace_.RTL)this.resizeGroup_.setAttribute("transform","translate("+(i+t)+","+(this.height_-t-i)+") scale(-1, 1)");else this.resizeGroup_.setAttribute("transform","translate("+(this.width_-t-i)+","+(this.height_-t-i)+")")}if(this.isMinimized_){this.topBarLabel_.setAttribute("x",this.width_/2);this.topBarLabel_.setAttribute("y",this.height_/2)}if(this.rendered_){this.positionBubble_();this.renderArrow_()}if(this.resizeCallback_)this.resizeCallback_()};Blockly.ScratchBubble.prototype.renderArrow_=function(){var e=this.width_/2;var o=Blockly.ScratchBubble.TOP_BAR_HEIGHT/2;var t=-this.relativeLeft_;var i=-this.relativeTop_;if(e!=t||o!=i){var r=i-o;var n=t-e;if(this.workspace_.RTL){n*=-1;n-=this.width_}var l=e;var s=o;this.bubbleArrow_.setAttribute("x1",l);this.bubbleArrow_.setAttribute("y1",s);this.bubbleArrow_.setAttribute("x2",l+n);this.bubbleArrow_.setAttribute("y2",s+r);this.bubbleArrow_.setAttribute("stroke-width",Blockly.ScratchBubble.LINE_THICKNESS)}};Blockly.ScratchBubble.prototype.setColour=function(e){this.bubbleBack_.setAttribute("stroke",e);this.bubbleArrow_.setAttribute("stroke",e)};Blockly.ScratchBubble.prototype.moveDuringDrag=function(e,o){if(e){e.translateSurface(o.x,o.y);this.updatePosition_(o.x,o.y)}else this.moveTo(o.x,o.y)};Blockly.ScratchBubble.prototype.updatePosition_=function(e,o){if(this.workspace_.RTL)this.relativeLeft_=this.anchorXY_.x-e;else this.relativeLeft_=e-this.anchorXY_.x;this.relativeTop_=o-this.anchorXY_.y;this.renderArrow_()};Blockly.ScratchBubble.prototype.dispose=function(){Blockly.ScratchBubble.superClass_.dispose.call(this);this.topBarLabel_=null;this.commentTopBar_=null;this.minimizeArrow_=null;this.deleteIcon_=null};goog.provide("Blockly.VariableMap");goog.require("Blockly.Events.VarDelete");goog.require("Blockly.Events.VarRename");goog.require("Blockly.VariableModel");Blockly.VariableMap=function(e){this.variableMap_={};this.workspace=e};Blockly.VariableMap.prototype.clear=function(){this.variableMap_=new Object(null)};Blockly.VariableMap.prototype.renameVariable=function(e,o){var t=e.type;var i=this.getVariable(o,t);var r=this.workspace.getAllBlocks();Blockly.Events.setGroup(true);try{if(!i)this.renameVariableAndUses_(e,o,r);else console.warn("Unexpected conflict when attempting to rename "+"variable with name: "+e.name+" and id: "+e.getId()+" to new name: "+o+". A variable with the new name already exists"+" and has id: "+i.getId())}finally{Blockly.Events.setGroup(false)}};Blockly.VariableMap.prototype.renameVariableById=function(e,o){var t=this.getVariableById(e);if(!t)throw new Error("Tried to rename a variable that didn't exist. ID: "+e);this.renameVariable(t,o)};Blockly.VariableMap.prototype.renameVariableAndUses_=function(e,o,t){Blockly.Events.fire(new Blockly.Events.VarRename(e,o));e.name=o;for(var i=0;i<t.length;i++)t[i].updateVarName(e)};Blockly.VariableMap.prototype.renameVariableWithConflict_=function(e,o,t,i){var r=e.type;var n=t.name;if(o!=n)this.renameVariableAndUses_(t,o,i);for(var l=0;l<i.length;l++)i[l].renameVarById(e.getId(),t.getId());Blockly.Events.fire(new Blockly.Events.VarDelete(e));var s=this.getVariablesOfType(r);var g=s.indexOf(e);this.variableMap_[r].splice(g,1)};Blockly.VariableMap.prototype.createVariable=function(e,o,t,i,r){var n=this.getVariable(e,o);if(n){if(t&&n.getId()!=t)console.warn('Variable "'+e+'" is already in use and its id is "'+n.getId()+'" which conflicts with the passed in '+'id, "'+t+'".');return n}if(t){n=this.getVariableById(t);if(n){console.warn('Variable id, "'+t+'", is already in use.');return n}}t=t||Blockly.utils.genUid();o=o||"";n=new Blockly.VariableModel(this.workspace,e,o,t,i,r);if(!this.variableMap_[o])this.variableMap_[o]=[n];else this.variableMap_[o].push(n);return n};Blockly.VariableMap.prototype.deleteVariable=function(e){var o=this.variableMap_[e.type];for(var t=0,i;i=o[t];t++)if(i.getId()==e.getId()){o.splice(t,1);Blockly.Events.fire(new Blockly.Events.VarDelete(e));return}};Blockly.VariableMap.prototype.deleteVariableById=function(e){var o=this.getVariableById(e);if(o){var t=o.name;var i=this.getVariableUsesById(e);for(var r=0,n;n=i[r];r++)if(n.type==Blockly.PROCEDURES_DEFINITION_BLOCK_TYPE||"procedures_defreturn"==n.type){var l=n.getFieldValue("NAME");var s=Blockly.Msg.CANNOT_DELETE_VARIABLE_PROCEDURE.replace("%1",t).replace("%2",l);Blockly.alert(s);return}var g=this;if(i.length>1){var a=Blockly.Msg.DELETE_VARIABLE_CONFIRMATION.replace("%1",String(i.length)).replace("%2",t);Blockly.confirm(a,(function(e){if(e)g.deleteVariableInternal_(o,i)}))}else g.deleteVariableInternal_(o,i)}else console.warn("Can't delete non-existent variable: "+e)};Blockly.VariableMap.prototype.deleteVariableInternal_=function(e,o){var t=Blockly.Events.getGroup();if(!t)Blockly.Events.setGroup(true);try{for(var i=0;i<o.length;i++)o[i].dispose(true,false);this.deleteVariable(e)}finally{if(!t)Blockly.Events.setGroup(false)}};Blockly.VariableMap.prototype.getVariable=function(e,o){var t=o||"";var i=this.variableMap_[t];if(i)for(var r=0,n;n=i[r];r++)if(n.name==e)return n;return null};Blockly.VariableMap.prototype.getVariableById=function(e){var o=Object.keys(this.variableMap_);for(var t=0;t<o.length;t++){var i=o[t];for(var r=0,n;n=this.variableMap_[i][r];r++)if(n.getId()==e)return n}return null};Blockly.VariableMap.prototype.getVariablesOfType=function(e){e=e||"";var o=this.variableMap_[e];if(o)return o.slice();return[]};Blockly.VariableMap.prototype.getVariableTypes=function(){var e=Object.keys(this.variableMap_);var o=false;for(var t=0;t<e.length;t++)if(""==e[t])o=true;if(!o)e.push("");return e};Blockly.VariableMap.prototype.getAllVariables=function(){var e=[];var o=Object.keys(this.variableMap_);for(var t=0;t<o.length;t++)e=e.concat(this.variableMap_[o[t]]);return e};Blockly.VariableMap.prototype.getVariableUsesById=function(e){var o=[];var t=this.workspace.getAllBlocks();for(var i=0;i<t.length;i++){var r=t[i].getVarModels();if(r)for(var n=0;n<r.length;n++)if(r[n].getId()==e)o.push(t[i])}return o};goog.provide("Blockly.VariableModel");goog.require("Blockly.Events.VarCreate");goog.require("goog.string");Blockly.VariableModel=function(e,o,t,i,r,n){this.workspace=e;this.name=o;this.type=t||"";this.id_=i||Blockly.utils.genUid();this.isLocal=r||false;this.isCloud=n||false;Blockly.Events.fire(new Blockly.Events.VarCreate(this))};Blockly.VariableModel.prototype.getId=function(){return this.id_};Blockly.VariableModel.compareByName=function(e,o){return Blockly.scratchBlocksUtils.compareStrings(e.name,o.name)};goog.provide("Blockly.Variables");goog.require("Blockly.Blocks");goog.require("Blockly.constants");goog.require("Blockly.VariableModel");goog.require("Blockly.Workspace");goog.require("goog.string");Blockly.Variables.NAME_TYPE=Blockly.VARIABLE_CATEGORY_NAME;Blockly.Variables.CLOUD_PREFIX="☁ ";Blockly.Variables.allUsedVariables=function(e){var o;if(e instanceof Blockly.Block)o=e.getDescendants(false);else if(e instanceof Blockly.Workspace||e instanceof Blockly.WorkspaceSvg)o=e.getAllBlocks();else throw"Not Block or Workspace: "+e;var t=Blockly.Variables.noVariableText();var i=Object.create(null);for(var r=0;r<o.length;r++){var n=o[r].getVarModels();if(n)for(var l=0;l<n.length;l++){var s=n[l];if(s.getId()&&s.name.toLowerCase()!=t)i[s.name.toLowerCase()]=s.name}}var g=[];for(var a in i)g.push(i[a]);return g};Blockly.Variables.allVariables=function(e){if(e instanceof Blockly.Block){console.warn("Deprecated call to Blockly.Variables.allVariables "+"with a block instead of a workspace.  You may want "+"Blockly.Variables.allUsedVariables");return{}}return e.getAllVariables()};Blockly.Variables.allDeveloperVariables=function(e){var o=e.getAllBlocks();var t={};for(var i=0;i<o.length;i++){var r=o[i];if(r.getDeveloperVars){var n=r.getDeveloperVars();for(var l=0;l<n.length;l++)t[n[l]]=n[l]}}var s=[];for(var g in t)s.push(t[g]);return s};Blockly.Variables.noVariableText=function(){return"No variable selected"};Blockly.Variables.generateUniqueName=function(e){var o=e.getAllVariables();var t="";if(o.length){var i=1;var r="ijkmnopqrstuvwxyzabcdefgh";var n=0;var l=r.charAt(n);while(!t){var s=false;for(var g=0;g<o.length;g++)if(o[g].name.toLowerCase()==l){s=true;break}if(s){n++;if(n==r.length){n=0;i++}l=r.charAt(n);if(i>1)l+=i}else t=l}}else t="i";return t};Blockly.Variables.realizePotentialVar=function(e,o,t,i){var r=t.getPotentialVariableMap();var n=t.targetWorkspace;if(!r){console.warn("Called Blockly.Variables.realizePotentialVar with incorrect "+"workspace. The provided workspace does not have a potential variable map.");return}var l;if(i)l=Blockly.Variables.getVariable(n,null,e,o);var s=r.getVariable(e,o);if(!s)return null;var g=s.getId();r.deleteVariable(s);if(l)return l;return n.createVariable(e,o,g)};Blockly.Variables.createVariable=function(e,o,t){var i,r;if(t==Blockly.BROADCAST_MESSAGE_VARIABLE_TYPE){i=Blockly.Msg.NEW_BROADCAST_MESSAGE_TITLE;r=Blockly.Msg.BROADCAST_MODAL_TITLE}else if(t==Blockly.LIST_VARIABLE_TYPE){i=Blockly.Msg.NEW_LIST_TITLE;r=Blockly.Msg.LIST_MODAL_TITLE}else{t=t?t:"";i=Blockly.Msg.NEW_VARIABLE_TITLE;r=Blockly.Msg.VARIABLE_MODAL_TITLE}var n=Blockly.Variables.nameValidator_.bind(null,t);Blockly.prompt(i,"",(function(i,r,l){l=l||{};var s=l.scope;var g="local"===s||false;var a=l.isCloud||false;r=r||[];var c=g?[]:r;var u=n(i,e,c,a,o);if(u){var h=e.getPotentialVariableMap();var d;if(h&&t)d=Blockly.Variables.realizePotentialVar(u,t,e,false);if(!d)d=e.createVariable(u,t,null,g,a);var p=e.isFlyout?e:e.getFlyout();var y=d.getId();if(p.setCheckboxState)p.setCheckboxState(y,true);if(o)o(y)}else if(o)o(null)}),r,t)};Blockly.Variables.nameValidator_=function(e,o,t,i,r,n){if(e==Blockly.BROADCAST_MESSAGE_VARIABLE_TYPE)return Blockly.Variables.validateBroadcastMessageName_(o,t,n);else if(e==Blockly.LIST_VARIABLE_TYPE)return Blockly.Variables.validateScalarVarOrListName_(o,t,i,false,e,Blockly.Msg.LIST_ALREADY_EXISTS);else return Blockly.Variables.validateScalarVarOrListName_(o,t,i,r,e,Blockly.Msg.VARIABLE_ALREADY_EXISTS)};Blockly.Variables.validateBroadcastMessageName_=function(e,o,t){if(!e)return null;var i=o.getVariable(e,Blockly.BROADCAST_MESSAGE_VARIABLE_TYPE);if(i){if(t)t(i.getId());return null}else return e};Blockly.Variables.validateScalarVarOrListName_=function(e,o,t,i,r,n){e=Blockly.Variables.trimName_(e);if(!e)return null;if(i)e=Blockly.Variables.CLOUD_PREFIX+e;if(o.getVariable(e,r)||t.indexOf(e)>=0){Blockly.alert(n.replace("%1",e));return null}else return e};Blockly.Variables.renameVariable=function(e,o,t){var i,r;var n=o.type;if(n==Blockly.BROADCAST_MESSAGE_VARIABLE_TYPE){console.warn("Unexpected attempt to rename a broadcast message with "+"id: "+o.getId()+" and name: "+o.name);return}if(n==Blockly.LIST_VARIABLE_TYPE){i=Blockly.Msg.RENAME_LIST_TITLE;r=Blockly.Msg.RENAME_LIST_MODAL_TITLE}else{i=Blockly.Msg.RENAME_VARIABLE_TITLE;r=Blockly.Msg.RENAME_VARIABLE_MODAL_TITLE}var l=Blockly.Variables.nameValidator_.bind(null,n);var s=i.replace("%1",o.name);var g=o.name;if(o.isCloud&&0==o.name.indexOf(Blockly.Variables.CLOUD_PREFIX))g=g.substring(Blockly.Variables.CLOUD_PREFIX.length);Blockly.prompt(s,g,(function(i,r){if(o.isCloud&&i.length>0&&0==i.indexOf(Blockly.Variables.CLOUD_PREFIX))i=i.substring(Blockly.Variables.CLOUD_PREFIX.length);r=r||[];var n=o.isLocal?[]:r;var s=l(i,e,n,o.isCloud);if(s){e.renameVariableById(o.getId(),s);if(t)t(i)}else if(t)t(null)}),r,n)};Blockly.Variables.trimName_=function(e){if(e)return goog.string.trim(e);else return e};Blockly.Variables.generateVariableFieldXml_=function(e,o){var t=e.type;if(""==t)t="''";var i=o||"VARIABLE";var r='<field name="'+i+'" id="'+e.getId()+'" variabletype="'+goog.string.htmlEscape(t)+'">'+goog.string.htmlEscape(e.name)+"</field>";return r};Blockly.Variables.getOrCreateVariablePackage=function(e,o,t,i){var r=Blockly.Variables.getVariable(e,o,t,i);if(!r)r=Blockly.Variables.createVariable_(e,o,t,i);return r};Blockly.Variables.getVariable=function(e,o,t,i){var r=e.getPotentialVariableMap();if(o){var n=e.getVariableById(o);if(!n&&r)n=r.getVariableById(o)}else if(t){if(void 0==i)throw new Error("Tried to look up a variable by name without a type");var n=e.getVariable(t,i);if(!n&&r)n=r.getVariable(t,i)}return n};Blockly.Variables.createVariable_=function(e,o,t,i){var r=e.getPotentialVariableMap();if(!t){var n=e.isFlyout?e.targetWorkspace:e;t=Blockly.Variables.generateUniqueName(n)}if(r)var l=r.createVariable(t,i,o);else var l=e.createVariable(t,i,o);return l};Blockly.Variables.getAddedVariables=function(e,o){var t=e.getAllVariables();var i=[];if(o.length!=t.length)for(var r=0;r<t.length;r++){var n=t[r];if(!o.includes(n))i.push(n)}return i};goog.provide("Blockly.Icon");goog.require("goog.dom");goog.require("goog.math.Coordinate");Blockly.Icon=function(e){this.block_=e};Blockly.Icon.prototype.collapseHidden=true;Blockly.Icon.prototype.SIZE=17;Blockly.Icon.prototype.bubble_=null;Blockly.Icon.prototype.iconXY_=null;Blockly.Icon.prototype.createIcon=function(){if(this.iconGroup_)return;this.iconGroup_=Blockly.utils.createSvgElement("g",{class:"blocklyIconGroup"},null);if(this.block_.isInFlyout)Blockly.utils.addClass(this.iconGroup_,"blocklyIconGroupReadonly");this.drawIcon_(this.iconGroup_);this.block_.getSvgRoot().appendChild(this.iconGroup_);Blockly.bindEventWithChecks_(this.iconGroup_,"mouseup",this,this.iconClick_);this.updateEditable()};Blockly.Icon.prototype.dispose=function(){goog.dom.removeNode(this.iconGroup_);this.iconGroup_=null;this.setVisible(false);this.block_=null};Blockly.Icon.prototype.updateEditable=function(){};Blockly.Icon.prototype.isVisible=function(){return!!this.bubble_};Blockly.Icon.prototype.iconClick_=function(e){if(this.block_.workspace.isDragging())return;if(!this.block_.isInFlyout&&!Blockly.utils.isRightButton(e))this.setVisible(!this.isVisible())};Blockly.Icon.prototype.updateColour=function(){if(this.isVisible())this.bubble_.setColour(this.block_.getColour())};Blockly.Icon.prototype.renderIcon=function(e){if(this.collapseHidden&&this.block_.isCollapsed()){this.iconGroup_.setAttribute("display","none");return e}this.iconGroup_.setAttribute("display","block");var o=5;var t=this.SIZE;if(this.block_.RTL)e-=t;this.iconGroup_.setAttribute("transform","translate("+e+","+o+")");this.computeIconLocation();if(this.block_.RTL)e-=Blockly.BlockSvg.SEP_SPACE_X;else e+=t+Blockly.BlockSvg.SEP_SPACE_X;return e};Blockly.Icon.prototype.setIconLocation=function(e){this.iconXY_=e;if(this.isVisible())this.bubble_.setAnchorLocation(e)};Blockly.Icon.prototype.computeIconLocation=function(){var e=this.block_.getRelativeToSurfaceXY();var o=Blockly.utils.getRelativeXY(this.iconGroup_);var t=new goog.math.Coordinate(e.x+o.x+this.SIZE/2,e.y+o.y+this.SIZE/2);if(!goog.math.Coordinate.equals(this.getIconLocation(),t))this.setIconLocation(t)};Blockly.Icon.prototype.getIconLocation=function(){return this.iconXY_};goog.provide("Blockly.Comment");goog.require("Blockly.Bubble");goog.require("Blockly.Events.BlockChange");goog.require("Blockly.Events.Ui");goog.require("Blockly.Icon");goog.require("goog.userAgent");Blockly.Comment=function(e){Blockly.Comment.superClass_.constructor.call(this,e);this.createIcon()};goog.inherits(Blockly.Comment,Blockly.Icon);Blockly.Comment.prototype.text_="";Blockly.Comment.prototype.width_=160;Blockly.Comment.prototype.height_=80;Blockly.Comment.prototype.drawIcon_=function(e){Blockly.utils.createSvgElement("circle",{class:"blocklyIconShape",r:"8",cx:"8",cy:"8"},e);Blockly.utils.createSvgElement("path",{class:"blocklyIconSymbol",d:"m6.8,10h2c0.003,-0.617 0.271,-0.962 0.633,-1.266 2.875,-2.405"+"0.607,-5.534 -3.765,-3.874v1.7c3.12,-1.657 3.698,0.118 2.336,1.25"+"-1.201,0.998 -1.201,1.528 -1.204,2.19z"},e);Blockly.utils.createSvgElement("rect",{class:"blocklyIconSymbol",x:"6.8",y:"10.78",height:"2",width:"2"},e)};Blockly.Comment.prototype.createEditor_=function(){this.foreignObject_=Blockly.utils.createSvgElement("foreignObject",{x:Blockly.Bubble.BORDER_WIDTH,y:Blockly.Bubble.BORDER_WIDTH},null);var e=document.createElementNS(Blockly.HTML_NS,"body");e.setAttribute("xmlns",Blockly.HTML_NS);e.className="blocklyMinimalBody";var o=document.createElementNS(Blockly.HTML_NS,"textarea");o.className="blocklyCommentTextarea";o.setAttribute("dir",this.block_.RTL?"RTL":"LTR");e.appendChild(o);this.textarea_=o;this.foreignObject_.appendChild(e);Blockly.bindEventWithChecks_(o,"mouseup",this,this.textareaFocus_);Blockly.bindEventWithChecks_(o,"wheel",this,(function(e){e.stopPropagation()}));Blockly.bindEventWithChecks_(o,"change",this,(function(e){if(this.text_!=o.value){Blockly.Events.fire(new Blockly.Events.BlockChange(this.block_,"comment",null,this.text_,o.value));this.text_=o.value}}));setTimeout((function(){o.focus()}),0);return this.foreignObject_};Blockly.Comment.prototype.updateEditable=function(){if(this.isVisible()){this.setVisible(false);this.setVisible(true)}Blockly.Icon.prototype.updateEditable.call(this)};Blockly.Comment.prototype.resizeBubble_=function(){if(this.isVisible()){var e=this.bubble_.getBubbleSize();var o=2*Blockly.Bubble.BORDER_WIDTH;this.foreignObject_.setAttribute("width",e.width-o);this.foreignObject_.setAttribute("height",e.height-o);this.textarea_.style.width=e.width-o-4+"px";this.textarea_.style.height=e.height-o-4+"px"}};Blockly.Comment.prototype.setVisible=function(e){if(e==this.isVisible())return;Blockly.Events.fire(new Blockly.Events.Ui(this.block_,"commentOpen",!e,e));if(!this.block_.isEditable()&&!this.textarea_||goog.userAgent.IE){Blockly.Warning.prototype.setVisible.call(this,e);return}var o=this.getText();var t=this.getBubbleSize();if(e){this.bubble_=new Blockly.Bubble(this.block_.workspace,this.createEditor_(),this.block_.svgPath_,this.iconXY_,this.width_,this.height_);this.bubble_.setSvgId(this.block_.id);this.bubble_.registerResizeEvent(this.resizeBubble_.bind(this));this.updateColour()}else{this.bubble_.dispose();this.bubble_=null;this.textarea_=null;this.foreignObject_=null}this.setText(o);this.setBubbleSize(t.width,t.height)};Blockly.Comment.prototype.textareaFocus_=function(e){if(this.bubble_.promote_())this.textarea_.focus()};Blockly.Comment.prototype.getBubbleSize=function(){if(this.isVisible())return this.bubble_.getBubbleSize();else return{width:this.width_,height:this.height_}};Blockly.Comment.prototype.setBubbleSize=function(e,o){if(this.textarea_)this.bubble_.setBubbleSize(e,o);else{this.width_=e;this.height_=o}};Blockly.Comment.prototype.getText=function(){return this.textarea_?this.textarea_.value:this.text_};Blockly.Comment.prototype.setText=function(e){if(this.text_!=e){Blockly.Events.fire(new Blockly.Events.BlockChange(this.block_,"comment",null,this.text_,e));this.text_=e}if(this.textarea_)this.textarea_.value=e};Blockly.Comment.prototype.dispose=function(){if(Blockly.Events.isEnabled())this.setText("");this.block_.comment=null;Blockly.Icon.prototype.dispose.call(this)};goog.provide("Blockly.ScratchBlockComment");goog.require("Blockly.Comment");goog.require("Blockly.Events.BlockChange");goog.require("Blockly.Events.Ui");goog.require("Blockly.Icon");goog.require("Blockly.ScratchBubble");goog.require("goog.math.Coordinate");goog.require("goog.userAgent");Blockly.ScratchBlockComment=function(e,o,t,i,r,n){Blockly.ScratchBlockComment.superClass_.constructor.call(this,e);this.text_=o;var l="number"==typeof i&&!isNaN(i);var s="number"==typeof r&&!isNaN(r);this.needsAutoPositioning_=!l&&!s;this.x_=l?i:0;this.y_=s?r:0;this.isMinimized_=n||false;this.workspace=e.workspace;this.id=goog.isString(t)&&!this.workspace.getCommentById(t)?t:Blockly.utils.genUid();this.workspace.addTopComment(this);this.blockId=e.id;if(!e.rendered)Blockly.ScratchBlockComment.fireCreateEvent(this)};goog.inherits(Blockly.ScratchBlockComment,Blockly.Comment);Blockly.ScratchBlockComment.prototype.width_=200;Blockly.ScratchBlockComment.prototype.height_=200;Blockly.ScratchBlockComment.prototype.SIZE=0;Blockly.ScratchBlockComment.TEXTAREA_OFFSET=12;Blockly.ScratchBlockComment.MAX_LABEL_LENGTH=12;Blockly.ScratchBlockComment.COMMENT_TEXT_LIMIT=8e3;Blockly.ScratchBlockComment.MINIMIZE_WIDTH=200;Blockly.ScratchBlockComment.prototype.drawIcon_=function(e){};Blockly.ScratchBlockComment.prototype.renderIcon=function(e,o){if(this.collapseHidden&&this.block_.isCollapsed()){this.iconGroup_.setAttribute("display","none");return e}this.iconGroup_.setAttribute("display","block");var t=this.SIZE;if(this.block_.RTL)e-=t;this.iconGroup_.setAttribute("transform","translate("+e+","+o+")");this.computeIconLocation();if(this.block_.RTL)e-=Blockly.BlockSvg.SEP_SPACE_X;else e+=t+Blockly.BlockSvg.SEP_SPACE_X;return e};Blockly.ScratchBlockComment.prototype.createEditor_=function(){this.foreignObject_=Blockly.utils.createSvgElement("foreignObject",{x:Blockly.ScratchBubble.BORDER_WIDTH,y:Blockly.ScratchBubble.BORDER_WIDTH+Blockly.ScratchBubble.TOP_BAR_HEIGHT,class:"scratchCommentForeignObject"},null);var e=document.createElementNS(Blockly.HTML_NS,"body");e.setAttribute("xmlns",Blockly.HTML_NS);e.className="blocklyMinimalBody scratchCommentBody";var o=document.createElementNS(Blockly.HTML_NS,"textarea");o.className="scratchCommentTextarea scratchCommentText";o.setAttribute("dir",this.block_.RTL?"RTL":"LTR");o.setAttribute("maxlength",Blockly.ScratchBlockComment.COMMENT_TEXT_LIMIT);o.setAttribute("placeholder",Blockly.Msg.WORKSPACE_COMMENT_DEFAULT_TEXT);e.appendChild(o);this.textarea_=o;this.textarea_.style.margin=Blockly.ScratchBlockComment.TEXTAREA_OFFSET+"px";this.foreignObject_.appendChild(e);Blockly.bindEventWithChecks_(o,"mousedown",this,this.textareaFocus_,true,true);Blockly.bindEventWithChecks_(o,"wheel",this,(function(e){e.stopPropagation()}));Blockly.bindEventWithChecks_(o,"change",this,(function(e){if(this.text_!=o.value){Blockly.Events.fire(new Blockly.Events.CommentChange(this,{text:this.text_},{text:o.value}));this.text_=o.value}}));this.label_=this.getLabelText();return{commentEditor:this.foreignObject_,labelText:this.label_}};Blockly.ScratchBlockComment.prototype.textareaFocus_=function(e){Blockly.ScratchBlockComment.superClass_.textareaFocus_.call(this,e);e.stopPropagation()};Blockly.ScratchBlockComment.prototype.resizeBubble_=function(){if(this.isVisible()&&!this.isMinimized_){var e=this.bubble_.getBubbleSize();var o=2*Blockly.ScratchBubble.BORDER_WIDTH;var t=2*Blockly.ScratchBlockComment.TEXTAREA_OFFSET;this.foreignObject_.setAttribute("width",e.width-o);this.foreignObject_.setAttribute("height",e.height-o-Blockly.ScratchBubble.TOP_BAR_HEIGHT);this.textarea_.style.width=e.width-t+"px";this.textarea_.style.height=e.height-o-Blockly.ScratchBubble.TOP_BAR_HEIGHT-t+"px";this.width_=e.width;this.height_=e.height}};Blockly.ScratchBlockComment.prototype.updateColour=function(){if(this.isVisible())this.bubble_.setColour(this.block_.getColourTertiary())};Blockly.ScratchBlockComment.prototype.autoPosition_=function(){if(!this.needsAutoPositioning_)return;if(this.isMinimized_){var e=4*Blockly.BlockSvg.GRID_UNIT;this.x_=this.block_.RTL?this.iconXY_.x-this.getBubbleSize().width-e:this.iconXY_.x+e;this.y_=this.iconXY_.y-Blockly.ScratchBubble.TOP_BAR_HEIGHT/2}else{var o=Math.floor(this.block_.svgPath_.getBBox().width);var t=Math.floor(this.block_.getHeightWidth().width);var i=t-o;var r=8*Blockly.BlockSvg.GRID_UNIT;this.x_=this.block_.RTL?this.iconXY_.x-this.width_-i-r:this.iconXY_.x+i+r;this.y_=this.iconXY_.y-Blockly.ScratchBubble.TOP_BAR_HEIGHT/2}};Blockly.ScratchBlockComment.prototype.setVisible=function(e){if(e==this.isVisible())return;if(!this.block_.isEditable()&&!this.textarea_||goog.userAgent.IE){Blockly.Warning.prototype.setVisible.call(this,e);return}var o=this.getText();var t=this.getBubbleSize();if(e){if(this.needsAutoPositioning_){this.autoPosition_();this.needsAutoPositioning_=false}this.bubble_=new Blockly.ScratchBubble(this,this.block_.workspace,this.createEditor_(),this.iconXY_,this.width_,this.height_,this.x_,this.y_,this.isMinimized_);this.bubble_.setAutoLayout(false);this.bubble_.registerResizeEvent(this.resizeBubble_.bind(this));this.bubble_.registerMinimizeToggleEvent(this.toggleMinimize_.bind(this));this.bubble_.registerDeleteEvent(this.dispose.bind(this));this.bubble_.registerContextMenuCallback(this.showContextMenu_.bind(this));this.updateColour()}else{this.bubble_.dispose();this.bubble_=null;this.textarea_=null;this.foreignObject_=null;this.label_=null}this.setText(o);this.setBubbleSize(t.width,t.height);if(e)Blockly.ScratchBlockComment.fireCreateEvent(this)};Blockly.ScratchBlockComment.prototype.toggleMinimize_=function(){this.setMinimized(!this.isMinimized_)};Blockly.ScratchBlockComment.prototype.setMinimized=function(e){if(this.isMinimized_==e)return;Blockly.Events.fire(new Blockly.Events.CommentChange(this,{minimized:this.isMinimized_},{minimized:e}));this.isMinimized_=e;if(e){this.bubble_.setMinimized(true,this.getLabelText());this.setBubbleSize(Blockly.ScratchBlockComment.MINIMIZE_WIDTH,Blockly.ScratchBubble.TOP_BAR_HEIGHT)}else{this.bubble_.setMinimized(false);this.setText(this.text_);this.setBubbleSize(this.width_,this.height_)}};Blockly.ScratchBlockComment.prototype.setBubbleSize=function(e,o){if(this.bubble_)if(this.isMinimized_)this.bubble_.setBubbleSize(Blockly.ScratchBlockComment.MINIMIZE_WIDTH,Blockly.ScratchBubble.TOP_BAR_HEIGHT);else this.bubble_.setBubbleSize(e,o)};Blockly.ScratchBlockComment.prototype.setSize=function(e,o){var t=this.width_;var i=this.height_;if(!this.isMinimized_)this.setBubbleSize(e,o);this.height_=o;this.width_=e;if(t!=this.width_||i!=this.height_)Blockly.Events.fire(new Blockly.Events.CommentChange(this,{width:t,height:i},{width:this.width_,height:this.height_}))};Blockly.ScratchBlockComment.prototype.getLabelText=function(){if(this.text_.length>Blockly.ScratchBlockComment.MAX_LABEL_LENGTH){if(this.block_.RTL)return"…"+this.text_.slice(0,Blockly.ScratchBlockComment.MAX_LABEL_LENGTH);return this.text_.slice(0,Blockly.ScratchBlockComment.MAX_LABEL_LENGTH)+"…"}else return this.text_};Blockly.ScratchBlockComment.prototype.setText=function(e){if(this.text_!=e){Blockly.Events.fire(new Blockly.Events.CommentChange(this,{text:this.text_},{text:e}));this.text_=e}if(this.textarea_)this.textarea_.value=e};Blockly.ScratchBlockComment.prototype.moveTo=function(e,o){var t=new Blockly.Events.CommentMove(this);if(this.bubble_)this.bubble_.moveTo(e,o);this.x_=e;this.y_=o;t.recordNew();Blockly.Events.fire(t)};Blockly.ScratchBlockComment.prototype.getXY=function(){if(this.bubble_)return this.bubble_.getRelativeToSurfaceXY();if(this.needsAutoPositioning_&&this.iconXY_)this.autoPosition_();return new goog.math.Coordinate(this.x_,this.y_)};Blockly.ScratchBlockComment.prototype.getHeightWidth=function(){return{height:this.height_,width:this.width_}};Blockly.ScratchBlockComment.prototype.getBoundingRectangle=function(){var e=this.getXY();var o=this.getBubbleSize();var t;var i;if(this.workspace.RTL){t=new goog.math.Coordinate(e.x-o.width,e.y);i=new goog.math.Coordinate(e.x,e.y+o.height)}else{t=new goog.math.Coordinate(e.x,e.y);i=new goog.math.Coordinate(e.x+o.width,e.y+o.height)}return{topLeft:t,bottomRight:i}};Blockly.ScratchBlockComment.prototype.isMinimized=function(){return this.isMinimized_};Blockly.ScratchBlockComment.prototype.showContextMenu_=function(e){var o=[];o.push(Blockly.ContextMenu.commentDeleteOption(this,Blockly.Msg.DELETE));Blockly.ContextMenu.show(e,o,this.block_.RTL)};Blockly.ScratchBlockComment.prototype.toXmlWithXY=function(){var e=goog.dom.createDom("comment");e.setAttribute("id",this.id);e.textContent=this.text_;e.setAttribute("x",Math.round(this.workspace.RTL?this.workspace.getWidth()-this.x_:this.x_));e.setAttribute("y",Math.round(this.y_));e.setAttribute("h",this.height_);e.setAttribute("w",this.width_);return e};Blockly.ScratchBlockComment.fireCreateEvent=function(e){if(Blockly.Events.isEnabled()){var o=Blockly.Events.getGroup();if(!o)Blockly.Events.setGroup(true);try{Blockly.Events.fire(new Blockly.Events.CommentCreate(e))}finally{if(!o)Blockly.Events.setGroup(false)}}};Blockly.ScratchBlockComment.prototype.dispose=function(){if(Blockly.Events.isEnabled())Blockly.Events.fire(new Blockly.Events.CommentDelete(this));this.block_.comment=null;this.workspace.removeTopComment(this);Blockly.Icon.prototype.dispose.call(this)};Blockly.ScratchBlockComment.prototype.focus=function(){this.textarea_.focus()};goog.provide("Blockly.Mutator");goog.require("Blockly.Bubble");goog.require("Blockly.Events.BlockChange");goog.require("Blockly.Events.Ui");goog.require("Blockly.Icon");goog.require("Blockly.WorkspaceSvg");goog.require("goog.dom");Blockly.Mutator=function(e){Blockly.Mutator.superClass_.constructor.call(this,null);this.quarkNames_=e};goog.inherits(Blockly.Mutator,Blockly.Icon);Blockly.Mutator.prototype.workspaceWidth_=0;Blockly.Mutator.prototype.workspaceHeight_=0;Blockly.Mutator.prototype.drawIcon_=function(e){Blockly.utils.createSvgElement("rect",{class:"blocklyIconShape",rx:"4",ry:"4",height:"16",width:"16"},e);Blockly.utils.createSvgElement("path",{class:"blocklyIconSymbol",d:"m4.203,7.296 0,1.368 -0.92,0.677 -0.11,0.41 0.9,1.559 0.41,"+"0.11 1.043,-0.457 1.187,0.683 0.127,1.134 0.3,0.3 1.8,0 0.3,"+"-0.299 0.127,-1.138 1.185,-0.682 1.046,0.458 0.409,-0.11 0.9,"+"-1.559 -0.11,-0.41 -0.92,-0.677 0,-1.366 0.92,-0.677 0.11,"+"-0.41 -0.9,-1.559 -0.409,-0.109 -1.046,0.458 -1.185,-0.682 "+"-0.127,-1.138 -0.3,-0.299 -1.8,0 -0.3,0.3 -0.126,1.135 -1.187,"+"0.682 -1.043,-0.457 -0.41,0.11 -0.899,1.559 0.108,0.409z"},e);Blockly.utils.createSvgElement("circle",{class:"blocklyIconShape",r:"2.7",cx:"8",cy:"8"},e)};Blockly.Mutator.prototype.iconClick_=function(e){if(this.block_.isEditable())Blockly.Icon.prototype.iconClick_.call(this,e)};Blockly.Mutator.prototype.createEditor_=function(){this.svgDialog_=Blockly.utils.createSvgElement("svg",{x:Blockly.Bubble.BORDER_WIDTH,y:Blockly.Bubble.BORDER_WIDTH},null);if(this.quarkNames_.length){var e=goog.dom.createDom("xml");for(var o=0,t;t=this.quarkNames_[o];o++)e.appendChild(goog.dom.createDom("block",{type:t}))}else var e=null;var i={languageTree:e,parentWorkspace:this.block_.workspace,pathToMedia:this.block_.workspace.options.pathToMedia,RTL:this.block_.RTL,toolboxPosition:this.block_.RTL?Blockly.TOOLBOX_AT_RIGHT:Blockly.TOOLBOX_AT_LEFT,horizontalLayout:false,getMetrics:this.getFlyoutMetrics_.bind(this),setMetrics:null};this.workspace_=new Blockly.WorkspaceSvg(i,this.block_.workspace.dragSurface);this.workspace_.isMutator=true;var r=this.workspace_.addFlyout_("g");var n=this.workspace_.createDom("blocklyMutatorBackground");n.insertBefore(r,this.workspace_.svgBlockCanvas_);this.svgDialog_.appendChild(n);return this.svgDialog_};Blockly.Mutator.prototype.updateEditable=function(){if(!this.block_.isInFlyout)if(this.block_.isEditable()){if(this.iconGroup_)Blockly.utils.removeClass(this.iconGroup_,"blocklyIconGroupReadonly")}else{this.setVisible(false);if(this.iconGroup_)Blockly.utils.addClass(this.iconGroup_,"blocklyIconGroupReadonly")}Blockly.Icon.prototype.updateEditable.call(this)};Blockly.Mutator.prototype.resizeBubble_=function(){var e=2*Blockly.Bubble.BORDER_WIDTH;var o=this.workspace_.getCanvas().getBBox();var t;if(this.block_.RTL)t=-o.x;else t=o.width+o.x;var i=o.height+3*e;if(this.workspace_.flyout_){var r=this.workspace_.flyout_.getMetrics_();i=Math.max(i,r.contentHeight+20)}t+=3*e;if(Math.abs(this.workspaceWidth_-t)>e||Math.abs(this.workspaceHeight_-i)>e){this.workspaceWidth_=t;this.workspaceHeight_=i;this.bubble_.setBubbleSize(t+e,i+e);this.svgDialog_.setAttribute("width",this.workspaceWidth_);this.svgDialog_.setAttribute("height",this.workspaceHeight_)}if(this.block_.RTL){var n="translate("+this.workspaceWidth_+",0)";this.workspace_.getCanvas().setAttribute("transform",n)}this.workspace_.resize()};Blockly.Mutator.prototype.setVisible=function(e){if(e==this.isVisible())return;Blockly.Events.fire(new Blockly.Events.Ui(this.block_,"mutatorOpen",!e,e));if(e){this.bubble_=new Blockly.Bubble(this.block_.workspace,this.createEditor_(),this.block_.svgPath_,this.iconXY_,null,null);var o=this.workspace_.options.languageTree;if(o){this.workspace_.flyout_.init(this.workspace_);this.workspace_.flyout_.show(o.childNodes)}this.rootBlock_=this.block_.decompose(this.workspace_);var t=this.rootBlock_.getDescendants(false);for(var i=0,r;r=t[i];i++)r.render();this.rootBlock_.setMovable(false);this.rootBlock_.setDeletable(false);if(this.workspace_.flyout_){var n=2*this.workspace_.flyout_.CORNER_RADIUS;var l=this.workspace_.flyout_.width_+n}else{var n=16;var l=n}if(this.block_.RTL)l=-l;this.rootBlock_.moveBy(l,n);if(this.block_.saveConnections){var s=this;this.block_.saveConnections(this.rootBlock_);this.sourceListener_=function(){s.block_.saveConnections(s.rootBlock_)};this.block_.workspace.addChangeListener(this.sourceListener_)}this.resizeBubble_();this.workspace_.addChangeListener(this.workspaceChanged_.bind(this));this.updateColour()}else{this.svgDialog_=null;this.workspace_.dispose();this.workspace_=null;this.rootBlock_=null;this.bubble_.dispose();this.bubble_=null;this.workspaceWidth_=0;this.workspaceHeight_=0;if(this.sourceListener_){this.block_.workspace.removeChangeListener(this.sourceListener_);this.sourceListener_=null}}};Blockly.Mutator.prototype.workspaceChanged_=function(){if(!this.workspace_.isDragging()){var e=this.workspace_.getTopBlocks(false);var o=20;for(var t=0,i;i=e[t];t++){var r=i.getRelativeToSurfaceXY();var n=i.getHeightWidth();if(r.y+n.height<o)i.moveBy(0,o-n.height-r.y)}}if(this.rootBlock_.workspace==this.workspace_){Blockly.Events.setGroup(true);var i=this.block_;var l=i.mutationToDom();var s=l&&Blockly.Xml.domToText(l);var g=i.rendered;i.rendered=false;i.compose(this.rootBlock_);i.rendered=g;i.initSvg();var a=i.mutationToDom();var c=a&&Blockly.Xml.domToText(a);if(s!=c){Blockly.Events.fire(new Blockly.Events.BlockChange(i,"mutation",null,s,c));var u=Blockly.Events.getGroup();setTimeout((function(){Blockly.Events.setGroup(u);i.bumpNeighbours_();Blockly.Events.setGroup(false)}),Blockly.BUMP_DELAY)}if(i.rendered)i.render();if(!this.workspace_.isDragging())this.resizeBubble_();Blockly.Events.setGroup(false)}};Blockly.Mutator.prototype.getFlyoutMetrics_=function(){return{viewHeight:this.workspaceHeight_,viewWidth:this.workspaceWidth_,absoluteTop:0,absoluteLeft:0}};Blockly.Mutator.prototype.dispose=function(){this.block_.mutator=null;Blockly.Icon.prototype.dispose.call(this)};Blockly.Mutator.reconnect=function(e,o,t){if(!e||!e.getSourceBlock().workspace)return false;var i=o.getInput(t).connection;var r=e.targetBlock();if((!r||r==o)&&i.targetConnection!=e){if(i.isConnected())i.disconnect();i.connect(e);return true}return false};if(!goog.global["Blockly"])goog.global["Blockly"]={};if(!goog.global["Blockly"]["Mutator"])goog.global["Blockly"]["Mutator"]={};goog.global["Blockly"]["Mutator"]["reconnect"]=Blockly.Mutator.reconnect;goog.provide("Blockly.Warning");goog.require("Blockly.Bubble");goog.require("Blockly.Events.Ui");goog.require("Blockly.Icon");Blockly.Warning=function(e){Blockly.Warning.superClass_.constructor.call(this,e);this.createIcon();this.text_={}};goog.inherits(Blockly.Warning,Blockly.Icon);Blockly.Warning.prototype.collapseHidden=false;Blockly.Warning.prototype.drawIcon_=function(e){Blockly.utils.createSvgElement("path",{class:"blocklyIconShape",d:"M2,15Q-1,15 0.5,12L6.5,1.7Q8,-1 9.5,1.7L15.5,12Q17,15 14,15z"},e);Blockly.utils.createSvgElement("path",{class:"blocklyIconSymbol",d:"m7,4.8v3.16l0.27,2.27h1.46l0.27,-2.27v-3.16z"},e);Blockly.utils.createSvgElement("rect",{class:"blocklyIconSymbol",x:"7",y:"11",height:"2",width:"2"},e)};Blockly.Warning.textToDom_=function(e){var o=Blockly.utils.createSvgElement("text",{class:"blocklyText blocklyBubbleText",y:Blockly.Bubble.BORDER_WIDTH},null);var t=e.split("\n");for(var i=0;i<t.length;i++){var r=Blockly.utils.createSvgElement("tspan",{dy:"1em",x:Blockly.Bubble.BORDER_WIDTH},o);var n=document.createTextNode(t[i]);r.appendChild(n)}return o};Blockly.Warning.prototype.setVisible=function(e){if(e==this.isVisible())return;Blockly.Events.fire(new Blockly.Events.Ui(this.block_,"warningOpen",!e,e));if(e){var o=Blockly.Warning.textToDom_(this.getText());this.bubble_=new Blockly.Bubble(this.block_.workspace,o,this.block_.svgPath_,this.iconXY_,null,null);if(this.block_.RTL){var t=o.getBBox().width;for(var i=0,r;r=o.childNodes[i];i++){r.setAttribute("text-anchor","end");r.setAttribute("x",t+Blockly.Bubble.BORDER_WIDTH)}}this.updateColour();var n=this.bubble_.getBubbleSize();this.bubble_.setBubbleSize(n.width,n.height)}else{this.bubble_.dispose();this.bubble_=null;this.body_=null}};Blockly.Warning.prototype.bodyFocus_=function(e){this.bubble_.promote_()};Blockly.Warning.prototype.setText=function(e,o){if(this.text_[o]==e)return;if(e)this.text_[o]=e;else delete this.text_[o];if(this.isVisible()){this.setVisible(false);this.setVisible(true)}};Blockly.Warning.prototype.getText=function(){var e=[];for(var o in this.text_)e.push(this.text_[o]);return e.join("\n")};Blockly.Warning.prototype.dispose=function(){this.block_.warning=null;Blockly.Icon.prototype.dispose.call(this)};goog.provide("Blockly.Events");goog.require("goog.array");goog.require("goog.math.Coordinate");Blockly.Events.group_="";Blockly.Events.recordUndo=true;Blockly.Events.disabled_=0;Blockly.Events.CREATE="create";Blockly.Events.BLOCK_CREATE=Blockly.Events.CREATE;Blockly.Events.DELETE="delete";Blockly.Events.BLOCK_DELETE=Blockly.Events.DELETE;Blockly.Events.CHANGE="change";Blockly.Events.BLOCK_CHANGE=Blockly.Events.CHANGE;Blockly.Events.MOVE="move";Blockly.Events.DRAG_OUTSIDE="dragOutside";Blockly.Events.END_DRAG="endDrag";Blockly.Events.BLOCK_MOVE=Blockly.Events.MOVE;Blockly.Events.VAR_CREATE="var_create";Blockly.Events.VAR_DELETE="var_delete";Blockly.Events.VAR_RENAME="var_rename";Blockly.Events.COMMENT_CREATE="comment_create";Blockly.Events.COMMENT_MOVE="comment_move";Blockly.Events.COMMENT_CHANGE="comment_change";Blockly.Events.COMMENT_DELETE="comment_delete";Blockly.Events.UI="ui";Blockly.Events.FIRE_QUEUE_=[];Blockly.Events.fire=function(e){if(!Blockly.Events.isEnabled())return;if(!Blockly.Events.FIRE_QUEUE_.length)setTimeout(Blockly.Events.fireNow_,0);Blockly.Events.FIRE_QUEUE_.push(e)};Blockly.Events.fireNow_=function(){var e=Blockly.Events.filter(Blockly.Events.FIRE_QUEUE_,true);Blockly.Events.FIRE_QUEUE_.length=0;for(var o=0,t;t=e[o];o++){var i=Blockly.Workspace.getById(t.workspaceId);if(i)i.fireChangeListener(t)}};Blockly.Events.filter=function(e,o){var t=goog.array.clone(e);if(!o)t.reverse();var i=[];var r=Object.create(null);for(var n=0,l;l=t[n];n++)if(!l.isNull()){var s=[l.type,l.blockId,l.workspaceId].join(" ");var g=r[s];if(!g){r[s]=l;i.push(l)}else if(l.type==Blockly.Events.MOVE){g.newParentId=l.newParentId;g.newInputName=l.newInputName;g.newCoordinate=l.newCoordinate}else if(l.type==Blockly.Events.CHANGE&&l.element==g.element&&l.name==g.name)g.newValue=l.newValue;else if(l.type==Blockly.Events.UI&&"click"==l.element&&("commentOpen"==g.element||"mutatorOpen"==g.element||"warningOpen"==g.element))g.newValue=l.newValue;else{r[s]=l;i.push(l)}}t=i.filter((function(e){return!e.isNull()}));if(!o)t.reverse();for(var n=1,l;l=t[n];n++)if(l.type==Blockly.Events.CHANGE&&"mutation"==l.element)t.unshift(t.splice(n,1)[0]);return t};Blockly.Events.clearPendingUndo=function(){for(var e=0,o;o=Blockly.Events.FIRE_QUEUE_[e];e++)o.recordUndo=false};Blockly.Events.disable=function(){Blockly.Events.disabled_++};Blockly.Events.enable=function(){Blockly.Events.disabled_--};Blockly.Events.isEnabled=function(){return 0==Blockly.Events.disabled_};Blockly.Events.getGroup=function(){return Blockly.Events.group_};Blockly.Events.setGroup=function(e){if("boolean"==typeof e)Blockly.Events.group_=e?Blockly.utils.genUid():"";else Blockly.Events.group_=e};Blockly.Events.getDescendantIds_=function(e){var o=[];var t=e.getDescendants(false);for(var i=0,r;r=t[i];i++)o[i]=r.id;return o};Blockly.Events.fromJson=function(e,o){var t;switch(e.type){case Blockly.Events.CREATE:t=new Blockly.Events.Create(null);break;case Blockly.Events.DELETE:t=new Blockly.Events.Delete(null);break;case Blockly.Events.CHANGE:t=new Blockly.Events.Change(null);break;case Blockly.Events.MOVE:t=new Blockly.Events.Move(null);break;case Blockly.Events.VAR_CREATE:t=new Blockly.Events.VarCreate(null);break;case Blockly.Events.VAR_DELETE:t=new Blockly.Events.VarDelete(null);break;case Blockly.Events.VAR_RENAME:t=new Blockly.Events.VarRename(null);break;case Blockly.Events.COMMENT_CREATE:t=new Blockly.Events.CommentCreate(null);break;case Blockly.Events.COMMENT_CHANGE:t=new Blockly.Events.CommentChange(null);break;case Blockly.Events.COMMENT_MOVE:t=new Blockly.Events.CommentMove(null);break;case Blockly.Events.COMMENT_DELETE:t=new Blockly.Events.CommentDelete(null);break;case Blockly.Events.UI:t=new Blockly.Events.Ui(null);break;case Blockly.Events.DRAG_OUTSIDE:t=new Blockly.Events.DragBlockOutside(null);break;case Blockly.Events.END_DRAG:t=new Blockly.Events.EndBlockDrag(null,false);break;default:throw"Unknown event type."}t.fromJson(e);t.workspaceId=o.id;return t};Blockly.Events.disableOrphans=function(e){if(e.type==Blockly.Events.MOVE||e.type==Blockly.Events.CREATE){Blockly.Events.disable();var o=Blockly.Workspace.getById(e.workspaceId);var t=o.getBlockById(e.blockId);if(t)if(t.getParent()&&!t.getParent().disabled){var i=t.getDescendants(false);for(var r=0,n;n=i[r];r++)n.setDisabled(false)}else if((t.outputConnection||t.previousConnection)&&!o.isDragging())do{t.setDisabled(true);t=t.getNextBlock()}while(t);Blockly.Events.enable()}};goog.provide("Blockly.Events.Abstract");goog.require("Blockly.Events");goog.require("goog.array");goog.require("goog.math.Coordinate");Blockly.Events.Abstract=function(){this.workspaceId=void 0;this.group=Blockly.Events.group_;this.recordUndo=Blockly.Events.recordUndo};Blockly.Events.Abstract.prototype.toJson=function(){var e={type:this.type};if(this.group)e["group"]=this.group;return e};Blockly.Events.Abstract.prototype.fromJson=function(e){this.group=e["group"]};Blockly.Events.Abstract.prototype.isNull=function(){return false};Blockly.Events.Abstract.prototype.run=function(e){};Blockly.Events.Abstract.prototype.getEventWorkspace_=function(){var e=Blockly.Workspace.getById(this.workspaceId);if(!e)throw Error("Workspace is null. Event must have been generated from real"+" Blockly events.");return e};goog.provide("Blockly.Events.BlockBase");goog.provide("Blockly.Events.BlockChange");goog.provide("Blockly.Events.BlockCreate");goog.provide("Blockly.Events.BlockDelete");goog.provide("Blockly.Events.BlockMove");goog.provide("Blockly.Events.Change");goog.provide("Blockly.Events.Create");goog.provide("Blockly.Events.Delete");goog.provide("Blockly.Events.Move");goog.require("Blockly.Events");goog.require("Blockly.Events.Abstract");goog.require("goog.array");goog.require("goog.math.Coordinate");Blockly.Events.BlockBase=function(e){Blockly.Events.BlockBase.superClass_.constructor.call(this);this.blockId=e.id;this.workspaceId=e.workspace.id};goog.inherits(Blockly.Events.BlockBase,Blockly.Events.Abstract);Blockly.Events.BlockBase.prototype.toJson=function(){var e=Blockly.Events.BlockBase.superClass_.toJson.call(this);e["blockId"]=this.blockId;return e};Blockly.Events.BlockBase.prototype.fromJson=function(e){Blockly.Events.BlockBase.superClass_.toJson.call(this);this.blockId=e["blockId"]};Blockly.Events.Change=function(e,o,t,i,r){if(!e)return;Blockly.Events.Change.superClass_.constructor.call(this,e);this.element=o;this.name=t;this.oldValue=i;this.newValue=r};goog.inherits(Blockly.Events.Change,Blockly.Events.BlockBase);Blockly.Events.BlockChange=Blockly.Events.Change;Blockly.Events.Change.prototype.type=Blockly.Events.CHANGE;Blockly.Events.Change.prototype.toJson=function(){var e=Blockly.Events.Change.superClass_.toJson.call(this);e["element"]=this.element;if(this.name)e["name"]=this.name;e["newValue"]=this.newValue;return e};Blockly.Events.Change.prototype.fromJson=function(e){Blockly.Events.Change.superClass_.fromJson.call(this,e);this.element=e["element"];this.name=e["name"];this.newValue=e["newValue"]};Blockly.Events.Change.prototype.isNull=function(){return this.oldValue==this.newValue};Blockly.Events.Change.prototype.run=function(e){var o=this.getEventWorkspace_();var t=o.getBlockById(this.blockId);if(!t){console.warn("Can't change non-existent block: "+this.blockId);return}if(t.mutator)t.mutator.setVisible(false);var i=e?this.newValue:this.oldValue;switch(this.element){case"field":var r=t.getField(this.name);if(r){r.callValidator(i);r.setValue(i)}else console.warn("Can't set non-existent field: "+this.name);break;case"comment":t.setCommentText(i||null);break;case"collapsed":t.setCollapsed(i);break;case"disabled":t.setDisabled(i);break;case"inline":t.setInputsInline(i);break;case"mutation":var n="";if(t.mutationToDom){var l=t.mutationToDom();n=l&&Blockly.Xml.domToText(l)}if(t.domToMutation){i=i||"<mutation></mutation>";var s=Blockly.Xml.textToDom("<xml>"+i+"</xml>");t.domToMutation(s.firstChild)}Blockly.Events.fire(new Blockly.Events.Change(t,"mutation",null,n,i));break;default:console.warn("Unknown change type: "+this.element)}};Blockly.Events.Create=function(e){if(!e)return;Blockly.Events.Create.superClass_.constructor.call(this,e);if(e.workspace.rendered)this.xml=Blockly.Xml.blockToDomWithXY(e);else this.xml=Blockly.Xml.blockToDom(e);this.ids=Blockly.Events.getDescendantIds_(e)};goog.inherits(Blockly.Events.Create,Blockly.Events.BlockBase);Blockly.Events.BlockCreate=Blockly.Events.Create;Blockly.Events.Create.prototype.type=Blockly.Events.CREATE;Blockly.Events.Create.prototype.toJson=function(){var e=Blockly.Events.Create.superClass_.toJson.call(this);e["xml"]=Blockly.Xml.domToText(this.xml);e["ids"]=this.ids;return e};Blockly.Events.Create.prototype.fromJson=function(e){Blockly.Events.Create.superClass_.fromJson.call(this,e);this.xml=Blockly.Xml.textToDom("<xml>"+e["xml"]+"</xml>").firstChild;this.ids=e["ids"]};Blockly.Events.Create.prototype.run=function(e){var o=this.getEventWorkspace_();if(e){var t=goog.dom.createDom("xml");t.appendChild(this.xml);Blockly.Xml.domToWorkspace(t,o)}else for(var i=0,r;r=this.ids[i];i++){var n=o.getBlockById(r);if(n)n.dispose(false,false);else if(r==this.blockId)console.warn("Can't uncreate non-existent block: "+r)}};Blockly.Events.Delete=function(e){if(!e)return;if(e.getParent())throw"Connected blocks cannot be deleted.";Blockly.Events.Delete.superClass_.constructor.call(this,e);if(e.workspace.rendered)this.oldXml=Blockly.Xml.blockToDomWithXY(e);else this.oldXml=Blockly.Xml.blockToDom(e);this.ids=Blockly.Events.getDescendantIds_(e)};goog.inherits(Blockly.Events.Delete,Blockly.Events.BlockBase);Blockly.Events.BlockDelete=Blockly.Events.Delete;Blockly.Events.Delete.prototype.type=Blockly.Events.DELETE;Blockly.Events.Delete.prototype.toJson=function(){var e=Blockly.Events.Delete.superClass_.toJson.call(this);e["ids"]=this.ids;return e};Blockly.Events.Delete.prototype.fromJson=function(e){Blockly.Events.Delete.superClass_.fromJson.call(this,e);this.ids=e["ids"]};Blockly.Events.Delete.prototype.run=function(e){var o=this.getEventWorkspace_();if(e)for(var t=0,i;i=this.ids[t];t++){var r=o.getBlockById(i);if(r)r.dispose(false,false);else if(i==this.blockId)console.warn("Can't delete non-existent block: "+i)}else{var n=goog.dom.createDom("xml");n.appendChild(this.oldXml);Blockly.Xml.domToWorkspace(n,o)}};Blockly.Events.Move=function(e){if(!e)return;Blockly.Events.Move.superClass_.constructor.call(this,e);var o=this.currentLocation_();this.oldParentId=o.parentId;this.oldInputName=o.inputName;this.oldCoordinate=o.coordinate};goog.inherits(Blockly.Events.Move,Blockly.Events.BlockBase);Blockly.Events.BlockMove=Blockly.Events.Move;Blockly.Events.Move.prototype.type=Blockly.Events.MOVE;Blockly.Events.Move.prototype.toJson=function(){var e=Blockly.Events.Move.superClass_.toJson.call(this);if(this.newParentId)e["newParentId"]=this.newParentId;if(this.newInputName)e["newInputName"]=this.newInputName;if(this.newCoordinate)e["newCoordinate"]=Math.round(this.newCoordinate.x)+","+Math.round(this.newCoordinate.y);return e};Blockly.Events.Move.prototype.fromJson=function(e){Blockly.Events.Move.superClass_.fromJson.call(this,e);this.newParentId=e["newParentId"];this.newInputName=e["newInputName"];if(e["newCoordinate"]){var o=e["newCoordinate"].split(",");this.newCoordinate=new goog.math.Coordinate(parseFloat(o[0]),parseFloat(o[1]))}};Blockly.Events.Move.prototype.recordNew=function(){var e=this.currentLocation_();this.newParentId=e.parentId;this.newInputName=e.inputName;this.newCoordinate=e.coordinate};Blockly.Events.Move.prototype.currentLocation_=function(){var e=Blockly.Workspace.getById(this.workspaceId);var o=e.getBlockById(this.blockId);var t={};var i=o.getParent();if(i){t.parentId=i.id;var r=i.getInputWithBlock(o);if(r)t.inputName=r.name}else{var n=o.getRelativeToSurfaceXY();var l=e.RTL?e.getWidth()-n.x:n.x;t.coordinate=new goog.math.Coordinate(l,n.y)}return t};Blockly.Events.Move.prototype.isNull=function(){return this.oldParentId==this.newParentId&&this.oldInputName==this.newInputName&&goog.math.Coordinate.equals(this.oldCoordinate,this.newCoordinate)};Blockly.Events.Move.prototype.run=function(e){var o=this.getEventWorkspace_();var t=o.getBlockById(this.blockId);if(!t){console.warn("Can't move non-existent block: "+this.blockId);return}var i=e?this.newParentId:this.oldParentId;var r=e?this.newInputName:this.oldInputName;var n=e?this.newCoordinate:this.oldCoordinate;var l=null;if(i){l=o.getBlockById(i);if(!l){console.warn("Can't connect to non-existent block: "+i);return}}if(t.getParent())t.unplug();if(n){var s=t.getRelativeToSurfaceXY();var g=o.RTL?o.getWidth()-n.x:n.x;t.moveBy(g-s.x,n.y-s.y)}else{var a=t.outputConnection||t.previousConnection;var c;if(r){var u=l.getInput(r);if(u)c=u.connection}else if(a.type==Blockly.PREVIOUS_STATEMENT)c=l.nextConnection;if(c)a.connect(c);else console.warn("Can't connect to non-existent input: "+r)}};goog.provide("Blockly.Events.DragBlockOutside");goog.provide("Blockly.Events.EndBlockDrag");goog.require("Blockly.Events");goog.require("Blockly.Events.BlockBase");goog.require("goog.array");goog.require("goog.math.Coordinate");Blockly.Events.DragBlockOutside=function(e){if(!e)return;Blockly.Events.DragBlockOutside.superClass_.constructor.call(this,e);this.recordUndo=false};goog.inherits(Blockly.Events.DragBlockOutside,Blockly.Events.BlockBase);Blockly.Events.DragBlockOutside.prototype.type=Blockly.Events.DRAG_OUTSIDE;Blockly.Events.DragBlockOutside.prototype.toJson=function(){var e=Blockly.Events.DragBlockOutside.superClass_.toJson.call(this);if(this.isOutside)e["isOutside"]=this.isOutside;return e};Blockly.Events.DragBlockOutside.prototype.fromJson=function(e){Blockly.Events.DragBlockOutside.superClass_.fromJson.call(this,e);this.isOutside=e["isOutside"]};Blockly.Events.EndBlockDrag=function(e,o){if(!e)return;Blockly.Events.EndBlockDrag.superClass_.constructor.call(this,e);this.isOutside=o;if(o)this.xml=Blockly.Xml.blockToDom(e,true);this.recordUndo=false};goog.inherits(Blockly.Events.EndBlockDrag,Blockly.Events.BlockBase);Blockly.Events.EndBlockDrag.prototype.type=Blockly.Events.END_DRAG;Blockly.Events.EndBlockDrag.prototype.toJson=function(){var e=Blockly.Events.EndBlockDrag.superClass_.toJson.call(this);if(this.isOutside)e["isOutside"]=this.isOutside;if(this.xml)e["xml"]=this.xml;return e};Blockly.Events.EndBlockDrag.prototype.fromJson=function(e){Blockly.Events.EndBlockDrag.superClass_.fromJson.call(this,e);this.isOutside=e["isOutside"];this.xml=e["xml"]};goog.provide("Blockly.Events.CommentBase");goog.provide("Blockly.Events.CommentChange");goog.provide("Blockly.Events.CommentCreate");goog.provide("Blockly.Events.CommentDelete");goog.provide("Blockly.Events.CommentMove");goog.require("Blockly.Events");goog.require("Blockly.Events.Abstract");goog.require("goog.math.Coordinate");Blockly.Events.CommentBase=function(e){this.commentId=e.id;this.workspaceId=e.workspace.id;this.blockId=e.blockId||null;this.group=Blockly.Events.group_;this.recordUndo=Blockly.Events.recordUndo};goog.inherits(Blockly.Events.CommentBase,Blockly.Events.Abstract);Blockly.Events.CommentBase.prototype.toJson=function(){var e={type:this.type};if(this.group)e["group"]=this.group;if(this.commentId)e["commentId"]=this.commentId;if(this.blockId)e["blockId"]=this.blockId;return e};Blockly.Events.CommentBase.prototype.fromJson=function(e){this.commentId=e["commentId"];this.group=e["group"];this.blockId=e["blockId"]};Blockly.Events.CommentBase.prototype.getComment_=function(){var e=this.getEventWorkspace_();return e.getCommentById(this.commentId)};Blockly.Events.CommentChange=function(e,o,t){if(!e)return;Blockly.Events.CommentChange.superClass_.constructor.call(this,e);this.oldContents_=o;this.newContents_=t};goog.inherits(Blockly.Events.CommentChange,Blockly.Events.CommentBase);Blockly.Events.CommentChange.prototype.type=Blockly.Events.COMMENT_CHANGE;Blockly.Events.CommentChange.prototype.toJson=function(){var e=Blockly.Events.CommentChange.superClass_.toJson.call(this);e["newContents"]=this.newContents_;return e};Blockly.Events.CommentChange.prototype.fromJson=function(e){Blockly.Events.CommentChange.superClass_.fromJson.call(this,e);this.newContents_=e["newValue"]};Blockly.Events.CommentChange.prototype.isNull=function(){return this.oldContents_==this.newContents_};Blockly.Events.CommentChange.prototype.run=function(e){var o=this.getComment_();if(!o){console.warn("Can't change non-existent comment: "+this.commentId);return}var t=e?this.newContents_:this.oldContents_;if(t.hasOwnProperty("minimized"))o.setMinimized(t.minimized);if(t.hasOwnProperty("width")&&t.hasOwnProperty("height"))o.setSize(t.width,t.height);if(t.hasOwnProperty("text"))o.setText(t.text)};Blockly.Events.CommentCreate=function(e){if(!e)return;Blockly.Events.CommentCreate.superClass_.constructor.call(this,e);this.text=e.getText();this.xy=e.getXY();var o=e.getHeightWidth();this.width=o.width;this.height=o.height;this.minimized=e.isMinimized()||false;this.xml=e.toXmlWithXY()};goog.inherits(Blockly.Events.CommentCreate,Blockly.Events.CommentBase);Blockly.Events.CommentCreate.prototype.type=Blockly.Events.COMMENT_CREATE;Blockly.Events.CommentCreate.prototype.toJson=function(){var e=Blockly.Events.CommentCreate.superClass_.toJson.call(this);e["xml"]=Blockly.Xml.domToText(this.xml);return e};Blockly.Events.CommentCreate.prototype.fromJson=function(e){Blockly.Events.CommentCreate.superClass_.fromJson.call(this,e);this.xml=Blockly.Xml.textToDom("<xml>"+e["xml"]+"</xml>").firstChild};Blockly.Events.CommentCreate.prototype.run=function(e){if(e){var o=this.getEventWorkspace_();if(this.blockId){var t=o.getBlockById(this.blockId);if(t)t.setCommentText("",this.commentId,this.xy.x,this.xy.y,this.minimized)}else{var i=goog.dom.createDom("xml");i.appendChild(this.xml);Blockly.Xml.domToWorkspace(i,o)}}else{var r=this.getComment_();if(r)r.dispose(false,false);else console.warn("Can't uncreate non-existent comment: "+this.commentId)}};Blockly.Events.CommentDelete=function(e){if(!e)return;Blockly.Events.CommentDelete.superClass_.constructor.call(this,e);this.xy=e.getXY();this.minimized=e.isMinimized()||false;this.text=e.getText();var o=e.getHeightWidth();this.height=o.height;this.width=o.width;this.xml=e.toXmlWithXY()};goog.inherits(Blockly.Events.CommentDelete,Blockly.Events.CommentBase);Blockly.Events.CommentDelete.prototype.type=Blockly.Events.COMMENT_DELETE;Blockly.Events.CommentDelete.prototype.toJson=function(){var e=Blockly.Events.CommentDelete.superClass_.toJson.call(this);return e};Blockly.Events.CommentDelete.prototype.fromJson=function(e){Blockly.Events.CommentDelete.superClass_.fromJson.call(this,e)};Blockly.Events.CommentDelete.prototype.run=function(e){if(e){var o=this.getComment_();if(o)o.dispose(false,false);else console.warn("Can't delete non-existent comment: "+this.commentId)}else{var t=this.getEventWorkspace_();if(this.blockId){var i=t.getBlockById(this.blockId);i.setCommentText(this.text,this.commentId,this.xy.x,this.xy.y,this.minimized);i.comment.setSize(this.width,this.height)}else{var r=goog.dom.createDom("xml");r.appendChild(this.xml);Blockly.Xml.domToWorkspace(r,t)}}};Blockly.Events.CommentMove=function(e){if(!e)return;Blockly.Events.CommentMove.superClass_.constructor.call(this,e);this.comment_=e;this.workspaceWidth_=e.workspace.getWidth();this.oldCoordinate_=this.currentLocation_();this.newCoordinate_=null};goog.inherits(Blockly.Events.CommentMove,Blockly.Events.CommentBase);Blockly.Events.CommentMove.prototype.currentLocation_=function(){var e=this.comment_.getXY();if(!this.comment_.workspace.RTL)return e;var o;if(this.comment_ instanceof Blockly.ScratchBlockComment){var t=this.comment_.getBubbleSize().width;o=this.workspaceWidth_-e.x-t}else o=this.workspaceWidth_-e.x;return new goog.math.Coordinate(o,e.y)};Blockly.Events.CommentMove.prototype.recordNew=function(){if(!this.comment_)throw new Error("Tried to record the new position of a comment on the "+"same event twice.");this.newCoordinate_=this.currentLocation_();this.comment_=null};Blockly.Events.CommentMove.prototype.type=Blockly.Events.COMMENT_MOVE;Blockly.Events.CommentMove.prototype.setOldCoordinate=function(e){this.oldCoordinate_=new goog.math.Coordinate(this.comment_.workspace.RTL?this.workspaceWidth_-e.x:e.x,e.y)};Blockly.Events.CommentMove.prototype.toJson=function(){var e=Blockly.Events.CommentMove.superClass_.toJson.call(this);if(this.newCoordinate_)e["newCoordinate"]=Math.round(this.newCoordinate_.x)+","+Math.round(this.newCoordinate_.y);return e};Blockly.Events.CommentMove.prototype.fromJson=function(e){Blockly.Events.CommentMove.superClass_.fromJson.call(this,e);if(e["newCoordinate"]){var o=e["newCoordinate"].split(",");this.newCoordinate_=new goog.math.Coordinate(parseFloat(o[0]),parseFloat(o[1]))}};Blockly.Events.CommentMove.prototype.isNull=function(){return goog.math.Coordinate.equals(this.oldCoordinate_,this.newCoordinate_)};Blockly.Events.CommentMove.prototype.run=function(e){var o=this.getComment_();if(!o){console.warn("Can't move non-existent comment: "+this.commentId);return}var t=e?this.newCoordinate_:this.oldCoordinate_;if(o instanceof Blockly.ScratchBlockComment)if(o.workspace.RTL)o.moveTo(this.workspaceWidth_-t.x,t.y);else o.moveTo(t.x,t.y);else{var i=o.getXY();if(o.workspace.RTL){var r=t.x-(this.workspaceWidth_-i.x);o.moveBy(-r,t.y-i.y)}else o.moveBy(t.x-i.x,t.y-i.y)}};goog.provide("Blockly.Events.Ui");goog.require("Blockly.Events");goog.require("Blockly.Events.Abstract");goog.require("goog.array");goog.require("goog.math.Coordinate");Blockly.Events.Ui=function(e,o,t,i){Blockly.Events.Ui.superClass_.constructor.call(this);this.blockId=e?e.id:null;this.workspaceId=e?e.workspace.id:null;this.element=o;this.oldValue=t;this.newValue=i;this.recordUndo=false};goog.inherits(Blockly.Events.Ui,Blockly.Events.Abstract);Blockly.Events.Ui.prototype.type=Blockly.Events.UI;Blockly.Events.Ui.prototype.toJson=function(){var e=Blockly.Events.Ui.superClass_.toJson.call(this);e["element"]=this.element;if(void 0!==this.newValue)e["newValue"]=this.newValue;if(this.blockId)e["blockId"]=this.blockId;return e};Blockly.Events.Ui.prototype.fromJson=function(e){Blockly.Events.Ui.superClass_.fromJson.call(this,e);this.element=e["element"];this.newValue=e["newValue"];this.blockId=e["blockId"]};goog.provide("Blockly.Events.VarBase");goog.provide("Blockly.Events.VarCreate");goog.provide("Blockly.Events.VarDelete");goog.provide("Blockly.Events.VarRename");goog.require("Blockly.Events");goog.require("Blockly.Events.Abstract");goog.require("goog.array");goog.require("goog.math.Coordinate");Blockly.Events.VarBase=function(e){Blockly.Events.VarBase.superClass_.constructor.call(this);this.varId=e.getId();this.workspaceId=e.workspace.id};goog.inherits(Blockly.Events.VarBase,Blockly.Events.Abstract);Blockly.Events.VarBase.prototype.toJson=function(){var e=Blockly.Events.VarBase.superClass_.toJson.call(this);e["varId"]=this.varId;return e};Blockly.Events.VarBase.prototype.fromJson=function(e){Blockly.Events.VarBase.superClass_.toJson.call(this);this.varId=e["varId"]};Blockly.Events.VarCreate=function(e){if(!e)return;Blockly.Events.VarCreate.superClass_.constructor.call(this,e);this.varType=e.type;this.varName=e.name;this.isLocal=e.isLocal;this.isCloud=e.isCloud};goog.inherits(Blockly.Events.VarCreate,Blockly.Events.VarBase);Blockly.Events.VarCreate.prototype.type=Blockly.Events.VAR_CREATE;Blockly.Events.VarCreate.prototype.toJson=function(){var e=Blockly.Events.VarCreate.superClass_.toJson.call(this);e["varType"]=this.varType;e["varName"]=this.varName;e["isLocal"]=this.isLocal;e["isCloud"]=this.isCloud;return e};Blockly.Events.VarCreate.prototype.fromJson=function(e){Blockly.Events.VarCreate.superClass_.fromJson.call(this,e);this.varType=e["varType"];this.varName=e["varName"];this.isLocal=e["isLocal"];this.isCloud=e["isCloud"]};Blockly.Events.VarCreate.prototype.run=function(e){var o=this.getEventWorkspace_();if(e)o.createVariable(this.varName,this.varType,this.varId,this.isLocal,this.isCloud);else o.deleteVariableById(this.varId)};Blockly.Events.VarDelete=function(e){if(!e)return;Blockly.Events.VarDelete.superClass_.constructor.call(this,e);this.varType=e.type;this.varName=e.name;this.isLocal=e.isLocal;this.isCloud=e.isCloud};goog.inherits(Blockly.Events.VarDelete,Blockly.Events.VarBase);Blockly.Events.VarDelete.prototype.type=Blockly.Events.VAR_DELETE;Blockly.Events.VarDelete.prototype.toJson=function(){var e=Blockly.Events.VarDelete.superClass_.toJson.call(this);e["varType"]=this.varType;e["varName"]=this.varName;e["isLocal"]=this.isLocal;e["isCloud"]=this.isCloud;return e};Blockly.Events.VarDelete.prototype.fromJson=function(e){Blockly.Events.VarDelete.superClass_.fromJson.call(this,e);this.varType=e["varType"];this.varName=e["varName"];this.isLocal=e["isLocal"];this.isCloud=e["isCloud"]};Blockly.Events.VarDelete.prototype.run=function(e){var o=this.getEventWorkspace_();if(e)o.deleteVariableById(this.varId);else o.createVariable(this.varName,this.varType,this.varId,this.isLocal,this.isCloud)};Blockly.Events.VarRename=function(e,o){if(!e)return;Blockly.Events.VarRename.superClass_.constructor.call(this,e);this.oldName=e.name;this.newName=o};goog.inherits(Blockly.Events.VarRename,Blockly.Events.VarBase);Blockly.Events.VarRename.prototype.type=Blockly.Events.VAR_RENAME;Blockly.Events.VarRename.prototype.toJson=function(){var e=Blockly.Events.VarRename.superClass_.toJson.call(this);e["oldName"]=this.oldName;e["newName"]=this.newName;return e};Blockly.Events.VarRename.prototype.fromJson=function(e){Blockly.Events.VarRename.superClass_.fromJson.call(this,e);this.oldName=e["oldName"];this.newName=e["newName"]};Blockly.Events.VarRename.prototype.run=function(e){var o=this.getEventWorkspace_();if(e)o.renameVariableById(this.varId,this.newName);else o.renameVariableById(this.varId,this.oldName)};goog.provide("Blockly.Msg");goog.getMsgOrig=goog.getMsg;goog.getMsg=function(e,o){var t=goog.getMsg.blocklyMsgMap[e];if(t)e=Blockly.Msg[t];return goog.getMsgOrig(e,o)};goog.getMsg.blocklyMsgMap={Today:"TODAY"};goog.provide("Blockly.ScratchMsgs");goog.require("Blockly.Msg");Blockly.ScratchMsgs.locales={};Blockly.ScratchMsgs.currentLocale_="en";Blockly.ScratchMsgs.setLocale=function(e){if(Object.keys(Blockly.ScratchMsgs.locales).includes(e)){Blockly.ScratchMsgs.currentLocale_=e;Blockly.Msg=Object.assign({},Blockly.Msg,Blockly.ScratchMsgs.locales[e])}else console.warn("Ignoring unrecognized locale: "+e)};Blockly.ScratchMsgs.translate=function(e,o,t){var i=t||Blockly.ScratchMsgs.currentLocale_;if(Object.keys(Blockly.ScratchMsgs.locales).includes(i)){var r=Blockly.ScratchMsgs.locales[i];if(Object.keys(r).includes(e))return r[e]}return o};goog.provide("Blockly.Scrollbar");goog.provide("Blockly.ScrollbarPair");goog.require("goog.dom");goog.require("goog.events");Blockly.ScrollbarPair=function(e){this.workspace_=e;this.hScroll=new Blockly.Scrollbar(e,true,true,"blocklyMainWorkspaceScrollbar");this.vScroll=new Blockly.Scrollbar(e,false,true,"blocklyMainWorkspaceScrollbar");this.corner_=Blockly.utils.createSvgElement("rect",{height:Blockly.Scrollbar.scrollbarThickness,width:Blockly.Scrollbar.scrollbarThickness,class:"blocklyScrollbarBackground"},null);Blockly.utils.insertAfter(this.corner_,e.getBubbleCanvas())};Blockly.ScrollbarPair.prototype.oldHostMetrics_=null;Blockly.ScrollbarPair.prototype.dispose=function(){goog.dom.removeNode(this.corner_);this.corner_=null;this.workspace_=null;this.oldHostMetrics_=null;this.hScroll.dispose();this.hScroll=null;this.vScroll.dispose();this.vScroll=null};Blockly.ScrollbarPair.prototype.resize=function(){var e=this.workspace_.getMetrics();if(!e)return;var o=false;var t=false;if(!this.oldHostMetrics_||this.oldHostMetrics_.viewWidth!=e.viewWidth||this.oldHostMetrics_.viewHeight!=e.viewHeight||this.oldHostMetrics_.absoluteTop!=e.absoluteTop||this.oldHostMetrics_.absoluteLeft!=e.absoluteLeft){o=true;t=true}else{if(!this.oldHostMetrics_||this.oldHostMetrics_.contentWidth!=e.contentWidth||this.oldHostMetrics_.viewLeft!=e.viewLeft||this.oldHostMetrics_.contentLeft!=e.contentLeft)o=true;if(!this.oldHostMetrics_||this.oldHostMetrics_.contentHeight!=e.contentHeight||this.oldHostMetrics_.viewTop!=e.viewTop||this.oldHostMetrics_.contentTop!=e.contentTop)t=true}if(o)this.hScroll.resize(e);if(t)this.vScroll.resize(e);if(!this.oldHostMetrics_||this.oldHostMetrics_.viewWidth!=e.viewWidth||this.oldHostMetrics_.absoluteLeft!=e.absoluteLeft)this.corner_.setAttribute("x",this.vScroll.position_.x);if(!this.oldHostMetrics_||this.oldHostMetrics_.viewHeight!=e.viewHeight||this.oldHostMetrics_.absoluteTop!=e.absoluteTop)this.corner_.setAttribute("y",this.hScroll.position_.y);this.oldHostMetrics_=e};Blockly.ScrollbarPair.prototype.set=function(e,o){var t={};var i=e*this.hScroll.ratio_;var r=o*this.vScroll.ratio_;var n=this.hScroll.scrollViewSize_;var l=this.vScroll.scrollViewSize_;t.x=this.getRatio_(i,n);t.y=this.getRatio_(r,l);this.workspace_.setMetrics(t);this.hScroll.setHandlePosition(i);this.vScroll.setHandlePosition(r)};Blockly.ScrollbarPair.prototype.getRatio_=function(e,o){var t=e/o;if(isNaN(t))return 0;return t};Blockly.Scrollbar=function(e,o,t,i){this.workspace_=e;this.pair_=t||false;this.horizontal_=o;this.oldHostMetrics_=null;this.createDom_(i);this.position_=new goog.math.Coordinate(0,0);var r=Blockly.Scrollbar.scrollbarThickness;if(o){this.svgBackground_.setAttribute("height",r);this.outerSvg_.setAttribute("height",r);this.svgHandle_.setAttribute("height",r-5);this.svgHandle_.setAttribute("y",2.5);this.lengthAttribute_="width";this.positionAttribute_="x"}else{this.svgBackground_.setAttribute("width",r);this.outerSvg_.setAttribute("width",r);this.svgHandle_.setAttribute("width",r-5);this.svgHandle_.setAttribute("x",2.5);this.lengthAttribute_="height";this.positionAttribute_="y"}var n=this;this.onMouseDownBarWrapper_=Blockly.bindEventWithChecks_(this.svgBackground_,"mousedown",n,n.onMouseDownBar_);this.onMouseDownHandleWrapper_=Blockly.bindEventWithChecks_(this.svgHandle_,"mousedown",n,n.onMouseDownHandle_)};Blockly.Scrollbar.prototype.origin_=new goog.math.Coordinate(0,0);Blockly.Scrollbar.prototype.originHasChanged_=true;Blockly.Scrollbar.prototype.scrollViewSize_=0;Blockly.Scrollbar.prototype.handleLength_=0;Blockly.Scrollbar.prototype.handlePosition_=0;Blockly.Scrollbar.prototype.isVisible_=true;Blockly.Scrollbar.prototype.containerVisible_=true;Blockly.Scrollbar.scrollbarThickness=11;if(goog.events.BrowserFeature.TOUCH_ENABLED)Blockly.Scrollbar.scrollbarThickness=14;Blockly.Scrollbar.metricsAreEquivalent_=function(e,o){if(!(e&&o))return false;if(e.viewWidth!=o.viewWidth||e.viewHeight!=o.viewHeight||e.viewLeft!=o.viewLeft||e.viewTop!=o.viewTop||e.absoluteTop!=o.absoluteTop||e.absoluteLeft!=o.absoluteLeft||e.contentWidth!=o.contentWidth||e.contentHeight!=o.contentHeight||e.contentLeft!=o.contentLeft||e.contentTop!=o.contentTop)return false;return true};Blockly.Scrollbar.prototype.dispose=function(){this.cleanUp_();Blockly.unbindEvent_(this.onMouseDownBarWrapper_);this.onMouseDownBarWrapper_=null;Blockly.unbindEvent_(this.onMouseDownHandleWrapper_);this.onMouseDownHandleWrapper_=null;goog.dom.removeNode(this.outerSvg_);this.outerSvg_=null;this.svgGroup_=null;this.svgBackground_=null;this.svgHandle_=null;this.workspace_=null};Blockly.Scrollbar.prototype.setHandleLength_=function(e){this.handleLength_=e;this.svgHandle_.setAttribute(this.lengthAttribute_,this.handleLength_)};Blockly.Scrollbar.prototype.setHandlePosition=function(e){this.handlePosition_=e;this.svgHandle_.setAttribute(this.positionAttribute_,this.handlePosition_)};Blockly.Scrollbar.prototype.setScrollViewSize_=function(e){this.scrollViewSize_=e;this.outerSvg_.setAttribute(this.lengthAttribute_,this.scrollViewSize_);this.svgBackground_.setAttribute(this.lengthAttribute_,this.scrollViewSize_)};Blockly.ScrollbarPair.prototype.setContainerVisible=function(e){this.hScroll.setContainerVisible(e);this.vScroll.setContainerVisible(e)};Blockly.Scrollbar.prototype.setPosition_=function(e,o){this.position_.x=e;this.position_.y=o;var t=this.position_.x+this.origin_.x;var i=this.position_.y+this.origin_.y;var r="translate("+t+"px,"+i+"px)";Blockly.utils.setCssTransform(this.outerSvg_,r)};Blockly.Scrollbar.prototype.resize=function(e){var o=e;if(!o){o=this.workspace_.getMetrics();if(!o)return}if(this.originHasChanged_)this.originHasChanged_=false;else if(Blockly.Scrollbar.metricsAreEquivalent_(o,this.oldHostMetrics_))return;this.oldHostMetrics_=o;if(this.horizontal_)this.resizeHorizontal_(o);else this.resizeVertical_(o);this.onScroll_()};Blockly.Scrollbar.prototype.resizeHorizontal_=function(e){this.resizeViewHorizontal(e)};Blockly.Scrollbar.prototype.resizeViewHorizontal=function(e){var o=e.viewWidth-1;if(this.pair_)o-=Blockly.Scrollbar.scrollbarThickness;this.setScrollViewSize_(Math.max(0,o));var t=e.absoluteLeft+.5;if(this.pair_&&this.workspace_.RTL)t+=Blockly.Scrollbar.scrollbarThickness;var i=e.absoluteTop+e.viewHeight-Blockly.Scrollbar.scrollbarThickness-.5;this.setPosition_(t,i);this.resizeContentHorizontal(e)};Blockly.Scrollbar.prototype.resizeContentHorizontal=function(e){if(!this.pair_)this.setVisible(this.scrollViewSize_<e.contentWidth);this.ratio_=this.scrollViewSize_/e.contentWidth;if(this.ratio_==-1/0||this.ratio_==1/0||isNaN(this.ratio_))this.ratio_=0;var o=e.viewWidth*this.ratio_;this.setHandleLength_(Math.max(0,o));var t=(e.viewLeft-e.contentLeft)*this.ratio_;this.setHandlePosition(this.constrainHandle_(t))};Blockly.Scrollbar.prototype.resizeVertical_=function(e){this.resizeViewVertical(e)};Blockly.Scrollbar.prototype.resizeViewVertical=function(e){var o=e.viewHeight-1;if(this.pair_)o-=Blockly.Scrollbar.scrollbarThickness;this.setScrollViewSize_(Math.max(0,o));var t=e.absoluteLeft+.5;if(!this.workspace_.RTL)t+=e.viewWidth-Blockly.Scrollbar.scrollbarThickness-1;var i=e.absoluteTop+.5;this.setPosition_(t,i);this.resizeContentVertical(e)};Blockly.Scrollbar.prototype.resizeContentVertical=function(e){if(!this.pair_)this.setVisible(this.scrollViewSize_<e.contentHeight);this.ratio_=this.scrollViewSize_/e.contentHeight;if(this.ratio_==-1/0||this.ratio_==1/0||isNaN(this.ratio_))this.ratio_=0;var o=e.viewHeight*this.ratio_;this.setHandleLength_(Math.max(0,o));var t=(e.viewTop-e.contentTop)*this.ratio_;this.setHandlePosition(this.constrainHandle_(t))};Blockly.Scrollbar.prototype.createDom_=function(e){var o="blocklyScrollbar"+(this.horizontal_?"Horizontal":"Vertical");if(e)o+=" "+e;this.outerSvg_=Blockly.utils.createSvgElement("svg",{class:o},null);this.svgGroup_=Blockly.utils.createSvgElement("g",{},this.outerSvg_);this.svgBackground_=Blockly.utils.createSvgElement("rect",{class:"blocklyScrollbarBackground"},this.svgGroup_);var t=Math.floor((Blockly.Scrollbar.scrollbarThickness-5)/2);this.svgHandle_=Blockly.utils.createSvgElement("rect",{class:"blocklyScrollbarHandle",rx:t,ry:t},this.svgGroup_);Blockly.utils.insertAfter(this.outerSvg_,this.workspace_.getParentSvg())};Blockly.Scrollbar.prototype.isVisible=function(){return this.isVisible_};Blockly.Scrollbar.prototype.setContainerVisible=function(e){var o=e!=this.containerVisible_;this.containerVisible_=e;if(o)this.updateDisplay_()};Blockly.Scrollbar.prototype.setVisible=function(e){var o=e!=this.isVisible();if(this.pair_)throw"Unable to toggle visibility of paired scrollbars.";this.isVisible_=e;if(o)this.updateDisplay_()};Blockly.Scrollbar.prototype.updateDisplay_=function(){var e=true;if(!this.containerVisible_)e=false;else e=this.isVisible();if(e)this.outerSvg_.setAttribute("display","block");else this.outerSvg_.setAttribute("display","none")};Blockly.Scrollbar.prototype.onMouseDownBar_=function(e){this.workspace_.markFocused();Blockly.Touch.clearTouchIdentifier();this.cleanUp_();if(Blockly.utils.isRightButton(e)){e.stopPropagation();return}var o=Blockly.utils.mouseToSvg(e,this.workspace_.getParentSvg(),this.workspace_.getInverseScreenCTM());var t=this.horizontal_?o.x:o.y;var i=Blockly.utils.getInjectionDivXY_(this.svgHandle_);var r=this.horizontal_?i.x:i.y;var n=this.handlePosition_;var l=.95*this.handleLength_;if(t<=r)n-=l;else if(t>=r+this.handleLength_)n+=l;Blockly.WidgetDiv.hide(true);Blockly.DropDownDiv.hideWithoutAnimation();this.setHandlePosition(this.constrainHandle_(n));this.onScroll_();e.stopPropagation();e.preventDefault()};Blockly.Scrollbar.prototype.onMouseDownHandle_=function(e){this.workspace_.markFocused();this.cleanUp_();if(Blockly.utils.isRightButton(e)){e.stopPropagation();return}this.startDragHandle=this.handlePosition_;this.workspace_.setupDragSurface();this.startDragMouse_=this.horizontal_?e.clientX:e.clientY;Blockly.Scrollbar.onMouseUpWrapper_=Blockly.bindEventWithChecks_(document,"mouseup",this,this.onMouseUpHandle_);Blockly.Scrollbar.onMouseMoveWrapper_=Blockly.bindEventWithChecks_(document,"mousemove",this,this.onMouseMoveHandle_);Blockly.WidgetDiv.hide(true);Blockly.DropDownDiv.hideWithoutAnimation();e.stopPropagation();e.preventDefault()};Blockly.Scrollbar.prototype.onMouseMoveHandle_=function(e){var o=this.horizontal_?e.clientX:e.clientY;var t=o-this.startDragMouse_;var i=this.startDragHandle+t;this.setHandlePosition(this.constrainHandle_(i));this.onScroll_()};Blockly.Scrollbar.prototype.onMouseUpHandle_=function(){this.workspace_.resetDragSurface();Blockly.Touch.clearTouchIdentifier();this.cleanUp_()};Blockly.Scrollbar.prototype.cleanUp_=function(){Blockly.hideChaff(true);if(Blockly.Scrollbar.onMouseUpWrapper_){Blockly.unbindEvent_(Blockly.Scrollbar.onMouseUpWrapper_);Blockly.Scrollbar.onMouseUpWrapper_=null}if(Blockly.Scrollbar.onMouseMoveWrapper_){Blockly.unbindEvent_(Blockly.Scrollbar.onMouseMoveWrapper_);Blockly.Scrollbar.onMouseMoveWrapper_=null}};Blockly.Scrollbar.prototype.constrainHandle_=function(e){if(e<=0||isNaN(e)||this.scrollViewSize_<this.handleLength_)e=0;else e=Math.min(e,this.scrollViewSize_-this.handleLength_);return e};Blockly.Scrollbar.prototype.onScroll_=function(){var e=this.handlePosition_/this.scrollViewSize_;if(isNaN(e))e=0;var o={};if(this.horizontal_)o.x=e;else o.y=e;this.workspace_.setMetrics(o)};Blockly.Scrollbar.prototype.set=function(e){this.setHandlePosition(this.constrainHandle_(e*this.ratio_));this.onScroll_()};Blockly.Scrollbar.prototype.setOrigin=function(e,o){if(e!=this.origin_.x||o!=this.origin_.y){this.origin_=new goog.math.Coordinate(e,o);this.originHasChanged_=true}};goog.provide("Blockly.Toolbox");goog.require("Blockly.Events.Ui");goog.require("Blockly.HorizontalFlyout");goog.require("Blockly.Touch");goog.require("Blockly.VerticalFlyout");goog.require("goog.dom");goog.require("goog.dom.TagName");goog.require("goog.events");goog.require("goog.events.BrowserFeature");goog.require("goog.html.SafeHtml");goog.require("goog.html.SafeStyle");goog.require("goog.math.Rect");goog.require("goog.style");goog.require("goog.ui.tree.TreeControl");goog.require("goog.ui.tree.TreeNode");Blockly.Toolbox=function(e){this.workspace_=e;this.iconic_=false;this.RTL=e.options.RTL;this.horizontalLayout_=e.options.horizontalLayout;this.toolboxPosition=e.options.toolboxPosition};Blockly.Toolbox.prototype.width=310;Blockly.Toolbox.prototype.height=0;Blockly.Toolbox.prototype.selectedItem_=null;Blockly.Toolbox.prototype.init=function(){var e=this.workspace_;var o=this.workspace_.getParentSvg();this.HtmlDiv=goog.dom.createDom(goog.dom.TagName.DIV,"blocklyToolboxDiv");this.HtmlDiv.setAttribute("dir",e.RTL?"RTL":"LTR");o.parentNode.insertBefore(this.HtmlDiv,o);Blockly.bindEventWithChecks_(this.HtmlDiv,"mousedown",this,(function(e){this.workspace_.cancelCurrentGesture();if(Blockly.utils.isRightButton(e)||e.target==this.HtmlDiv)Blockly.hideChaff(false);else Blockly.hideChaff(true);Blockly.Touch.clearTouchIdentifier()}),false,true);this.createFlyout_();this.categoryMenu_=new Blockly.Toolbox.CategoryMenu(this,this.HtmlDiv);this.populate_(e.options.languageTree);this.position()};Blockly.Toolbox.prototype.dispose=function(){this.flyout_.dispose();this.categoryMenu_.dispose();this.categoryMenu_=null;goog.dom.removeNode(this.HtmlDiv);this.workspace_=null;this.lastCategory_=null};Blockly.Toolbox.prototype.createFlyout_=function(){var e=this.workspace_;var o={disabledPatternId:e.options.disabledPatternId,parentWorkspace:e,RTL:e.RTL,oneBasedIndex:e.options.oneBasedIndex,horizontalLayout:e.horizontalLayout,toolboxPosition:e.options.toolboxPosition,stackGlowFilterId:e.options.stackGlowFilterId};if(e.horizontalLayout)this.flyout_=new Blockly.HorizontalFlyout(o);else this.flyout_=new Blockly.VerticalFlyout(o);this.flyout_.setParentToolbox(this);goog.dom.insertSiblingAfter(this.flyout_.createDom("svg"),this.workspace_.getParentSvg());this.flyout_.init(e)};Blockly.Toolbox.prototype.populate_=function(e){this.categoryMenu_.populate(e);this.showAll_();this.setSelectedItem(this.categoryMenu_.categories_[0],false)};Blockly.Toolbox.prototype.showAll_=function(){var e=[];for(var o=0;o<this.categoryMenu_.categories_.length;o++){var t=this.categoryMenu_.categories_[o];var i='<xml><label text="'+t.name_+'"'+' id="'+t.id_+'"'+' category-label="true"'+' showStatusButton="'+t.showStatusButton_+'"'+' web-class="categoryLabel">'+"</label></xml>";var r=Blockly.Xml.textToDom(i);e.push(r.firstChild);e=e.concat(t.getContents())}this.flyout_.show(e)};Blockly.Toolbox.prototype.getWidth=function(){return this.width};Blockly.Toolbox.prototype.getHeight=function(){return this.categoryMenu_?this.categoryMenu_.getHeight():0};Blockly.Toolbox.prototype.position=function(){var e=this.HtmlDiv;if(!e)return;var o=this.workspace_.getParentSvg();var t=Blockly.svgSize(o);if(this.horizontalLayout_){e.style.left="0";e.style.height="auto";e.style.width=t.width+"px";this.height=e.offsetHeight;if(this.toolboxPosition==Blockly.TOOLBOX_AT_TOP)e.style.top="0";else e.style.bottom="0"}else{if(this.toolboxPosition==Blockly.TOOLBOX_AT_RIGHT)e.style.right="0";else e.style.left="0";e.style.height="100%"}this.flyout_.position()};Blockly.Toolbox.prototype.clearSelection=function(){this.setSelectedItem(null)};Blockly.Toolbox.prototype.addStyle=function(e){Blockly.utils.addClass(this.HtmlDiv,e)};Blockly.Toolbox.prototype.removeStyle=function(e){Blockly.utils.removeClass(this.HtmlDiv,e)};Blockly.Toolbox.prototype.getClientRect=function(){if(!this.HtmlDiv)return null;if(!this.flyout_.autoClose)return this.flyout_.getClientRect();var e=1e7;var o=this.HtmlDiv.getBoundingClientRect();var t=o.left;var i=o.top;var r=o.width;var n=o.height;if(this.toolboxPosition==Blockly.TOOLBOX_AT_LEFT)return new goog.math.Rect(-e,-e,e+t+r,2*e);else if(this.toolboxPosition==Blockly.TOOLBOX_AT_RIGHT)return new goog.math.Rect(o.right-r,-e,e+r,2*e);else if(this.toolboxPosition==Blockly.TOOLBOX_AT_TOP)return new goog.math.Rect(-e,-e,2*e,e+i+n);else return new goog.math.Rect(0,i,2*e,e)};Blockly.Toolbox.prototype.refreshSelection=function(){this.showAll_()};Blockly.Toolbox.prototype.getSelectedItem=function(){return this.selectedItem_};Blockly.Toolbox.prototype.getSelectedCategoryName=function(){return this.selectedItem_.name_};Blockly.Toolbox.prototype.getSelectedCategoryId=function(){return this.selectedItem_.id_};Blockly.Toolbox.prototype.getCategoryScrollOffset=function(){var e=this.getCategoryPositionById(this.getSelectedCategoryId());return this.flyout_.getScrollPos()-e};Blockly.Toolbox.prototype.getCategoryPositionByName=function(e){var o=this.flyout_.categoryScrollPositions;for(var t=0;t<o.length;t++)if(e===o[t].categoryName)return o[t].position};Blockly.Toolbox.prototype.getCategoryPositionById=function(e){var o=this.flyout_.categoryScrollPositions;for(var t=0;t<o.length;t++)if(e===o[t].categoryId)return o[t].position};Blockly.Toolbox.prototype.getCategoryLengthByName=function(e){var o=this.flyout_.categoryScrollPositions;for(var t=0;t<o.length;t++)if(e===o[t].categoryName)return o[t].length};Blockly.Toolbox.prototype.getCategoryLengthById=function(e){var o=this.flyout_.categoryScrollPositions;for(var t=0;t<o.length;t++)if(e===o[t].categoryId)return o[t].length};Blockly.Toolbox.prototype.setFlyoutScrollPos=function(e){this.flyout_.setScrollPos(e)};Blockly.Toolbox.prototype.setSelectedItem=function(e,o){if("undefined"===typeof o)o=true;if(this.selectedItem_)this.selectedItem_.setSelected(false);this.selectedItem_=e;if(null!=this.selectedItem_){this.selectedItem_.setSelected(true);var t=e.id_;if(o)this.scrollToCategoryById(t)}};Blockly.Toolbox.prototype.setSelectedCategoryByName=function(e){this.selectCategoryByName(e);this.scrollToCategoryByName(e)};Blockly.Toolbox.prototype.setSelectedCategoryById=function(e){this.selectCategoryById(e);this.scrollToCategoryById(e)};Blockly.Toolbox.prototype.scrollToCategoryByName=function(e){var o=this.flyout_.categoryScrollPositions;for(var t=0;t<o.length;t++)if(e===o[t].categoryName){this.flyout_.setVisible(true);this.flyout_.scrollTo(o[t].position);return}};Blockly.Toolbox.prototype.scrollToCategoryById=function(e){var o=this.flyout_.categoryScrollPositions;for(var t=0;t<o.length;t++)if(e===o[t].categoryId){this.flyout_.setVisible(true);this.flyout_.scrollTo(o[t].position);return}};Blockly.Toolbox.prototype.getCategoryByIndex=function(e){if(!this.categoryMenu_.categories_)return null;return this.categoryMenu_.categories_[e]};Blockly.Toolbox.prototype.selectCategoryByName=function(e){for(var o=0;o<this.categoryMenu_.categories_.length;o++){var t=this.categoryMenu_.categories_[o];if(e===t.name_){this.selectedItem_.setSelected(false);this.selectedItem_=t;this.selectedItem_.setSelected(true)}}};Blockly.Toolbox.prototype.selectCategoryById=function(e){for(var o=0;o<this.categoryMenu_.categories_.length;o++){var t=this.categoryMenu_.categories_[o];if(e===t.id_){this.selectedItem_.setSelected(false);this.selectedItem_=t;this.selectedItem_.setSelected(true)}}};Blockly.Toolbox.prototype.setSelectedItemFactory=function(e){var o=e;return function(){if(!this.workspace_.isDragging()){this.setSelectedItem(o);Blockly.Touch.clearTouchIdentifier()}}};Blockly.Toolbox.CategoryMenu=function(e,o){this.parent_=e;this.height_=0;this.parentHtml_=o;this.createDom();this.categories_=[]};Blockly.Toolbox.CategoryMenu.prototype.getHeight=function(){return this.height_};Blockly.Toolbox.CategoryMenu.prototype.createDom=function(){this.table=goog.dom.createDom("div",this.parent_.horizontalLayout_?"scratchCategoryMenuHorizontal":"scratchCategoryMenu");this.parentHtml_.appendChild(this.table)};Blockly.Toolbox.CategoryMenu.prototype.populate=function(e){if(!e)return;this.dispose();this.createDom();var o=[];for(var t=0,i;i=e.childNodes[t];t++){if(!i.tagName||"CATEGORY"!=i.tagName.toUpperCase())continue;o.push(i)}for(var t=0;t<o.length;t++){var i=o[t];var r=goog.dom.createDom("div","scratchCategoryMenuRow");this.table.appendChild(r);if(i)this.categories_.push(new Blockly.Toolbox.Category(this,r,i))}this.height_=this.table.offsetHeight};Blockly.Toolbox.CategoryMenu.prototype.dispose=function(){for(var e=0,o;o=this.categories_[e];e++)o.dispose();this.categories_=[];if(this.table){goog.dom.removeNode(this.table);this.table=null}};Blockly.Toolbox.Category=function(e,o,t){this.parent_=e;this.parentHtml_=o;this.name_=t.getAttribute("name");this.id_=t.getAttribute("id");this.setColour(t);this.custom_=t.getAttribute("custom");this.iconURI_=t.getAttribute("iconURI");this.showStatusButton_=t.getAttribute("showStatusButton");this.contents_=[];if(!this.custom_)this.parseContents_(t);this.createDom()};Blockly.Toolbox.Category.prototype.dispose=function(){if(this.item_){goog.dom.removeNode(this.item_);this.item=null}this.parent_=null;this.parentHtml_=null;this.contents_=null};Blockly.Toolbox.Category.prototype.getMenuItemClassName_=function(e){var o=["scratchCategoryMenuItem","scratchCategoryId-"+this.id_];if(e)o.push("categorySelected");return o.join(" ")};Blockly.Toolbox.Category.prototype.createDom=function(){var e=this.parent_.parent_;this.item_=goog.dom.createDom("div",{class:this.getMenuItemClassName_()});this.label_=goog.dom.createDom("div",{class:"scratchCategoryMenuItemLabel"},Blockly.utils.replaceMessageReferences(this.name_));if(this.iconURI_){this.bubble_=goog.dom.createDom("div",{class:"scratchCategoryItemIcon"});this.bubble_.style.backgroundImage="url("+this.iconURI_+")"}else{this.bubble_=goog.dom.createDom("div",{class:"scratchCategoryItemBubble"});this.bubble_.style.backgroundColor=this.colour_;this.bubble_.style.borderColor=this.secondaryColour_}this.item_.appendChild(this.bubble_);this.item_.appendChild(this.label_);this.parentHtml_.appendChild(this.item_);Blockly.bindEvent_(this.item_,"mouseup",e,e.setSelectedItemFactory(this))};Blockly.Toolbox.Category.prototype.setSelected=function(e){this.item_.className=this.getMenuItemClassName_(e)};Blockly.Toolbox.Category.prototype.parseContents_=function(e){for(var o=0,t;t=e.childNodes[o];o++){if(!t.tagName)continue;switch(t.tagName.toUpperCase()){case"BLOCK":case"SHADOW":case"LABEL":case"BUTTON":case"SEP":case"TEXT":this.contents_.push(t);break}}};Blockly.Toolbox.Category.prototype.getContents=function(){return this.custom_?this.custom_:this.contents_};Blockly.Toolbox.Category.prototype.setColour=function(e){var o=e.getAttribute("colour");var t=e.getAttribute("secondaryColour");if(goog.isString(o)){if(o.match(/^#[0-9a-fA-F]{6}$/))this.colour_=o;else this.colour_=Blockly.hueToRgb(o);if(t.match(/^#[0-9a-fA-F]{6}$/))this.secondaryColour_=t;else this.secondaryColour_=Blockly.hueToRgb(t);this.hasColours_=true}else{this.colour_="#000000";this.secondaryColour_="#000000"}};goog.provide("Blockly.Tooltip");goog.require("goog.dom");goog.require("goog.dom.TagName");Blockly.Tooltip.visible=false;Blockly.Tooltip.blocked_=false;Blockly.Tooltip.LIMIT=50;Blockly.Tooltip.mouseOutPid_=0;Blockly.Tooltip.showPid_=0;Blockly.Tooltip.lastX_=0;Blockly.Tooltip.lastY_=0;Blockly.Tooltip.element_=null;Blockly.Tooltip.poisonedElement_=null;Blockly.Tooltip.OFFSET_X=0;Blockly.Tooltip.OFFSET_Y=10;Blockly.Tooltip.RADIUS_OK=10;Blockly.Tooltip.HOVER_MS=750;Blockly.Tooltip.MARGINS=5;Blockly.Tooltip.DIV=null;Blockly.Tooltip.createDom=function(){if(Blockly.Tooltip.DIV)return;Blockly.Tooltip.DIV=goog.dom.createDom(goog.dom.TagName.DIV,"blocklyTooltipDiv");document.body.appendChild(Blockly.Tooltip.DIV)};Blockly.Tooltip.bindMouseEvents=function(e){Blockly.bindEvent_(e,"mouseover",null,Blockly.Tooltip.onMouseOver_);Blockly.bindEvent_(e,"mouseout",null,Blockly.Tooltip.onMouseOut_);e.addEventListener("mousemove",Blockly.Tooltip.onMouseMove_,false)};Blockly.Tooltip.onMouseOver_=function(e){if(Blockly.Tooltip.blocked_)return;var o=e.target;while(!goog.isString(o.tooltip)&&!goog.isFunction(o.tooltip))o=o.tooltip;if(Blockly.Tooltip.element_!=o){Blockly.Tooltip.hide();Blockly.Tooltip.poisonedElement_=null;Blockly.Tooltip.element_=o}clearTimeout(Blockly.Tooltip.mouseOutPid_)};Blockly.Tooltip.onMouseOut_=function(e){if(Blockly.Tooltip.blocked_)return;Blockly.Tooltip.mouseOutPid_=setTimeout((function(){Blockly.Tooltip.element_=null;Blockly.Tooltip.poisonedElement_=null;Blockly.Tooltip.hide()}),1);clearTimeout(Blockly.Tooltip.showPid_)};Blockly.Tooltip.onMouseMove_=function(e){if(!Blockly.Tooltip.element_||!Blockly.Tooltip.element_.tooltip)return;else if(Blockly.WidgetDiv.isVisible())return;else if(Blockly.Tooltip.blocked_)return;if(Blockly.Tooltip.visible){var o=Blockly.Tooltip.lastX_-e.pageX;var t=Blockly.Tooltip.lastY_-e.pageY;if(Math.sqrt(o*o+t*t)>Blockly.Tooltip.RADIUS_OK)Blockly.Tooltip.hide()}else if(Blockly.Tooltip.poisonedElement_!=Blockly.Tooltip.element_){clearTimeout(Blockly.Tooltip.showPid_);Blockly.Tooltip.lastX_=e.pageX;Blockly.Tooltip.lastY_=e.pageY;Blockly.Tooltip.showPid_=setTimeout(Blockly.Tooltip.show_,Blockly.Tooltip.HOVER_MS)}};Blockly.Tooltip.hide=function(){if(Blockly.Tooltip.visible){Blockly.Tooltip.visible=false;if(Blockly.Tooltip.DIV)Blockly.Tooltip.DIV.style.display="none"}if(Blockly.Tooltip.showPid_)clearTimeout(Blockly.Tooltip.showPid_)};Blockly.Tooltip.block=function(){Blockly.Tooltip.hide();Blockly.Tooltip.blocked_=true};Blockly.Tooltip.unblock=function(){Blockly.Tooltip.blocked_=false};Blockly.Tooltip.show_=function(){if(Blockly.Tooltip.blocked_)return;Blockly.Tooltip.poisonedElement_=Blockly.Tooltip.element_;if(!Blockly.Tooltip.DIV)return;goog.dom.removeChildren(Blockly.Tooltip.DIV);var e=Blockly.Tooltip.element_.tooltip;while(goog.isFunction(e))e=e();e=Blockly.utils.wrap(e,Blockly.Tooltip.LIMIT);var o=e.split("\n");for(var t=0;t<o.length;t++){var i=document.createElement("div");i.appendChild(document.createTextNode(o[t]));Blockly.Tooltip.DIV.appendChild(i)}var r=Blockly.Tooltip.element_.RTL;var n=goog.dom.getViewportSize();Blockly.Tooltip.DIV.style.direction=r?"rtl":"ltr";Blockly.Tooltip.DIV.style.display="block";Blockly.Tooltip.visible=true;var l=Blockly.Tooltip.lastX_;if(r)l-=Blockly.Tooltip.OFFSET_X+Blockly.Tooltip.DIV.offsetWidth;else l+=Blockly.Tooltip.OFFSET_X;var s=Blockly.Tooltip.lastY_+Blockly.Tooltip.OFFSET_Y;if(s+Blockly.Tooltip.DIV.offsetHeight>n.height+window.scrollY)s-=Blockly.Tooltip.DIV.offsetHeight+2*Blockly.Tooltip.OFFSET_Y;if(r)l=Math.max(Blockly.Tooltip.MARGINS-window.scrollX,l);else if(l+Blockly.Tooltip.DIV.offsetWidth>n.width+window.scrollX-2*Blockly.Tooltip.MARGINS)l=n.width-Blockly.Tooltip.DIV.offsetWidth-2*Blockly.Tooltip.MARGINS;Blockly.Tooltip.DIV.style.top=s+"px";Blockly.Tooltip.DIV.style.left=l+"px"};goog.provide("Blockly.Touch");goog.require("goog.events");goog.require("goog.events.BrowserFeature");goog.require("goog.string");Blockly.Touch.touchIdentifier_=null;Blockly.Touch.TOUCH_MAP={};if(goog.events.BrowserFeature.TOUCH_ENABLED)Blockly.Touch.TOUCH_MAP={mousedown:["touchstart"],mousemove:["touchmove"],mouseup:["touchend","touchcancel"]};Blockly.longPid_=0;Blockly.longStart_=function(e,o){Blockly.longStop_();if(1!=e.changedTouches.length)return;Blockly.longPid_=setTimeout((function(){e.button=2;e.clientX=e.changedTouches[0].clientX;e.clientY=e.changedTouches[0].clientY;if(o)o.handleRightClick(e)}),Blockly.LONGPRESS)};Blockly.longStop_=function(){if(Blockly.longPid_){clearTimeout(Blockly.longPid_);Blockly.longPid_=0}};Blockly.Touch.clearTouchIdentifier=function(){Blockly.Touch.touchIdentifier_=null};Blockly.Touch.shouldHandleEvent=function(e){return!Blockly.Touch.isMouseOrTouchEvent(e)||Blockly.Touch.checkTouchIdentifier(e)};Blockly.Touch.getTouchIdentifierFromEvent=function(e){return e.changedTouches&&e.changedTouches[0]&&void 0!=e.changedTouches[0].identifier&&null!=e.changedTouches[0].identifier?e.changedTouches[0].identifier:"mouse"};Blockly.Touch.checkTouchIdentifier=function(e){var o=Blockly.Touch.getTouchIdentifierFromEvent(e);if(void 0!=Blockly.Touch.touchIdentifier_&&null!=Blockly.Touch.touchIdentifier_)return Blockly.Touch.touchIdentifier_==o;if("mousedown"==e.type||"touchstart"==e.type){Blockly.Touch.touchIdentifier_=o;return true}return false};Blockly.Touch.setClientFromTouch=function(e){if(Blockly.utils.startsWith(e.type,"touch")){var o=e.changedTouches[0];e.clientX=o.clientX;e.clientY=o.clientY}};Blockly.Touch.isMouseOrTouchEvent=function(e){return Blockly.utils.startsWith(e.type,"touch")||Blockly.utils.startsWith(e.type,"mouse")};Blockly.Touch.splitEventByTouches=function(e){var o=[];if(e.changedTouches)for(var t=0;t<e.changedTouches.length;t++){var i={type:e.type,changedTouches:[e.changedTouches[t]],target:e.target,stopPropagation:function(){e.stopPropagation()},preventDefault:function(){e.preventDefault()}};o[t]=i}else o.push(e);return o};goog.provide("Blockly.Trashcan");goog.require("goog.dom");goog.require("goog.math.Rect");Blockly.Trashcan=function(e){this.workspace_=e};Blockly.Trashcan.prototype.WIDTH_=47;Blockly.Trashcan.prototype.BODY_HEIGHT_=44;Blockly.Trashcan.prototype.LID_HEIGHT_=16;Blockly.Trashcan.prototype.MARGIN_BOTTOM_=20;Blockly.Trashcan.prototype.MARGIN_SIDE_=20;Blockly.Trashcan.prototype.MARGIN_HOTSPOT_=10;Blockly.Trashcan.prototype.SPRITE_LEFT_=0;Blockly.Trashcan.prototype.SPRITE_TOP_=32;Blockly.Trashcan.prototype.isOpen=false;Blockly.Trashcan.prototype.svgGroup_=null;Blockly.Trashcan.prototype.svgLid_=null;Blockly.Trashcan.prototype.lidTask_=0;Blockly.Trashcan.prototype.lidOpen_=0;Blockly.Trashcan.prototype.left_=0;Blockly.Trashcan.prototype.top_=0;Blockly.Trashcan.prototype.createDom=function(){this.svgGroup_=Blockly.utils.createSvgElement("g",{class:"blocklyTrash"},null);var e;var o=String(Math.random()).substring(2);e=Blockly.utils.createSvgElement("clipPath",{id:"blocklyTrashBodyClipPath"+o},this.svgGroup_);Blockly.utils.createSvgElement("rect",{width:this.WIDTH_,height:this.BODY_HEIGHT_,y:this.LID_HEIGHT_},e);var t=Blockly.utils.createSvgElement("image",{width:Blockly.SPRITE.width,x:-this.SPRITE_LEFT_,height:Blockly.SPRITE.height,y:-this.SPRITE_TOP_,"clip-path":"url(#blocklyTrashBodyClipPath"+o+")"},this.svgGroup_);t.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",this.workspace_.options.pathToMedia+Blockly.SPRITE.url);e=Blockly.utils.createSvgElement("clipPath",{id:"blocklyTrashLidClipPath"+o},this.svgGroup_);Blockly.utils.createSvgElement("rect",{width:this.WIDTH_,height:this.LID_HEIGHT_},e);this.svgLid_=Blockly.utils.createSvgElement("image",{width:Blockly.SPRITE.width,x:-this.SPRITE_LEFT_,height:Blockly.SPRITE.height,y:-this.SPRITE_TOP_,"clip-path":"url(#blocklyTrashLidClipPath"+o+")"},this.svgGroup_);this.svgLid_.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",this.workspace_.options.pathToMedia+Blockly.SPRITE.url);Blockly.bindEventWithChecks_(this.svgGroup_,"mouseup",this,this.click);this.animateLid_();return this.svgGroup_};Blockly.Trashcan.prototype.init=function(e){this.bottom_=this.MARGIN_BOTTOM_+e;this.setOpen_(false);return this.bottom_+this.BODY_HEIGHT_+this.LID_HEIGHT_};Blockly.Trashcan.prototype.dispose=function(){if(this.svgGroup_){goog.dom.removeNode(this.svgGroup_);this.svgGroup_=null}this.svgLid_=null;this.workspace_=null;clearTimeout(this.lidTask_)};Blockly.Trashcan.prototype.position=function(){var e=this.workspace_.getMetrics();if(!e)return;if(this.workspace_.RTL){this.left_=this.MARGIN_SIDE_+Blockly.Scrollbar.scrollbarThickness;if(e.toolboxPosition==Blockly.TOOLBOX_AT_LEFT){this.left_+=e.flyoutWidth;if(this.workspace_.toolbox_)this.left_+=e.absoluteLeft}}else{this.left_=e.viewWidth+e.absoluteLeft-this.WIDTH_-this.MARGIN_SIDE_-Blockly.Scrollbar.scrollbarThickness;if(e.toolboxPosition==Blockly.TOOLBOX_AT_RIGHT)this.left_-=e.flyoutWidth}this.top_=e.viewHeight+e.absoluteTop-(this.BODY_HEIGHT_+this.LID_HEIGHT_)-this.bottom_;if(e.toolboxPosition==Blockly.TOOLBOX_AT_BOTTOM)this.top_-=e.flyoutHeight;this.svgGroup_.setAttribute("transform","translate("+this.left_+","+this.top_+")")};Blockly.Trashcan.prototype.getClientRect=function(){if(!this.svgGroup_)return null;var e=this.svgGroup_.getBoundingClientRect();var o=e.left+this.SPRITE_LEFT_-this.MARGIN_HOTSPOT_;var t=e.top+this.SPRITE_TOP_-this.MARGIN_HOTSPOT_;var i=this.WIDTH_+2*this.MARGIN_HOTSPOT_;var r=this.LID_HEIGHT_+this.BODY_HEIGHT_+2*this.MARGIN_HOTSPOT_;return new goog.math.Rect(o,t,i,r)};Blockly.Trashcan.prototype.setOpen_=function(e){if(this.isOpen==e)return;clearTimeout(this.lidTask_);this.isOpen=e;this.animateLid_()};Blockly.Trashcan.prototype.animateLid_=function(){this.lidOpen_+=this.isOpen?.2:-.2;this.lidOpen_=Math.min(Math.max(this.lidOpen_,0),1);var e=45*this.lidOpen_;this.svgLid_.setAttribute("transform","rotate("+(this.workspace_.RTL?-e:e)+","+(this.workspace_.RTL?4:this.WIDTH_-4)+","+(this.LID_HEIGHT_-2)+")");var o=.4+this.lidOpen_*(.8-.4);this.svgGroup_.style.opacity=o;if(this.lidOpen_>0&&this.lidOpen_<1)this.lidTask_=setTimeout(this.animateLid_.bind(this),20)};Blockly.Trashcan.prototype.close=function(){this.setOpen_(false)};Blockly.Trashcan.prototype.click=function(){var e=this.workspace_.startScrollX-this.workspace_.scrollX;var o=this.workspace_.startScrollY-this.workspace_.scrollY;if(Math.sqrt(e*e+o*o)>Blockly.DRAG_RADIUS)return;console.log("TODO: Inspect trash.")};goog.provide("Blockly.utils.uiMenu");Blockly.utils.uiMenu.getSize=function(e){var o=e.getElement();var t=goog.style.getSize(o);t.height=o.scrollHeight;return t};Blockly.utils.uiMenu.adjustBBoxesForRTL=function(e,o,t){o.left+=t.width;o.right+=t.width;e.left+=t.width;e.right+=t.width};goog.provide("Blockly.utils");goog.require("Blockly.Touch");goog.require("goog.dom");goog.require("goog.events.BrowserFeature");goog.require("goog.math.Coordinate");goog.require("goog.userAgent");Blockly.utils.getMessageArray_=function(){return goog.global["Blockly"]["Msg"]};Blockly.utils.removeAttribute=function(e,o){if(goog.userAgent.IE&&goog.userAgent.isVersion("10.0"))e.setAttribute(o,null);else e.removeAttribute(o)};Blockly.utils.addClass=function(e,o){var t=e.getAttribute("class")||"";if(-1!=(" "+t+" ").indexOf(" "+o+" "))return false;if(t)t+=" ";e.setAttribute("class",t+o);return true};Blockly.utils.removeClass=function(e,o){var t=e.getAttribute("class");if(-1==(" "+t+" ").indexOf(" "+o+" "))return false;var i=t.split(/\s+/);for(var r=0;r<i.length;r++)if(!i[r]||i[r]==o){i.splice(r,1);r--}if(i.length)e.setAttribute("class",i.join(" "));else Blockly.utils.removeAttribute(e,"class");return true};Blockly.utils.hasClass=function(e,o){var t=e.getAttribute("class");return-1!=(" "+t+" ").indexOf(" "+o+" ")};Blockly.utils.noEvent=function(e){e.preventDefault();e.stopPropagation()};Blockly.utils.isTargetInput=function(e){return"textarea"==e.target.type||"text"==e.target.type||"number"==e.target.type||"email"==e.target.type||"password"==e.target.type||"search"==e.target.type||"tel"==e.target.type||"url"==e.target.type||e.target.isContentEditable};Blockly.utils.getRelativeXY=function(e){var o=new goog.math.Coordinate(0,0);var t=e.getAttribute("x");if(t)o.x=parseInt(t,10);var i=e.getAttribute("y");if(i)o.y=parseInt(i,10);var r=e.getAttribute("transform");var n=r&&r.match(Blockly.utils.getRelativeXY.XY_REGEX_);if(n){o.x+=parseFloat(n[1]);if(n[3])o.y+=parseFloat(n[3])}var l=e.getAttribute("style");if(l&&l.indexOf("translate")>-1){var s=l.match(Blockly.utils.getRelativeXY.XY_STYLE_REGEX_);if(s){o.x+=parseFloat(s[1]);if(s[3])o.y+=parseFloat(s[3])}}return o};Blockly.utils.getInjectionDivXY_=function(e){var o=0;var t=0;while(e){var i=Blockly.utils.getRelativeXY(e);var r=Blockly.utils.getScale_(e);o=o*r+i.x;t=t*r+i.y;var n=e.getAttribute("class")||"";if(-1!=(" "+n+" ").indexOf(" injectionDiv "))break;e=e.parentNode}return new goog.math.Coordinate(o,t)};Blockly.utils.getScale_=function(e){var o=1;var t=e.getAttribute("transform");if(t){var i=t.match(Blockly.utils.getScale_.REGEXP_);if(i&&i[0])o=parseFloat(i[0])}return o};Blockly.utils.getRelativeXY.XY_REGEX_=/translate\(\s*([-+\d.e]+)([ ,]\s*([-+\d.e]+)\s*)?/;Blockly.utils.getScale_REGEXP_=/scale\(\s*([-+\d.e]+)\s*\)/;Blockly.utils.getRelativeXY.XY_STYLE_REGEX_=/transform:\s*translate(?:3d)?\(\s*([-+\d.e]+)\s*px([ ,]\s*([-+\d.e]+)\s*px)?/;Blockly.utils.createSvgElement=function(e,o,t){var i=document.createElementNS(Blockly.SVG_NS,e);for(var r in o)i.setAttribute(r,o[r]);if(document.body.runtimeStyle)i.runtimeStyle=i.currentStyle=i.style;if(t)t.appendChild(i);return i};Blockly.utils.isRightButton=function(e){if(e.ctrlKey&&goog.userAgent.MAC)return true;return 2==e.button};Blockly.utils.mouseToSvg=function(e,o,t){var i=o.createSVGPoint();i.x=e.clientX;i.y=e.clientY;if(!t)t=o.getScreenCTM().inverse();return i.matrixTransform(t)};Blockly.utils.shortestStringLength=function(e){if(!e.length)return 0;return e.reduce((function(e,o){return e.length<o.length?e:o})).length};Blockly.utils.commonWordPrefix=function(e,o){if(!e.length)return 0;else if(1==e.length)return e[0].length;var t=0;var i=o||Blockly.utils.shortestStringLength(e);for(var r=0;r<i;r++){var n=e[0][r];for(var l=1;l<e.length;l++)if(n!=e[l][r])return t;if(" "==n)t=r+1}for(var l=1;l<e.length;l++){var n=e[l][r];if(n&&" "!=n)return t}return i};Blockly.utils.commonWordSuffix=function(e,o){if(!e.length)return 0;else if(1==e.length)return e[0].length;var t=0;var i=o||Blockly.utils.shortestStringLength(e);for(var r=0;r<i;r++){var n=e[0].substr(-r-1,1);for(var l=1;l<e.length;l++)if(n!=e[l].substr(-r-1,1))return t;if(" "==n)t=r+1}for(var l=1;l<e.length;l++){var n=e[l].charAt(e[l].length-r-1);if(n&&" "!=n)return t}return i};Blockly.utils.tokenizeInterpolation=function(e){return Blockly.utils.tokenizeInterpolation_(e,true)};Blockly.utils.replaceMessageReferences=function(e){if(!goog.isString(e))return e;var o=Blockly.utils.tokenizeInterpolation_(e,false);return o.length?o[0]:""};Blockly.utils.checkMessageReferences=function(e){var o=true;var t=/%{BKY_([a-zA-Z][a-zA-Z0-9_]*)}/g;var i=t.exec(e);while(i){var r=i[1];if(void 0==Blockly.utils.getMessageArray_()[r]){console.log("WARNING: No message string for %{BKY_"+r+"}.");o=false}e=e.substring(i.index+r.length+1);i=t.exec(e)}return o};Blockly.utils.tokenizeInterpolation_=function(e,o){var t=[];var i=e.split("");i.push("");var r=0;var n=[];var l=null;for(var s=0;s<i.length;s++){var g=i[s];if(0==r)if("%"==g){var a=n.join("");if(a)t.push(a);n.length=0;r=1}else n.push(g);else if(1==r)if("%"==g){n.push(g);r=0}else if(o&&"0"<=g&&g<="9"){r=2;l=g;var a=n.join("");if(a)t.push(a);n.length=0}else if("{"==g)r=3;else{n.push("%",g);r=0}else if(2==r)if("0"<=g&&g<="9")l+=g;else{t.push(parseInt(l,10));s--;r=0}else if(3==r)if(""==g){n.splice(0,0,"%{");s--;r=0}else if("}"!=g)n.push(g);else{var c=n.join("");if(/[a-zA-Z][a-zA-Z0-9_]*/.test(c)){var u=c.toUpperCase();var h=goog.string.startsWith(u,"BKY_")?u.substring(4):null;if(h&&h in Blockly.Msg){var d=Blockly.Msg[h];if(goog.isString(d))Array.prototype.push.apply(t,Blockly.utils.tokenizeInterpolation(d));else if(o)t.push(String(d));else t.push(d)}else t.push("%{"+c+"}");n.length=0;r=0}else{t.push("%{"+c+"}");n.length=0;r=0}}}var a=n.join("");if(a)t.push(a);var p=[];n.length=0;for(var s=0;s<t.length;++s)if("string"==typeof t[s])n.push(t[s]);else{a=n.join("");if(a)p.push(a);n.length=0;p.push(t[s])}a=n.join("");if(a)p.push(a);n.length=0;return p};Blockly.utils.genUid=function(){var e=20;var o=Blockly.utils.genUid.soup_.length;var t=[];for(var i=0;i<e;i++)t[i]=Blockly.utils.genUid.soup_.charAt(Math.random()*o);return t.join("")};Blockly.utils.genUid.soup_="!#$%()*+,-./:;=?@[]^_`{|}~"+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789";Blockly.utils.wrap=function(e,o){var t=e.split("\n");for(var i=0;i<t.length;i++)t[i]=Blockly.utils.wrapLine_(t[i],o);return t.join("\n")};Blockly.utils.wrapLine_=function(e,o){if(e.length<=o)return e;var t=e.trim().split(/\s+/);for(var i=0;i<t.length;i++)if(t[i].length>o)o=t[i].length;var r;var n=-1/0;var l;var s=1;do{r=n;l=e;var g=[];var a=t.length/s;var c=1;for(var i=0;i<t.length-1;i++)if(c<(i+1.5)/a){c++;g[i]=true}else g[i]=false;g=Blockly.utils.wrapMutate_(t,g,o);n=Blockly.utils.wrapScore_(t,g,o);e=Blockly.utils.wrapToText_(t,g);s++}while(n>r);return l};Blockly.utils.wrapScore_=function(e,o,t){var i=[0];var r=[];for(var n=0;n<e.length;n++){i[i.length-1]+=e[n].length;if(true===o[n]){i.push(0);r.push(e[n].charAt(e[n].length-1))}else if(false===o[n])i[i.length-1]++}var l=Math.max.apply(Math,i);var s=0;for(var n=0;n<i.length;n++){s-=2*Math.pow(Math.abs(t-i[n]),1.5);s-=Math.pow(l-i[n],1.5);if(-1!=".?!".indexOf(r[n]))s+=t/3;else if(-1!=",;)]}".indexOf(r[n]))s+=t/4}if(i.length>1&&i[i.length-1]<=i[i.length-2])s+=.5;return s};Blockly.utils.wrapMutate_=function(e,o,t){var i=Blockly.utils.wrapScore_(e,o,t);var r;for(var n=0;n<o.length-1;n++){if(o[n]==o[n+1])continue;var l=[].concat(o);l[n]=!l[n];l[n+1]=!l[n+1];var s=Blockly.utils.wrapScore_(e,l,t);if(s>i){i=s;r=l}}if(r)return Blockly.utils.wrapMutate_(e,r,t);return o};Blockly.utils.wrapToText_=function(e,o){var t=[];for(var i=0;i<e.length;i++){t.push(e[i]);if(void 0!==o[i])t.push(o[i]?"\n":" ")}return t.join("")};Blockly.utils.is3dSupported=function(){if(void 0!==Blockly.utils.is3dSupported.cached_)return Blockly.utils.is3dSupported.cached_;if(!goog.global.getComputedStyle)return false;var e=document.createElement("p");var o="none";var t={webkitTransform:"-webkit-transform",OTransform:"-o-transform",msTransform:"-ms-transform",MozTransform:"-moz-transform",transform:"transform"};document.body.insertBefore(e,null);for(var i in t)if(void 0!==e.style[i]){e.style[i]="translate3d(1px,1px,1px)";var r=goog.global.getComputedStyle(e);if(!r){document.body.removeChild(e);return false}o=r.getPropertyValue(t[i])}document.body.removeChild(e);Blockly.utils.is3dSupported.cached_="none"!==o;return Blockly.utils.is3dSupported.cached_};Blockly.utils.insertAfter=function(e,o){var t=o.nextSibling;var i=o.parentNode;if(!i)throw"Reference node has no parent.";if(t)i.insertBefore(e,t);else i.appendChild(e)};Blockly.utils.runAfterPageLoad=function(e){if(!document)throw new Error("Blockly.utils.runAfterPageLoad() requires browser document.");if("complete"===document.readyState)e();else var o=setInterval((function(){if("complete"===document.readyState){clearInterval(o);e()}}),10)};Blockly.utils.setCssTransform=function(e,o){e.style["transform"]=o;e.style["-webkit-transform"]=o};Blockly.utils.getViewportBBox=function(){var e=goog.dom.getViewportSize();var o=goog.style.getViewportPageOffset(document);return{right:e.width+o.x,bottom:e.height+o.y,top:o.y,left:o.x}};Blockly.utils.startsWith=function(e,o){return 0==e.lastIndexOf(o,0)};Blockly.utils.toRadians=function(e){return e*Math.PI/180};goog.provide("Blockly.WidgetDiv");goog.require("Blockly.Css");goog.require("goog.dom");goog.require("goog.dom.TagName");goog.require("goog.style");Blockly.WidgetDiv.DIV=null;Blockly.WidgetDiv.owner_=null;Blockly.WidgetDiv.dispose_=null;Blockly.WidgetDiv.disposeAnimationFinished_=null;Blockly.WidgetDiv.disposeAnimationTimer_=null;Blockly.WidgetDiv.disposeAnimationTimerLength_=0;Blockly.WidgetDiv.createDom=function(){if(Blockly.WidgetDiv.DIV)return;Blockly.WidgetDiv.DIV=goog.dom.createDom(goog.dom.TagName.DIV,"blocklyWidgetDiv");document.body.appendChild(Blockly.WidgetDiv.DIV)};Blockly.WidgetDiv.show=function(e,o,t,i,r){Blockly.WidgetDiv.hide();Blockly.WidgetDiv.owner_=e;Blockly.WidgetDiv.dispose_=t;Blockly.WidgetDiv.disposeAnimationFinished_=i;Blockly.WidgetDiv.disposeAnimationTimerLength_=r;var n=goog.style.getViewportPageOffset(document);Blockly.WidgetDiv.DIV.style.top=n.y+"px";Blockly.WidgetDiv.DIV.style.direction=o?"rtl":"ltr";Blockly.WidgetDiv.DIV.style.display="block"};Blockly.WidgetDiv.repositionForWindowResize=function(){if(Blockly.WidgetDiv.owner_&&Blockly.WidgetDiv.owner_.getScaledBBox_&&Blockly.WidgetDiv.owner_.getSize){var e=Blockly.WidgetDiv.owner_.getScaledBBox_();var o=Blockly.WidgetDiv.owner_.getSize();Blockly.WidgetDiv.positionInternal_(e.left,e.top,o.height)}else Blockly.WidgetDiv.hide()};Blockly.WidgetDiv.hide=function(e){if(Blockly.WidgetDiv.disposeAnimationTimer_){window.clearTimeout(Blockly.WidgetDiv.disposeAnimationTimer_);Blockly.WidgetDiv.disposeAnimationFinished_&&Blockly.WidgetDiv.disposeAnimationFinished_();Blockly.WidgetDiv.disposeAnimationFinished_=null;Blockly.WidgetDiv.disposeAnimationTimer_=null;Blockly.WidgetDiv.owner_=null;Blockly.WidgetDiv.hideAndClearDom_()}else if(Blockly.WidgetDiv.isVisible()){Blockly.WidgetDiv.dispose_&&Blockly.WidgetDiv.dispose_();Blockly.WidgetDiv.dispose_=null;if(Blockly.WidgetDiv.disposeAnimationFinished_&&!e)Blockly.WidgetDiv.disposeAnimationTimer_=window.setTimeout(Blockly.WidgetDiv.hide,1e3*Blockly.WidgetDiv.disposeAnimationTimerLength_);else{Blockly.WidgetDiv.disposeAnimationFinished_&&Blockly.WidgetDiv.disposeAnimationFinished_();Blockly.WidgetDiv.disposeAnimationFinished_=null;Blockly.WidgetDiv.owner_=null;Blockly.WidgetDiv.hideAndClearDom_()}}};Blockly.WidgetDiv.hideAndClearDom_=function(){Blockly.WidgetDiv.DIV.style.display="none";Blockly.WidgetDiv.DIV.style.left="";Blockly.WidgetDiv.DIV.style.top="";Blockly.WidgetDiv.DIV.style.height="";goog.dom.removeChildren(Blockly.WidgetDiv.DIV)};Blockly.WidgetDiv.isVisible=function(){return!!Blockly.WidgetDiv.owner_};Blockly.WidgetDiv.hideIfOwner=function(e){if(Blockly.WidgetDiv.owner_==e)Blockly.WidgetDiv.hide()};Blockly.WidgetDiv.position=function(e,o,t,i,r){if(o<i.y)o=i.y;if(r){if(e>t.width+i.x)e=t.width+i.x}else if(e<i.x)e=i.x;Blockly.WidgetDiv.positionInternal_(e,o,t.height)};Blockly.WidgetDiv.positionInternal_=function(e,o,t){Blockly.WidgetDiv.DIV.style.left=e+"px";Blockly.WidgetDiv.DIV.style.top=o+"px";Blockly.WidgetDiv.DIV.style.height=t+"px"};Blockly.WidgetDiv.positionWithAnchor=function(e,o,t,i){var r=Blockly.WidgetDiv.calculateY_(e,o,t);var n=Blockly.WidgetDiv.calculateX_(e,o,t,i);if(r<0)Blockly.WidgetDiv.positionInternal_(n,0,t.height+r);else Blockly.WidgetDiv.positionInternal_(n,r,t.height)};Blockly.WidgetDiv.calculateX_=function(e,o,t,i){if(i){var r=o.right-t.width;var n=Math.max(r,e.left);return Math.min(n,e.right-t.width)}else{var n=Math.min(o.left,e.right-t.width);return Math.max(n,e.left)}};Blockly.WidgetDiv.calculateY_=function(e,o,t){if(o.bottom+t.height>=e.bottom)return o.top-t.height;else return o.bottom};goog.provide("Blockly.Workspace");goog.require("Blockly.VariableMap");goog.require("Blockly.WorkspaceComment");goog.require("goog.array");goog.require("goog.math");Blockly.Workspace=function(e){this.id=Blockly.utils.genUid();Blockly.Workspace.WorkspaceDB_[this.id]=this;this.options=e||{};this.RTL=!!this.options.RTL;this.horizontalLayout=!!this.options.horizontalLayout;this.toolboxPosition=this.options.toolboxPosition;this.topBlocks_=[];this.topComments_=[];this.commentDB_=Object.create(null);this.listeners_=[];this.tapListeners_=[];this.undoStack_=[];this.redoStack_=[];this.blockDB_=Object.create(null);this.variableMap_=new Blockly.VariableMap(this);this.potentialVariableMap_=null};Blockly.Workspace.prototype.rendered=false;Blockly.Workspace.prototype.isClearing=false;Blockly.Workspace.prototype.MAX_UNDO=1024;Blockly.Workspace.prototype.refreshToolboxSelection_=function(){};Blockly.Workspace.prototype.dispose=function(){this.listeners_.length=0;this.clear();delete Blockly.Workspace.WorkspaceDB_[this.id]};Blockly.Workspace.SCAN_ANGLE=3;Blockly.Workspace.prototype.addTopBlock=function(e){this.topBlocks_.push(e)};Blockly.Workspace.prototype.removeTopBlock=function(e){if(!goog.array.remove(this.topBlocks_,e))throw"Block not present in workspace's list of top-most blocks."};Blockly.Workspace.prototype.getTopBlocks=function(e){var o=[].concat(this.topBlocks_);if(e&&o.length>1){var t=Math.sin(goog.math.toRadians(Blockly.Workspace.SCAN_ANGLE));if(this.RTL)t*=-1;o.sort((function(e,o){var i=e.getRelativeToSurfaceXY();var r=o.getRelativeToSurfaceXY();return i.y+t*i.x-(r.y+t*r.x)}))}return o};Blockly.Workspace.prototype.addTopComment=function(e){this.topComments_.push(e);if(this.commentDB_[e.id])console.warn('Overriding an existing comment on this workspace, with id "'+e.id+'"');this.commentDB_[e.id]=e};Blockly.Workspace.prototype.removeTopComment=function(e){if(!goog.array.remove(this.topComments_,e))throw"Comment not present in workspace's list of top-most comments.";delete this.commentDB_[e.id]};Blockly.Workspace.prototype.getTopComments=function(e){var o=[].concat(this.topComments_);if(e&&o.length>1){var t=Math.sin(goog.math.toRadians(Blockly.Workspace.SCAN_ANGLE));if(this.RTL)t*=-1;o.sort((function(e,o){var i=e instanceof Blockly.ScratchBlockComment?e.getXY():e.getRelativeToSurfaceXY();var r=o instanceof Blockly.ScratchBlockComment?o.getXY():o.getRelativeToSurfaceXY();return i.y+t*i.x-(r.y+t*r.x)}))}return o};Blockly.Workspace.prototype.getAllBlocks=function(e){if(e){var o=this.getTopBlocks(true);var t=[];for(var i=0;i<o.length;i++)t.push.apply(t,o[i].getDescendants(true))}else{var t=this.getTopBlocks(false);for(var i=0;i<t.length;i++)t.push.apply(t,t[i].getChildren(false))}return t};Blockly.Workspace.prototype.clear=function(){this.isClearing=true;var e=Blockly.Events.getGroup();if(!e)Blockly.Events.setGroup(true);while(this.topBlocks_.length)this.topBlocks_[0].dispose();while(this.topComments_.length)this.topComments_[this.topComments_.length-1].dispose();if(!e)Blockly.Events.setGroup(false);this.variableMap_.clear();if(Blockly.DropDownDiv)Blockly.DropDownDiv.hideWithoutAnimation();if(Blockly.WidgetDiv)Blockly.WidgetDiv.hide(true);if(this.potentialVariableMap_)this.potentialVariableMap_.clear();this.isClearing=false};Blockly.Workspace.prototype.renameVariableById=function(e,o){this.variableMap_.renameVariableById(e,o)};Blockly.Workspace.prototype.createVariable=function(e,o,t,i,r){return this.variableMap_.createVariable(e,o,t,i,r)};Blockly.Workspace.prototype.getVariableUsesById=function(e){return this.variableMap_.getVariableUsesById(e)};Blockly.Workspace.prototype.deleteVariableById=function(e){this.variableMap_.deleteVariableById(e)};Blockly.Workspace.prototype.deleteVariableInternal_=function(e,o){this.variableMap_.deleteVariableInternal_(e,o)};Blockly.Workspace.prototype.variableIndexOf=function(e){console.warn("Deprecated call to Blockly.Workspace.prototype.variableIndexOf");return-1};Blockly.Workspace.prototype.getVariable=function(e,o){return this.variableMap_.getVariable(e,o)};Blockly.Workspace.prototype.getVariableById=function(e){return this.variableMap_.getVariableById(e)};Blockly.Workspace.prototype.getVariablesOfType=function(e){return this.variableMap_.getVariablesOfType(e)};Blockly.Workspace.prototype.getVariableTypes=function(){return this.variableMap_.getVariableTypes()};Blockly.Workspace.prototype.getAllVariables=function(){return this.variableMap_.getAllVariables()};Blockly.Workspace.prototype.getWidth=function(){return 0};Blockly.Workspace.prototype.newBlock=function(e,o){return new Blockly.Block(this,e,o)};Blockly.Workspace.prototype.undo=function(e){var o=e?this.redoStack_:this.undoStack_;var t=e?this.undoStack_:this.redoStack_;var i=o.pop();if(!i)return;var r=[i];while(o.length&&i.group&&i.group==o[o.length-1].group)r.push(o.pop());for(var n=0,l;l=r[n];n++)t.push(l);r=Blockly.Events.filter(r,e);Blockly.Events.recordUndo=false;if(Blockly.selected){Blockly.Events.disable();try{Blockly.selected.unselect()}finally{Blockly.Events.enable()}}try{for(var n=0,l;l=r[n];n++)l.run(e)}finally{Blockly.Events.recordUndo=true}};Blockly.Workspace.prototype.clearUndo=function(){this.undoStack_.length=0;this.redoStack_.length=0;Blockly.Events.clearPendingUndo()};Blockly.Workspace.prototype.hasRedoStack=function(){return 0!=this.redoStack_.length};Blockly.Workspace.prototype.hasUndoStack=function(){return 0!=this.undoStack_.length};Blockly.Workspace.prototype.addChangeListener=function(e){this.listeners_.push(e);return e};Blockly.Workspace.prototype.removeChangeListener=function(e){goog.array.remove(this.listeners_,e)};Blockly.Workspace.prototype.fireChangeListener=function(e){if(e.recordUndo){this.undoStack_.push(e);this.redoStack_.length=0;if(this.undoStack_.length>this.MAX_UNDO)this.undoStack_.unshift()}var o=this.listeners_.slice();for(var t=0,i;i=o[t];t++)i(e)};Blockly.Workspace.prototype.getBlockById=function(e){var o=this.blockDB_[e];if(!o&&this.getFlyout()&&this.getFlyout().getWorkspace())o=this.getFlyout().getWorkspace().blockDB_[e];return o||null};Blockly.Workspace.prototype.getCommentById=function(e){return this.commentDB_[e]||null};Blockly.Workspace.prototype.getFlyout=function(){return null};Blockly.Workspace.prototype.allInputsFilled=function(e){var o=this.getTopBlocks(false);for(var t=0,i;i=o[t];t++)if(!i.allInputsFilled(e))return false;return true};Blockly.Workspace.prototype.getPotentialVariableMap=function(){return this.potentialVariableMap_};Blockly.Workspace.prototype.createPotentialVariableMap=function(){this.potentialVariableMap_=new Blockly.VariableMap(this)};Blockly.Workspace.prototype.getVariableMap=function(){return this.variableMap_};Blockly.Workspace.WorkspaceDB_=Object.create(null);Blockly.Workspace.getById=function(e){return Blockly.Workspace.WorkspaceDB_[e]||null};Blockly.Workspace.prototype["clear"]=Blockly.Workspace.prototype.clear;Blockly.Workspace.prototype["clearUndo"]=Blockly.Workspace.prototype.clearUndo;Blockly.Workspace.prototype["addChangeListener"]=Blockly.Workspace.prototype.addChangeListener;Blockly.Workspace.prototype["removeChangeListener"]=Blockly.Workspace.prototype.removeChangeListener;goog.provide("Blockly.WorkspaceAudio");goog.require("goog.userAgent");Blockly.WorkspaceAudio=function(e){this.parentWorkspace_=e;this.SOUNDS_=Object.create(null)};Blockly.WorkspaceAudio.prototype.lastSound_=null;Blockly.WorkspaceAudio.prototype.dispose=function(){this.parentWorkspace_=null;this.SOUNDS_=null};Blockly.WorkspaceAudio.prototype.load=function(e,o){if(!e.length)return;try{var t=new window["Audio"]}catch(e){return}var i;for(var r=0;r<e.length;r++){var n=e[r];var l=n.match(/\.(\w+)$/);if(l&&t.canPlayType("audio/"+l[1])){i=new window["Audio"](n);break}}if(i&&i.play)this.SOUNDS_[o]=i};Blockly.WorkspaceAudio.prototype.preload=function(){for(var e in this.SOUNDS_){var o=this.SOUNDS_[e];o.volume=.01;var t=o.play();if(t)t.then(o.pause).catch((function(){}));else o.pause();if(goog.userAgent.IPAD||goog.userAgent.IPHONE)break}};Blockly.WorkspaceAudio.prototype.play=function(e,o){var t=this.SOUNDS_[e];if(t){var i=new Date;if(null!=this.lastSound_&&i-this.lastSound_<Blockly.SOUND_LIMIT)return;this.lastSound_=i;var r;var n=goog.userAgent.DOCUMENT_MODE&&9===goog.userAgent.DOCUMENT_MODE;if(n||goog.userAgent.IPAD||goog.userAgent.ANDROID)r=t;else r=t.cloneNode();r.volume=void 0===o?1:o;r.play()}else if(this.parentWorkspace_)this.parentWorkspace_.getAudioManager().play(e,o)};goog.provide("Blockly.WorkspaceComment");goog.require("Blockly.Events.CommentChange");goog.require("Blockly.Events.CommentCreate");goog.require("Blockly.Events.CommentDelete");goog.require("Blockly.Events.CommentMove");goog.require("goog.math.Coordinate");Blockly.WorkspaceComment=function(e,o,t,i,r,n){this.id=n&&!e.getCommentById(n)?n:Blockly.utils.genUid();e.addTopComment(this);this.xy_=new goog.math.Coordinate(0,0);this.height_=t;this.width_=i;this.isMinimized_=r;this.workspace=e;this.RTL=e.RTL;this.deletable_=true;this.movable_=true;this.content_=o;this.isComment=true;Blockly.WorkspaceComment.fireCreateEvent(this)};Blockly.WorkspaceComment.MAX_LABEL_LENGTH=12;Blockly.WorkspaceComment.COMMENT_TEXT_LIMIT=8e3;Blockly.WorkspaceComment.prototype.dispose=function(){if(!this.workspace)return;if(Blockly.Events.isEnabled())Blockly.Events.fire(new Blockly.Events.CommentDelete(this));this.workspace.removeTopComment(this);this.workspace=null};Blockly.WorkspaceComment.prototype.getHeight=function(){return this.height_};Blockly.WorkspaceComment.prototype.setHeight=function(e){this.height_=e};Blockly.WorkspaceComment.prototype.getWidth=function(){return this.width_};Blockly.WorkspaceComment.prototype.setWidth=function(e){this.width_=e};Blockly.WorkspaceComment.prototype.getHeightWidth=function(){return{height:this.height_,width:this.width_}};Blockly.WorkspaceComment.prototype.getXY=function(){return this.xy_.clone()};Blockly.WorkspaceComment.prototype.moveBy=function(e,o){var t=new Blockly.Events.CommentMove(this);this.xy_.translate(e,o);t.recordNew();Blockly.Events.fire(t)};Blockly.WorkspaceComment.prototype.isDeletable=function(){return this.deletable_&&!(this.workspace&&this.workspace.options.readOnly)};Blockly.WorkspaceComment.prototype.setDeletable=function(e){this.deletable_=e};Blockly.WorkspaceComment.prototype.isMovable=function(){return this.movable_&&!(this.workspace&&this.workspace.options.readOnly)};Blockly.WorkspaceComment.prototype.setMovable=function(e){this.movable_=e};Blockly.WorkspaceComment.prototype.getText=function(){return this.content_};Blockly.WorkspaceComment.prototype.setText=function(e){if(this.content_!=e){Blockly.Events.fire(new Blockly.Events.CommentChange(this,{text:this.content_},{text:e}));this.content_=e}};Blockly.WorkspaceComment.prototype.isMinimized=function(){return this.isMinimized_};Blockly.WorkspaceComment.prototype.toXmlWithXY=function(e){var o=this.toXml(e);o.setAttribute("x",Math.round(this.xy_.x));o.setAttribute("y",Math.round(this.xy_.y));o.setAttribute("h",this.height_);o.setAttribute("w",this.width_);return o};Blockly.WorkspaceComment.prototype.getLabelText=function(){if(this.content_.length>Blockly.WorkspaceComment.MAX_LABEL_LENGTH){if(this.RTL)return"…"+this.content_.slice(0,Blockly.WorkspaceComment.MAX_LABEL_LENGTH);return this.content_.slice(0,Blockly.WorkspaceComment.MAX_LABEL_LENGTH)+"…"}else return this.content_};Blockly.WorkspaceComment.prototype.toXml=function(e){var o=goog.dom.createDom("comment");if(!e)o.setAttribute("id",this.id);if(this.isMinimized_)o.setAttribute("minimized",true);o.textContent=this.getText();return o};Blockly.WorkspaceComment.fireCreateEvent=function(e){if(Blockly.Events.isEnabled()){var o=Blockly.Events.getGroup();if(!o)Blockly.Events.setGroup(true);try{Blockly.Events.fire(new Blockly.Events.CommentCreate(e))}finally{if(!o)Blockly.Events.setGroup(false)}}};Blockly.WorkspaceComment.fromXml=function(e,o){var t=Blockly.WorkspaceComment.parseAttributes(e);var i=new Blockly.WorkspaceComment(o,t.content,t.h,t.w,t.minimized,t.id);if(!isNaN(t.x)&&!isNaN(t.y))i.moveBy(t.x,t.y);Blockly.WorkspaceComment.fireCreateEvent(i);return i};Blockly.WorkspaceComment.parseAttributes=function(e){var o=e.getAttribute("h");var t=e.getAttribute("w");return{id:e.getAttribute("id"),h:o?parseInt(o,10):100,w:t?parseInt(t,10):100,x:parseInt(e.getAttribute("x"),10),y:parseInt(e.getAttribute("y"),10),minimized:"true"==e.getAttribute("minimized")||false,content:e.textContent}};goog.provide("Blockly.WorkspaceCommentSvg");goog.require("Blockly.Events.CommentCreate");goog.require("Blockly.Events.CommentDelete");goog.require("Blockly.Events.CommentMove");goog.require("Blockly.WorkspaceComment");Blockly.WorkspaceCommentSvg=function(e,o,t,i,r,n){this.svgGroup_=Blockly.utils.createSvgElement("g",{},null);this.svgGroup_.translate_="";this.svgRect_=Blockly.utils.createSvgElement("rect",{class:"scratchCommentRect scratchWorkspaceCommentBorder",x:0,y:0,rx:4*Blockly.WorkspaceCommentSvg.BORDER_WIDTH,ry:4*Blockly.WorkspaceCommentSvg.BORDER_WIDTH});this.svgGroup_.appendChild(this.svgRect_);this.rendered_=false;this.useDragSurface_=Blockly.utils.is3dSupported()&&!!e.blockDragSurface_;Blockly.WorkspaceCommentSvg.superClass_.constructor.call(this,e,o,t,i,r,n);this.render()};goog.inherits(Blockly.WorkspaceCommentSvg,Blockly.WorkspaceComment);Blockly.WorkspaceCommentSvg.DEFAULT_SIZE=200;Blockly.WorkspaceCommentSvg.prototype.dispose=function(){if(!this.workspace)return;if(Blockly.selected==this){this.unselect();this.workspace.cancelCurrentGesture()}if(Blockly.Events.isEnabled())Blockly.Events.fire(new Blockly.Events.CommentDelete(this));goog.dom.removeNode(this.svgGroup_);this.svgGroup_=null;this.svgRect_=null;this.disposeInternal_();Blockly.Events.disable();Blockly.WorkspaceCommentSvg.superClass_.dispose.call(this);Blockly.Events.enable()};Blockly.WorkspaceCommentSvg.prototype.initSvg=function(){goog.asserts.assert(this.workspace.rendered,"Workspace is headless.");if(!this.workspace.options.readOnly&&!this.eventsInit_){Blockly.bindEventWithChecks_(this.svgRectTarget_,"mousedown",this,this.pathMouseDown_);Blockly.bindEventWithChecks_(this.svgHandleTarget_,"mousedown",this,this.pathMouseDown_)}this.eventsInit_=true;this.updateMovable();if(!this.getSvgRoot().parentNode)this.workspace.getBubbleCanvas().appendChild(this.getSvgRoot())};Blockly.WorkspaceCommentSvg.prototype.pathMouseDown_=function(e){var o=this.workspace.getGesture(e);if(o)o.handleBubbleStart(e,this)};Blockly.WorkspaceCommentSvg.prototype.showContextMenu_=function(e){if(this.workspace.options.readOnly)return;var o=this;var t=[];if(this.isDeletable()&&this.isMovable()){t.push(Blockly.ContextMenu.commentDuplicateOption(o));t.push(Blockly.ContextMenu.commentDeleteOption(o))}Blockly.ContextMenu.show(e,t,this.RTL)};Blockly.WorkspaceCommentSvg.prototype.select=function(){if(Blockly.selected==this)return;var e=null;if(Blockly.selected){e=Blockly.selected.id;Blockly.Events.disable();try{Blockly.selected.unselect()}finally{Blockly.Events.enable()}}var o=new Blockly.Events.Ui(null,"selected",e,this.id);o.workspaceId=this.workspace.id;Blockly.Events.fire(o);Blockly.selected=this;this.addSelect()};Blockly.WorkspaceCommentSvg.prototype.unselect=function(){if(Blockly.selected!=this)return;var e=new Blockly.Events.Ui(null,"selected",this.id,null);e.workspaceId=this.workspace.id;Blockly.Events.fire(e);Blockly.selected=null;this.removeSelect()};Blockly.WorkspaceCommentSvg.prototype.addSelect=function(){Blockly.utils.addClass(this.svgGroup_,"blocklySelected");this.setFocus()};Blockly.WorkspaceCommentSvg.prototype.removeSelect=function(){Blockly.utils.removeClass(this.svgGroup_,"blocklySelected");this.blurFocus()};Blockly.WorkspaceCommentSvg.prototype.addFocus=function(){Blockly.utils.addClass(this.svgGroup_,"blocklyFocused")};Blockly.WorkspaceCommentSvg.prototype.removeFocus=function(){Blockly.utils.removeClass(this.svgGroup_,"blocklyFocused")};Blockly.WorkspaceCommentSvg.prototype.getRelativeToSurfaceXY=function(){var e=0;var o=0;var t=this.useDragSurface_?this.workspace.blockDragSurface_.getGroup():null;var i=this.getSvgRoot();if(i)do{var r=Blockly.utils.getRelativeXY(i);e+=r.x;o+=r.y;if(this.useDragSurface_&&this.workspace.blockDragSurface_.getCurrentBlock()==i){var n=this.workspace.blockDragSurface_.getSurfaceTranslation();e+=n.x;o+=n.y}i=i.parentNode}while(i&&i!=this.workspace.getBubbleCanvas()&&i!=t);this.xy_=new goog.math.Coordinate(e,o);return this.xy_};Blockly.WorkspaceCommentSvg.prototype.moveBy=function(e,o){var t=new Blockly.Events.CommentMove(this);var i=this.getRelativeToSurfaceXY();this.translate(i.x+e,i.y+o);t.recordNew();Blockly.Events.fire(t);this.workspace.resizeContents()};Blockly.WorkspaceCommentSvg.prototype.translate=function(e,o){this.xy_=new goog.math.Coordinate(e,o);this.getSvgRoot().setAttribute("transform","translate("+e+","+o+")")};Blockly.WorkspaceCommentSvg.prototype.moveToDragSurface_=function(){if(!this.useDragSurface_)return;var e=this.getRelativeToSurfaceXY();this.clearTransformAttributes_();this.workspace.blockDragSurface_.translateSurface(e.x,e.y);this.workspace.blockDragSurface_.setBlocksAndShow(this.getSvgRoot())};Blockly.WorkspaceCommentSvg.prototype.moveOffDragSurface_=function(e){if(!this.useDragSurface_)return;this.translate(e.x,e.y);this.workspace.blockDragSurface_.clearAndHide(this.workspace.getCanvas())};Blockly.WorkspaceCommentSvg.prototype.moveDuringDrag=function(e,o){if(e)e.translateSurface(o.x,o.y);else{this.svgGroup_.translate_="translate("+o.x+","+o.y+")";this.svgGroup_.setAttribute("transform",this.svgGroup_.translate_+this.svgGroup_.skew_)}};Blockly.WorkspaceCommentSvg.prototype.moveTo=function(e,o){this.translate(e,o)};Blockly.WorkspaceCommentSvg.prototype.clearTransformAttributes_=function(){Blockly.utils.removeAttribute(this.getSvgRoot(),"transform")};Blockly.WorkspaceCommentSvg.prototype.getBubbleSize=function(){if(this.rendered_)return{width:parseInt(this.svgRect_.getAttribute("width")),height:parseInt(this.svgRect_.getAttribute("height"))};else this.getHeightWidth()};Blockly.WorkspaceCommentSvg.prototype.getBoundingRectangle=function(){var e=this.getRelativeToSurfaceXY();var o=this.getHeightWidth();var t;var i;if(this.RTL){t=new goog.math.Coordinate(e.x-o.width,e.y);i=new goog.math.Coordinate(e.x,e.y+o.height)}else{t=new goog.math.Coordinate(e.x,e.y);i=new goog.math.Coordinate(e.x+o.width,e.y+o.height)}return{topLeft:t,bottomRight:i}};Blockly.WorkspaceCommentSvg.prototype.updateMovable=function(){if(this.isMovable())Blockly.utils.addClass(this.svgGroup_,"blocklyDraggable");else Blockly.utils.removeClass(this.svgGroup_,"blocklyDraggable")};Blockly.WorkspaceCommentSvg.prototype.setMovable=function(e){Blockly.WorkspaceCommentSvg.superClass_.setMovable.call(this,e);this.updateMovable()};Blockly.WorkspaceCommentSvg.prototype.setDragging=function(e){if(e){var o=this.getSvgRoot();o.translate_="";o.skew_="";Blockly.utils.addClass(this.svgGroup_,"blocklyDragging")}else Blockly.utils.removeClass(this.svgGroup_,"blocklyDragging")};Blockly.WorkspaceCommentSvg.prototype.getSvgRoot=function(){return this.svgGroup_};Blockly.WorkspaceCommentSvg.prototype.getText=function(){return this.textarea_?this.textarea_.value:this.content_};Blockly.WorkspaceCommentSvg.prototype.setText=function(e){Blockly.WorkspaceCommentSvg.superClass_.setText.call(this,e);if(this.textarea_)this.textarea_.value=e};Blockly.WorkspaceCommentSvg.prototype.setDeleteStyle=function(e){if(e)Blockly.utils.addClass(this.svgGroup_,"blocklyDraggingDelete");else Blockly.utils.removeClass(this.svgGroup_,"blocklyDraggingDelete")};Blockly.WorkspaceCommentSvg.prototype.setAutoLayout=function(){};Blockly.WorkspaceCommentSvg.fromXml=function(e,o,t){Blockly.Events.disable();try{var i=Blockly.WorkspaceComment.parseAttributes(e);var r=new Blockly.WorkspaceCommentSvg(o,i.content,i.h,i.w,i.minimized,i.id);if(o.rendered){r.initSvg();r.render(false)}if(!isNaN(i.x)&&!isNaN(i.y))if(o.RTL){var n=t||o.getWidth();r.moveBy(n-i.x,i.y)}else r.moveBy(i.x,i.y)}finally{Blockly.Events.enable()}Blockly.WorkspaceComment.fireCreateEvent(r);return r};Blockly.WorkspaceCommentSvg.prototype.toXmlWithXY=function(e){var o;if(this.workspace.RTL)o=this.workspace.getWidth();var t=this.toXml(e);var i=this.getRelativeToSurfaceXY();t.setAttribute("x",Math.round(this.workspace.RTL?o-i.x:i.x));t.setAttribute("y",Math.round(i.y));t.setAttribute("h",this.getHeight());t.setAttribute("w",this.getWidth());return t};goog.provide("Blockly.WorkspaceCommentSvg.render");goog.require("Blockly.WorkspaceCommentSvg");Blockly.WorkspaceCommentSvg.BORDER_WIDTH=1;Blockly.WorkspaceCommentSvg.RESIZE_SIZE=16;Blockly.WorkspaceCommentSvg.TEXTAREA_OFFSET=12;Blockly.WorkspaceCommentSvg.TOP_BAR_HEIGHT=32;Blockly.WorkspaceCommentSvg.MINIMIZE_ICON_SIZE=32;Blockly.WorkspaceCommentSvg.DELETE_ICON_SIZE=32;Blockly.WorkspaceCommentSvg.TOP_BAR_ICON_INSET=0;Blockly.WorkspaceCommentSvg.RESIZE_CORNER_PAD=4;Blockly.WorkspaceCommentSvg.RESIZE_OUTER_PAD=8;Blockly.WorkspaceCommentSvg.MINIMIZE_WIDTH=200;Blockly.WorkspaceCommentSvg.prototype.getHeightWidth=function(){return{width:this.getWidth(),height:this.getHeight()}};Blockly.WorkspaceCommentSvg.prototype.render=function(){if(this.rendered_)return;var e=this.getHeightWidth();this.commentEditor_=this.createEditor_();this.svgGroup_.appendChild(this.commentEditor_);this.createCommentTopBar_();this.svgRectTarget_=Blockly.utils.createSvgElement("rect",{class:"blocklyDraggable scratchCommentTarget",x:0,y:Blockly.WorkspaceCommentSvg.TOP_BAR_HEIGHT,rx:4*Blockly.WorkspaceCommentSvg.BORDER_WIDTH,ry:4*Blockly.WorkspaceCommentSvg.BORDER_WIDTH});this.svgGroup_.appendChild(this.svgRectTarget_);this.addResizeDom_();if(this.isMinimized()){this.minimizeArrow_.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",Blockly.mainWorkspace.options.pathToMedia+"comment-arrow-up.svg");this.commentEditor_.setAttribute("display","none");this.resizeGroup_.setAttribute("display","none")}else{this.minimizeArrow_.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",Blockly.mainWorkspace.options.pathToMedia+"comment-arrow-down.svg");this.topBarLabel_.setAttribute("display","none")}this.setSize(e.width,e.height);this.textarea_.value=this.content_;this.rendered_=true;if(this.resizeGroup_){Blockly.bindEventWithChecks_(this.resizeGroup_,"mousedown",this,this.resizeMouseDown_);Blockly.bindEventWithChecks_(this.resizeGroup_,"mouseup",this,this.resizeMouseUp_)}Blockly.bindEventWithChecks_(this.minimizeArrow_,"mousedown",this,this.minimizeArrowMouseDown_,true);Blockly.bindEventWithChecks_(this.minimizeArrow_,"mouseout",this,this.minimizeArrowMouseOut_,true);Blockly.bindEventWithChecks_(this.minimizeArrow_,"mouseup",this,this.minimizeArrowMouseUp_,true);Blockly.bindEventWithChecks_(this.deleteIcon_,"mousedown",this,this.deleteMouseDown_,true);Blockly.bindEventWithChecks_(this.deleteIcon_,"mouseout",this,this.deleteMouseOut_,true);Blockly.bindEventWithChecks_(this.deleteIcon_,"mouseup",this,this.deleteMouseUp_,true)};Blockly.WorkspaceCommentSvg.prototype.createEditor_=function(){this.foreignObject_=Blockly.utils.createSvgElement("foreignObject",{x:Blockly.WorkspaceCommentSvg.BORDER_WIDTH,y:Blockly.WorkspaceCommentSvg.BORDER_WIDTH+Blockly.WorkspaceCommentSvg.TOP_BAR_HEIGHT,class:"scratchCommentForeignObject"},null);var e=document.createElementNS(Blockly.HTML_NS,"body");e.setAttribute("xmlns",Blockly.HTML_NS);e.className="blocklyMinimalBody scratchCommentBody";var o=document.createElementNS(Blockly.HTML_NS,"textarea");o.className="scratchCommentTextarea scratchCommentText";o.setAttribute("dir",this.RTL?"RTL":"LTR");o.setAttribute("maxlength",Blockly.WorkspaceComment.COMMENT_TEXT_LIMIT);o.setAttribute("placeholder",Blockly.Msg.WORKSPACE_COMMENT_DEFAULT_TEXT);e.appendChild(o);this.textarea_=o;this.textarea_.style.margin=Blockly.WorkspaceCommentSvg.TEXTAREA_OFFSET+"px";this.foreignObject_.appendChild(e);Blockly.bindEventWithChecks_(o,"mousedown",this,(function(e){e.stopPropagation()}),true,true);Blockly.bindEventWithChecks_(o,"wheel",this,(function(e){e.stopPropagation()}));Blockly.bindEventWithChecks_(o,"change",this,(function(e){if(this.text_!=o.value)this.setText(o.value)}));this.labelText_=this.getLabelText();return this.foreignObject_};Blockly.WorkspaceCommentSvg.prototype.addResizeDom_=function(){this.resizeGroup_=Blockly.utils.createSvgElement("g",{class:this.RTL?"scratchCommentResizeSW":"scratchCommentResizeSE"},this.svgGroup_);var e=Blockly.WorkspaceCommentSvg.RESIZE_SIZE;var o=Blockly.ScratchBubble.RESIZE_OUTER_PAD;var t=Blockly.ScratchBubble.RESIZE_CORNER_PAD;Blockly.utils.createSvgElement("polygon",{points:[-o,e+t,e+t,e+t,e+t,-o].join(" ")},this.resizeGroup_);Blockly.utils.createSvgElement("line",{class:"blocklyResizeLine",x1:e/3,y1:e-1,x2:e-1,y2:e/3},this.resizeGroup_);Blockly.utils.createSvgElement("line",{class:"blocklyResizeLine",x1:2*e/3,y1:e-1,x2:e-1,y2:2*e/3},this.resizeGroup_)};Blockly.WorkspaceCommentSvg.prototype.createCommentTopBar_=function(){this.svgHandleTarget_=Blockly.utils.createSvgElement("rect",{class:"blocklyDraggable scratchCommentTopBar",rx:Blockly.WorkspaceCommentSvg.BORDER_WIDTH,ry:Blockly.WorkspaceCommentSvg.BORDER_WIDTH,height:Blockly.WorkspaceCommentSvg.TOP_BAR_HEIGHT},this.svgGroup_);this.createTopBarIcons_();this.createTopBarLabel_()};Blockly.WorkspaceCommentSvg.prototype.createTopBarLabel_=function(){this.topBarLabel_=Blockly.utils.createSvgElement("text",{class:"scratchCommentText",x:this.width_/2,y:Blockly.WorkspaceCommentSvg.TOP_BAR_HEIGHT/2+Blockly.WorkspaceCommentSvg.BORDER_WIDTH,"text-anchor":"middle","dominant-baseline":"middle"},this.svgGroup_);var e=document.createTextNode(this.labelText_);this.topBarLabel_.appendChild(e)};Blockly.WorkspaceCommentSvg.prototype.createTopBarIcons_=function(){var e=Blockly.WorkspaceCommentSvg.TOP_BAR_HEIGHT/2+Blockly.WorkspaceCommentSvg.BORDER_WIDTH;var o=Blockly.WorkspaceCommentSvg.TOP_BAR_ICON_INSET;this.minimizeArrow_=Blockly.utils.createSvgElement("image",{x:o,y:e-Blockly.WorkspaceCommentSvg.MINIMIZE_ICON_SIZE/2,width:Blockly.WorkspaceCommentSvg.MINIMIZE_ICON_SIZE,height:Blockly.WorkspaceCommentSvg.MINIMIZE_ICON_SIZE},this.svgGroup_);this.deleteIcon_=Blockly.utils.createSvgElement("image",{x:o,y:e-Blockly.WorkspaceCommentSvg.DELETE_ICON_SIZE/2,width:Blockly.WorkspaceCommentSvg.DELETE_ICON_SIZE,height:Blockly.WorkspaceCommentSvg.DELETE_ICON_SIZE},this.svgGroup_);this.deleteIcon_.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",Blockly.mainWorkspace.options.pathToMedia+"delete-x.svg")};Blockly.WorkspaceCommentSvg.prototype.minimizeArrowMouseDown_=function(e){this.shouldToggleMinimize_=true;e.stopPropagation()};Blockly.WorkspaceCommentSvg.prototype.minimizeArrowMouseOut_=function(e){this.shouldToggleMinimize_=false};Blockly.WorkspaceCommentSvg.prototype.minimizeArrowMouseUp_=function(e){if(this.shouldToggleMinimize_){this.shouldToggleMinimize=false;this.toggleMinimize_()}e.stopPropagation()};Blockly.WorkspaceCommentSvg.prototype.deleteMouseDown_=function(e){this.shouldDelete_=true;e.stopPropagation()};Blockly.WorkspaceCommentSvg.prototype.deleteMouseOut_=function(e){this.shouldDelete_=false};Blockly.WorkspaceCommentSvg.prototype.deleteMouseUp_=function(e){if(this.shouldDelete_)this.dispose();e.stopPropagation()};Blockly.WorkspaceCommentSvg.prototype.resizeMouseDown_=function(e){this.resizeStartSize_={width:this.width_,height:this.height_};this.unbindDragEvents_();this.workspace.setResizesEnabled(false);if(Blockly.utils.isRightButton(e)){e.stopPropagation();return}this.workspace.startDrag(e,new goog.math.Coordinate(this.workspace.RTL?-this.width_:this.width_,this.height_));this.onMouseUpWrapper_=Blockly.bindEventWithChecks_(document,"mouseup",this,this.resizeMouseUp_);this.onMouseMoveWrapper_=Blockly.bindEventWithChecks_(document,"mousemove",this,this.resizeMouseMove_);Blockly.hideChaff();e.stopPropagation()};Blockly.WorkspaceCommentSvg.prototype.setRenderedMinimizeState_=function(e,o){if(e){this.minimizeArrow_.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",Blockly.mainWorkspace.options.pathToMedia+"comment-arrow-up.svg");this.commentEditor_.setAttribute("display","none");if(this.resizeGroup_)this.resizeGroup_.setAttribute("display","none");if(o&&this.labelText_!=o)this.topBarLabel_.textContent=o;Blockly.utils.removeAttribute(this.topBarLabel_,"display")}else{this.minimizeArrow_.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",Blockly.mainWorkspace.options.pathToMedia+"comment-arrow-down.svg");this.topBarLabel_.setAttribute("display","none");Blockly.utils.removeAttribute(this.commentEditor_,"display");if(this.resizeGroup_)Blockly.utils.removeAttribute(this.resizeGroup_,"display")}};Blockly.WorkspaceCommentSvg.prototype.unbindDragEvents_=function(){if(this.onMouseUpWrapper_){Blockly.unbindEvent_(this.onMouseUpWrapper_);this.onMouseUpWrapper_=null}if(this.onMouseMoveWrapper_){Blockly.unbindEvent_(this.onMouseMoveWrapper_);this.onMouseMoveWrapper_=null}};Blockly.WorkspaceCommentSvg.prototype.resizeMouseUp_=function(){Blockly.Touch.clearTouchIdentifier();this.unbindDragEvents_();var e=this.resizeStartSize_;this.resizeStartSize_=null;if(this.width_==e.width&&this.height_==e.height)return;Blockly.Events.fire(new Blockly.Events.CommentChange(this,{width:e.width,height:e.height},{width:this.width_,height:this.height_}));this.workspace.setResizesEnabled(true)};Blockly.WorkspaceCommentSvg.prototype.resizeMouseMove_=function(e){this.autoLayout_=false;var o=this.workspace.moveDrag(e);var t=false;if(Blockly.Events.isEnabled()){Blockly.Events.disable();t=true}this.setSize(this.RTL?-o.x:o.x,o.y);if(t)Blockly.Events.enable()};Blockly.WorkspaceCommentSvg.prototype.resizeComment_=function(){var e=2*Blockly.WorkspaceCommentSvg.BORDER_WIDTH;var o=Blockly.WorkspaceCommentSvg.TOP_BAR_HEIGHT;var t=2*Blockly.WorkspaceCommentSvg.TEXTAREA_OFFSET;this.foreignObject_.setAttribute("width",this.width_-e);this.foreignObject_.setAttribute("height",this.height_-e-o);if(this.RTL)this.foreignObject_.setAttribute("x",-this.width_);this.textarea_.style.width=this.width_-t+"px";this.textarea_.style.height=this.height_-e-t-o+"px"};Blockly.WorkspaceCommentSvg.prototype.setSize=function(e,o){var t=this.width_;var i=this.height_;var r=2*Blockly.WorkspaceCommentSvg.BORDER_WIDTH;if(this.isMinimized_){e=Blockly.WorkspaceCommentSvg.MINIMIZE_WIDTH;o=Blockly.WorkspaceCommentSvg.TOP_BAR_HEIGHT}else{e=Math.max(e,r+50);o=Math.max(o,r+20+Blockly.WorkspaceCommentSvg.TOP_BAR_HEIGHT);this.width_=e;this.height_=o;Blockly.Events.fire(new Blockly.Events.CommentChange(this,{width:t,height:i},{width:this.width_,height:this.height_}))}this.svgRect_.setAttribute("width",e);this.svgRect_.setAttribute("height",o);this.svgRectTarget_.setAttribute("width",e);this.svgRectTarget_.setAttribute("height",o-Blockly.WorkspaceCommentSvg.TOP_BAR_HEIGHT);this.svgHandleTarget_.setAttribute("width",e);this.svgHandleTarget_.setAttribute("height",Blockly.WorkspaceCommentSvg.TOP_BAR_HEIGHT);if(this.RTL){this.minimizeArrow_.setAttribute("x",e-Blockly.WorkspaceCommentSvg.MINIMIZE_ICON_SIZE-Blockly.WorkspaceCommentSvg.TOP_BAR_ICON_INSET);this.deleteIcon_.setAttribute("x",-e+Blockly.WorkspaceCommentSvg.TOP_BAR_ICON_INSET);this.svgRect_.setAttribute("transform","scale(-1 1)");this.svgHandleTarget_.setAttribute("transform","scale(-1 1)");this.svgHandleTarget_.setAttribute("transform","translate("+-e+", 1)");this.minimizeArrow_.setAttribute("transform","translate("+-e+", 1)");this.deleteIcon_.setAttribute("tranform","translate("+-e+", 1)");this.svgRectTarget_.setAttribute("transform","translate("+-e+", 1)");this.topBarLabel_.setAttribute("transform","translate("+-e+", 1)")}else this.deleteIcon_.setAttribute("x",e-Blockly.WorkspaceCommentSvg.DELETE_ICON_SIZE-Blockly.WorkspaceCommentSvg.TOP_BAR_ICON_INSET);var n=Blockly.WorkspaceCommentSvg.RESIZE_SIZE;if(this.resizeGroup_)if(this.RTL)this.resizeGroup_.setAttribute("transform","translate("+(-e+r+n)+","+(o-r-n)+") scale(-1 1)");else this.resizeGroup_.setAttribute("transform","translate("+(e-r-n)+","+(o-r-n)+")");if(this.isMinimized_){this.topBarLabel_.setAttribute("x",e/2);this.topBarLabel_.setAttribute("y",o/2)}this.resizeComment_()};Blockly.WorkspaceComment.prototype.toggleMinimize_=function(){this.setMinimized(!this.isMinimized_)};Blockly.WorkspaceComment.prototype.setMinimized=function(e){if(this.isMinimized_==e)return;Blockly.Events.fire(new Blockly.Events.CommentChange(this,{minimized:this.isMinimized_},{minimized:e}));this.isMinimized_=e;if(e){if(this.rendered_)this.setRenderedMinimizeState_(true,this.getLabelText());this.setSize(Blockly.WorkspaceCommentSvg.MINIMIZE_WIDTH,Blockly.WorkspaceCommentSvg.TOP_BAR_HEIGHT)}else{if(this.rendered_)this.setRenderedMinimizeState_(false);this.setText(this.content_);this.setSize(this.width_,this.height_)}};Blockly.WorkspaceCommentSvg.prototype.disposeInternal_=function(){this.textarea_=null;this.foreignObject_=null;this.svgRect_=null;this.svgRectTarget_=null;this.svgHandleTarget_=null};Blockly.WorkspaceCommentSvg.prototype.setFocus=function(){var e=this;this.focused_=true;e.textarea_.focus();setTimeout((function(){e.addFocus();Blockly.utils.addClass(e.svgRectTarget_,"scratchCommentTargetFocused");Blockly.utils.addClass(e.svgHandleTarget_,"scratchCommentHandleTargetFocused")}),0)};Blockly.WorkspaceCommentSvg.prototype.blurFocus=function(){var e=this;this.focused_=false;e.textarea_.blur();setTimeout((function(){if(e.svgGroup_){e.removeFocus();Blockly.utils.removeClass(e.svgRectTarget_,"scratchCommentTargetFocused");Blockly.utils.removeClass(e.svgHandleTarget_,"scratchCommentHandleTargetFocused")}}),0)};goog.provide("Blockly.WorkspaceDragSurfaceSvg");goog.require("Blockly.utils");goog.require("goog.asserts");goog.require("goog.math.Coordinate");Blockly.WorkspaceDragSurfaceSvg=function(e){this.container_=e;this.createDom()};Blockly.WorkspaceDragSurfaceSvg.prototype.SVG_=null;Blockly.WorkspaceDragSurfaceSvg.prototype.dragGroup_=null;Blockly.WorkspaceDragSurfaceSvg.prototype.container_=null;Blockly.WorkspaceDragSurfaceSvg.prototype.createDom=function(){if(this.SVG_)return;this.SVG_=Blockly.utils.createSvgElement("svg",{xmlns:Blockly.SVG_NS,"xmlns:html":Blockly.HTML_NS,"xmlns:xlink":"http://www.w3.org/1999/xlink",version:"1.1",class:"blocklyWsDragSurface blocklyOverflowVisible"},null);this.container_.appendChild(this.SVG_)};Blockly.WorkspaceDragSurfaceSvg.prototype.translateSurface=function(e,o){var t=e.toFixed(0);var i=o.toFixed(0);this.SVG_.style.display="block";Blockly.utils.setCssTransform(this.SVG_,"translate3d("+t+"px, "+i+"px, 0px)")};Blockly.WorkspaceDragSurfaceSvg.prototype.getSurfaceTranslation=function(){return Blockly.utils.getRelativeXY(this.SVG_)};Blockly.WorkspaceDragSurfaceSvg.prototype.clearAndHide=function(e){if(!e)throw"Couldn't clear and hide the drag surface: missing new surface.";var o=this.SVG_.childNodes[0];var t=this.SVG_.childNodes[1];if(!o||!t||!Blockly.utils.hasClass(o,"blocklyBlockCanvas")||!Blockly.utils.hasClass(t,"blocklyBubbleCanvas"))throw"Couldn't clear and hide the drag surface.  A node was missing.";if(null!=this.previousSibling_)Blockly.utils.insertAfter(o,this.previousSibling_);else e.insertBefore(o,e.firstChild);Blockly.utils.insertAfter(t,o);this.SVG_.style.display="none";goog.asserts.assert(0==this.SVG_.childNodes.length,"Drag surface was not cleared.");Blockly.utils.setCssTransform(this.SVG_,"");this.previousSibling_=null};Blockly.WorkspaceDragSurfaceSvg.prototype.setContentsAndShow=function(e,o,t,i,r,n){goog.asserts.assert(0==this.SVG_.childNodes.length,"Already dragging a block.");this.previousSibling_=t;e.setAttribute("transform","translate(0, 0) scale("+n+")");o.setAttribute("transform","translate(0, 0) scale("+n+")");this.SVG_.setAttribute("width",i);this.SVG_.setAttribute("height",r);this.SVG_.appendChild(e);this.SVG_.appendChild(o);this.SVG_.style.display="block"};goog.provide("Blockly.WorkspaceSvg");goog.require("Blockly.Colours");goog.require("Blockly.ConnectionDB");goog.require("Blockly.constants");goog.require("Blockly.DataCategory");goog.require("Blockly.DropDownDiv");goog.require("Blockly.Events.BlockCreate");goog.require("Blockly.Gesture");goog.require("Blockly.Grid");goog.require("Blockly.Options");goog.require("Blockly.scratchBlocksUtils");goog.require("Blockly.ScrollbarPair");goog.require("Blockly.Touch");goog.require("Blockly.Trashcan");goog.require("Blockly.Workspace");goog.require("Blockly.WorkspaceAudio");goog.require("Blockly.WorkspaceComment");goog.require("Blockly.WorkspaceCommentSvg");goog.require("Blockly.WorkspaceCommentSvg.render");goog.require("Blockly.WorkspaceDragSurfaceSvg");goog.require("Blockly.Xml");goog.require("Blockly.ZoomControls");goog.require("goog.array");goog.require("goog.dom");goog.require("goog.math.Coordinate");goog.require("goog.userAgent");goog.require("goog.math.Rect");Blockly.WorkspaceSvg=function(e,o,t){Blockly.WorkspaceSvg.superClass_.constructor.call(this,e);this.getMetrics=e.getMetrics||Blockly.WorkspaceSvg.getTopLevelWorkspaceMetrics_;this.setMetrics=e.setMetrics||Blockly.WorkspaceSvg.setTopLevelWorkspaceMetrics_;Blockly.ConnectionDB.init(this);if(o)this.blockDragSurface_=o;if(t)this.workspaceDragSurface_=t;this.useWorkspaceDragSurface_=this.workspaceDragSurface_&&Blockly.utils.is3dSupported();this.highlightedBlocks_=[];this.glowingBlocks_=[];this.audioManager_=new Blockly.WorkspaceAudio(e.parentWorkspace);this.grid_=this.options.gridPattern?new Blockly.Grid(e.gridPattern,e.gridOptions):null;this.registerToolboxCategoryCallback(Blockly.VARIABLE_CATEGORY_NAME,Blockly.DataCategory);this.registerToolboxCategoryCallback(Blockly.PROCEDURE_CATEGORY_NAME,Blockly.Procedures.flyoutCategory)};goog.inherits(Blockly.WorkspaceSvg,Blockly.Workspace);Blockly.WorkspaceSvg.prototype.resizeHandlerWrapper_=null;Blockly.WorkspaceSvg.prototype.rendered=true;Blockly.WorkspaceSvg.prototype.isVisible_=true;Blockly.WorkspaceSvg.prototype.isFlyout=false;Blockly.WorkspaceSvg.prototype.isMutator=false;Blockly.WorkspaceSvg.prototype.resizesEnabled_=true;Blockly.WorkspaceSvg.prototype.toolboxRefreshEnabled_=true;Blockly.WorkspaceSvg.prototype.scrollX=0;Blockly.WorkspaceSvg.prototype.scrollY=0;Blockly.WorkspaceSvg.prototype.startScrollX=0;Blockly.WorkspaceSvg.prototype.startScrollY=0;Blockly.WorkspaceSvg.prototype.dragDeltaXY_=null;Blockly.WorkspaceSvg.prototype.scale=1;Blockly.WorkspaceSvg.prototype.trashcan=null;Blockly.WorkspaceSvg.prototype.scrollbar=null;Blockly.WorkspaceSvg.prototype.currentGesture_=null;Blockly.WorkspaceSvg.prototype.blockDragSurface_=null;Blockly.WorkspaceSvg.prototype.workspaceDragSurface_=null;Blockly.WorkspaceSvg.prototype.useWorkspaceDragSurface_=false;Blockly.WorkspaceSvg.prototype.isDragSurfaceActive_=false;Blockly.WorkspaceSvg.prototype.injectionDiv_=null;Blockly.WorkspaceSvg.prototype.lastRecordedPageScroll_=null;Blockly.WorkspaceSvg.prototype.flyoutButtonCallbacks_={};Blockly.WorkspaceSvg.prototype.toolboxCategoryCallbacks_={};Blockly.WorkspaceSvg.prototype.inverseScreenCTM_=null;Blockly.WorkspaceSvg.prototype.inverseScreenCTMDirty_=true;Blockly.WorkspaceSvg.prototype.getInverseScreenCTM=function(){if(this.inverseScreenCTMDirty_){var e=this.getParentSvg().getScreenCTM();if(e){this.inverseScreenCTM_=e.inverse();this.inverseScreenCTMDirty_=false}}return this.inverseScreenCTM_};Blockly.WorkspaceSvg.prototype.isVisible=function(){return this.isVisible_};Blockly.WorkspaceSvg.prototype.updateInverseScreenCTM=function(){this.inverseScreenCTMDirty_=true};Blockly.WorkspaceSvg.prototype.getSvgXY=function(e){var o=0;var t=0;var i=1;if(goog.dom.contains(this.getCanvas(),e)||goog.dom.contains(this.getBubbleCanvas(),e))i=this.scale;do{var r=Blockly.utils.getRelativeXY(e);if(e==this.getCanvas()||e==this.getBubbleCanvas())i=1;o+=r.x*i;t+=r.y*i;e=e.parentNode}while(e&&e!=this.getParentSvg());return new goog.math.Coordinate(o,t)};Blockly.WorkspaceSvg.prototype.getOriginOffsetInPixels=function(){return Blockly.utils.getInjectionDivXY_(this.svgBlockCanvas_)};Blockly.WorkspaceSvg.prototype.getInjectionDiv=function(){if(!this.injectionDiv_){var e=this.svgGroup_;while(e){var o=e.getAttribute("class")||"";if(-1!=(" "+o+" ").indexOf(" injectionDiv ")){this.injectionDiv_=e;break}e=e.parentNode}}return this.injectionDiv_};Blockly.WorkspaceSvg.prototype.setResizeHandlerWrapper=function(e){this.resizeHandlerWrapper_=e};Blockly.WorkspaceSvg.prototype.createDom=function(e){this.svgGroup_=Blockly.utils.createSvgElement("g",{class:"blocklyWorkspace"},null);if(e){this.svgBackground_=Blockly.utils.createSvgElement("rect",{height:"100%",width:"100%",class:e},this.svgGroup_);if("blocklyMainBackground"==e&&this.grid_)this.svgBackground_.style.fill="url(#"+this.grid_.getPatternId()+")"}this.svgBlockCanvas_=Blockly.utils.createSvgElement("g",{class:"blocklyBlockCanvas"},this.svgGroup_,this);this.svgBubbleCanvas_=Blockly.utils.createSvgElement("g",{class:"blocklyBubbleCanvas"},this.svgGroup_,this);var o=Blockly.Scrollbar.scrollbarThickness;if(this.options.hasTrashcan)o=this.addTrashcan_(o);if(this.options.zoomOptions&&this.options.zoomOptions.controls)this.addZoomControls_(o);if(!this.isFlyout){Blockly.bindEventWithChecks_(this.svgGroup_,"mousedown",this,this.onMouseDown_);if(this.options.zoomOptions&&this.options.zoomOptions.wheel)Blockly.bindEventWithChecks_(this.svgGroup_,"wheel",this,this.onMouseWheel_)}if(this.options.hasCategories)this.toolbox_=new Blockly.Toolbox(this);if(this.grid_)this.grid_.update(this.scale);this.recordCachedAreas();return this.svgGroup_};Blockly.WorkspaceSvg.prototype.dispose=function(){this.rendered=false;if(this.currentGesture_)this.currentGesture_.cancel();Blockly.WorkspaceSvg.superClass_.dispose.call(this);if(this.svgGroup_){goog.dom.removeNode(this.svgGroup_);this.svgGroup_=null}this.svgBlockCanvas_=null;this.svgBubbleCanvas_=null;if(this.toolbox_){this.toolbox_.dispose();this.toolbox_=null}if(this.flyout_){this.flyout_.dispose();this.flyout_=null}if(this.trashcan){this.trashcan.dispose();this.trashcan=null}if(this.scrollbar){this.scrollbar.dispose();this.scrollbar=null}if(this.zoomControls_){this.zoomControls_.dispose();this.zoomControls_=null}if(this.audioManager_){this.audioManager_.dispose();this.audioManager_=null}if(this.grid_){this.grid_.dispose();this.grid_=null}if(this.toolboxCategoryCallbacks_)this.toolboxCategoryCallbacks_=null;if(this.flyoutButtonCallbacks_)this.flyoutButtonCallbacks_=null;if(!this.options.parentWorkspace)goog.dom.removeNode(this.getParentSvg().parentNode);if(this.resizeHandlerWrapper_){Blockly.unbindEvent_(this.resizeHandlerWrapper_);this.resizeHandlerWrapper_=null}};Blockly.WorkspaceSvg.prototype.newBlock=function(e,o){return new Blockly.BlockSvg(this,e,o)};Blockly.WorkspaceSvg.prototype.addTrashcan_=function(e){this.trashcan=new Blockly.Trashcan(this);var o=this.trashcan.createDom();this.svgGroup_.insertBefore(o,this.svgBlockCanvas_);return this.trashcan.init(e)};Blockly.WorkspaceSvg.prototype.addZoomControls_=function(e){this.zoomControls_=new Blockly.ZoomControls(this);var o=this.zoomControls_.createDom();this.svgGroup_.appendChild(o);return this.zoomControls_.init(e)};Blockly.WorkspaceSvg.prototype.addFlyout_=function(e){var o={disabledPatternId:this.options.disabledPatternId,parentWorkspace:this,RTL:this.RTL,oneBasedIndex:this.options.oneBasedIndex,horizontalLayout:this.horizontalLayout,toolboxPosition:this.options.toolboxPosition,stackGlowFilterId:this.options.stackGlowFilterId};if(this.horizontalLayout)this.flyout_=new Blockly.HorizontalFlyout(o);else this.flyout_=new Blockly.VerticalFlyout(o);this.flyout_.autoClose=false;return this.flyout_.createDom(e)};Blockly.WorkspaceSvg.prototype.getFlyout=function(){if(this.flyout_)return this.flyout_;if(this.toolbox_)return this.toolbox_.flyout_;return null};Blockly.WorkspaceSvg.prototype.getToolbox=function(){return this.toolbox_};Blockly.WorkspaceSvg.prototype.updateScreenCalculations_=function(){this.updateInverseScreenCTM();this.recordCachedAreas()};Blockly.WorkspaceSvg.prototype.resizeContents=function(){if(!this.resizesEnabled_||!this.rendered)return;if(this.scrollbar)this.scrollbar.resize();this.updateInverseScreenCTM()};Blockly.WorkspaceSvg.prototype.resize=function(){if(this.toolbox_)this.toolbox_.position();if(this.flyout_)this.flyout_.position();if(this.trashcan)this.trashcan.position();if(this.zoomControls_)this.zoomControls_.position();if(this.scrollbar)this.scrollbar.resize();this.updateScreenCalculations_()};Blockly.WorkspaceSvg.prototype.updateScreenCalculationsIfScrolled=function(){var e=goog.dom.getDocumentScroll();if(!goog.math.Coordinate.equals(this.lastRecordedPageScroll_,e)){this.lastRecordedPageScroll_=e;this.updateScreenCalculations_()}};Blockly.WorkspaceSvg.prototype.getCanvas=function(){return this.svgBlockCanvas_};Blockly.WorkspaceSvg.prototype.getBubbleCanvas=function(){return this.svgBubbleCanvas_};Blockly.WorkspaceSvg.prototype.getParentSvg=function(){if(this.cachedParentSvg_)return this.cachedParentSvg_;var e=this.svgGroup_;while(e){if("svg"==e.tagName){this.cachedParentSvg_=e;return e}e=e.parentNode}return null};Blockly.WorkspaceSvg.prototype.translate=function(e,o){if(this.useWorkspaceDragSurface_&&this.isDragSurfaceActive_)this.workspaceDragSurface_.translateSurface(e,o);else{var t="translate("+e+","+o+") "+"scale("+this.scale+")";this.svgBlockCanvas_.setAttribute("transform",t);this.svgBubbleCanvas_.setAttribute("transform",t)}if(this.blockDragSurface_)this.blockDragSurface_.translateAndScaleGroup(e,o,this.scale)};Blockly.WorkspaceSvg.prototype.resetDragSurface=function(){if(!this.useWorkspaceDragSurface_)return;this.isDragSurfaceActive_=false;var e=this.workspaceDragSurface_.getSurfaceTranslation();this.workspaceDragSurface_.clearAndHide(this.svgGroup_);var o="translate("+e.x+","+e.y+") "+"scale("+this.scale+")";this.svgBlockCanvas_.setAttribute("transform",o);this.svgBubbleCanvas_.setAttribute("transform",o)};Blockly.WorkspaceSvg.prototype.setupDragSurface=function(){if(!this.useWorkspaceDragSurface_)return;if(this.isDragSurfaceActive_)return;this.isDragSurfaceActive_=true;var e=this.svgBlockCanvas_.previousSibling;var o=parseInt(this.getParentSvg().getAttribute("width"),10);var t=parseInt(this.getParentSvg().getAttribute("height"),10);var i=Blockly.utils.getRelativeXY(this.svgBlockCanvas_);this.workspaceDragSurface_.setContentsAndShow(this.svgBlockCanvas_,this.svgBubbleCanvas_,e,o,t,this.scale);this.workspaceDragSurface_.translateSurface(i.x,i.y)};Blockly.WorkspaceSvg.prototype.getBlockDragSurface=function(){return this.blockDragSurface_};Blockly.WorkspaceSvg.prototype.getWidth=function(){var e=this.getMetrics();return e?e.viewWidth/this.scale:0};Blockly.WorkspaceSvg.prototype.setVisible=function(e){if(this.scrollbar)this.scrollbar.setContainerVisible(e);if(this.getFlyout())this.getFlyout().setContainerVisible(e);this.getParentSvg().style.display=e?"block":"none";if(this.toolbox_)this.toolbox_.HtmlDiv.style.display=e?"block":"none";if(e){this.render();this.resize()}else{Blockly.hideChaff(true);Blockly.DropDownDiv.hideWithoutAnimation()}this.isVisible_=e};Blockly.WorkspaceSvg.prototype.render=function(){var e=this.getAllBlocks();for(var o=e.length-1;o>=0;o--)e[o].render(false)};Blockly.WorkspaceSvg.prototype.traceOn=function(){console.warn("Deprecated call to traceOn, delete this.")};Blockly.WorkspaceSvg.prototype.highlightBlock=function(e,o){if(void 0===o){for(var t=0,i;i=this.highlightedBlocks_[t];t++)i.highlightForReplacement(false);this.highlightedBlocks_.length=0}var i=e?this.getBlockById(e):null;if(i){var r=void 0===o||o;if(!r)goog.array.remove(this.highlightedBlocks_,i);else if(-1==this.highlightedBlocks_.indexOf(i))this.highlightedBlocks_.push(i);i.highlightForReplacement(r)}};Blockly.WorkspaceSvg.prototype.glowBlock=function(e,o){if(void 0===o){for(var t=0,i;i=this.glowingBlocks_[t];t++)i.setGlowBlock(false);this.glowingBlocks_.length=0;return}if(e){var i=this.getBlockById(e);if(!i)throw"Tried to glow block that does not exist.";i.setGlowBlock(o);if(!o)goog.array.remove(this.glowingBlocks_,i);else if(-1==this.glowingBlocks_.indexOf(i))this.glowingBlocks_.push(i)}};Blockly.WorkspaceSvg.prototype.glowStack=function(e,o){var t=null;if(e){t=this.getBlockById(e);if(!t)throw"Tried to glow stack on block that does not exist."}t.setGlowStack(o)};Blockly.WorkspaceSvg.prototype.reportValue=function(e,o){var t=this.getBlockById(e);if(!t)throw"Tried to report value on block that does not exist.";Blockly.DropDownDiv.hideWithoutAnimation();Blockly.DropDownDiv.clearContent();var i=Blockly.DropDownDiv.getContentDiv();var r=goog.dom.createElement("div");r.setAttribute("class","valueReportBox");r.innerHTML=Blockly.scratchBlocksUtils.encodeEntities(o);i.appendChild(r);Blockly.DropDownDiv.setColour(Blockly.Colours.valueReportBackground,Blockly.Colours.valueReportBorder);Blockly.DropDownDiv.showPositionedByBlock(this,t)};Blockly.WorkspaceSvg.prototype.paste=function(e){if(!this.rendered)return;if(this.currentGesture_)this.currentGesture_.cancel();if("comment"==e.tagName.toLowerCase())this.pasteWorkspaceComment_(e);else this.pasteBlock_(e)};Blockly.WorkspaceSvg.prototype.pasteBlock_=function(e){Blockly.Events.disable();try{var o=Blockly.Xml.domToBlock(e,this);Blockly.scratchBlocksUtils.changeObscuredShadowIds(o);var t=parseInt(e.getAttribute("x"),10);var i=parseInt(e.getAttribute("y"),10);if(!isNaN(t)&&!isNaN(i)){if(this.RTL)t=-t;do{var r=false;var n=this.getAllBlocks();for(var l=0,s;s=n[l];l++){var g=s.getRelativeToSurfaceXY();if(Math.abs(t-g.x)<=1&&Math.abs(i-g.y)<=1){r=true;break}}if(!r){var a=o.getConnections_(false);for(var l=0,c;c=a[l];l++){var u=c.closest(Blockly.SNAP_RADIUS,new goog.math.Coordinate(t,i));if(u.connection){r=true;break}}}if(r){if(this.RTL)t-=Blockly.SNAP_RADIUS;else t+=Blockly.SNAP_RADIUS;i+=2*Blockly.SNAP_RADIUS}}while(r);o.moveBy(t,i)}}finally{Blockly.Events.enable()}if(Blockly.Events.isEnabled()&&!o.isShadow())Blockly.Events.fire(new Blockly.Events.BlockCreate(o));o.select()};Blockly.WorkspaceSvg.prototype.pasteWorkspaceComment_=function(e){Blockly.Events.disable();try{var o=Blockly.WorkspaceCommentSvg.fromXml(e,this);var t=parseInt(e.getAttribute("x"),10);var i=parseInt(e.getAttribute("y"),10);if(!isNaN(t)&&!isNaN(i)){if(this.RTL)t=-t;t+=50;i+=50;o.moveBy(t,i)}}finally{Blockly.Events.enable()}if(Blockly.Events.isEnabled())Blockly.WorkspaceComment.fireCreateEvent(o);o.select()};Blockly.WorkspaceSvg.prototype.refreshToolboxSelection_=function(){if(this.toolbox_){if(this.toolbox_.flyout_&&!this.currentGesture_&&this.toolboxRefreshEnabled_)this.toolbox_.refreshSelection()}else{var e=this.targetWorkspace;if(e&&e.toolbox_&&e.toolbox_.flyout_&&!e.currentGesture_&&e.toolboxRefreshEnabled_)e.toolbox_.refreshSelection()}};Blockly.WorkspaceSvg.prototype.renameVariableById=function(e,o){Blockly.WorkspaceSvg.superClass_.renameVariableById.call(this,e,o);this.refreshToolboxSelection_()};Blockly.WorkspaceSvg.prototype.deleteVariableById=function(e){Blockly.WorkspaceSvg.superClass_.deleteVariableById.call(this,e);this.refreshToolboxSelection_()};Blockly.WorkspaceSvg.prototype.createVariable=function(e,o,t,i,r){var n=null!=this.getVariable(e,o);var l=Blockly.WorkspaceSvg.superClass_.createVariable.call(this,e,o,t,i,r);if(!n&&o!=Blockly.BROADCAST_MESSAGE_VARIABLE_TYPE)this.refreshToolboxSelection_();return l};Blockly.WorkspaceSvg.prototype.recordCachedAreas=function(){this.recordBlocksArea_();this.recordDeleteAreas_()};Blockly.WorkspaceSvg.prototype.recordDeleteAreas_=function(){if(this.trashcan)this.deleteAreaTrash_=this.trashcan.getClientRect();else this.deleteAreaTrash_=null;if(this.flyout_)this.deleteAreaToolbox_=this.flyout_.getClientRect();else if(this.toolbox_)this.deleteAreaToolbox_=this.toolbox_.getClientRect();else this.deleteAreaToolbox_=null};Blockly.WorkspaceSvg.prototype.recordBlocksArea_=function(){var e=this.getParentSvg();if(e){var o=e.getBoundingClientRect();this.blocksArea_=new goog.math.Rect(o.left,o.top,o.width,o.height)}else this.blocksArea_=null};Blockly.WorkspaceSvg.prototype.isDeleteArea=function(e){var o=new goog.math.Coordinate(e.clientX,e.clientY);if(this.deleteAreaTrash_&&this.deleteAreaTrash_.contains(o))return Blockly.DELETE_AREA_TRASH;if(this.deleteAreaToolbox_&&this.deleteAreaToolbox_.contains(o))return Blockly.DELETE_AREA_TOOLBOX;return Blockly.DELETE_AREA_NONE};Blockly.WorkspaceSvg.prototype.isInsideBlocksArea=function(e){var o=new goog.math.Coordinate(e.clientX,e.clientY);if(this.isDeleteArea(e)||this.blocksArea_&&this.blocksArea_.contains(o))return true;return false};Blockly.WorkspaceSvg.prototype.onMouseDown_=function(e){var o=this.getGesture(e);if(o)o.handleWsStart(e,this)};Blockly.WorkspaceSvg.prototype.startDrag=function(e,o){var t=Blockly.utils.mouseToSvg(e,this.getParentSvg(),this.getInverseScreenCTM());t.x/=this.scale;t.y/=this.scale;this.dragDeltaXY_=goog.math.Coordinate.difference(o,t)};Blockly.WorkspaceSvg.prototype.moveDrag=function(e){var o=Blockly.utils.mouseToSvg(e,this.getParentSvg(),this.getInverseScreenCTM());o.x/=this.scale;o.y/=this.scale;return goog.math.Coordinate.sum(this.dragDeltaXY_,o)};Blockly.WorkspaceSvg.prototype.isDragging=function(){return this.currentGesture_&&this.currentGesture_.isDragging()};Blockly.WorkspaceSvg.prototype.isDraggable=function(){return!!this.scrollbar};Blockly.WorkspaceSvg.prototype.onMouseWheel_=function(e){if(this.currentGesture_)this.currentGesture_.cancel();var o=1===e.deltaMode?Blockly.LINE_SCROLL_MULTIPLIER:1;if(e.ctrlKey){var t=50;var i=-e.deltaY/t*o;var r=Blockly.utils.mouseToSvg(e,this.getParentSvg(),this.getInverseScreenCTM());this.zoom(r.x,r.y,i)}else{Blockly.WidgetDiv.hide(true);Blockly.DropDownDiv.hideWithoutAnimation();var n=this.scrollX-e.deltaX*o;var l=this.scrollY-e.deltaY*o;if(e.shiftKey&&0===e.deltaX){n=this.scrollX-e.deltaY*o;l=this.scrollY}this.startDragMetrics=this.getMetrics();this.scroll(n,l)}e.preventDefault()};Blockly.WorkspaceSvg.prototype.getBlocksBoundingBox=function(){var e=this.getTopBlocks(false);var o=this.getTopComments(false);var t=e.concat(o);if(!t.length)return{x:0,y:0,width:0,height:0};var i=t[0].getBoundingRectangle();for(var r=1;r<t.length;r++){var n=t[r].getBoundingRectangle();if(n.topLeft.x<i.topLeft.x)i.topLeft.x=n.topLeft.x;if(n.bottomRight.x>i.bottomRight.x)i.bottomRight.x=n.bottomRight.x;if(n.topLeft.y<i.topLeft.y)i.topLeft.y=n.topLeft.y;if(n.bottomRight.y>i.bottomRight.y)i.bottomRight.y=n.bottomRight.y}return{x:i.topLeft.x,y:i.topLeft.y,width:i.bottomRight.x-i.topLeft.x,height:i.bottomRight.y-i.topLeft.y}};Blockly.WorkspaceSvg.prototype.cleanUp=function(){this.setResizesEnabled(false);Blockly.Events.setGroup(true);var e=this.getTopBlocks(true);var o=0;for(var t=0,i;i=e[t];t++){var r=i.getRelativeToSurfaceXY();i.moveBy(-r.x,o-r.y);i.snapToGrid();o=i.getRelativeToSurfaceXY().y+i.getHeightWidth().height+Blockly.BlockSvg.MIN_BLOCK_Y}Blockly.Events.setGroup(false);this.setResizesEnabled(true)};Blockly.WorkspaceSvg.prototype.showContextMenu_=function(e){if(this.options.readOnly||this.isFlyout)return;var o=[];var t=this.getTopBlocks(true);var i=Blockly.utils.genUid();var r=this;o.push(Blockly.ContextMenu.wsUndoOption(this));o.push(Blockly.ContextMenu.wsRedoOption(this));if(this.scrollbar)o.push(Blockly.ContextMenu.wsCleanupOption(this,t.length));if(this.options.collapse){var n=false;var l=false;for(var s=0;s<t.length;s++){var g=t[s];while(g){if(g.isCollapsed())n=true;else l=true;g=g.getNextBlock()}}o.push(Blockly.ContextMenu.wsCollapseOption(l,t));o.push(Blockly.ContextMenu.wsExpandOption(n,t))}if(this.options.comments)o.push(Blockly.ContextMenu.workspaceCommentOption(r,e));var a=Blockly.WorkspaceSvg.buildDeleteList_(t);var c=0;for(var s=0;s<a.length;s++)if(!a[s].isShadow())c++;var u=10;function h(){Blockly.Events.setGroup(i);var e=a.shift();if(e)if(e.workspace){e.dispose(false,true);setTimeout(h,u)}else h();Blockly.Events.setGroup(false)}var d={text:1==c?Blockly.Msg.DELETE_BLOCK:Blockly.Msg.DELETE_X_BLOCKS.replace("%1",String(c)),enabled:c>0,callback:function(){if(r.currentGesture_)r.currentGesture_.cancel();if(c<2)h();else Blockly.confirm(Blockly.Msg.DELETE_ALL_BLOCKS.replace("%1",String(c)),(function(e){if(e)h()}))}};o.push(d);Blockly.ContextMenu.show(e,o,this.RTL)};Blockly.WorkspaceSvg.buildDeleteList_=function(e){var o=[];function t(e){if(e.isDeletable())o=o.concat(e.getDescendants(false));else{var i=e.getChildren();for(var r=0;r<i.length;r++)t(i[r])}}for(var i=0;i<e.length;i++)t(e[i]);return o};Blockly.WorkspaceSvg.prototype.updateToolbox=function(e){e=Blockly.Options.parseToolboxTree(e);if(!e){if(this.options.languageTree)throw"Can't nullify an existing toolbox.";return}if(!this.options.languageTree)throw"Existing toolbox is null.  Can't create new toolbox.";if(e.getElementsByTagName("category").length){if(!this.toolbox_)throw"Existing toolbox has no categories.  Can't change mode.";this.options.languageTree=e;this.toolbox_.populate_(e);this.toolbox_.position()}else{if(!this.flyout_)throw"Existing toolbox has categories.  Can't change mode.";this.options.languageTree=e;this.flyout_.show(e.childNodes)}};Blockly.WorkspaceSvg.prototype.markFocused=function(){if(this.options.parentWorkspace)this.options.parentWorkspace.markFocused();else{Blockly.mainWorkspace=this;this.setBrowserFocus()}};Blockly.WorkspaceSvg.prototype.setBrowserFocus=function(){if(document.activeElement)document.activeElement.blur();try{this.getParentSvg().focus()}catch(e){try{this.getParentSvg().parentNode.setActive()}catch(e){this.getParentSvg().parentNode.focus()}}};Blockly.WorkspaceSvg.prototype.zoom=function(e,o,t){var i=this.options.zoomOptions.scaleSpeed;var r=this.getMetrics();var n=this.getParentSvg().createSVGPoint();n.x=e;n.y=o;n=n.matrixTransform(this.getCanvas().getCTM().inverse());e=n.x;o=n.y;var l=this.getCanvas();var s=Math.pow(i,t);var g=this.scale*s;if(g>this.options.zoomOptions.maxScale)s=this.options.zoomOptions.maxScale/this.scale;else if(g<this.options.zoomOptions.minScale)s=this.options.zoomOptions.minScale/this.scale;if(this.scale==g)return;if(this.scrollbar){var a=l.getCTM().translate(e*(1-s),o*(1-s)).scale(s);this.scrollX=a.e-r.absoluteLeft;this.scrollY=a.f-r.absoluteTop}this.setScale(g);Blockly.WidgetDiv.hide(true);Blockly.DropDownDiv.hideWithoutAnimation()};Blockly.WorkspaceSvg.prototype.zoomCenter=function(e){var o=this.getMetrics();var t=o.viewWidth/2;var i=o.viewHeight/2;this.zoom(t,i,e)};Blockly.WorkspaceSvg.prototype.zoomToFit=function(){var e=this.getMetrics();var o=this.getBlocksBoundingBox();var t=o.width;var i=o.height;if(!t)return;var r=e.viewWidth;var n=e.viewHeight;if(this.flyout_)r-=this.flyout_.width_;if(!this.scrollbar){t+=e.contentLeft;i+=e.contentTop}var l=r/t;var s=n/i;this.setScale(Math.min(l,s));this.scrollCenter()};Blockly.WorkspaceSvg.prototype.scrollCenter=function(){if(!this.scrollbar){console.warn("Tried to scroll a non-scrollable workspace.");return}Blockly.WidgetDiv.hide(true);Blockly.DropDownDiv.hideWithoutAnimation();Blockly.hideChaff(false);var e=this.getMetrics();var o=(e.contentWidth-e.viewWidth)/2;if(this.flyout_)o-=this.flyout_.width_/2;var t=(e.contentHeight-e.viewHeight)/2;this.scrollbar.set(o,t)};Blockly.WorkspaceSvg.prototype.centerOnBlock=function(e){if(!this.scrollbar){console.warn("Tried to scroll a non-scrollable workspace.");return}var o=this.getBlockById(e);if(!o)return;var t=o.getRelativeToSurfaceXY();var i=o.getHeightWidth();var r=t.y+i.height/2;var n=this.RTL?-1:1;var l=t.x+n*i.width/2;var s=this.scale;var g=l*s;var a=r*s;var c=this.getMetrics();var u=g-c.contentLeft;var h=a-c.contentTop;var d=c.viewWidth/2;var p=c.viewHeight/2;var y=u-d;var f=h-p;Blockly.hideChaff();this.scrollbar.set(y,f)};Blockly.WorkspaceSvg.prototype.setScale=function(e){if(this.options.zoomOptions.maxScale&&e>this.options.zoomOptions.maxScale)e=this.options.zoomOptions.maxScale;else if(this.options.zoomOptions.minScale&&e<this.options.zoomOptions.minScale)e=this.options.zoomOptions.minScale;this.scale=e;if(this.grid_)this.grid_.update(this.scale);if(this.scrollbar)this.scrollbar.resize();else this.translate(this.scrollX,this.scrollY);Blockly.hideChaff(false);if(this.flyout_)this.flyout_.reflow()};Blockly.WorkspaceSvg.prototype.scroll=function(e,o){var t=this.startDragMetrics;e=Math.min(e,-t.contentLeft);o=Math.min(o,-t.contentTop);e=Math.max(e,t.viewWidth-t.contentLeft-t.contentWidth);o=Math.max(o,t.viewHeight-t.contentTop-t.contentHeight);Blockly.WidgetDiv.hide(true);Blockly.DropDownDiv.hideWithoutAnimation();this.scrollbar.set(-e-t.contentLeft,-o-t.contentTop)};Blockly.WorkspaceSvg.prototype.updateStackGlowScale_=function(){if(this.options.stackGlowBlur)this.options.stackGlowBlur.setAttribute("stdDeviation",Blockly.Colours.stackGlowSize/this.scale)};Blockly.WorkspaceSvg.getDimensionsPx_=function(e){var o=0;var t=0;if(e){o=e.getWidth();t=e.getHeight()}return{width:o,height:t}};Blockly.WorkspaceSvg.getContentDimensions_=function(e,o){if(e.scrollbar)return Blockly.WorkspaceSvg.getContentDimensionsBounded_(e,o);else return Blockly.WorkspaceSvg.getContentDimensionsExact_(e)};Blockly.WorkspaceSvg.getContentDimensionsExact_=function(e){var o=e.getBlocksBoundingBox();var t=e.scale;var i=o.width*t;var r=o.height*t;var n=o.x*t;var l=o.y*t;return{left:n,top:l,right:n+i,bottom:l+r,width:i,height:r}};Blockly.WorkspaceSvg.getContentDimensionsBounded_=function(e,o){var t=Blockly.WorkspaceSvg.getContentDimensionsExact_(e);var i=o.width;var r=o.height;var n=i/2;var l=r/2;var s=Math.min(t.left-n,t.right-i);var g=Math.max(t.right+n,t.left+i);var a=Math.min(t.top-l,t.bottom-r);var c=Math.max(t.bottom+l,t.top+r);var u={left:s,top:a,height:c-a,width:g-s};return u};Blockly.WorkspaceSvg.getTopLevelWorkspaceMetrics_=function(){var e=Blockly.WorkspaceSvg.getDimensionsPx_(this.toolbox_);var o=Blockly.WorkspaceSvg.getDimensionsPx_(this.flyout_);var t=Blockly.svgSize(this.getParentSvg());if(this.toolbox_)if(this.toolboxPosition==Blockly.TOOLBOX_AT_TOP||this.toolboxPosition==Blockly.TOOLBOX_AT_BOTTOM)t.height-=e.height;else if(this.toolboxPosition==Blockly.TOOLBOX_AT_LEFT||this.toolboxPosition==Blockly.TOOLBOX_AT_RIGHT)t.width-=e.width;var i=Blockly.WorkspaceSvg.getContentDimensions_(this,t);var r=0;if(this.toolbox_&&this.toolboxPosition==Blockly.TOOLBOX_AT_LEFT)r=e.width;var n=0;if(this.toolbox_&&this.toolboxPosition==Blockly.TOOLBOX_AT_TOP)n=e.height;var l={contentHeight:i.height,contentWidth:i.width,contentTop:i.top,contentLeft:i.left,viewHeight:t.height,viewWidth:t.width,viewTop:-this.scrollY,viewLeft:-this.scrollX,absoluteTop:n,absoluteLeft:r,toolboxWidth:e.width,toolboxHeight:e.height,flyoutWidth:o.width,flyoutHeight:o.height,toolboxPosition:this.toolboxPosition};return l};Blockly.WorkspaceSvg.setTopLevelWorkspaceMetrics_=function(e){if(!this.scrollbar)throw"Attempt to set top level workspace scroll without scrollbars.";var o=this.getMetrics();if(goog.isNumber(e.x))this.scrollX=-o.contentWidth*e.x-o.contentLeft;if(goog.isNumber(e.y))this.scrollY=-o.contentHeight*e.y-o.contentTop;var t=this.scrollX+o.absoluteLeft;var i=this.scrollY+o.absoluteTop;this.translate(t,i);if(this.grid_)this.grid_.moveTo(t,i)};Blockly.WorkspaceSvg.prototype.setResizesEnabled=function(e){var o=!this.resizesEnabled_&&e;this.resizesEnabled_=e;if(o)this.resizeContents()};Blockly.WorkspaceSvg.prototype.setToolboxRefreshEnabled=function(e){var o=!this.toolboxRefreshEnabled_&&e;this.toolboxRefreshEnabled_=e;if(o)this.refreshToolboxSelection_()};Blockly.WorkspaceSvg.prototype.clear=function(){this.setResizesEnabled(false);Blockly.WorkspaceSvg.superClass_.clear.call(this);this.setResizesEnabled(true)};Blockly.WorkspaceSvg.prototype.registerButtonCallback=function(e,o){goog.asserts.assert(goog.isFunction(o),"Button callbacks must be functions.");this.flyoutButtonCallbacks_[e]=o};Blockly.WorkspaceSvg.prototype.getButtonCallback=function(e){var o=this.flyoutButtonCallbacks_[e];return o?o:null};Blockly.WorkspaceSvg.prototype.removeButtonCallback=function(e){this.flyoutButtonCallbacks_[e]=null};Blockly.WorkspaceSvg.prototype.registerToolboxCategoryCallback=function(e,o){goog.asserts.assert(goog.isFunction(o),"Toolbox category callbacks must be functions.");this.toolboxCategoryCallbacks_[e]=o};Blockly.WorkspaceSvg.prototype.getToolboxCategoryCallback=function(e){var o=this.toolboxCategoryCallbacks_[e];return o?o:null};Blockly.WorkspaceSvg.prototype.removeToolboxCategoryCallback=function(e){this.toolboxCategoryCallbacks_[e]=null};Blockly.WorkspaceSvg.prototype.getGesture=function(e){var o="mousedown"==e.type||"touchstart"==e.type;var t=this.currentGesture_;if(t){if(o&&t.hasStarted()){t.cancel();return null}return t}if(o){this.currentGesture_=new Blockly.Gesture(e,this);return this.currentGesture_}return null};Blockly.WorkspaceSvg.prototype.clearGesture=function(){this.currentGesture_=null};Blockly.WorkspaceSvg.prototype.cancelCurrentGesture=function(){if(this.currentGesture_)this.currentGesture_.cancel()};Blockly.WorkspaceSvg.prototype.startDragWithFakeEvent=function(e,o){Blockly.Touch.clearTouchIdentifier();Blockly.Touch.checkTouchIdentifier(e);var t=o.workspace.getGesture(e);t.forceStartBlockDrag(e,o)};Blockly.WorkspaceSvg.prototype.getAudioManager=function(){return this.audioManager_};Blockly.WorkspaceSvg.prototype.getGrid=function(){return this.grid_};Blockly.WorkspaceSvg.prototype["setVisible"]=Blockly.WorkspaceSvg.prototype.setVisible;goog.provide("Blockly.WorkspaceDragger");goog.require("goog.math.Coordinate");goog.require("goog.asserts");Blockly.WorkspaceDragger=function(e){this.workspace_=e;this.startDragMetrics_=e.getMetrics();this.startScrollXY_=new goog.math.Coordinate(e.scrollX,e.scrollY)};Blockly.WorkspaceDragger.prototype.dispose=function(){this.workspace_=null};Blockly.WorkspaceDragger.prototype.startDrag=function(){if(Blockly.selected)Blockly.selected.unselect();this.workspace_.setupDragSurface()};Blockly.WorkspaceDragger.prototype.endDrag=function(e){this.drag(e);this.workspace_.resetDragSurface()};Blockly.WorkspaceDragger.prototype.drag=function(e){var o=this.startDragMetrics_;var t=goog.math.Coordinate.sum(this.startScrollXY_,e);var i=Math.min(t.x,-o.contentLeft);var r=Math.min(t.y,-o.contentTop);i=Math.max(i,o.viewWidth-o.contentLeft-o.contentWidth);r=Math.max(r,o.viewHeight-o.contentTop-o.contentHeight);i=-i-o.contentLeft;r=-r-o.contentTop;this.updateScroll_(i,r)};Blockly.WorkspaceDragger.prototype.updateScroll_=function(e,o){this.workspace_.scrollbar.set(e,o)};goog.provide("Blockly.FlyoutDragger");goog.require("Blockly.WorkspaceDragger");goog.require("goog.asserts");goog.require("goog.math.Coordinate");Blockly.FlyoutDragger=function(e){Blockly.FlyoutDragger.superClass_.constructor.call(this,e.getWorkspace());this.scrollbar_=e.scrollbar_;this.horizontalLayout_=e.horizontalLayout_};goog.inherits(Blockly.FlyoutDragger,Blockly.WorkspaceDragger);Blockly.FlyoutDragger.prototype.updateScroll_=function(e,o){if(this.horizontalLayout_)this.scrollbar_.set(e);else this.scrollbar_.set(o)};goog.provide("Blockly.ZoomControls");goog.require("Blockly.Touch");goog.require("goog.dom");Blockly.ZoomControls=function(e){this.workspace_=e};Blockly.ZoomControls.prototype.ZOOM_IN_PATH_="zoom-in.svg";Blockly.ZoomControls.prototype.ZOOM_OUT_PATH_="zoom-out.svg";Blockly.ZoomControls.prototype.ZOOM_RESET_PATH_="zoom-reset.svg";Blockly.ZoomControls.prototype.WIDTH_=36;Blockly.ZoomControls.prototype.HEIGHT_=124;Blockly.ZoomControls.prototype.MARGIN_BETWEEN_=8;Blockly.ZoomControls.prototype.MARGIN_BOTTOM_=12;Blockly.ZoomControls.prototype.MARGIN_SIDE_=12;Blockly.ZoomControls.prototype.svgGroup_=null;Blockly.ZoomControls.prototype.left_=0;Blockly.ZoomControls.prototype.top_=0;Blockly.ZoomControls.prototype.createDom=function(){this.svgGroup_=Blockly.utils.createSvgElement("g",{class:"blocklyZoom"},null);this.createZoomOutSvg_();this.createZoomInSvg_();this.createZoomResetSvg_();return this.svgGroup_};Blockly.ZoomControls.prototype.init=function(e){this.bottom_=this.MARGIN_BOTTOM_+e;return this.bottom_+this.HEIGHT_};Blockly.ZoomControls.prototype.dispose=function(){if(this.svgGroup_){goog.dom.removeNode(this.svgGroup_);this.svgGroup_=null}this.workspace_=null};Blockly.ZoomControls.prototype.position=function(){var e=this.workspace_.getMetrics();if(!e)return;if(this.workspace_.RTL){this.left_=this.MARGIN_SIDE_+Blockly.Scrollbar.scrollbarThickness;if(e.toolboxPosition==Blockly.TOOLBOX_AT_LEFT){this.left_+=e.flyoutWidth;if(this.workspace_.toolbox_)this.left_+=e.absoluteLeft}}else{this.left_=e.viewWidth+e.absoluteLeft-this.WIDTH_-this.MARGIN_SIDE_-Blockly.Scrollbar.scrollbarThickness;if(e.toolboxPosition==Blockly.TOOLBOX_AT_RIGHT)this.left_-=e.flyoutWidth}this.top_=e.viewHeight+e.absoluteTop-this.HEIGHT_-this.bottom_;if(e.toolboxPosition==Blockly.TOOLBOX_AT_BOTTOM)this.top_-=e.flyoutHeight;this.svgGroup_.setAttribute("transform","translate("+this.left_+","+this.top_+")")};Blockly.ZoomControls.prototype.createZoomOutSvg_=function(){var e=this.workspace_;var o=Blockly.utils.createSvgElement("image",{width:this.WIDTH_,height:this.WIDTH_,y:1*this.WIDTH_+1*this.MARGIN_BETWEEN_},this.svgGroup_);o.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",e.options.pathToMedia+this.ZOOM_OUT_PATH_);Blockly.bindEventWithChecks_(o,"mousedown",null,(function(o){e.markFocused();e.zoomCenter(-1);Blockly.Touch.clearTouchIdentifier();o.stopPropagation();o.preventDefault()}))};Blockly.ZoomControls.prototype.createZoomInSvg_=function(){var e=this.workspace_;var o=Blockly.utils.createSvgElement("image",{width:this.WIDTH_,height:this.WIDTH_,y:0},this.svgGroup_);o.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",e.options.pathToMedia+this.ZOOM_IN_PATH_);Blockly.bindEventWithChecks_(o,"mousedown",null,(function(o){e.markFocused();e.zoomCenter(1);Blockly.Touch.clearTouchIdentifier();o.stopPropagation();o.preventDefault()}))};Blockly.ZoomControls.prototype.createZoomResetSvg_=function(){var e=this.workspace_;var o=Blockly.utils.createSvgElement("image",{width:this.WIDTH_,height:this.WIDTH_,y:2*this.WIDTH_+2*this.MARGIN_BETWEEN_},this.svgGroup_);o.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",e.options.pathToMedia+this.ZOOM_RESET_PATH_);Blockly.bindEventWithChecks_(o,"mousedown",null,(function(o){e.markFocused();e.setScale(e.options.zoomOptions.startScale);e.scrollCenter();Blockly.Touch.clearTouchIdentifier();o.stopPropagation();o.preventDefault()}))};goog.provide("Blockly.Xml");goog.require("Blockly.Events.BlockCreate");goog.require("Blockly.Events.VarCreate");goog.require("goog.asserts");goog.require("goog.dom");Blockly.Xml.workspaceToDom=function(e,o){var t=goog.dom.createDom("xml");t.appendChild(Blockly.Xml.variablesToDom(e.getAllVariables()));var i=e.getTopComments(true).filter((function(e){return e instanceof Blockly.WorkspaceComment}));for(var r=0,n;n=i[r];r++)t.appendChild(n.toXmlWithXY(o));var l=e.getTopBlocks(true);for(var r=0,s;s=l[r];r++)t.appendChild(Blockly.Xml.blockToDomWithXY(s,o));return t};Blockly.Xml.variablesToDom=function(e){var o=goog.dom.createDom("variables");for(var t=0,i;i=e[t];t++){var r=goog.dom.createDom("variable",null,i.name);r.setAttribute("type",i.type);r.setAttribute("id",i.getId());r.setAttribute("islocal",i.isLocal);r.setAttribute("isCloud",i.isCloud);o.appendChild(r)}return o};Blockly.Xml.blockToDomWithXY=function(e,o){var t;if(e.workspace.RTL)t=e.workspace.getWidth();var i=Blockly.Xml.blockToDom(e,o);var r=e.getRelativeToSurfaceXY();i.setAttribute("x",Math.round(e.workspace.RTL?t-r.x:r.x));i.setAttribute("y",Math.round(r.y));return i};Blockly.Xml.fieldToDomVariable_=function(e){var o=e.getValue();if(null==o){e.initModel();o=e.getValue()}var t=e.getVariable();if(!t)throw Error("Tried to serialize a variable field with no variable.");var i=goog.dom.createDom("field",null,t.name);i.setAttribute("name",e.name);i.setAttribute("id",t.getId());i.setAttribute("variabletype",t.type);return i};Blockly.Xml.fieldToDom_=function(e){if(e.name&&e.SERIALIZABLE)if(e.referencesVariables())return Blockly.Xml.fieldToDomVariable_(e);else{var o=goog.dom.createDom("field",null,e.getValue());o.setAttribute("name",e.name);return o}return null};Blockly.Xml.allFieldsToDom_=function(e,o){for(var t=0,i;i=e.inputList[t];t++)for(var r=0,n;n=i.fieldRow[r];r++){var l=Blockly.Xml.fieldToDom_(n);if(l)o.appendChild(l)}};Blockly.Xml.blockToDom=function(e,o){var t=goog.dom.createDom(e.isShadow()?"shadow":"block");t.setAttribute("type",e.type);if(!o)t.setAttribute("id",e.id);if(e.mutationToDom){var i=e.mutationToDom();if(i&&(i.hasChildNodes()||i.hasAttributes()))t.appendChild(i)}Blockly.Xml.allFieldsToDom_(e,t);Blockly.Xml.scratchCommentToDom_(e,t);if(e.data){var r=goog.dom.createDom("data",null,e.data);t.appendChild(r)}for(var n=0,l;l=e.inputList[n];n++){var s;var g=true;if(l.type==Blockly.DUMMY_INPUT)continue;else{var a=l.connection.targetBlock();if(l.type==Blockly.INPUT_VALUE)s=goog.dom.createDom("value");else if(l.type==Blockly.NEXT_STATEMENT)s=goog.dom.createDom("statement");var c=l.connection.getShadowDom();if(c&&(!a||!a.isShadow())){var u=Blockly.Xml.cloneShadow_(c);if(o&&u.getAttribute("id"))u.removeAttribute("id");s.appendChild(u)}if(a){s.appendChild(Blockly.Xml.blockToDom(a,o));g=false}}s.setAttribute("name",l.name);if(!g)t.appendChild(s)}if(e.inputsInlineDefault!=e.inputsInline)t.setAttribute("inline",e.inputsInline);if(e.isCollapsed())t.setAttribute("collapsed",true);if(e.disabled)t.setAttribute("disabled",true);if(!e.isDeletable()&&!e.isShadow())t.setAttribute("deletable",false);if(!e.isMovable()&&!e.isShadow())t.setAttribute("movable",false);if(!e.isEditable())t.setAttribute("editable",false);var h=e.getNextBlock();if(h){var s=goog.dom.createDom("next",null,Blockly.Xml.blockToDom(h,o));t.appendChild(s)}var c=e.nextConnection&&e.nextConnection.getShadowDom();if(c&&(!h||!h.isShadow()))s.appendChild(Blockly.Xml.cloneShadow_(c));return t};Blockly.Xml.scratchCommentToDom_=function(e,o){var t=e.getCommentText();if(t){var i=goog.dom.createDom("comment",null,t);if("object"==typeof e.comment){i.setAttribute("id",e.comment.id);i.setAttribute("pinned",e.comment.isVisible());var r;if(e.comment instanceof Blockly.ScratchBlockComment)r=e.comment.getHeightWidth();else r=e.comment.getBubbleSize();i.setAttribute("h",r.height);i.setAttribute("w",r.width);var n=e.comment.getXY();i.setAttribute("x",Math.round(e.workspace.RTL?e.workspace.getWidth()-n.x-r.width:n.x));i.setAttribute("y",n.y);i.setAttribute("minimized",e.comment.isMinimized())}o.appendChild(i)}};Blockly.Xml.cloneShadow_=function(e){e=e.cloneNode(true);var o=e;var t;while(o)if(o.firstChild)o=o.firstChild;else{while(o&&!o.nextSibling){t=o;o=o.parentNode;if(3==t.nodeType&&""==t.data.trim()&&o.firstChild!=t)goog.dom.removeNode(t)}if(o){t=o;o=o.nextSibling;if(3==t.nodeType&&""==t.data.trim())goog.dom.removeNode(t)}}return e};Blockly.Xml.domToText=function(e){var o=new XMLSerializer;return o.serializeToString(e)};Blockly.Xml.domToPrettyText=function(e){var o=Blockly.Xml.domToText(e);var t=o.split("<");var i="";for(var r=1;r<t.length;r++){var n=t[r];if("/"==n[0])i=i.substring(2);t[r]=i+"<"+n;if("/"!=n[0]&&"/>"!=n.slice(-2))i+="  "}var l=t.join("\n");l=l.replace(/(<(\w+)\b[^>]*>[^\n]*)\n *<\/\2>/g,"$1</$2>");return l.replace(/^\n/,"")};Blockly.Xml.textToDom=function(e){var o=new DOMParser;var t=o.parseFromString(e,"text/xml");if(!t||!t.firstChild||"xml"!=t.firstChild.nodeName.toLowerCase()||t.firstChild!==t.lastChild)goog.asserts.fail("Blockly.Xml.textToDom did not obtain a valid XML tree.");return t.firstChild};Blockly.Xml.clearWorkspaceAndLoadFromXml=function(e,o){o.setResizesEnabled(false);o.setToolboxRefreshEnabled(false);o.clear();var t=Blockly.Xml.domToWorkspace(e,o);o.setResizesEnabled(true);o.setToolboxRefreshEnabled(true);return t};Blockly.Xml.domToWorkspace=function(e,o){if(e instanceof Blockly.Workspace){var t=e;e=o;o=t;console.warn("Deprecated call to Blockly.Xml.domToWorkspace, "+"swap the arguments.")}var i;if(o.RTL)i=o.getWidth();var r=[];Blockly.Field.startCache();var n=e.childNodes.length;var l=Blockly.Events.getGroup();if(!l)Blockly.Events.setGroup(true);if(o.setResizesEnabled)o.setResizesEnabled(false);var s=true;try{for(var g=0;g<n;g++){var a=e.childNodes[g];var c=a.nodeName.toLowerCase();if("block"==c||"shadow"==c&&!Blockly.Events.recordUndo){var u=Blockly.Xml.domToBlock(a,o);r.push(u.id);var h=a.hasAttribute("x")?parseInt(a.getAttribute("x"),10):10;var d=a.hasAttribute("y")?parseInt(a.getAttribute("y"),10):10;if(!isNaN(h)&&!isNaN(d)){u.moveBy(o.RTL?i-h:h,d);if(u.comment&&"object"===typeof u.comment){var p=u.comment.getXY();var y=u.comment.getBubbleSize().width;u.comment.moveTo(u.workspace.RTL?i-p.x-y:p.x,p.y)}}s=false}else if("shadow"==c){goog.asserts.fail("Shadow block cannot be a top-level block.");s=false}else if("comment"==c)if(o.rendered)Blockly.WorkspaceCommentSvg.fromXml(a,o,i);else Blockly.WorkspaceComment.fromXml(a,o);else if("variables"==c){if(s)Blockly.Xml.domToVariables(a,o);else throw Error("'variables' tag must exist once before block and "+"shadow tag elements in the workspace XML, but it was found in "+"another location.");s=false}}}finally{if(!l)Blockly.Events.setGroup(false);Blockly.Field.stopCache()}if(o.setResizesEnabled)o.setResizesEnabled(true);return r};Blockly.Xml.appendDomToWorkspace=function(e,o){var t;if(o.hasOwnProperty("scale")){var i=Blockly.BlockSvg.TAB_WIDTH;try{Blockly.BlockSvg.TAB_WIDTH=0;t=o.getBlocksBoundingBox()}finally{Blockly.BlockSvg.TAB_WIDTH=i}}var r=Blockly.Xml.domToWorkspace(e,o);if(t&&t.height){var n=0;var l=0;var s=t.y+t.height;var g=t.x;var a=1/0;var c=1/0;for(var u=0;u<r.length;u++){var h=o.getBlockById(r[u]).getRelativeToSurfaceXY();if(h.y<c)c=h.y;if(h.x<a)a=h.x}n=s-c+Blockly.BlockSvg.SEP_SPACE_Y;l=g-a;var d;if(o.RTL)d=o.getWidth();for(var u=0;u<r.length;u++){var p=o.getBlockById(r[u]);p.moveBy(o.RTL?d-l:l,n)}}return r};Blockly.Xml.domToBlock=function(e,o){if(e instanceof Blockly.Workspace){var t=e;e=o;o=t;console.warn("Deprecated call to Blockly.Xml.domToBlock, "+"swap the arguments.")}Blockly.Events.disable();var i=o.getAllVariables();try{var r=Blockly.Xml.domToBlockHeadless_(e,o);var n=r.getDescendants(false);if(o.rendered){r.setConnectionsHidden(true);for(var l=n.length-1;l>=0;l--)n[l].initSvg();for(var l=n.length-1;l>=0;l--)n[l].render(false);if(!o.isFlyout)setTimeout((function(){if(r.workspace)r.setConnectionsHidden(false)}),1);r.updateDisabled();o.resizeContents()}else for(var l=n.length-1;l>=0;l--)n[l].initModel()}finally{Blockly.Events.enable()}if(Blockly.Events.isEnabled()){var s=Blockly.Variables.getAddedVariables(o,i);for(var l=0;l<s.length;l++){var g=s[l];Blockly.Events.fire(new Blockly.Events.VarCreate(g))}Blockly.Events.fire(new Blockly.Events.BlockCreate(r))}return r};Blockly.Xml.domToVariables=function(e,o){for(var t=0,i;i=e.children[t];t++){var r=i.getAttribute("type");var n=i.getAttribute("id");var l="true"==i.getAttribute("islocal");var s="true"==i.getAttribute("iscloud");var g=i.textContent;if(void 0===typeof r||null===r)throw Error("Variable with id, "+n+" is without a type");o.createVariable(g,r,n,l,s)}};Blockly.Xml.domToBlockHeadless_=function(e,o){var t=null;var i=e.getAttribute("type");goog.asserts.assert(i,"Block type unspecified: %s",e.outerHTML);var r=e.getAttribute("id");t=o.newBlock(i,r);var n=null;for(var l=0,s;s=e.childNodes[l];l++){if(3==s.nodeType)continue;var g;var a=null;var c=null;for(var u=0,h;h=s.childNodes[u];u++)if(1==h.nodeType)if("block"==h.nodeName.toLowerCase())a=h;else if("shadow"==h.nodeName.toLowerCase())c=h;if(!a&&c)a=c;var d=s.getAttribute("name");switch(s.nodeName.toLowerCase()){case"mutation":if(t.domToMutation){t.domToMutation(s);if(t.initSvg)t.initSvg()}break;case"comment":var p=s.getAttribute("id");var y=parseInt(s.getAttribute("x"),10);var f=parseInt(s.getAttribute("y"),10);var m=s.getAttribute("minimized")||false;t.setCommentText(s.textContent,p,y,f,"true"==m);var _=s.getAttribute("pinned");if(_&&!t.isInFlyout)setTimeout((function(){if(t.comment&&t.comment.setVisible)t.comment.setVisible("true"==_)}),1);var v=parseInt(s.getAttribute("w"),10);var k=parseInt(s.getAttribute("h"),10);if(!isNaN(v)&&!isNaN(k)&&t.comment&&t.comment.setVisible)if(t.comment instanceof Blockly.ScratchBlockComment)t.comment.setSize(v,k);else t.comment.setBubbleSize(v,k);break;case"data":t.data=s.textContent;break;case"title":case"field":Blockly.Xml.domToField_(t,d,s);break;case"value":case"statement":g=t.getInput(d);if(!g){console.warn("Ignoring non-existent input "+d+" in block "+i);break}if(c)g.connection.setShadowDom(c);if(a){n=Blockly.Xml.domToBlockHeadless_(a,o);if(n.outputConnection)g.connection.connect(n.outputConnection);else if(n.previousConnection)g.connection.connect(n.previousConnection);else goog.asserts.fail("Child block does not have output or previous statement.")}break;case"next":if(c&&t.nextConnection)t.nextConnection.setShadowDom(c);if(a){goog.asserts.assert(t.nextConnection,"Next statement does not exist.");goog.asserts.assert(!t.nextConnection.isConnected(),"Next statement is already connected.");n=Blockly.Xml.domToBlockHeadless_(a,o);goog.asserts.assert(n.previousConnection,"Next block does not have previous statement.");t.nextConnection.connect(n.previousConnection)}break;default:console.warn("Ignoring unknown tag: "+s.nodeName)}}var B=e.getAttribute("inline");if(B)t.setInputsInline("true"==B);var E=e.getAttribute("disabled");if(E)t.setDisabled("true"==E||"disabled"==E);var T=e.getAttribute("deletable");if(T)t.setDeletable("true"==T);var b=e.getAttribute("movable");if(b)t.setMovable("true"==b);var S=e.getAttribute("editable");if(S)t.setEditable("true"==S);var C=e.getAttribute("collapsed");if(C)t.setCollapsed("true"==C);if("shadow"==e.nodeName.toLowerCase()){var D=t.getChildren(false);for(var l=0,A;A=D[l];l++)goog.asserts.assert(A.isShadow(),"Shadow block not allowed non-shadow child.");t.setShadow(true)}return t};Blockly.Xml.domToFieldVariable_=function(e,o,t,i){var r=o.getAttribute("variabletype")||"";if("''"==r)r="";var n;if(!e.getPotentialVariableMap()&&!e.isFlyout&&e.getFlyout()){var l=e.getFlyout().getWorkspace();n=Blockly.Variables.realizePotentialVar(t,r,l,true)}if(!n)n=Blockly.Variables.getOrCreateVariablePackage(e,o.id,t,r);if(null!=r&&r!==n.type)throw Error("Serialized variable type with id '"+n.getId()+"' had type "+n.type+", and "+"does not match variable field that references it: "+Blockly.Xml.domToText(o)+".");i.setValue(n.getId())};Blockly.Xml.domToField_=function(e,o,t){var i=e.getField(o);if(!i){console.warn("Ignoring non-existent field "+o+" in block "+e.type);return}var r=e.workspace;var n=t.textContent;if(i.referencesVariables())Blockly.Xml.domToFieldVariable_(r,t,n,i);else i.setValue(n)};Blockly.Xml.deleteNext=function(e){for(var o=0,t;t=e.childNodes[o];o++)if("next"==t.nodeName.toLowerCase()){e.removeChild(t);break}};if(!goog.global["Blockly"])goog.global["Blockly"]={};if(!goog.global["Blockly"]["Xml"])goog.global["Blockly"]["Xml"]={};goog.global["Blockly"]["Xml"]["domToText"]=Blockly.Xml.domToText;goog.global["Blockly"]["Xml"]["domToWorkspace"]=Blockly.Xml.domToWorkspace;goog.global["Blockly"]["Xml"]["textToDom"]=Blockly.Xml.textToDom;goog.global["Blockly"]["Xml"]["workspaceToDom"]=Blockly.Xml.workspaceToDom;goog.global["Blockly"]["Xml"]["clearWorkspaceAndLoadFromXml"]=Blockly.Xml.clearWorkspaceAndLoadFromXml;
